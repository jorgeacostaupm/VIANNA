var X7=Object.defineProperty;var Y7=(wa,vn,_n)=>vn in wa?X7(wa,vn,{enumerable:!0,configurable:!0,writable:!0,value:_n}):wa[vn]=_n;var Wn=(wa,vn,_n)=>Y7(wa,typeof vn!="symbol"?vn+"":vn,_n);(function(){"use strict";class _n{constructor(t){this._size=t,this._bits=new Uint32Array(Math.ceil(t/32))}get length(){return this._size}count(){const t=this._bits.length;let r=0;for(let n=0;n<t;++n)for(let a=this._bits[n];a;++r)a&=a-1;return r}get(t){return this._bits[t>>5]&2147483648>>>t}set(t){this._bits[t>>5]|=2147483648>>>t}clear(t){this._bits[t>>5]&=~(2147483648>>>t)}scan(t){for(let r=this.next(0);r>=0;r=this.next(r+1))t(r)}next(t){const r=this._bits,n=r.length;let a=t>>5,i=r[a]&4294967295>>>t;for(;a<n;i=r[++a])if(i!==0)return(a<<5)+Math.clz32(i);return-1}nth(t){let r=this.next(0);for(;t--&&r>=0;)r=this.next(r+1);return r}not(){const t=this._bits,r=t.length;for(let a=0;a<r;++a)t[a]=~t[a];const n=this._size%32;return n&&(t[r-1]&=2147483648>>n-1),this}and(t){if(t){const r=this._bits,n=t._bits,a=r.length;for(let i=0;i<a;++i)r[i]&=n[i]}return this}or(t){if(t){const r=this._bits,n=t._bits,a=r.length;for(let i=0;i<a;++i)r[i]|=n[i]}return this}}function Xv(e,t,r,n,a){return e==null?null:e<t?-1/0:e>r?1/0:(e=Math.max(t,Math.min(e,r)),t+n*Math.floor(1e-14+(e-t)/n+(a||0)))}function yn(e){return e instanceof Date}function Os(e){return e instanceof RegExp}function wn(e){return e===Object(e)}function Bc(e,t){return e==null||t==null||e!==e||t!==t?!1:e===t?!0:yn(e)||yn(t)?+e==+t:Os(e)&&Os(t)?e+""==t+"":wn(e)&&wn(t)?Yv(e,t):!1}function Yv(e,t){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;if(e.length||t.length)return Xf(e,t);const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length||(r.sort(),n.sort(),!Xf(r,n,(i,s)=>i===s)))return!1;const a=r.length;for(let i=0;i<a;++i){const s=r[i];if(!Bc(e[s],t[s]))return!1}return!0}function Xf(e,t,r=Bc){const n=e.length;if(n!==t.length)return!1;for(let a=0;a<n;++a)if(!r(e[a],t[a]))return!1;return!0}function Jv(e,t,r){if(t instanceof Map){if(t.has(e))return t.get(e)}else{const n=`${e}`;if(Object.hasOwn(t,n))return t[n]}return r!==void 0?r:e}function Qv(e,t,r){let n=arguments.length;e=+e,t=+t,r=n<2?(t=e,e=0,1):n<3?1:+r,n=Math.max(0,Math.ceil((t-e)/r))|0;const a=new Array(n);for(let i=0;i<n;++i)a[i]=e+i*r;return a}const Oe=void 0;function Ot(e){return Array.isArray(e)}const Zv=Object.getPrototypeOf(Int8Array);function Rs(e){return e instanceof Zv}function En(e){return Ot(e)||Rs(e)}function mr(e){return typeof e=="string"}function xr(e){return e!=null&&e===e}const si=e=>En(e)||mr(e);function jv(e){return En(e)?e.filter(t=>xr(t)):e}function e2(...e){return[].concat(...e)}function t2(e,t,r){return si(e)?e.includes(t,r):!1}function r2(e,t){return si(e)?e.indexOf(t):-1}function n2(e,t){return En(e)?e.join(t):Oe}function a2(e,t){return si(e)?e.lastIndexOf(t):-1}function i2(e){return si(e)?e.length:0}function s2(e,t){return En(e)?e.map(r=>xr(r)?r[t]:Oe):Oe}function o2(e){return En(e)?e.slice().reverse():mr(e)?e.split("").reverse().join(""):Oe}function c2(e,t,r){return si(e)?e.slice(t,r):Oe}var u2=Object.freeze({__proto__:null,compact:jv,concat:e2,includes:t2,indexof:r2,join:n2,lastindexof:a2,length:i2,pluck:s2,reverse:o2,slice:c2});function Ns(e,t,r="0"){const n=e+"",a=n.length;return a<t?Array(t-a+1).join(r)+n:n}const Rr=e=>(e<10?"0":"")+e,f2=e=>e<0?"-"+Ns(-e,6):e>9999?"+"+Ns(e,6):Ns(e,4);function Yf(e,t,r,n,a,i,s,c,f){const u=c?"Z":"";return f2(e)+"-"+Rr(t+1)+"-"+Rr(r)+(!f||s?"T"+Rr(n)+":"+Rr(a)+":"+Rr(i)+"."+Ns(s,3)+u:i?"T"+Rr(n)+":"+Rr(a)+":"+Rr(i)+u:a||n||!c?"T"+Rr(n)+":"+Rr(a)+u:"")}function Jf(e,t){return isNaN(e)?"Invalid Date":Yf(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),!1,t)}function Ds(e,t){return isNaN(e)?"Invalid Date":Yf(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds(),!0,t)}const l2=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function Qf(e){return e.match(l2)&&!isNaN(Date.parse(e))}function h2(e,t=Date.parse){return Qf(e)?t(e):e}const Zf=6e4,jf=864e5,el=6048e5,Ke=new Date,Xe=new Date,Ze=e=>(Ke.setTime(typeof e=="string"?h2(e):e),Ke);function d2(e,t){return Jf(Ze(e),!t)}function p2(e,t){return Ds(Ze(e),!t)}function m2(){return Date.now()}function x2(e){return+Ze(e)}function g2(e,t,r,n,a,i,s){return arguments.length?new Date(e,t||0,r??1,n||0,a||0,i||0,s||0):new Date(Date.now())}function v2(e){return Ze(e).getFullYear()}function _2(e){return Math.floor(Ze(e).getMonth()/3)}function y2(e){return Ze(e).getMonth()}function w2(e,t){const r=t||0;Xe.setTime(+e),Xe.setDate(Xe.getDate()-(Xe.getDay()+7-r)%7),Xe.setHours(0,0,0,0),Ke.setTime(+e),Ke.setMonth(0),Ke.setDate(1),Ke.setDate(1-(Ke.getDay()+7-r)%7),Ke.setHours(0,0,0,0);const n=(Xe.getTimezoneOffset()-Ke.getTimezoneOffset())*Zf;return Math.floor((1+(+Xe-+Ke)-n)/el)}function E2(e){return Ze(e).getDate()}function k2(e){Xe.setTime(+e),Xe.setHours(0,0,0,0),Ke.setTime(+Xe),Ke.setMonth(0),Ke.setDate(1);const t=(Xe.getTimezoneOffset()-Ke.getTimezoneOffset())*Zf;return Math.floor(1+(+Xe-+Ke-t)/jf)}function T2(e){return Ze(e).getDay()}function A2(e){return Ze(e).getHours()}function C2(e){return Ze(e).getMinutes()}function b2(e){return Ze(e).getSeconds()}function S2(e){return Ze(e).getMilliseconds()}function F2(e,t,r,n,a,i,s){return arguments.length?new Date(Date.UTC(e,t||0,r??1,n||0,a||0,i||0,s||0)):new Date(Date.now())}function I2(e){return Ze(e).getUTCFullYear()}function O2(e){return Math.floor(Ze(e).getUTCMonth()/3)}function R2(e){return Ze(e).getUTCMonth()}function N2(e,t){const r=t||0;return Xe.setTime(+e),Xe.setUTCDate(Xe.getUTCDate()-(Xe.getUTCDay()+7-r)%7),Xe.setUTCHours(0,0,0,0),Ke.setTime(+e),Ke.setUTCMonth(0),Ke.setUTCDate(1),Ke.setUTCDate(1-(Ke.getUTCDay()+7-r)%7),Ke.setUTCHours(0,0,0,0),Math.floor((1+(+Xe-+Ke))/el)}function D2(e){return Ze(e).getUTCDate()}function P2(e){Xe.setTime(+e),Xe.setUTCHours(0,0,0,0);const t=Date.UTC(Xe.getUTCFullYear(),0,1);return Math.floor(1+(+Xe-t)/jf)}function L2(e){return Ze(e).getUTCDay()}function B2(e){return Ze(e).getUTCHours()}function M2(e){return Ze(e).getUTCMinutes()}function U2(e){return Ze(e).getUTCSeconds()}function V2(e){return Ze(e).getUTCMilliseconds()}var $2=Object.freeze({__proto__:null,date:E2,datetime:g2,dayofweek:T2,dayofyear:k2,format_date:d2,format_utcdate:p2,hours:A2,milliseconds:S2,minutes:C2,month:y2,now:m2,quarter:_2,seconds:b2,timestamp:x2,utcdate:D2,utcdatetime:F2,utcdayofweek:L2,utcdayofyear:P2,utchours:B2,utcmilliseconds:V2,utcminutes:M2,utcmonth:R2,utcquarter:O2,utcseconds:U2,utcweek:N2,utcyear:I2,week:w2,year:v2});function H2(e){return JSON.parse(e)}function W2(e){return JSON.stringify(e)}var z2=Object.freeze({__proto__:null,parse_json:H2,to_json:W2});let G2=Math.random;function Ea(){return G2()}function q2(){return Ea()}function K2(e){return Number.isNaN(e)}function X2(e){return Number.isFinite(e)}function Y2(e){return Math.abs(e)}function J2(e){return Math.cbrt(e)}function Q2(e){return Math.ceil(e)}function Z2(e){return Math.clz32(e)}function j2(e){return Math.exp(e)}function e_(e){return Math.expm1(e)}function t_(e){return Math.floor(e)}function r_(e){return Math.fround(e)}function n_(...e){return Math.max(...e)}function a_(...e){return Math.min(...e)}function i_(e){return Math.log(e)}function s_(e){return Math.log10(e)}function o_(e){return Math.log1p(e)}function c_(e){return Math.log2(e)}function u_(e,t){return Math.pow(e,t)}function f_(e){return Math.round(e)}function l_(e){return Math.sign(e)}function h_(e){return Math.sqrt(e)}function d_(e){return Math.trunc(e)}function p_(e){return 180*e/Math.PI}function m_(e){return Math.PI*e/180}function x_(e){return Math.acos(e)}function g_(e){return Math.acosh(e)}function v_(e){return Math.asin(e)}function __(e){return Math.asinh(e)}function y_(e){return Math.atan(e)}function w_(e,t){return Math.atan2(e,t)}function E_(e){return Math.atanh(e)}function k_(e){return Math.cos(e)}function T_(e){return Math.cosh(e)}function A_(e){return Math.sin(e)}function C_(e){return Math.sinh(e)}function b_(e){return Math.tan(e)}function S_(e){return Math.tanh(e)}var F_=Object.freeze({__proto__:null,abs:Y2,acos:x_,acosh:g_,asin:v_,asinh:__,atan:y_,atan2:w_,atanh:E_,cbrt:J2,ceil:Q2,clz32:Z2,cos:k_,cosh:T_,degrees:p_,exp:j2,expm1:e_,floor:t_,fround:r_,greatest:n_,is_finite:X2,is_nan:K2,least:a_,log:i_,log10:s_,log1p:o_,log2:c_,pow:u_,radians:m_,random:q2,round:f_,sign:l_,sin:A_,sinh:C_,sqrt:h_,tan:b_,tanh:S_,trunc:d_});function Mc(e){return e instanceof Map}function I_(e){return e instanceof Set}function Ps(e){return Mc(e)||I_(e)}function Uc(e){return Array.from(e)}function O_(e,t){return Ps(e)?e.has(t):e!=null?Object.hasOwn(e,`${t}`):!1}function R_(e){return Mc(e)?Uc(e.keys()):e!=null?Object.keys(e):[]}function N_(e){return Ps(e)?Uc(e.values()):e!=null?Object.values(e):[]}function D_(e){return Ps(e)?Uc(e.entries()):e!=null?Object.entries(e):[]}function P_(e){return e?Object.fromEntries(e):Oe}var L_=Object.freeze({__proto__:null,entries:D_,has:O_,keys:R_,object:P_,values:N_});function B_(e){return e==null?e:new Date(e)}function M_(e){return e==null?e:Number.parseFloat(e)}function U_(e,t){return e==null?e:Number.parseInt(e,t)}function V_(e,t,r){return e==null?!1:String(e).endsWith(t,r)}function $_(e,t,r){const n=e==null?e:String(e).match(t);return r==null||n==null?n:typeof r=="number"?n[r]:n.groups?n.groups[r]:null}function H_(e,t){return e==null?e:String(e).normalize(t)}function W_(e,t,r){return e==null?e:String(e).padEnd(t,r)}function z_(e,t,r){return e==null?e:String(e).padStart(t,r)}function G_(e){return e==null?e:String(e).toUpperCase()}function q_(e){return e==null?e:String(e).toLowerCase()}function K_(e,t){return e==null?e:String(e).repeat(t)}function X_(e,t,r){return e==null?e:String(e).replace(t,String(r))}function Y_(e,t,r){return e==null?[]:String(e).split(t,r)}function J_(e,t,r){return e==null?!1:String(e).startsWith(t,r)}function Q_(e,t,r){return e==null?e:String(e).substring(t,r)}function Z_(e){return e==null?e:String(e).trim()}var j_=Object.freeze({__proto__:null,endswith:V_,lower:q_,match:$_,normalize:H_,padend:W_,padstart:z_,parse_date:B_,parse_float:M_,parse_int:U_,repeat:K_,replace:X_,split:Y_,startswith:J_,substring:Q_,trim:Z_,upper:G_});const kn={bin:Xv,equal:Bc,recode:Jv,sequence:Qv,...u2,...$2,...z2,...F_,...L_,...j_};function Nr(e){return e!=null?Ot(e)?e:[e]:[]}function oi(e){return typeof e=="bigint"}function jt(e){return e===void 0?e+"":oi(e)?e+"n":JSON.stringify(e)}let ey=class{constructor(t,r,n){this.name=t,this.fields=r,this.params=n}toString(){const t=[...this.fields.map(r=>`d[${jt(r)}]`),...this.params.map(jt)];return`d => op.${this.name}(${t})`}toObject(){return{expr:this.toString(),func:!0}}};function ye(e,t=[],r=[]){return new ey(e,Nr(t),Nr(r))}const tl=e=>ye("any",e),rl=()=>ye("count"),nl=e=>ye("array_agg",e),al=e=>ye("array_agg_distinct",e),il=(e,t)=>ye("map_agg",[e,t]),sl=(e,t)=>ye("object_agg",[e,t]),ol=(e,t)=>ye("entries_agg",[e,t]),zn={...kn,row_object:(...e)=>ye("row_object",null,e.flat()),count:rl,any:tl,array_agg:nl,array_agg_distinct:al,object_agg:sl,map_agg:il,entries_agg:ol,valid:e=>ye("valid",e),invalid:e=>ye("invalid",e),distinct:e=>ye("distinct",e),mode:e=>ye("mode",e),sum:e=>ye("sum",e),product:e=>ye("product",e),mean:e=>ye("mean",e),average:e=>ye("average",e),variance:e=>ye("variance",e),variancep:e=>ye("variancep",e),stdev:e=>ye("stdev",e),stdevp:e=>ye("stdevp",e),min:e=>ye("min",e),max:e=>ye("max",e),quantile:(e,t)=>ye("quantile",e,t),median:e=>ye("median",e),covariance:(e,t)=>ye("covariance",[e,t]),covariancep:(e,t)=>ye("covariancep",[e,t]),corr:(e,t)=>ye("corr",[e,t]),bins:(e,t,r,n,a)=>ye("bins",e,[t,r,n,a]),row_number:()=>ye("row_number"),rank:()=>ye("rank"),avg_rank:()=>ye("avg_rank"),dense_rank:()=>ye("dense_rank"),percent_rank:()=>ye("percent_rank"),cume_dist:()=>ye("cume_dist"),ntile:e=>ye("ntile",null,e),lag:(e,t,r)=>ye("lag",e,[t,r]),lead:(e,t,r)=>ye("lead",e,[t,r]),first_value:e=>ye("first_value",e),last_value:e=>ye("last_value",e),nth_value:(e,t)=>ye("nth_value",e,t),fill_down:(e,t)=>ye("fill_down",e,t),fill_up:(e,t)=>ye("fill_up",e,t)};function Be(e,t){throw Error(e,{cause:t})}function ty(e,t){e=Ps(e)?e:new Set(e);let r=t,n=0;for(;e.has(r);)r=t+ ++n;return r}function xt(e){return typeof e=="function"}function ka(e,t){const r=Array(e);if(xt(t))for(let n=0;n<e;++n)r[n]=t(n);else r.fill(t);return r}function ry(e,t,r=15,n=!0,a=0,i){const c=Math.LN10;if(i==null){const f=Math.ceil(Math.log(r)/c),u=t-e||Math.abs(e)||1,o=[5,2];for(i=Math.max(a,Math.pow(10,Math.round(Math.log(u)/c)-f));Math.ceil(u/i)>r;)i*=10;const l=o.length;for(let h=0;h<l;++h){const d=i/o[h];d>=a&&u/d<=r&&(i=d)}}if(n){let f=Math.log(i);const u=f>=0?0:~~(-f/c)+1,o=Math.pow(10,-u-1);f=Math.floor(e/i+o)*i,e=e<f?f-i:f,t=Math.ceil(t/i)*i}return[e,t===e?e+i:t,i]}function Ta(e){const t=typeof e;return t==="string"?`"${e}"`:t!=="object"||!e?e:yn(e)?+e:Ot(e)||Rs(e)?`[${e.map(Ta)}]`:Os(e)?e+"":ny(e)}function ny(e){let t="{",r=-1;for(const n in e)++r>0&&(t+=","),t+=`"${n}":${Ta(e[n])}`;return t+="}",t}function Ls(e,t){const r=e.length;return r===1?(n,a)=>Ta(e[0](n,a)):(n,a)=>{let i="";for(let s=0;s<r;++s){s>0&&(i+="|");const c=e[s](n,a);if(t&&(c==null||c!==c))return null;i+=Ta(c)}return i}}function ay(){const e=new Map;return{count(){return e.size},values(){return Array.from(e.values(),t=>t.v)},increment(t){const r=Ta(t),n=e.get(r);n?++n.n:e.set(r,{v:t,n:1})},decrement(t){const r=Ta(t),n=e.get(r);n.n===1?e.delete(r):--n.n},forEach(t){e.forEach(({v:r,n})=>t(r,n))}}}function Yr(){}function iy(e,t=0,r=e.length){let n=e[t++];for(let a=t;a<r;++a)n*=e[a];return n}function ot(e){return e.init=e.init||Yr,e.add=e.add||Yr,e.rem=e.rem||Yr,e}function cl(e,t){return e.product_v=!1,e.product=t}const ul={count:{create:()=>ot({value:e=>e.count}),param:[]},array_agg:{create:()=>ot({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[1]},object_agg:{create:()=>ot({init:e=>e.values=!0,value:e=>Object.fromEntries(e.list.values())}),param:[2]},map_agg:{create:()=>ot({init:e=>e.values=!0,value:e=>new Map(e.list.values())}),param:[2]},entries_agg:{create:()=>ot({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[2]},any:{create:()=>ot({add:(e,t)=>{e.any==null&&(e.any=t)},value:e=>e.valid?e.any:Oe}),param:[1]},valid:{create:()=>ot({value:e=>e.valid}),param:[1]},invalid:{create:()=>ot({value:e=>e.count-e.valid}),param:[1]},distinct:{create:()=>({init:e=>e.distinct=ay(),value:e=>e.distinct.count()+(e.valid===e.count?0:1),add:(e,t)=>e.distinct.increment(t),rem:(e,t)=>e.distinct.decrement(t)}),param:[1]},array_agg_distinct:{create:()=>ot({value:e=>e.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>ot({value:e=>{let t=Oe,r=0;return e.distinct.forEach((n,a)=>{a>r&&(r=a,t=n)}),t}}),param:[1],req:["distinct"]},sum:{create:()=>({init:e=>e.sum=0,value:e=>e.valid?e.sum:Oe,add:(e,t)=>oi(t)?e.sum===0?e.sum=t:e.sum+=t:e.sum+=+t,rem:(e,t)=>e.sum-=t}),param:[1]},product:{create:()=>({init:e=>cl(e,1),value:e=>e.valid?e.product_v?cl(e,iy(e.list.values())):e.product:void 0,add:(e,t)=>oi(t)&&e.product===1?e.product=t:e.product*=t,rem:(e,t)=>t==0||t===1/0||t===-1/0?e.product_v=!0:e.product/=t}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:e=>e.mean=0,value:e=>e.valid?e.mean:Oe,add:(e,t)=>{e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:(e,t)=>{e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}}),param:[1]},average:{create:()=>ot({value:e=>e.valid?e.mean:Oe}),param:[1],req:["mean"]},variance:{create:()=>({init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):Oe,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean)}),param:[1],req:["mean"]},variancep:{create:()=>ot({value:e=>e.valid>1?e.dev/e.valid:Oe}),param:[1],req:["variance"]},stdev:{create:()=>ot({value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):Oe}),param:[1],req:["variance"]},stdevp:{create:()=>ot({value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):Oe}),param:[1],req:["variance"]},min:{create:()=>({init:e=>e.min=Oe,value:e=>e.min=Number.isNaN(e.min)?e.list.min():e.min,add:(e,t)=>{(t<e.min||e.min===Oe)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:e=>e.max=Oe,value:e=>e.max=Number.isNaN(e.max)?e.list.max():e.max,add:(e,t)=>{(t>e.max||e.max===Oe)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:e=>ot({value:t=>t.list.quantile(e)}),param:[1,1],req:["array_agg"]},median:{create:()=>ot({value:e=>e.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:e=>{e.cov=e.mean_x=e.mean_y=e.dev_x=e.dev_y=0},value:e=>e.valid>1?e.cov/(e.valid-1):Oe,add:(e,t,r)=>{const n=t-e.mean_x,a=r-e.mean_y;e.mean_x+=n/e.valid,e.mean_y+=a/e.valid;const i=r-e.mean_y;e.dev_x+=n*(t-e.mean_x),e.dev_y+=a*i,e.cov+=n*i},rem:(e,t,r)=>{const n=t-e.mean_x,a=r-e.mean_y;e.mean_x-=e.valid?n/e.valid:e.mean_x,e.mean_y-=e.valid?a/e.valid:e.mean_y;const i=r-e.mean_y;e.dev_x-=n*(t-e.mean_x),e.dev_y-=a*i,e.cov-=n*i}}),param:[2]},covariancep:{create:()=>ot({value:e=>e.valid>1?e.cov/e.valid:Oe}),param:[2],req:["covariance"]},corr:{create:()=>ot({value:e=>e.valid>1?e.cov/(Math.sqrt(e.dev_x)*Math.sqrt(e.dev_y)):Oe}),param:[2],req:["covariance"]},bins:{create:(e,t,r,n)=>ot({value:a=>ry(a.min,a.max,e,t,r,n)}),param:[1,4],req:["min","max"]}},fl={create(){let e;return{init:()=>e=1,value:t=>{const r=t.index;return r&&!t.peer(r)?e=r+1:e}}},param:[]},ll={create(){let e;return{init:()=>e=0,value:t=>{const{index:r,peer:n,size:a}=t;let i=r;if(e<i){for(;i+1<a&&n(i+1);)++i;e=i}return(1+e)/a}}},param:[]},hl={row_number:{create(){return{init:Yr,value:e=>e.index+1}},param:[]},rank:fl,avg_rank:{create(){let e,t;return{init:()=>(e=-1,t=1),value:r=>{const n=r.index;if(n>=e){for(t=e=n+1;r.peer(e);t+=++e);t/=e-n}return t}}},param:[]},dense_rank:{create(){let e;return{init:()=>e=1,value:t=>{const r=t.index;return r&&!t.peer(r)?++e:e}}},param:[]},percent_rank:{create(){const{init:e,value:t}=fl.create();return{init:e,value:r=>(t(r)-1)/(r.size-1)}},param:[]},cume_dist:ll,ntile:{create(e){e=+e,e>0||Be("ntile num must be greater than zero.");const{init:t,value:r}=ll.create();return{init:t,value:n=>Math.ceil(e*r(n))}},param:[0,1]},lag:{create(e,t=Oe){return e=+e||1,{init:Yr,value:(r,n)=>{const a=r.index-e;return a>=0?r.value(a,n):t}}},param:[1,2]},lead:{create(e,t=Oe){return e=+e||1,{init:Yr,value:(r,n)=>{const a=r.index+e;return a<r.size?r.value(a,n):t}}},param:[1,2]},first_value:{create(){return{init:Yr,value:(e,t)=>e.value(e.i0,t)}},param:[1]},last_value:{create(){return{init:Yr,value:(e,t)=>e.value(e.i1-1,t)}},param:[1]},nth_value:{create(e){return e=+e,e>0||Be("nth_value nth must be greater than zero."),{init:Yr,value:(t,r)=>{const n=t.i0+(e-1);return n<t.i1?t.value(n,r):Oe}}},param:[1,1]},fill_down:{create(e=Oe){let t;return{init:()=>t=e,value:(r,n)=>{const a=r.value(r.index,n);return xr(a)?t=a:t}}},param:[1,1]},fill_up:{create(e=Oe){let t,r;return{init:()=>(t=e,r=-1),value:(n,a)=>n.index<=r?t:(r=sy(n,a,n.index))>=0?t=n.value(r,a):(r=n.size,t=e)}},param:[1,1]}};function sy(e,t,r){for(const n=e.size;r<n;++r)if(xr(e.value(r,t)))return r;return-1}function Vc(e){return Object.hasOwn(ul,e)}function $c(e){return Object.hasOwn(hl,e)}function dl(e){return Object.hasOwn(kn,e)||e==="row_object"}function pl(e){return Vc(e)&&ul[e]}function ml(e){return $c(e)&&hl[e]}function ci(e,t=(n,a)=>n,r=""){const n=e.length;if(!n)return"";let a=t(e[0],0);for(let i=1;i<n;++i)a+=r+t(e[i],i);return a}function Aa(e,t,...r){const n=["_","$"],a=n.slice(0,r.length);return a.push('"use strict"; const '+r.map((i,s)=>i.map((c,f)=>`${n[s]}${f} = ${n[s]}[${f}]`).join(", ")).join(", ")+`; return (${e}) => ${t};`),Function(...a)(...r)}function Hc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function oy(e,t=0,r=e.length){let n=r?e[t++]:Oe;for(let a=t;a<r;++a)n<e[a]&&(n=e[a]);return n}function cy(e,t=0,r=e.length){let n=r?e[t++]:Oe;for(let a=t;a<r;++a)n>e[a]&&(n=e[a]);return n}function Bs(e){return oi(e)?e:+e}function uy(e,t){const r=e.length;if(!r)return Oe;if((t=+t)<=0||r<2)return Bs(e[0]);if(t>=1)return Bs(e[r-1]);const n=(r-1)*t,a=Math.floor(n),i=Bs(e[a]);return oi(i)?i:i+(Bs(e[a+1])-i)*(n-a)}class fy{constructor(t){this._values=t||[],this._sorted=null,this._start=0}values(t){return this._start&&(this._values=this._values.slice(this._start),this._start=0),t?this._values.slice():this._values}add(t){this._values.push(t),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:cy(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:oy(this._values,this._start)}quantile(t){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(Hc)),uy(this._sorted,t)}}class ly{constructor(t){this._outputs=t}size(){return this._outputs.length}outputs(){return this._outputs}init(t){return{}}add(t,r,n){}rem(t,r,n){}write(t,r,n){}}const Ms=(e,t,r)=>Aa(t,"{"+ci(e,(n,a)=>`_${a}.${r}(${t});`)+"}",e);function hy(e,t){const{ops:r,output:n}=dy(e,t),a=e[0].fields,i=a.length,s=i===0?Wc:i===1?py:i===2?my:Be("Unsupported field count: "+i);return new s(a,r,n,t)}function dy(e,t){const r={},n=[];function a(s,c=[]){const f=s+":"+c;if(r[f])return r[f];const u=pl(s),o=u.create(...c);return t<0&&u.stream&&u.stream.forEach(l=>a(l,[])),u.req&&u.req.forEach(l=>a(l,[])),r[f]=o,n.push(o),o}const i=e.map(s=>{const c=a(s.name,s.params);return c.output=s.id,c});return{ops:n,output:i}}class Wc extends ly{constructor(t,r,n,a){super(n),this._op=r,this._fields=t,this._stream=!!a}init(){const t={count:0,valid:0,stream:this._stream};return this._op.forEach(r=>r.init(t)),t.values&&(t.list=new fy),t}write(t,r,n){const a=this._outputs,i=a.length;for(let s=0;s<i;++s)r[a[s].output][n]=a[s].value(t);return 1}_add(){}_rem(){}add(t){++t.count}rem(t){--t.count}}class py extends Wc{constructor(t,r,n,a){super(t,r,n,a);const i=["state","v1","v2"];this._add=Ms(r,i,"add"),this._rem=Ms(r,i,"rem")}add(t,r,n){const a=this._fields[0](r,n);++t.count,xr(a)&&(++t.valid,t.list&&t.list.add(a),this._add(t,a))}rem(t,r,n){const a=this._fields[0](r,n);--t.count,xr(a)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,a))}}class my extends Wc{constructor(t,r,n,a){super(t,r,n,a);const i=["state","v1","v2"];this._add=Ms(r,i,"add"),this._rem=Ms(r,i,"rem")}add(t,r,n){const a=this._fields[0](r,n),i=this._fields[1](r,n);++t.count,xr(a)&&xr(i)&&(++t.valid,t.list&&t.list.add([a,i]),this._add(t,a,i))}rem(t,r,n){const a=this._fields[0](r,n),i=this._fields[1](r,n);--t.count,xr(a)&&xr(i)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,a,i))}}function Gn(e,t,r){if(t.length){const n=e.data(),{keys:a}=e.groups()||{},i=Ca(e,t),s=a?(c,f)=>i[c][a[f]]:c=>i[c][0];r=r.map(c=>f=>c(f,n,s))}return r}function Ca(e,t,r){if(!t.length)return r;const n=xl(t),a=e.groups(),i=a?a.size:1;return r=r||ka(t.length,()=>Array(i)),i>1?n.forEach(s=>{const c=vl(e,s,a);for(let f=0;f<i;++f)s.write(c[f],r,f)}):n.forEach(s=>{const c=gl(e,s);s.write(c,r,0)}),r}function xl(e,t){const r=[],n={};for(const a of e){const i=a.fields.map(s=>s+"").join(",");(n[i]||(n[i]=[])).push(a)}for(const a in n)r.push(hy(n[a],t));return r}function gl(e,t){const r=t.init(),n=e.totalRows(),a=e.data(),i=e.mask();if(e.isOrdered()){const s=e.indices();for(let c=0;c<n;++c)t.add(r,s[c],a)}else if(i)for(let s=i.next(0);s>=0;s=i.next(s+1))t.add(r,s,a);else for(let s=0;s<n;++s)t.add(r,s,a);return r}function vl(e,t,r){const{keys:n,size:a}=r,i=ka(a,()=>t.init()),s=e.data();if(e.isOrdered()){const c=e.indices(),f=c.length;for(let u=0;u<f;++u){const o=c[u];t.add(i[n[o]],o,s)}}else if(e.isFiltered()){const c=e.mask();for(let f=c.next(0);f>=0;f=c.next(f+1))t.add(i[n[f]],f,s)}else{const c=e.totalRows();for(let f=0;f<c;++f)t.add(i[n[f]],f,s)}return i}function _l(e,t){const{get:r,names:n,rows:a,size:i}=t,s=n.length;for(let c=0;c<s;++c){const f=e.add(n[c],Array(i)),u=r[c];for(let o=0;o<i;++o)f[o]=u(a[o])}}function Us(e){return Ot(e)?e:Mc(e)?e.entries():e?Object.entries(e):[]}const xy="ArrayPattern",gy="ArrowFunctionExpression",vy="FunctionExpression",Tn="Identifier",ba="Literal",yl="MemberExpression",_y="ObjectExpression",wl="ObjectPattern",El="Property",kl="Column",yy="Constant",wy="Dictionary",Ey="Function",ky="Parameter",Tl="Op";function Se(e,t,r,n){const a=r[e.type]||r.Default;if(a&&a(e,t,n)===!1)return;const i=Ty[e.type];i&&i(e,t,r)}const Vs=(e,t,r)=>{Se(e.argument,t,r,e)},zc=(e,t,r)=>{Se(e.left,t,r,e),Se(e.right,t,r,e)},Al=(e,t,r)=>{Se(e.test,t,r,e),Se(e.consequent,t,r,e),e.alternate&&Se(e.alternate,t,r,e)},Gc=(e,t,r)=>{Dr(e.params,t,r,e),Se(e.body,t,r,e)},Cl=(e,t,r)=>{Se(e.callee,t,r,e),Dr(e.arguments,t,r,e)},Dr=(e,t,r,n)=>{e.forEach(a=>Se(a,t,r,n))},Ty={TemplateLiteral:(e,t,r)=>{Dr(e.expressions,t,r,e),Dr(e.quasis,t,r,e)},MemberExpression:(e,t,r)=>{Se(e.object,t,r,e),Se(e.property,t,r,e)},CallExpression:Cl,NewExpression:Cl,ArrayExpression:(e,t,r)=>{Dr(e.elements,t,r,e)},AssignmentExpression:zc,AwaitExpression:Vs,BinaryExpression:zc,LogicalExpression:zc,UnaryExpression:Vs,UpdateExpression:Vs,ConditionalExpression:Al,ObjectExpression:(e,t,r)=>{Dr(e.properties,t,r,e)},Property:(e,t,r)=>{Se(e.key,t,r,e),Se(e.value,t,r,e)},ArrowFunctionExpression:Gc,FunctionExpression:Gc,FunctionDeclaration:Gc,VariableDeclaration:(e,t,r)=>{Dr(e.declarations,t,r,e)},VariableDeclarator:(e,t,r)=>{Se(e.id,t,r,e),Se(e.init,t,r,e)},SpreadElement:(e,t,r)=>{Se(e.argument,t,r,e)},BlockStatement:(e,t,r)=>{Dr(e.body,t,r,e)},ExpressionStatement:(e,t,r)=>{Se(e.expression,t,r,e)},IfStatement:Al,ForStatement:(e,t,r)=>{Se(e.init,t,r,e),Se(e.test,t,r,e),Se(e.update,t,r,e),Se(e.body,t,r,e)},WhileStatement:(e,t,r)=>{Se(e.test,t,r,e),Se(e.body,t,r,e)},DoWhileStatement:(e,t,r)=>{Se(e.body,t,r,e),Se(e.test,t,r,e)},SwitchStatement:(e,t,r)=>{Se(e.discriminant,t,r,e),Dr(e.cases,t,r,e)},SwitchCase:(e,t,r)=>{e.test&&Se(e.test,t,r,e),Dr(e.consequent,t,r,e)},ReturnStatement:Vs,Program:(e,t,r)=>{Se(e.body[0],t,r,e)}};function bl(e){delete e.start,delete e.end,delete e.optional}function Sl(e){bl(e),delete e.object,delete e.property,delete e.computed,e.table||delete e.table}function Ay(e){return Se(e,null,{Column:Sl,Constant:Sl,Default:bl}),e}function ct(e,t){return t&&t.type===e}function Cy(e){return ct(vy,e)||ct(gy,e)}const $e=(e,t)=>{const r=Sy[e.type];return r?r(e,t):Be(`Unsupported expression construct: ${e.type}`)},qc=(e,t)=>"("+$e(e.left,t)+" "+e.operator+" "+$e(e.right,t)+")",Kc=(e,t)=>"("+Pr(e.params,t)+")=>"+$e(e.body,t),Fl=(e,t)=>$e(e.callee,t)+"("+Pr(e.arguments,t)+")",Pr=(e,t,r=",")=>e.map(n=>$e(n,t)).join(r),Xc=e=>e.computed?`[${jt(e.name)}]`:`.${e.name}`,Il=(e,t,r)=>{const n=e.table||"";return`data${n}${Xc(e)}.${r}(${t.index}${n})`},by=(e,t)=>{const r=e.table||"";return`data${r}${Xc(e)}[${t.index}${r}]`},Sy={Constant:e=>e.raw,Column:(e,t)=>e.array?by(e,t):Il(e,t,"at"),Dictionary:(e,t)=>Il(e,t,"key"),Function:e=>`fn.${e.name}`,Parameter:e=>`$${Xc(e)}`,Op:(e,t)=>`op(${jt(e.name)},${t.op||t.index})`,Literal:e=>e.raw,Identifier:e=>e.name,TemplateLiteral:(e,t)=>{const{quasis:r,expressions:n}=e,a=n.length;let i=r[0].value.raw;for(let s=0;s<a;)i+="${"+$e(n[s],t)+"}"+r[++s].value.raw;return"`"+i+"`"},MemberExpression:(e,t)=>{const r=!e.computed,n=$e(e.object,t),a=$e(e.property,t);return n+(r?"."+a:"["+a+"]")},CallExpression:Fl,NewExpression:(e,t)=>"new "+Fl(e,t),ArrayExpression:(e,t)=>"["+Pr(e.elements,t)+"]",AssignmentExpression:qc,BinaryExpression:qc,LogicalExpression:qc,UnaryExpression:(e,t)=>"("+e.operator+$e(e.argument,t)+")",ConditionalExpression:(e,t)=>"("+$e(e.test,t)+"?"+$e(e.consequent,t)+":"+$e(e.alternate,t)+")",ObjectExpression:(e,t)=>"({"+Pr(e.properties,t)+"})",Property:(e,t)=>{const r=$e(e.key,t);return(e.computed?`[${r}]`:r)+":"+$e(e.value,t)},ArrowFunctionExpression:Kc,FunctionExpression:Kc,FunctionDeclaration:Kc,ArrayPattern:(e,t)=>"["+Pr(e.elements,t)+"]",ObjectPattern:(e,t)=>"{"+Pr(e.properties,t)+"}",VariableDeclaration:(e,t)=>e.kind+" "+Pr(e.declarations,t,","),VariableDeclarator:(e,t)=>$e(e.id,t)+"="+$e(e.init,t),SpreadElement:(e,t)=>"..."+$e(e.argument,t),BlockStatement:(e,t)=>"{"+Pr(e.body,t,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(e,t)=>$e(e.expression,t),IfStatement:(e,t)=>"if ("+$e(e.test,t)+")"+$e(e.consequent,t)+(e.alternate?" else "+$e(e.alternate,t):""),SwitchStatement:(e,t)=>"switch ("+$e(e.discriminant,t)+") {"+Pr(e.cases,t,"")+"}",SwitchCase:(e,t)=>(e.test?"case "+$e(e.test,t):"default")+": "+Pr(e.consequent,t,";")+";",ReturnStatement:(e,t)=>"return "+$e(e.argument,t),Program:(e,t)=>$e(e.body[0],t)};function $s(e,t={index:"row"}){return $e(e,t)}function ui(e,t,r){return e=`"use strict"; return ${e};`,Function("fn","$",e)(t,r)}const Yc={escape:(e,t,r)=>ui(e,t,r),expr:(e,t)=>ui(`(row,data,op)=>${e}`,kn,t),expr2:(e,t)=>ui(`(row0,data0,row,data)=>${e}`,kn,t),join:(e,t)=>ui(`(row1,data1,row2,data2)=>${e}`,kn,t),param:(e,t)=>ui(e,kn,t)},Fy={"==":1,"!=":1,"===":1,"!==":1};function Ol(e,t,r=0,n=void 0,a=void 0){if(e.type=kl,e.name=t,e.table=r,En(n)&&(e.array=!0),a&&n&&xt(n.keyFor)){const i=Fy[a.operator]?a.left===e?a.right:a.left:a.callee&&a.callee.name==="equal"?a.arguments[a.arguments[0]===e?1:0]:null;i&&i.type===ba&&Iy(a,e,i,n.keyFor(i.value))}return e}function Iy(e,t,r,n){return n<0?(e.type=ba,e.value=!1,e.raw="false"):(t.type=wy,r.value=n,r.raw=n+""),!0}const Hs="row_object";function Rl(e,t,r=t.columnNames()){e.type=_y;const n=e.properties=[];for(const a of Us(r)){const[i,s]=Ot(a)?a:[a,a];n.push({type:El,key:{type:ba,raw:jt(s)},value:Ol({computed:!0},i,0,t.column(i))})}return e}function Nl(e,t){return $s(Rl({},e,t))}function Dl(e,t){return Yc.expr(Nl(e,t))}function Oy(e){return xt(e)?e:()=>e}const Ry="Escaped functions are not valid as rollup or pivot values.";function Ny(e,t,r){e.aggronly&&Be(Ry);const n=`(row,data)=>fn(${Nl(e.table)},$)`;return{escape:Yc.escape(n,Oy(t.expr),r)}}var Dy=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],Pl=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],Py="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",Ll="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Jc={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},Qc="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Ly={5:Qc,"5module":Qc+" export import",6:Qc+" const class extends export import super"},By=/^in(stanceof)?$/,My=new RegExp("["+Ll+"]"),Uy=new RegExp("["+Ll+Py+"]");function Zc(e,t){for(var r=65536,n=0;n<t.length;n+=2){if(r+=t[n],r>e)return!1;if(r+=t[n+1],r>=e)return!0}return!1}function Jr(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&My.test(String.fromCharCode(e)):t===!1?!1:Zc(e,Pl)}function Sa(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&Uy.test(String.fromCharCode(e)):t===!1?!1:Zc(e,Pl)||Zc(e,Dy)}var Re=function(t,r){r===void 0&&(r={}),this.label=t,this.keyword=r.keyword,this.beforeExpr=!!r.beforeExpr,this.startsExpr=!!r.startsExpr,this.isLoop=!!r.isLoop,this.isAssign=!!r.isAssign,this.prefix=!!r.prefix,this.postfix=!!r.postfix,this.binop=r.binop||null,this.updateContext=null};function er(e,t){return new Re(e,{beforeExpr:!0,binop:t})}var tr={beforeExpr:!0},Ut={startsExpr:!0},jc={};function Ce(e,t){return t===void 0&&(t={}),t.keyword=e,jc[e]=new Re(e,t)}var A={num:new Re("num",Ut),regexp:new Re("regexp",Ut),string:new Re("string",Ut),name:new Re("name",Ut),privateId:new Re("privateId",Ut),eof:new Re("eof"),bracketL:new Re("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Re("]"),braceL:new Re("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Re("}"),parenL:new Re("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Re(")"),comma:new Re(",",tr),semi:new Re(";",tr),colon:new Re(":",tr),dot:new Re("."),question:new Re("?",tr),questionDot:new Re("?."),arrow:new Re("=>",tr),template:new Re("template"),invalidTemplate:new Re("invalidTemplate"),ellipsis:new Re("...",tr),backQuote:new Re("`",Ut),dollarBraceL:new Re("${",{beforeExpr:!0,startsExpr:!0}),eq:new Re("=",{beforeExpr:!0,isAssign:!0}),assign:new Re("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Re("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Re("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:er("||",1),logicalAND:er("&&",2),bitwiseOR:er("|",3),bitwiseXOR:er("^",4),bitwiseAND:er("&",5),equality:er("==/!=/===/!==",6),relational:er("</>/<=/>=",7),bitShift:er("<</>>/>>>",8),plusMin:new Re("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:er("%",10),star:er("*",10),slash:er("/",10),starstar:new Re("**",{beforeExpr:!0}),coalesce:er("??",1),_break:Ce("break"),_case:Ce("case",tr),_catch:Ce("catch"),_continue:Ce("continue"),_debugger:Ce("debugger"),_default:Ce("default",tr),_do:Ce("do",{isLoop:!0,beforeExpr:!0}),_else:Ce("else",tr),_finally:Ce("finally"),_for:Ce("for",{isLoop:!0}),_function:Ce("function",Ut),_if:Ce("if"),_return:Ce("return",tr),_switch:Ce("switch"),_throw:Ce("throw",tr),_try:Ce("try"),_var:Ce("var"),_const:Ce("const"),_while:Ce("while",{isLoop:!0}),_with:Ce("with"),_new:Ce("new",{beforeExpr:!0,startsExpr:!0}),_this:Ce("this",Ut),_super:Ce("super",Ut),_class:Ce("class",Ut),_extends:Ce("extends",tr),_export:Ce("export"),_import:Ce("import",Ut),_null:Ce("null",Ut),_true:Ce("true",Ut),_false:Ce("false",Ut),_in:Ce("in",{beforeExpr:!0,binop:7}),_instanceof:Ce("instanceof",{beforeExpr:!0,binop:7}),_typeof:Ce("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Ce("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Ce("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},rr=/\r\n?|\n|\u2028|\u2029/,Vy=new RegExp(rr.source,"g");function Fa(e){return e===10||e===13||e===8232||e===8233}function Bl(e,t,r){r===void 0&&(r=e.length);for(var n=t;n<r;n++){var a=e.charCodeAt(n);if(Fa(a))return n<r-1&&a===13&&e.charCodeAt(n+1)===10?n+2:n+1}return-1}var Ml=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,nr=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Ul=Object.prototype,$y=Ul.hasOwnProperty,Hy=Ul.toString,Ia=Object.hasOwn||function(e,t){return $y.call(e,t)},Vl=Array.isArray||function(e){return Hy.call(e)==="[object Array]"},$l=Object.create(null);function An(e){return $l[e]||($l[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function Qr(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var Wy=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,fi=function(t,r){this.line=t,this.column=r};fi.prototype.offset=function(t){return new fi(this.line,this.column+t)};var Ws=function(t,r,n){this.start=r,this.end=n,t.sourceFile!==null&&(this.source=t.sourceFile)};function Hl(e,t){for(var r=1,n=0;;){var a=Bl(e,n,t);if(a<0)return new fi(r,t-n);++r,n=a}}var eu={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Wl=!1;function zy(e){var t={};for(var r in eu)t[r]=e&&Ia(e,r)?e[r]:eu[r];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!Wl&&typeof console=="object"&&console.warn&&(Wl=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),Vl(t.onToken)){var n=t.onToken;t.onToken=function(a){return n.push(a)}}return Vl(t.onComment)&&(t.onComment=Gy(t,t.onComment)),t}function Gy(e,t){return function(r,n,a,i,s,c){var f={type:r?"Block":"Line",value:n,start:a,end:i};e.locations&&(f.loc=new Ws(this,s,c)),e.ranges&&(f.range=[a,i]),t.push(f)}}var li=1,Oa=2,tu=4,zl=8,ru=16,Gl=32,zs=64,ql=128,qn=256,hi=512,Gs=li|Oa|qn;function nu(e,t){return Oa|(e?tu:0)|(t?zl:0)}var qs=0,au=1,Zr=2,Kl=3,Xl=4,Yl=5,ut=function(t,r,n){this.options=t=zy(t),this.sourceFile=t.sourceFile,this.keywords=An(Ly[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var a="";t.allowReserved!==!0&&(a=Jc[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(a+=" await")),this.reservedWords=An(a);var i=(a?a+" ":"")+Jc.strict;this.reservedWordsStrict=An(i),this.reservedWordsStrictBind=An(i+" "+Jc.strictBind),this.input=String(r),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf(`
`,n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(rr).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=A.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(li),this.regexpState=null,this.privateNameStack=[]},Lr={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};ut.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},Lr.inFunction.get=function(){return(this.currentVarScope().flags&Oa)>0},Lr.inGenerator.get=function(){return(this.currentVarScope().flags&zl)>0},Lr.inAsync.get=function(){return(this.currentVarScope().flags&tu)>0},Lr.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],r=t.flags;if(r&(qn|hi))return!1;if(r&Oa)return(r&tu)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},Lr.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags;return(t&zs)>0||this.options.allowSuperOutsideMethod},Lr.allowDirectSuper.get=function(){return(this.currentThisScope().flags&ql)>0},Lr.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Lr.allowNewDotTarget.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],r=t.flags;if(r&(qn|hi)||r&Oa&&!(r&ru))return!0}return!1},Lr.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&qn)>0},ut.extend=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];for(var n=this,a=0;a<t.length;a++)n=t[a](n);return n},ut.parse=function(t,r){return new this(r,t).parse()},ut.parseExpressionAt=function(t,r,n){var a=new this(n,t,r);return a.nextToken(),a.parseExpression()},ut.tokenizer=function(t,r){return new this(r,t)},Object.defineProperties(ut.prototype,Lr);var Rt=ut.prototype,qy=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Rt.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){nr.lastIndex=e,e+=nr.exec(this.input)[0].length;var t=qy.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){nr.lastIndex=e+t[0].length;var r=nr.exec(this.input),n=r.index+r[0].length,a=this.input.charAt(n);return a===";"||a==="}"||rr.test(r[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(a)||a==="!"&&this.input.charAt(n+1)==="=")}e+=t[0].length,nr.lastIndex=e,e+=nr.exec(this.input)[0].length,this.input[e]===";"&&e++}},Rt.eat=function(e){return this.type===e?(this.next(),!0):!1},Rt.isContextual=function(e){return this.type===A.name&&this.value===e&&!this.containsEsc},Rt.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1},Rt.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},Rt.canInsertSemicolon=function(){return this.type===A.eof||this.type===A.braceR||rr.test(this.input.slice(this.lastTokEnd,this.start))},Rt.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},Rt.semicolon=function(){!this.eat(A.semi)&&!this.insertSemicolon()&&this.unexpected()},Rt.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},Rt.expect=function(e){this.eat(e)||this.unexpected()},Rt.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var Ks=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Rt.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var r=t?e.parenthesizedAssign:e.parenthesizedBind;r>-1&&this.raiseRecoverable(r,t?"Assigning to rvalue":"Parenthesized pattern")}},Rt.checkExpressionErrors=function(e,t){if(!e)return!1;var r=e.shorthandAssign,n=e.doubleProto;if(!t)return r>=0||n>=0;r>=0&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns"),n>=0&&this.raiseRecoverable(n,"Redefinition of __proto__ property")},Rt.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},Rt.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var de=ut.prototype;de.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==A.eof;){var r=this.parseStatement(null,!0,t);e.body.push(r)}if(this.inModule)for(var n=0,a=Object.keys(this.undefinedExports);n<a.length;n+=1){var i=a[n];this.raiseRecoverable(this.undefinedExports[i].start,"Export '"+i+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var iu={kind:"loop"},Ky={kind:"switch"};de.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;nr.lastIndex=this.pos;var t=nr.exec(this.input),r=this.pos+t[0].length,n=this.input.charCodeAt(r);if(n===91||n===92)return!0;if(e)return!1;if(n===123||n>55295&&n<56320)return!0;if(Jr(n,!0)){for(var a=r+1;Sa(n=this.input.charCodeAt(a),!0);)++a;if(n===92||n>55295&&n<56320)return!0;var i=this.input.slice(r,a);if(!By.test(i))return!0}return!1},de.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;nr.lastIndex=this.pos;var e=nr.exec(this.input),t=this.pos+e[0].length,r;return!rr.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(Sa(r=this.input.charCodeAt(t+8))||r>55295&&r<56320))},de.parseStatement=function(e,t,r){var n=this.type,a=this.startNode(),i;switch(this.isLet(e)&&(n=A._var,i="let"),n){case A._break:case A._continue:return this.parseBreakContinueStatement(a,n.keyword);case A._debugger:return this.parseDebuggerStatement(a);case A._do:return this.parseDoStatement(a);case A._for:return this.parseForStatement(a);case A._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(a,!1,!e);case A._class:return e&&this.unexpected(),this.parseClass(a,!0);case A._if:return this.parseIfStatement(a);case A._return:return this.parseReturnStatement(a);case A._switch:return this.parseSwitchStatement(a);case A._throw:return this.parseThrowStatement(a);case A._try:return this.parseTryStatement(a);case A._const:case A._var:return i=i||this.value,e&&i!=="var"&&this.unexpected(),this.parseVarStatement(a,i);case A._while:return this.parseWhileStatement(a);case A._with:return this.parseWithStatement(a);case A.braceL:return this.parseBlock(!0,a);case A.semi:return this.parseEmptyStatement(a);case A._export:case A._import:if(this.options.ecmaVersion>10&&n===A._import){nr.lastIndex=this.pos;var s=nr.exec(this.input),c=this.pos+s[0].length,f=this.input.charCodeAt(c);if(f===40||f===46)return this.parseExpressionStatement(a,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),n===A._import?this.parseImport(a):this.parseExport(a,r);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(a,!0,!e);var u=this.value,o=this.parseExpression();return n===A.name&&o.type==="Identifier"&&this.eat(A.colon)?this.parseLabeledStatement(a,u,o,e):this.parseExpressionStatement(a,o)}},de.parseBreakContinueStatement=function(e,t){var r=t==="break";this.next(),this.eat(A.semi)||this.insertSemicolon()?e.label=null:this.type!==A.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var n=0;n<this.labels.length;++n){var a=this.labels[n];if((e.label==null||a.name===e.label.name)&&(a.kind!=null&&(r||a.kind==="loop")||e.label&&r))break}return n===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,r?"BreakStatement":"ContinueStatement")},de.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},de.parseDoStatement=function(e){return this.next(),this.labels.push(iu),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(A._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(A.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},de.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(iu),this.enterScope(0),this.expect(A.parenL),this.type===A.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var r=this.isLet();if(this.type===A._var||this.type===A._const||r){var n=this.startNode(),a=r?"let":this.value;return this.next(),this.parseVar(n,!0,a),this.finishNode(n,"VariableDeclaration"),(this.type===A._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&n.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===A._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,n)):(t>-1&&this.unexpected(t),this.parseFor(e,n))}var i=this.isContextual("let"),s=!1,c=this.containsEsc,f=new Ks,u=this.start,o=t>-1?this.parseExprSubscripts(f,"await"):this.parseExpression(!0,f);return this.type===A._in||(s=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===A._in&&this.unexpected(t),e.await=!0):s&&this.options.ecmaVersion>=8&&(o.start===u&&!c&&o.type==="Identifier"&&o.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),i&&s&&this.raise(o.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(o,!1,f),this.checkLValPattern(o),this.parseForIn(e,o)):(this.checkExpressionErrors(f,!0),t>-1&&this.unexpected(t),this.parseFor(e,o))},de.parseFunctionStatement=function(e,t,r){return this.next(),this.parseFunction(e,di|(r?0:su),!1,t)},de.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(A._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},de.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(A.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},de.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(A.braceL),this.labels.push(Ky),this.enterScope(0);for(var t,r=!1;this.type!==A.braceR;)if(this.type===A._case||this.type===A._default){var n=this.type===A._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),n?t.test=this.parseExpression():(r&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),r=!0,t.test=null),this.expect(A.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},de.parseThrowStatement=function(e){return this.next(),rr.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var Xy=[];de.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?Gl:0),this.checkLValPattern(e,t?Xl:Zr),this.expect(A.parenR),e},de.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===A._catch){var t=this.startNode();this.next(),this.eat(A.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(A._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},de.parseVarStatement=function(e,t,r){return this.next(),this.parseVar(e,!1,t,r),this.semicolon(),this.finishNode(e,"VariableDeclaration")},de.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(iu),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},de.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},de.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},de.parseLabeledStatement=function(e,t,r,n){for(var a=0,i=this.labels;a<i.length;a+=1){var s=i[a];s.name===t&&this.raise(r.start,"Label '"+t+"' is already declared")}for(var c=this.type.isLoop?"loop":this.type===A._switch?"switch":null,f=this.labels.length-1;f>=0;f--){var u=this.labels[f];if(u.statementStart===e.start)u.statementStart=this.start,u.kind=c;else break}return this.labels.push({name:t,kind:c,statementStart:this.start}),e.body=this.parseStatement(n?n.indexOf("label")===-1?n+"label":n:"label"),this.labels.pop(),e.label=r,this.finishNode(e,"LabeledStatement")},de.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},de.parseBlock=function(e,t,r){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(A.braceL),e&&this.enterScope(0);this.type!==A.braceR;){var n=this.parseStatement(null);t.body.push(n)}return r&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")},de.parseFor=function(e,t){return e.init=t,this.expect(A.semi),e.test=this.type===A.semi?null:this.parseExpression(),this.expect(A.semi),e.update=this.type===A.parenR?null:this.parseExpression(),this.expect(A.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},de.parseForIn=function(e,t){var r=this.type===A._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!r||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(r?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=r?this.parseExpression():this.parseMaybeAssign(),this.expect(A.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,r?"ForInStatement":"ForOfStatement")},de.parseVar=function(e,t,r,n){for(e.declarations=[],e.kind=r;;){var a=this.startNode();if(this.parseVarId(a,r),this.eat(A.eq)?a.init=this.parseMaybeAssign(t):!n&&r==="const"&&!(this.type===A._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!n&&a.id.type!=="Identifier"&&!(t&&(this.type===A._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):a.init=null,e.declarations.push(this.finishNode(a,"VariableDeclarator")),!this.eat(A.comma))break}return e},de.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?au:Zr,!1)};var di=1,su=2,Jl=4;de.parseFunction=function(e,t,r,n,a){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!n)&&(this.type===A.star&&t&su&&this.unexpected(),e.generator=this.eat(A.star)),this.options.ecmaVersion>=8&&(e.async=!!n),t&di&&(e.id=t&Jl&&this.type!==A.name?null:this.parseIdent(),e.id&&!(t&su)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?au:Zr:Kl));var i=this.yieldPos,s=this.awaitPos,c=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(nu(e.async,e.generator)),t&di||(e.id=this.type===A.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,r,!1,a),this.yieldPos=i,this.awaitPos=s,this.awaitIdentPos=c,this.finishNode(e,t&di?"FunctionDeclaration":"FunctionExpression")},de.parseFunctionParams=function(e){this.expect(A.parenL),e.params=this.parseBindingList(A.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},de.parseClass=function(e,t){this.next();var r=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var n=this.enterClassBody(),a=this.startNode(),i=!1;for(a.body=[],this.expect(A.braceL);this.type!==A.braceR;){var s=this.parseClassElement(e.superClass!==null);s&&(a.body.push(s),s.type==="MethodDefinition"&&s.kind==="constructor"?(i&&this.raiseRecoverable(s.start,"Duplicate constructor in the same class"),i=!0):s.key&&s.key.type==="PrivateIdentifier"&&Yy(n,s)&&this.raiseRecoverable(s.key.start,"Identifier '#"+s.key.name+"' has already been declared"))}return this.strict=r,this.next(),e.body=this.finishNode(a,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},de.parseClassElement=function(e){if(this.eat(A.semi))return null;var t=this.options.ecmaVersion,r=this.startNode(),n="",a=!1,i=!1,s="method",c=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(A.braceL))return this.parseClassStaticBlock(r),r;this.isClassElementNameStart()||this.type===A.star?c=!0:n="static"}if(r.static=c,!n&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===A.star)&&!this.canInsertSemicolon()?i=!0:n="async"),!n&&(t>=9||!i)&&this.eat(A.star)&&(a=!0),!n&&!i&&!a){var f=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?s=f:n=f)}if(n?(r.computed=!1,r.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),r.key.name=n,this.finishNode(r.key,"Identifier")):this.parseClassElementName(r),t<13||this.type===A.parenL||s!=="method"||a||i){var u=!r.static&&Xs(r,"constructor"),o=u&&e;u&&s!=="method"&&this.raise(r.key.start,"Constructor can't have get/set modifier"),r.kind=u?"constructor":s,this.parseClassMethod(r,a,i,o)}else this.parseClassField(r);return r},de.isClassElementNameStart=function(){return this.type===A.name||this.type===A.privateId||this.type===A.num||this.type===A.string||this.type===A.bracketL||this.type.keyword},de.parseClassElementName=function(e){this.type===A.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)},de.parseClassMethod=function(e,t,r,n){var a=e.key;e.kind==="constructor"?(t&&this.raise(a.start,"Constructor can't be a generator"),r&&this.raise(a.start,"Constructor can't be an async method")):e.static&&Xs(e,"prototype")&&this.raise(a.start,"Classes may not have a static property named prototype");var i=e.value=this.parseMethod(t,r,n);return e.kind==="get"&&i.params.length!==0&&this.raiseRecoverable(i.start,"getter should have no params"),e.kind==="set"&&i.params.length!==1&&this.raiseRecoverable(i.start,"setter should have exactly one param"),e.kind==="set"&&i.params[0].type==="RestElement"&&this.raiseRecoverable(i.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")},de.parseClassField=function(e){return Xs(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&Xs(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(A.eq)?(this.enterScope(hi|zs),e.value=this.parseMaybeAssign(),this.exitScope()):e.value=null,this.semicolon(),this.finishNode(e,"PropertyDefinition")},de.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(qn|zs);this.type!==A.braceR;){var r=this.parseStatement(null);e.body.push(r)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")},de.parseClassId=function(e,t){this.type===A.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,Zr,!1)):(t===!0&&this.unexpected(),e.id=null)},de.parseClassSuper=function(e){e.superClass=this.eat(A._extends)?this.parseExprSubscripts(null,!1):null},de.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared},de.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,r=e.used;if(this.options.checkPrivateFields)for(var n=this.privateNameStack.length,a=n===0?null:this.privateNameStack[n-1],i=0;i<r.length;++i){var s=r[i];Ia(t,s.name)||(a?a.used.push(s):this.raiseRecoverable(s.start,"Private field '#"+s.name+"' must be declared in an enclosing class"))}};function Yy(e,t){var r=t.key.name,n=e[r],a="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(a=(t.static?"s":"i")+t.kind),n==="iget"&&a==="iset"||n==="iset"&&a==="iget"||n==="sget"&&a==="sset"||n==="sset"&&a==="sget"?(e[r]="true",!1):n?!0:(e[r]=a,!1)}function Xs(e,t){var r=e.computed,n=e.key;return!r&&(n.type==="Identifier"&&n.name===t||n.type==="Literal"&&n.value===t)}de.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==A.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")},de.parseExport=function(e,t){if(this.next(),this.eat(A.star))return this.parseExportAllDeclaration(e,t);if(this.eat(A._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[]);else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==A.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var r=0,n=e.specifiers;r<n.length;r+=1){var a=n[r];this.checkUnreserved(a.local),this.checkLocalExport(a.local),a.local.type==="Literal"&&this.raise(a.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[])}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},de.parseExportDeclaration=function(e){return this.parseStatement(null)},de.parseExportDefaultDeclaration=function(){var e;if(this.type===A._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,di|Jl,!1,e)}else if(this.type===A._class){var r=this.startNode();return this.parseClass(r,"nullableID")}else{var n=this.parseMaybeAssign();return this.semicolon(),n}},de.checkExport=function(e,t,r){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),Ia(e,t)&&this.raiseRecoverable(r,"Duplicate export '"+t+"'"),e[t]=!0)},de.checkPatternExport=function(e,t){var r=t.type;if(r==="Identifier")this.checkExport(e,t,t.start);else if(r==="ObjectPattern")for(var n=0,a=t.properties;n<a.length;n+=1){var i=a[n];this.checkPatternExport(e,i)}else if(r==="ArrayPattern")for(var s=0,c=t.elements;s<c.length;s+=1){var f=c[s];f&&this.checkPatternExport(e,f)}else r==="Property"?this.checkPatternExport(e,t.value):r==="AssignmentPattern"?this.checkPatternExport(e,t.left):r==="RestElement"&&this.checkPatternExport(e,t.argument)},de.checkVariableExport=function(e,t){if(e)for(var r=0,n=t;r<n.length;r+=1){var a=n[r];this.checkPatternExport(e,a.id)}},de.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},de.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")},de.parseExportSpecifiers=function(e){var t=[],r=!0;for(this.expect(A.braceL);!this.eat(A.braceR);){if(r)r=!1;else if(this.expect(A.comma),this.afterTrailingComma(A.braceR))break;t.push(this.parseExportSpecifier(e))}return t},de.parseImport=function(e){return this.next(),this.type===A.string?(e.specifiers=Xy,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===A.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},de.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,Zr),this.finishNode(e,"ImportSpecifier")},de.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,Zr),this.finishNode(e,"ImportDefaultSpecifier")},de.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,Zr),this.finishNode(e,"ImportNamespaceSpecifier")},de.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===A.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(A.comma)))return e;if(this.type===A.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(A.braceL);!this.eat(A.braceR);){if(t)t=!1;else if(this.expect(A.comma),this.afterTrailingComma(A.braceR))break;e.push(this.parseImportSpecifier())}return e},de.parseWithClause=function(){var e=[];if(!this.eat(A._with))return e;this.expect(A.braceL);for(var t={},r=!0;!this.eat(A.braceR);){if(r)r=!1;else if(this.expect(A.comma),this.afterTrailingComma(A.braceR))break;var n=this.parseImportAttribute(),a=n.key.type==="Identifier"?n.key.name:n.key.value;Ia(t,a)&&this.raiseRecoverable(n.key.start,"Duplicate attribute key '"+a+"'"),t[a]=!0,e.push(n)}return e},de.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===A.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(A.colon),this.type!==A.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")},de.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===A.string){var e=this.parseLiteral(this.value);return Wy.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)},de.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},de.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var ar=ut.prototype;ar.toAssignable=function(e,t,r){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",r&&this.checkPatternErrors(r,!0);for(var n=0,a=e.properties;n<a.length;n+=1){var i=a[n];this.toAssignable(i,t),i.type==="RestElement"&&(i.argument.type==="ArrayPattern"||i.argument.type==="ObjectPattern")&&this.raise(i.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",r&&this.checkPatternErrors(r,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,r);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else r&&this.checkPatternErrors(r,!0);return e},ar.toAssignableList=function(e,t){for(var r=e.length,n=0;n<r;n++){var a=e[n];a&&this.toAssignable(a,t)}if(r){var i=e[r-1];this.options.ecmaVersion===6&&t&&i&&i.type==="RestElement"&&i.argument.type!=="Identifier"&&this.unexpected(i.argument.start)}return e},ar.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},ar.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==A.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},ar.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case A.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(A.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case A.braceL:return this.parseObj(!0)}return this.parseIdent()},ar.parseBindingList=function(e,t,r,n){for(var a=[],i=!0;!this.eat(e);)if(i?i=!1:this.expect(A.comma),t&&this.type===A.comma)a.push(null);else{if(r&&this.afterTrailingComma(e))break;if(this.type===A.ellipsis){var s=this.parseRestBinding();this.parseBindingListItem(s),a.push(s),this.type===A.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else a.push(this.parseAssignableListItem(n))}return a},ar.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t},ar.parseBindingListItem=function(e){return e},ar.parseMaybeDefault=function(e,t,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(A.eq))return r;var n=this.startNodeAt(e,t);return n.left=r,n.right=this.parseMaybeAssign(),this.finishNode(n,"AssignmentPattern")},ar.checkLValSimple=function(e,t,r){t===void 0&&(t=qs);var n=t!==qs;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(n?"Binding ":"Assigning to ")+e.name+" in strict mode"),n&&(t===Zr&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),r&&(Ia(r,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),r[e.name]=!0),t!==Yl&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":n&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return n&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,r);default:this.raise(e.start,(n?"Binding":"Assigning to")+" rvalue")}},ar.checkLValPattern=function(e,t,r){switch(t===void 0&&(t=qs),e.type){case"ObjectPattern":for(var n=0,a=e.properties;n<a.length;n+=1){var i=a[n];this.checkLValInnerPattern(i,t,r)}break;case"ArrayPattern":for(var s=0,c=e.elements;s<c.length;s+=1){var f=c[s];f&&this.checkLValInnerPattern(f,t,r)}break;default:this.checkLValSimple(e,t,r)}},ar.checkLValInnerPattern=function(e,t,r){switch(t===void 0&&(t=qs),e.type){case"Property":this.checkLValInnerPattern(e.value,t,r);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,r);break;case"RestElement":this.checkLValPattern(e.argument,t,r);break;default:this.checkLValPattern(e,t,r)}};var gr=function(t,r,n,a,i){this.token=t,this.isExpr=!!r,this.preserveSpace=!!n,this.override=a,this.generator=!!i},We={b_stat:new gr("{",!1),b_expr:new gr("{",!0),b_tmpl:new gr("${",!1),p_stat:new gr("(",!1),p_expr:new gr("(",!0),q_tmpl:new gr("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new gr("function",!1),f_expr:new gr("function",!0),f_expr_gen:new gr("function",!0,!1,null,!0),f_gen:new gr("function",!1,!1,null,!0)},Ra=ut.prototype;Ra.initialContext=function(){return[We.b_stat]},Ra.curContext=function(){return this.context[this.context.length-1]},Ra.braceIsBlock=function(e){var t=this.curContext();return t===We.f_expr||t===We.f_stat?!0:e===A.colon&&(t===We.b_stat||t===We.b_expr)?!t.isExpr:e===A._return||e===A.name&&this.exprAllowed?rr.test(this.input.slice(this.lastTokEnd,this.start)):e===A._else||e===A.semi||e===A.eof||e===A.parenR||e===A.arrow?!0:e===A.braceL?t===We.b_stat:e===A._var||e===A._const||e===A.name?!1:!this.exprAllowed},Ra.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1},Ra.updateContext=function(e){var t,r=this.type;r.keyword&&e===A.dot?this.exprAllowed=!1:(t=r.updateContext)?t.call(this,e):this.exprAllowed=r.beforeExpr},Ra.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)},A.parenR.updateContext=A.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===We.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr},A.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?We.b_stat:We.b_expr),this.exprAllowed=!0},A.dollarBraceL.updateContext=function(){this.context.push(We.b_tmpl),this.exprAllowed=!0},A.parenL.updateContext=function(e){var t=e===A._if||e===A._for||e===A._with||e===A._while;this.context.push(t?We.p_stat:We.p_expr),this.exprAllowed=!0},A.incDec.updateContext=function(){},A._function.updateContext=A._class.updateContext=function(e){e.beforeExpr&&e!==A._else&&!(e===A.semi&&this.curContext()!==We.p_stat)&&!(e===A._return&&rr.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===A.colon||e===A.braceL)&&this.curContext()===We.b_stat)?this.context.push(We.f_expr):this.context.push(We.f_stat),this.exprAllowed=!1},A.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},A.backQuote.updateContext=function(){this.curContext()===We.q_tmpl?this.context.pop():this.context.push(We.q_tmpl),this.exprAllowed=!1},A.star.updateContext=function(e){if(e===A._function){var t=this.context.length-1;this.context[t]===We.f_expr?this.context[t]=We.f_expr_gen:this.context[t]=We.f_gen}this.exprAllowed=!0},A.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==A.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var ge=ut.prototype;ge.checkPropClash=function(e,t,r){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var n=e.key,a;switch(n.type){case"Identifier":a=n.name;break;case"Literal":a=String(n.value);break;default:return}var i=e.kind;if(this.options.ecmaVersion>=6){a==="__proto__"&&i==="init"&&(t.proto&&(r?r.doubleProto<0&&(r.doubleProto=n.start):this.raiseRecoverable(n.start,"Redefinition of __proto__ property")),t.proto=!0);return}a="$"+a;var s=t[a];if(s){var c;i==="init"?c=this.strict&&s.init||s.get||s.set:c=s.init||s[i],c&&this.raiseRecoverable(n.start,"Redefinition of property")}else s=t[a]={init:!1,get:!1,set:!1};s[i]=!0}},ge.parseExpression=function(e,t){var r=this.start,n=this.startLoc,a=this.parseMaybeAssign(e,t);if(this.type===A.comma){var i=this.startNodeAt(r,n);for(i.expressions=[a];this.eat(A.comma);)i.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(i,"SequenceExpression")}return a},ge.parseMaybeAssign=function(e,t,r){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var n=!1,a=-1,i=-1,s=-1;t?(a=t.parenthesizedAssign,i=t.trailingComma,s=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new Ks,n=!0);var c=this.start,f=this.startLoc;(this.type===A.parenL||this.type===A.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var u=this.parseMaybeConditional(e,t);if(r&&(u=r.call(this,u,c,f)),this.type.isAssign){var o=this.startNodeAt(c,f);return o.operator=this.value,this.type===A.eq&&(u=this.toAssignable(u,!1,t)),n||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=u.start&&(t.shorthandAssign=-1),this.type===A.eq?this.checkLValPattern(u):this.checkLValSimple(u),o.left=u,this.next(),o.right=this.parseMaybeAssign(e),s>-1&&(t.doubleProto=s),this.finishNode(o,"AssignmentExpression")}else n&&this.checkExpressionErrors(t,!0);return a>-1&&(t.parenthesizedAssign=a),i>-1&&(t.trailingComma=i),u},ge.parseMaybeConditional=function(e,t){var r=this.start,n=this.startLoc,a=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return a;if(this.eat(A.question)){var i=this.startNodeAt(r,n);return i.test=a,i.consequent=this.parseMaybeAssign(),this.expect(A.colon),i.alternate=this.parseMaybeAssign(e),this.finishNode(i,"ConditionalExpression")}return a},ge.parseExprOps=function(e,t){var r=this.start,n=this.startLoc,a=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||a.start===r&&a.type==="ArrowFunctionExpression"?a:this.parseExprOp(a,r,n,-1,e)},ge.parseExprOp=function(e,t,r,n,a){var i=this.type.binop;if(i!=null&&(!a||this.type!==A._in)&&i>n){var s=this.type===A.logicalOR||this.type===A.logicalAND,c=this.type===A.coalesce;c&&(i=A.logicalAND.binop);var f=this.value;this.next();var u=this.start,o=this.startLoc,l=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,a),u,o,i,a),h=this.buildBinary(t,r,e,l,f,s||c);return(s&&this.type===A.coalesce||c&&(this.type===A.logicalOR||this.type===A.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(h,t,r,n,a)}return e},ge.buildBinary=function(e,t,r,n,a,i){n.type==="PrivateIdentifier"&&this.raise(n.start,"Private identifier can only be left side of binary expression");var s=this.startNodeAt(e,t);return s.left=r,s.operator=a,s.right=n,this.finishNode(s,i?"LogicalExpression":"BinaryExpression")},ge.parseMaybeUnary=function(e,t,r,n){var a=this.start,i=this.startLoc,s;if(this.isContextual("await")&&this.canAwait)s=this.parseAwait(n),t=!0;else if(this.type.prefix){var c=this.startNode(),f=this.type===A.incDec;c.operator=this.value,c.prefix=!0,this.next(),c.argument=this.parseMaybeUnary(null,!0,f,n),this.checkExpressionErrors(e,!0),f?this.checkLValSimple(c.argument):this.strict&&c.operator==="delete"&&Ql(c.argument)?this.raiseRecoverable(c.start,"Deleting local variable in strict mode"):c.operator==="delete"&&ou(c.argument)?this.raiseRecoverable(c.start,"Private fields can not be deleted"):t=!0,s=this.finishNode(c,f?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===A.privateId)(n||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),s=this.parsePrivateIdent(),this.type!==A._in&&this.unexpected();else{if(s=this.parseExprSubscripts(e,n),this.checkExpressionErrors(e))return s;for(;this.type.postfix&&!this.canInsertSemicolon();){var u=this.startNodeAt(a,i);u.operator=this.value,u.prefix=!1,u.argument=s,this.checkLValSimple(s),this.next(),s=this.finishNode(u,"UpdateExpression")}}if(!r&&this.eat(A.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(a,i,s,this.parseMaybeUnary(null,!1,!1,n),"**",!1);else return s};function Ql(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&Ql(e.expression)}function ou(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&ou(e.expression)||e.type==="ParenthesizedExpression"&&ou(e.expression)}ge.parseExprSubscripts=function(e,t){var r=this.start,n=this.startLoc,a=this.parseExprAtom(e,t);if(a.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return a;var i=this.parseSubscripts(a,r,n,!1,t);return e&&i.type==="MemberExpression"&&(e.parenthesizedAssign>=i.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=i.start&&(e.parenthesizedBind=-1),e.trailingComma>=i.start&&(e.trailingComma=-1)),i},ge.parseSubscripts=function(e,t,r,n,a){for(var i=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,s=!1;;){var c=this.parseSubscript(e,t,r,n,i,s,a);if(c.optional&&(s=!0),c===e||c.type==="ArrowFunctionExpression"){if(s){var f=this.startNodeAt(t,r);f.expression=c,c=this.finishNode(f,"ChainExpression")}return c}e=c}},ge.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(A.arrow)},ge.parseSubscriptAsyncArrow=function(e,t,r,n){return this.parseArrowExpression(this.startNodeAt(e,t),r,!0,n)},ge.parseSubscript=function(e,t,r,n,a,i,s){var c=this.options.ecmaVersion>=11,f=c&&this.eat(A.questionDot);n&&f&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(A.bracketL);if(u||f&&this.type!==A.parenL&&this.type!==A.backQuote||this.eat(A.dot)){var o=this.startNodeAt(t,r);o.object=e,u?(o.property=this.parseExpression(),this.expect(A.bracketR)):this.type===A.privateId&&e.type!=="Super"?o.property=this.parsePrivateIdent():o.property=this.parseIdent(this.options.allowReserved!=="never"),o.computed=!!u,c&&(o.optional=f),e=this.finishNode(o,"MemberExpression")}else if(!n&&this.eat(A.parenL)){var l=new Ks,h=this.yieldPos,d=this.awaitPos,p=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var m=this.parseExprList(A.parenR,this.options.ecmaVersion>=8,!1,l);if(a&&!f&&this.shouldParseAsyncArrow())return this.checkPatternErrors(l,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=h,this.awaitPos=d,this.awaitIdentPos=p,this.parseSubscriptAsyncArrow(t,r,m,s);this.checkExpressionErrors(l,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=d||this.awaitPos,this.awaitIdentPos=p||this.awaitIdentPos;var x=this.startNodeAt(t,r);x.callee=e,x.arguments=m,c&&(x.optional=f),e=this.finishNode(x,"CallExpression")}else if(this.type===A.backQuote){(f||i)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var v=this.startNodeAt(t,r);v.tag=e,v.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(v,"TaggedTemplateExpression")}return e},ge.parseExprAtom=function(e,t,r){this.type===A.slash&&this.readRegexp();var n,a=this.potentialArrowAt===this.start;switch(this.type){case A._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),n=this.startNode(),this.next(),this.type===A.parenL&&!this.allowDirectSuper&&this.raise(n.start,"super() call outside constructor of a subclass"),this.type!==A.dot&&this.type!==A.bracketL&&this.type!==A.parenL&&this.unexpected(),this.finishNode(n,"Super");case A._this:return n=this.startNode(),this.next(),this.finishNode(n,"ThisExpression");case A.name:var i=this.start,s=this.startLoc,c=this.containsEsc,f=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!c&&f.name==="async"&&!this.canInsertSemicolon()&&this.eat(A._function))return this.overrideContext(We.f_expr),this.parseFunction(this.startNodeAt(i,s),0,!1,!0,t);if(a&&!this.canInsertSemicolon()){if(this.eat(A.arrow))return this.parseArrowExpression(this.startNodeAt(i,s),[f],!1,t);if(this.options.ecmaVersion>=8&&f.name==="async"&&this.type===A.name&&!c&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return f=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(A.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(i,s),[f],!0,t)}return f;case A.regexp:var u=this.value;return n=this.parseLiteral(u.value),n.regex={pattern:u.pattern,flags:u.flags},n;case A.num:case A.string:return this.parseLiteral(this.value);case A._null:case A._true:case A._false:return n=this.startNode(),n.value=this.type===A._null?null:this.type===A._true,n.raw=this.type.keyword,this.next(),this.finishNode(n,"Literal");case A.parenL:var o=this.start,l=this.parseParenAndDistinguishExpression(a,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(l)&&(e.parenthesizedAssign=o),e.parenthesizedBind<0&&(e.parenthesizedBind=o)),l;case A.bracketL:return n=this.startNode(),this.next(),n.elements=this.parseExprList(A.bracketR,!0,!0,e),this.finishNode(n,"ArrayExpression");case A.braceL:return this.overrideContext(We.b_expr),this.parseObj(!1,e);case A._function:return n=this.startNode(),this.next(),this.parseFunction(n,0);case A._class:return this.parseClass(this.startNode(),!1);case A._new:return this.parseNew();case A.backQuote:return this.parseTemplate();case A._import:return this.options.ecmaVersion>=11?this.parseExprImport(r):this.unexpected();default:return this.parseExprAtomDefault()}},ge.parseExprAtomDefault=function(){this.unexpected()},ge.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===A.parenL&&!e)return this.parseDynamicImport(t);if(this.type===A.dot){var r=this.startNodeAt(t.start,t.loc&&t.loc.start);return r.name="import",t.meta=this.finishNode(r,"Identifier"),this.parseImportMeta(t)}else this.unexpected()},ge.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(A.parenR)?e.options=null:(this.expect(A.comma),this.afterTrailingComma(A.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(A.parenR)||(this.expect(A.comma),this.afterTrailingComma(A.parenR)||this.unexpected())));else if(!this.eat(A.parenR)){var t=this.start;this.eat(A.comma)&&this.eat(A.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},ge.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")},ge.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")},ge.parseParenExpression=function(){this.expect(A.parenL);var e=this.parseExpression();return this.expect(A.parenR),e},ge.shouldParseArrow=function(e){return!this.canInsertSemicolon()},ge.parseParenAndDistinguishExpression=function(e,t){var r=this.start,n=this.startLoc,a,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var s=this.start,c=this.startLoc,f=[],u=!0,o=!1,l=new Ks,h=this.yieldPos,d=this.awaitPos,p;for(this.yieldPos=0,this.awaitPos=0;this.type!==A.parenR;)if(u?u=!1:this.expect(A.comma),i&&this.afterTrailingComma(A.parenR,!0)){o=!0;break}else if(this.type===A.ellipsis){p=this.start,f.push(this.parseParenItem(this.parseRestBinding())),this.type===A.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else f.push(this.parseMaybeAssign(!1,l,this.parseParenItem));var m=this.lastTokEnd,x=this.lastTokEndLoc;if(this.expect(A.parenR),e&&this.shouldParseArrow(f)&&this.eat(A.arrow))return this.checkPatternErrors(l,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=h,this.awaitPos=d,this.parseParenArrowList(r,n,f,t);(!f.length||o)&&this.unexpected(this.lastTokStart),p&&this.unexpected(p),this.checkExpressionErrors(l,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=d||this.awaitPos,f.length>1?(a=this.startNodeAt(s,c),a.expressions=f,this.finishNodeAt(a,"SequenceExpression",m,x)):a=f[0]}else a=this.parseParenExpression();if(this.options.preserveParens){var v=this.startNodeAt(r,n);return v.expression=a,this.finishNode(v,"ParenthesizedExpression")}else return a},ge.parseParenItem=function(e){return e},ge.parseParenArrowList=function(e,t,r,n){return this.parseArrowExpression(this.startNodeAt(e,t),r,!1,n)};var Jy=[];ge.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===A.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var r=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),r&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var n=this.start,a=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),n,a,!0,!1),this.eat(A.parenL)?e.arguments=this.parseExprList(A.parenR,this.options.ecmaVersion>=8,!1):e.arguments=Jy,this.finishNode(e,"NewExpression")},ge.parseTemplateElement=function(e){var t=e.isTagged,r=this.startNode();return this.type===A.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),r.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):r.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),r.tail=this.type===A.backQuote,this.finishNode(r,"TemplateElement")},ge.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var r=this.startNode();this.next(),r.expressions=[];var n=this.parseTemplateElement({isTagged:t});for(r.quasis=[n];!n.tail;)this.type===A.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(A.dollarBraceL),r.expressions.push(this.parseExpression()),this.expect(A.braceR),r.quasis.push(n=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(r,"TemplateLiteral")},ge.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===A.name||this.type===A.num||this.type===A.string||this.type===A.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===A.star)&&!rr.test(this.input.slice(this.lastTokEnd,this.start))},ge.parseObj=function(e,t){var r=this.startNode(),n=!0,a={};for(r.properties=[],this.next();!this.eat(A.braceR);){if(n)n=!1;else if(this.expect(A.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(A.braceR))break;var i=this.parseProperty(e,t);e||this.checkPropClash(i,a,t),r.properties.push(i)}return this.finishNode(r,e?"ObjectPattern":"ObjectExpression")},ge.parseProperty=function(e,t){var r=this.startNode(),n,a,i,s;if(this.options.ecmaVersion>=9&&this.eat(A.ellipsis))return e?(r.argument=this.parseIdent(!1),this.type===A.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(r,"RestElement")):(r.argument=this.parseMaybeAssign(!1,t),this.type===A.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(r,"SpreadElement"));this.options.ecmaVersion>=6&&(r.method=!1,r.shorthand=!1,(e||t)&&(i=this.start,s=this.startLoc),e||(n=this.eat(A.star)));var c=this.containsEsc;return this.parsePropertyName(r),!e&&!c&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(r)?(a=!0,n=this.options.ecmaVersion>=9&&this.eat(A.star),this.parsePropertyName(r)):a=!1,this.parsePropertyValue(r,e,n,a,i,s,t,c),this.finishNode(r,"Property")},ge.parseGetterSetter=function(e){var t=e.key.name;this.parsePropertyName(e),e.value=this.parseMethod(!1),e.kind=t;var r=e.kind==="get"?0:1;if(e.value.params.length!==r){var n=e.value.start;e.kind==="get"?this.raiseRecoverable(n,"getter should have no params"):this.raiseRecoverable(n,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")},ge.parsePropertyValue=function(e,t,r,n,a,i,s,c){(r||n)&&this.type===A.colon&&this.unexpected(),this.eat(A.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,s),e.kind="init"):this.options.ecmaVersion>=6&&this.type===A.parenL?(t&&this.unexpected(),e.method=!0,e.value=this.parseMethod(r,n),e.kind="init"):!t&&!c&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==A.comma&&this.type!==A.braceR&&this.type!==A.eq?((r||n)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((r||n)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=a),t?e.value=this.parseMaybeDefault(a,i,this.copyNode(e.key)):this.type===A.eq&&s?(s.shorthandAssign<0&&(s.shorthandAssign=this.start),e.value=this.parseMaybeDefault(a,i,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.kind="init",e.shorthand=!0):this.unexpected()},ge.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(A.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(A.bracketR),e.key;e.computed=!1}return e.key=this.type===A.num||this.type===A.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},ge.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},ge.parseMethod=function(e,t,r){var n=this.startNode(),a=this.yieldPos,i=this.awaitPos,s=this.awaitIdentPos;return this.initFunction(n),this.options.ecmaVersion>=6&&(n.generator=e),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(nu(t,n.generator)|zs|(r?ql:0)),this.expect(A.parenL),n.params=this.parseBindingList(A.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(n,!1,!0,!1),this.yieldPos=a,this.awaitPos=i,this.awaitIdentPos=s,this.finishNode(n,"FunctionExpression")},ge.parseArrowExpression=function(e,t,r,n){var a=this.yieldPos,i=this.awaitPos,s=this.awaitIdentPos;return this.enterScope(nu(r,!1)|ru),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!r),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,n),this.yieldPos=a,this.awaitPos=i,this.awaitIdentPos=s,this.finishNode(e,"ArrowFunctionExpression")},ge.parseFunctionBody=function(e,t,r,n){var a=t&&this.type!==A.braceL,i=this.strict,s=!1;if(a)e.body=this.parseMaybeAssign(n),e.expression=!0,this.checkParams(e,!1);else{var c=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!i||c)&&(s=this.strictDirective(this.end),s&&c&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var f=this.labels;this.labels=[],s&&(this.strict=!0),this.checkParams(e,!i&&!s&&!t&&!r&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,Yl),e.body=this.parseBlock(!1,void 0,s&&!i),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=f}this.exitScope()},ge.isSimpleParamList=function(e){for(var t=0,r=e;t<r.length;t+=1){var n=r[t];if(n.type!=="Identifier")return!1}return!0},ge.checkParams=function(e,t){for(var r=Object.create(null),n=0,a=e.params;n<a.length;n+=1){var i=a[n];this.checkLValInnerPattern(i,au,t?null:r)}},ge.parseExprList=function(e,t,r,n){for(var a=[],i=!0;!this.eat(e);){if(i)i=!1;else if(this.expect(A.comma),t&&this.afterTrailingComma(e))break;var s=void 0;r&&this.type===A.comma?s=null:this.type===A.ellipsis?(s=this.parseSpread(n),n&&this.type===A.comma&&n.trailingComma<0&&(n.trailingComma=this.start)):s=this.parseMaybeAssign(!1,n),a.push(s)}return a},ge.checkUnreserved=function(e){var t=e.start,r=e.end,n=e.name;if(this.inGenerator&&n==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&n==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&Gs)&&n==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(n==="arguments"||n==="await")&&this.raise(t,"Cannot use "+n+" in class static initialization block"),this.keywords.test(n)&&this.raise(t,"Unexpected keyword '"+n+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,r).indexOf("\\")!==-1)){var a=this.strict?this.reservedWordsStrict:this.reservedWords;a.test(n)&&(!this.inAsync&&n==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+n+"' is reserved"))}},ge.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t},ge.parseIdentNode=function(){var e=this.startNode();return this.type===A.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=A.name):this.unexpected(),e},ge.parsePrivateIdent=function(){var e=this.startNode();return this.type===A.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e},ge.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===A.semi||this.canInsertSemicolon()||this.type!==A.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(A.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},ge.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var Ys=ut.prototype;Ys.raise=function(e,t){var r=Hl(this.input,e);t+=" ("+r.line+":"+r.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var n=new SyntaxError(t);throw n.pos=e,n.loc=r,n.raisedAt=this.pos,n},Ys.raiseRecoverable=Ys.raise,Ys.curPosition=function(){if(this.options.locations)return new fi(this.curLine,this.pos-this.lineStart)};var Cn=ut.prototype,Qy=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};Cn.enterScope=function(e){this.scopeStack.push(new Qy(e))},Cn.exitScope=function(){this.scopeStack.pop()},Cn.treatFunctionsAsVarInScope=function(e){return e.flags&Oa||!this.inModule&&e.flags&li},Cn.declareName=function(e,t,r){var n=!1;if(t===Zr){var a=this.currentScope();n=a.lexical.indexOf(e)>-1||a.functions.indexOf(e)>-1||a.var.indexOf(e)>-1,a.lexical.push(e),this.inModule&&a.flags&li&&delete this.undefinedExports[e]}else if(t===Xl){var i=this.currentScope();i.lexical.push(e)}else if(t===Kl){var s=this.currentScope();this.treatFunctionsAsVar?n=s.lexical.indexOf(e)>-1:n=s.lexical.indexOf(e)>-1||s.var.indexOf(e)>-1,s.functions.push(e)}else for(var c=this.scopeStack.length-1;c>=0;--c){var f=this.scopeStack[c];if(f.lexical.indexOf(e)>-1&&!(f.flags&Gl&&f.lexical[0]===e)||!this.treatFunctionsAsVarInScope(f)&&f.functions.indexOf(e)>-1){n=!0;break}if(f.var.push(e),this.inModule&&f.flags&li&&delete this.undefinedExports[e],f.flags&Gs)break}n&&this.raiseRecoverable(r,"Identifier '"+e+"' has already been declared")},Cn.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)},Cn.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Cn.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(Gs|hi|qn))return t}},Cn.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(Gs|hi|qn)&&!(t.flags&ru))return t}};var Js=function(t,r,n){this.type="",this.start=r,this.end=0,t.options.locations&&(this.loc=new Ws(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[r,0])},pi=ut.prototype;pi.startNode=function(){return new Js(this,this.start,this.startLoc)},pi.startNodeAt=function(e,t){return new Js(this,e,t)};function Zl(e,t,r,n){return e.type=t,e.end=r,this.options.locations&&(e.loc.end=n),this.options.ranges&&(e.range[1]=r),e}pi.finishNode=function(e,t){return Zl.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},pi.finishNodeAt=function(e,t,r,n){return Zl.call(this,e,t,r,n)},pi.copyNode=function(e){var t=new Js(this,e.start,this.startLoc);for(var r in e)t[r]=e[r];return t};var Zy="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",jl="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",eh=jl+" Extended_Pictographic",th=eh,rh=th+" EBase EComp EMod EPres ExtPict",nh=rh,jy=nh,ew={9:jl,10:eh,11:th,12:rh,13:nh,14:jy},tw="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",rw={9:"",10:"",11:"",12:"",13:"",14:tw},ah="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ih="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",sh=ih+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",oh=sh+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ch=oh+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",uh=ch+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",nw=uh+" "+Zy,aw={9:ih,10:sh,11:oh,12:ch,13:uh,14:nw},fh={};function iw(e){var t=fh[e]={binary:An(ew[e]+" "+ah),binaryOfStrings:An(rw[e]),nonBinary:{General_Category:An(ah),Script:An(aw[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var cu=0,lh=[9,10,11,12,13,14];cu<lh.length;cu+=1){var sw=lh[cu];iw(sw)}var he=ut.prototype,Qs=function(t,r){this.parent=t,this.base=r||this};Qs.prototype.separatedFrom=function(t){for(var r=this;r;r=r.parent)for(var n=t;n;n=n.parent)if(r.base===n.base&&r!==n)return!0;return!1},Qs.prototype.sibling=function(){return new Qs(this.parent,this.base)};var Br=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=fh[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Br.prototype.reset=function(t,r,n){var a=n.indexOf("v")!==-1,i=n.indexOf("u")!==-1;this.start=t|0,this.source=r+"",this.flags=n,a&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=i&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=i&&this.parser.options.ecmaVersion>=9)},Br.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},Br.prototype.at=function(t,r){r===void 0&&(r=!1);var n=this.source,a=n.length;if(t>=a)return-1;var i=n.charCodeAt(t);if(!(r||this.switchU)||i<=55295||i>=57344||t+1>=a)return i;var s=n.charCodeAt(t+1);return s>=56320&&s<=57343?(i<<10)+s-56613888:i},Br.prototype.nextIndex=function(t,r){r===void 0&&(r=!1);var n=this.source,a=n.length;if(t>=a)return a;var i=n.charCodeAt(t),s;return!(r||this.switchU)||i<=55295||i>=57344||t+1>=a||(s=n.charCodeAt(t+1))<56320||s>57343?t+1:t+2},Br.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)},Br.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)},Br.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)},Br.prototype.eat=function(t,r){return r===void 0&&(r=!1),this.current(r)===t?(this.advance(r),!0):!1},Br.prototype.eatChars=function(t,r){r===void 0&&(r=!1);for(var n=this.pos,a=0,i=t;a<i.length;a+=1){var s=i[a],c=this.at(n,r);if(c===-1||c!==s)return!1;n=this.nextIndex(n,r)}return this.pos=n,!0},he.validateRegExpFlags=function(e){for(var t=e.validFlags,r=e.flags,n=!1,a=!1,i=0;i<r.length;i++){var s=r.charAt(i);t.indexOf(s)===-1&&this.raise(e.start,"Invalid regular expression flag"),r.indexOf(s,i+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),s==="u"&&(n=!0),s==="v"&&(a=!0)}this.options.ecmaVersion>=15&&n&&a&&this.raise(e.start,"Invalid regular expression flag")};function ow(e){for(var t in e)return!0;return!1}he.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&ow(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))},he.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,r=e.backReferenceNames;t<r.length;t+=1){var n=r[t];e.groupNames[n]||e.raise("Invalid named capture referenced")}},he.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new Qs(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},he.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},he.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1},he.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var r=!1;if(this.options.ecmaVersion>=9&&(r=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!r,!0}return e.pos=t,!1},he.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1},he.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},he.regexp_eatBracedQuantifier=function(e,t){var r=e.pos;if(e.eat(123)){var n=0,a=-1;if(this.regexp_eatDecimalDigits(e)&&(n=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(a=e.lastIntValue),e.eat(125)))return a!==-1&&a<n&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=r}return!1},he.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},he.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},he.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var r=this.regexp_eatModifiers(e),n=e.eat(45);if(r||n){for(var a=0;a<r.length;a++){var i=r.charAt(a);r.indexOf(i,a+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(n){var s=this.regexp_eatModifiers(e);!r&&!s&&e.current()===58&&e.raise("Invalid regular expression modifiers");for(var c=0;c<s.length;c++){var f=s.charAt(c);(s.indexOf(f,c+1)>-1||r.indexOf(f)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1},he.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},he.regexp_eatModifiers=function(e){for(var t="",r=0;(r=e.current())!==-1&&cw(r);)t+=Qr(r),e.advance();return t};function cw(e){return e===105||e===109||e===115}he.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},he.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},he.regexp_eatSyntaxCharacter=function(e){var t=e.current();return hh(t)?(e.lastIntValue=t,e.advance(),!0):!1};function hh(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}he.regexp_eatPatternCharacters=function(e){for(var t=e.pos,r=0;(r=e.current())!==-1&&!hh(r);)e.advance();return e.pos!==t},he.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1},he.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,r=e.groupNames[e.lastStringValue];if(r)if(t)for(var n=0,a=r;n<a.length;n+=1){var i=a[n];i.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(r||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}},he.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},he.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=Qr(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=Qr(e.lastIntValue);return!0}return!1},he.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,r=this.options.ecmaVersion>=11,n=e.current(r);return e.advance(r),n===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,r)&&(n=e.lastIntValue),uw(n)?(e.lastIntValue=n,!0):(e.pos=t,!1)};function uw(e){return Jr(e,!0)||e===36||e===95}he.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,r=this.options.ecmaVersion>=11,n=e.current(r);return e.advance(r),n===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,r)&&(n=e.lastIntValue),fw(n)?(e.lastIntValue=n,!0):(e.pos=t,!1)};function fw(e){return Sa(e,!0)||e===36||e===95||e===8204||e===8205}he.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},he.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var r=e.lastIntValue;if(e.switchU)return r>e.maxBackReference&&(e.maxBackReference=r),!0;if(r<=e.numCapturingParens)return!0;e.pos=t}return!1},he.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},he.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},he.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},he.regexp_eatZero=function(e){return e.current()===48&&!Zs(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1},he.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1},he.regexp_eatControlLetter=function(e){var t=e.current();return dh(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function dh(e){return e>=65&&e<=90||e>=97&&e<=122}he.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var r=e.pos,n=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var a=e.lastIntValue;if(n&&a>=55296&&a<=56319){var i=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var s=e.lastIntValue;if(s>=56320&&s<=57343)return e.lastIntValue=(a-55296)*1024+(s-56320)+65536,!0}e.pos=i,e.lastIntValue=a}return!0}if(n&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&lw(e.lastIntValue))return!0;n&&e.raise("Invalid unicode escape"),e.pos=r}return!1};function lw(e){return e>=0&&e<=1114111}he.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1},he.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var ph=0,jr=1,ir=2;he.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(hw(t))return e.lastIntValue=-1,e.advance(),jr;var r=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((r=t===80)||t===112)){e.lastIntValue=-1,e.advance();var n;if(e.eat(123)&&(n=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return r&&n===ir&&e.raise("Invalid property name"),n;e.raise("Invalid property name")}return ph};function hw(e){return e===100||e===68||e===115||e===83||e===119||e===87}he.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var r=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var n=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,r,n),jr}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var a=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,a)}return ph},he.regexp_validateUnicodePropertyNameAndValue=function(e,t,r){Ia(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(r)||e.raise("Invalid property value")},he.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return jr;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return ir;e.raise("Invalid property name")},he.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";mh(t=e.current());)e.lastStringValue+=Qr(t),e.advance();return e.lastStringValue!==""};function mh(e){return dh(e)||e===95}he.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";dw(t=e.current());)e.lastStringValue+=Qr(t),e.advance();return e.lastStringValue!==""};function dw(e){return mh(e)||Zs(e)}he.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},he.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),r=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&r===ir&&e.raise("Negated character class may contain strings"),!0}return!1},he.regexp_classContents=function(e){return e.current()===93?jr:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),jr)},he.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var r=e.lastIntValue;e.switchU&&(t===-1||r===-1)&&e.raise("Invalid character class"),t!==-1&&r!==-1&&t>r&&e.raise("Range out of order in character class")}}},he.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var r=e.current();(r===99||vh(r))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var n=e.current();return n!==93?(e.lastIntValue=n,e.advance(),!0):!1},he.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},he.regexp_classSetExpression=function(e){var t=jr,r;if(!this.regexp_eatClassSetRange(e))if(r=this.regexp_eatClassSetOperand(e)){r===ir&&(t=ir);for(var n=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(r=this.regexp_eatClassSetOperand(e))){r!==ir&&(t=jr);continue}e.raise("Invalid character in character class")}if(n!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(n!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(r=this.regexp_eatClassSetOperand(e),!r)return t;r===ir&&(t=ir)}},he.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var r=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var n=e.lastIntValue;return r!==-1&&n!==-1&&r>n&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1},he.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?jr:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)},he.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var r=e.eat(94),n=this.regexp_classContents(e);if(e.eat(93))return r&&n===ir&&e.raise("Negated character class may contain strings"),n;e.pos=t}if(e.eat(92)){var a=this.regexp_eatCharacterClassEscape(e);if(a)return a;e.pos=t}return null},he.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var r=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return r}else e.raise("Invalid escape");e.pos=t}return null},he.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===ir&&(t=ir);return t},he.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?jr:ir},he.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var r=e.current();return r<0||r===e.lookahead()&&pw(r)||mw(r)?!1:(e.advance(),e.lastIntValue=r,!0)};function pw(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function mw(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}he.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return xw(t)?(e.lastIntValue=t,e.advance(),!0):!1};function xw(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}he.regexp_eatClassControlLetter=function(e){var t=e.current();return Zs(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1},he.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},he.regexp_eatDecimalDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;Zs(r=e.current());)e.lastIntValue=10*e.lastIntValue+(r-48),e.advance();return e.pos!==t};function Zs(e){return e>=48&&e<=57}he.regexp_eatHexDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;xh(r=e.current());)e.lastIntValue=16*e.lastIntValue+gh(r),e.advance();return e.pos!==t};function xh(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function gh(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}he.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var r=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+r*8+e.lastIntValue:e.lastIntValue=t*8+r}else e.lastIntValue=t;return!0}return!1},he.regexp_eatOctalDigit=function(e){var t=e.current();return vh(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function vh(e){return e>=48&&e<=55}he.regexp_eatFixedHexDigits=function(e,t){var r=e.pos;e.lastIntValue=0;for(var n=0;n<t;++n){var a=e.current();if(!xh(a))return e.pos=r,!1;e.lastIntValue=16*e.lastIntValue+gh(a),e.advance()}return!0};var uu=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new Ws(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},Ae=ut.prototype;Ae.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new uu(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Ae.getToken=function(){return this.next(),new uu(this)},typeof Symbol<"u"&&(Ae[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===A.eof,value:t}}}}),Ae.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(A.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())},Ae.readToken=function(e){return Jr(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)},Ae.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888},Ae.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(r===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(var n=void 0,a=t;(n=Bl(this.input,a,this.pos))>-1;)++this.curLine,a=this.lineStart=n;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,r),t,this.pos,e,this.curPosition())},Ae.skipLineComment=function(e){for(var t=this.pos,r=this.options.onComment&&this.curPosition(),n=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!Fa(n);)n=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,r,this.curPosition())},Ae.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&Ml.test(String.fromCharCode(e)))++this.pos;else break e}}},Ae.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=e,this.value=t,this.updateContext(r)},Ae.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(A.ellipsis)):(++this.pos,this.finishToken(A.dot))},Ae.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(A.assign,2):this.finishOp(A.slash,1)},Ae.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),r=1,n=e===42?A.star:A.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++r,n=A.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(A.assign,r+1):this.finishOp(n,r)},Ae.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var r=this.input.charCodeAt(this.pos+2);if(r===61)return this.finishOp(A.assign,3)}return this.finishOp(e===124?A.logicalOR:A.logicalAND,2)}return t===61?this.finishOp(A.assign,2):this.finishOp(e===124?A.bitwiseOR:A.bitwiseAND,1)},Ae.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(A.assign,2):this.finishOp(A.bitwiseXOR,1)},Ae.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||rr.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(A.incDec,2):t===61?this.finishOp(A.assign,2):this.finishOp(A.plusMin,1)},Ae.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),r=1;return t===e?(r=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+r)===61?this.finishOp(A.assign,r+1):this.finishOp(A.bitShift,r)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(r=2),this.finishOp(A.relational,r))},Ae.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(A.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(A.arrow)):this.finishOp(e===61?A.eq:A.prefix,1)},Ae.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var r=this.input.charCodeAt(this.pos+2);if(r<48||r>57)return this.finishOp(A.questionDot,2)}if(t===63){if(e>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(A.assign,3)}return this.finishOp(A.coalesce,2)}}return this.finishOp(A.question,1)},Ae.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),Jr(t,!0)||t===92))return this.finishToken(A.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Qr(t)+"'")},Ae.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(A.parenL);case 41:return++this.pos,this.finishToken(A.parenR);case 59:return++this.pos,this.finishToken(A.semi);case 44:return++this.pos,this.finishToken(A.comma);case 91:return++this.pos,this.finishToken(A.bracketL);case 93:return++this.pos,this.finishToken(A.bracketR);case 123:return++this.pos,this.finishToken(A.braceL);case 125:return++this.pos,this.finishToken(A.braceR);case 58:return++this.pos,this.finishToken(A.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(A.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(A.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Qr(e)+"'")},Ae.finishOp=function(e,t){var r=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,r)},Ae.readRegexp=function(){for(var e,t,r=this.pos;;){this.pos>=this.input.length&&this.raise(r,"Unterminated regular expression");var n=this.input.charAt(this.pos);if(rr.test(n)&&this.raise(r,"Unterminated regular expression"),e)e=!1;else{if(n==="[")t=!0;else if(n==="]"&&t)t=!1;else if(n==="/"&&!t)break;e=n==="\\"}++this.pos}var a=this.input.slice(r,this.pos);++this.pos;var i=this.pos,s=this.readWord1();this.containsEsc&&this.unexpected(i);var c=this.regexpState||(this.regexpState=new Br(this));c.reset(r,a,s),this.validateRegExpFlags(c),this.validateRegExpPattern(c);var f=null;try{f=new RegExp(a,s)}catch{}return this.finishToken(A.regexp,{pattern:a,flags:s,value:f})},Ae.readInt=function(e,t,r){for(var n=this.options.ecmaVersion>=12&&t===void 0,a=r&&this.input.charCodeAt(this.pos)===48,i=this.pos,s=0,c=0,f=0,u=t??1/0;f<u;++f,++this.pos){var o=this.input.charCodeAt(this.pos),l=void 0;if(n&&o===95){a&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),c===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),f===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),c=o;continue}if(o>=97?l=o-97+10:o>=65?l=o-65+10:o>=48&&o<=57?l=o-48:l=1/0,l>=e)break;c=o,s=s*e+l}return n&&c===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===i||t!=null&&this.pos-i!==t?null:s};function gw(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function _h(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}Ae.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var r=this.readInt(e);return r==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(r=_h(this.input.slice(t,this.pos)),++this.pos):Jr(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(A.num,r)},Ae.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var r=this.pos-t>=2&&this.input.charCodeAt(t)===48;r&&this.strict&&this.raise(t,"Invalid number");var n=this.input.charCodeAt(this.pos);if(!r&&!e&&this.options.ecmaVersion>=11&&n===110){var a=_h(this.input.slice(t,this.pos));return++this.pos,Jr(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(A.num,a)}r&&/[89]/.test(this.input.slice(t,this.pos))&&(r=!1),n===46&&!r&&(++this.pos,this.readInt(10),n=this.input.charCodeAt(this.pos)),(n===69||n===101)&&!r&&(n=this.input.charCodeAt(++this.pos),(n===43||n===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),Jr(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var i=gw(this.input.slice(t,this.pos),r);return this.finishToken(A.num,i)},Ae.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(r,"Code point out of bounds")}else t=this.readHexChar(4);return t},Ae.readString=function(e){for(var t="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var n=this.input.charCodeAt(this.pos);if(n===e)break;n===92?(t+=this.input.slice(r,this.pos),t+=this.readEscapedChar(!1),r=this.pos):n===8232||n===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(Fa(n)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(r,this.pos++),this.finishToken(A.string,t)};var yh={};Ae.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===yh)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1},Ae.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw yh;this.raise(e,t)},Ae.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(r===96||r===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===A.template||this.type===A.invalidTemplate)?r===36?(this.pos+=2,this.finishToken(A.dollarBraceL)):(++this.pos,this.finishToken(A.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(A.template,e));if(r===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(Fa(r)){switch(e+=this.input.slice(t,this.pos),++this.pos,r){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(r);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},Ae.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(A.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},Ae.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Qr(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var r=this.pos-1;this.invalidStringToken(r,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],a=parseInt(n,8);return a>255&&(n=n.slice(0,-1),a=parseInt(n,8)),this.pos+=n.length-1,t=this.input.charCodeAt(this.pos),(n!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-n.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(a)}return Fa(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}},Ae.readHexChar=function(e){var t=this.pos,r=this.readInt(16,e);return r===null&&this.invalidStringToken(t,"Bad character escape sequence"),r},Ae.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,r=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var a=this.fullCharCodeAtPos();if(Sa(a,n))this.pos+=a<=65535?1:2;else if(a===92){this.containsEsc=!0,e+=this.input.slice(r,this.pos);var i=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var s=this.readCodePoint();(t?Jr:Sa)(s,n)||this.invalidStringToken(i,"Invalid Unicode escape"),e+=Qr(s),r=this.pos}else break;t=!1}return e+this.input.slice(r,this.pos)},Ae.readWord=function(){var e=this.readWord1(),t=A.name;return this.keywords.test(e)&&(t=jc[e]),this.finishToken(t,e)};var vw="8.14.1";ut.acorn={Parser:ut,version:vw,defaultOptions:eu,Position:fi,SourceLocation:Ws,getLineInfo:Hl,Node:Js,TokenType:Re,tokTypes:A,keywordTypes:jc,TokContext:gr,tokContexts:We,isIdentifierChar:Sa,isIdentifierStart:Jr,Token:uu,isNewLine:Fa,lineBreak:rr,lineBreakG:Vy,nonASCIIwhitespace:Ml};function _w(e,t){return ut.parse(e,t)}const fu={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"};function bn(e){return typeof e=="number"}const yw={ecmaVersion:11},wh="$",ww="d",Ew="d1",kw="d2",gt=e=>(t,r)=>r.error(t,e+" not allowed"),Tw=gt("Aggregate function"),Aw=gt("Window function"),Cw="Invalid argument",lu="Invalid column reference",bw=lu+" (must be input to an aggregate function)",Eh="Invalid function call",Sw="Invalid member expression",Fw="Invalid operator parameter",Iw="Invalid param reference",Ow="Invalid variable reference",Rw="Variable not accessible in operator call",Nw="Unsupported variable declaration",Dw="Unsupported destructuring pattern",kh="Table expressions do not support closures",Th="Use aq.escape(fn) to use a function as-is (including closures)",Pw="use table.params({ name: value }) to define dynamic parameters",Lw="use aq.addFunction(name, fn) to add new op functions",Bw=`
Note: ${kh}. ${Th}, or ${Pw}.`,Ah=`
Note: ${kh}. ${Th}, or ${Lw}.`,Mw=`The ${Hs} method is not valid in multi-table expressions.`;function Uw(e,t){const r=Vw(t);let n=e.root=r;return e.spec=t,e.tuple=null,e.tuple1=null,e.tuple2=null,e.$param=null,e.$op=0,e.scope=new Set,e.paramsRef=new Map,e.columnRef=new Map,Cy(n)?(Hw(n,e),n=n.body):e.join?(e.scope.add(e.tuple1=Ew),e.scope.add(e.tuple2=kw),e.scope.add(e.$param=wh)):(e.scope.add(e.tuple=ww),e.scope.add(e.$param=wh)),Se(n,e,hu),e.root}function Vw(e){try{const t=e.field?$w(e):Ot(e)?jt(e):e;return _w(`expr=(${t})`,yw).body[0].expression.right}catch{Be(`Expression parse error: ${e+""}`)}}function $w(e){const t=JSON.stringify(e+"");return e.table?`(a,b)=>b[${t}]`:`d=>d[${t}]`}const hu={FunctionDeclaration:gt("Function definitions"),ForStatement:gt("For loops"),ForOfStatement:gt("For-of loops"),ForInStatement:gt("For-in loops"),WhileStatement:gt("While loops"),DoWhileStatement:gt("Do-while loops"),AwaitExpression:gt("Await expressions"),ArrowFunctionExpression:gt("Function definitions"),AssignmentExpression:gt("Assignments"),FunctionExpression:gt("Function definitions"),NewExpression:gt('Use of "new"'),UpdateExpression:gt("Update expressions"),VariableDeclarator(e,t){mu(e.id,t)},Identifier(e,t,r){Fh(e,t,r)&&!t.scope.has(e.name)&&t.error(e,Ow,Bw)},CallExpression(e,t){const r=bh(e.callee),n=pl(r)||ml(r);if(n){if((t.join||t.aggregate===!1)&&Vc(r)&&Tw(e,t),(t.join||t.window===!1)&&$c(r)&&Aw(e,t),t.$op=1,t.ast)pu(e,r,t),e.arguments.forEach(a=>Se(a,t,du));else{const a=t.op(Ww(t,n,r,e.arguments));Object.assign(e,{type:Tl,name:a.id})}return t.$op=0,!1}else dl(r)?pu(e,r,t):t.error(e,Eh,Ah)},MemberExpression(e,t,r){const{object:n,property:a}=e;if(!ct(Tn,n))return;const{name:i}=n;if(Sh(e)&&ct(Tn,a)&&Object.hasOwn(fu,a.name)){Rh(e,a.name);return}const s=i===t.tuple?0:i===t.tuple1?1:i===t.tuple2?2:-1;if(s>=0)return Ch(e,s,t,Ih,r);if(i===t.$param)return Ch(e,s,t,Gw);t.paramsRef.has(i)?xi(e,t.paramsRef.get(i)):t.columnRef.has(i)?Oh(n,i,t,e):Object.hasOwn(t.params,i)&&xi(n,i)}};function Ch(e,t,r,n,a){const{property:i,computed:s}=e;let c;if(!s)c=i.name;else if(ct(ba,i))c=i.value;else try{Se(i,r,hu,e),c=r.param(i)}catch{r.error(e,Sw)}return n(e,c,t,r,a),!1}const du={...hu,VariableDeclarator:gt("Variable declaration in operator call"),Identifier(e,t,r){Fh(e,t,r)&&t.error(e,Rw)},CallExpression(e,t){const r=bh(e.callee);dl(r)?pu(e,r,t):t.error(e,Eh,Ah)}};function Hw(e,t){e.generator&&gt("Generator functions")(e,t),e.async&&gt("Async functions")(e,t);const{params:r}=e,n=r.length,a=s=>(c,f)=>t.columnRef.set(c,[f,s]),i=(s,c)=>t.paramsRef.set(s,c);n&&(t.join?(mi(t,r[0],"tuple1",a(1)),n>1&&mi(t,r[1],"tuple2",a(2)),n>2&&mi(t,r[2],"$param",i)):(mi(t,r[0],"tuple",a(0)),n>1&&mi(t,r[1],"$param",i))),t.root=e.body}function mi(e,t,r,n){ct(Tn,t)?(e.scope.add(t.name),e[r]=t.name):ct(wl,t)&&t.properties.forEach(a=>{const i=ct(Tn,a.key)?a.key.name:ct(ba,a.key)?a.key.value:e.error(a,Cw);ct(Tn,a.value)||e.error(a.value,Dw),n(a.value.name,i)})}function Ww(e,t,r,n){const a=[],i=[],s=t.param[0]||0,c=s+(t.param[1]||0);return n.forEach((f,u)=>{u<s?(Se(f,e,du),a.push(e.field(f))):u<c?(Se(f,e,du),i.push(e.param(f))):e.error(f,Fw)}),{name:r,fields:a,params:i,...e.spec.window||{}}}function bh(e){return ct(Tn,e)?e.name:ct(yl,e)?Sh(e)?zw(e.property.name):e.property.name:null}function Sh(e){return ct(Tn,e.object)&&e.object.name==="Math"}function zw(e){return e==="max"?"greatest":e==="min"?"least":e}function Fh(e,t,r){const{name:n}=e;if(!(ct(yl,r)&&r.property===e)){if(!(ct(El,r)&&r.key===e))if(t.paramsRef.has(n))xi(e,t.paramsRef.get(n));else if(t.columnRef.has(n))Oh(e,n,t,r);else if(Object.hasOwn(t.params,n))xi(e,n);else if(Object.hasOwn(fu,n))Rh(e,n);else return!0}}function Ih(e,t,r,n,a){const i=r===0?n.table:r>0?n.join[r-1]:null,s=i&&i.column(t);i&&!s&&n.error(e,lu),n.aggronly&&!n.$op&&n.error(e,bw),Ol(e,t,r,s,a)}function Oh(e,t,r,n){const[a,i]=r.columnRef.get(t);Ih(e,a,i,r,n)}function Gw(e,t,r,n){n.params&&!Object.hasOwn(n.params,t)&&n.error(e,Iw),xi(e,t)}function xi(e,t){e.type=ky,e.name=t}function Rh(e,t){e.type=yy,e.name=t,e.raw=fu[t]}function pu(e,t,r){if(t===Hs){const n=r.table;n||r.error(e,Mw),Rl(e,n,e.arguments.length?e.arguments.map(a=>{const i=r.param(a),s=bn(i)?n.columnName(i):i;return n.column(s)||r.error(a,lu),s}):n.columnNames())}else e.callee={type:Ey,name:t}}function mu(e,t){ct(Tn,e)?t.scope.add(e.name):ct(xy,e)?e.elements.forEach(r=>mu(r,t)):ct(wl,e)?e.properties.forEach(r=>mu(r.value,t)):t.error(e.id,Nw)}const qw={[kl]:1,[Tl]:1};function zt(e,t={}){const r=t.generate||$s,n=t.compiler||Yc,a=Xw(t),i={},s={},c=[],f=[];let u=0,o=-1;const l=t.join?n.join:t.index==1?n.expr2:n.expr,h={op(m){const x=Kw(m);return s[x]||(m.id=++o,s[x]=m)},field(m){const x=r(m);return i[x]||(i[x]=++u)},param(m){return ct(ba,m)?m.value:n.param(r(m),a)},value(m,x){c.push(m);const v=x.escape||(t.ast?Ay(x):l(r(x),a));f.push(v),qw[x.type]&&v!==x&&wn(v)&&(v.field=x.name)},error(m,x,v=""){const y=m.start-6,g=m.end-6,_=String(h.spec).slice(y,g);Be(`${x}: "${_}"${v}`)}};Object.assign(h,t,{params:a});for(const[m,x]of Us(e))h.value(m+"",x.escape?Ny(h,x,a):Uw(h,x));if(t.ast)return{names:c,exprs:f};const d=[];for(const m in i)d[i[m]]=n.expr(m,a);const p=Object.values(s);return p.forEach(m=>m.fields=m.fields.map(x=>d[x])),{names:c,exprs:f,ops:p}}function Kw(e){let t=`${e.name}(${e.fields.concat(e.params).join(",")})`;if(e.frame){const r=e.frame.map(n=>Number.isFinite(n)?Math.abs(n):-1);t+=`[${r},${!!e.peers}]`}return t}function Xw(e){return(e.table?xu(e.table):e.join?{...xu(e.join[1]),...xu(e.join[0])}:{})||{}}function xu(e){return e&&xt(e.params)?e.params():{}}function Nh(e,t){return e&&e.expr?new Dh({...e,...t}):new Dh(t,e)}class Dh{constructor(t,r){this.expr=r,Object.assign(this,t)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...xt(this.expr)?{func:!0}:{}}}}function js(e,t,r=0){const n=r?{field:!0,table:r}:{field:!0};return Nh(e,t?{expr:t,...n}:n)}function Ph(e,t){for(const[r,n]of Us(t))e.set(r,n);return e}function en(e,t,r=new Map){return t=bn(t)?e.columnName(t):t,mr(t)?r.set(t,t):Ot(t)?t.forEach(n=>en(e,n,r)):xt(t)?en(e,t(e),r):wn(t)?Ph(r,t):Be(`Invalid column selection: ${jt(t)}`),r}function Lh(e,t){return e.toObject=t,e}function Bh(e){return Ot(e)?e.map(Bh):e&&e.toObject?e.toObject():e}function gi(){return Lh(e=>e.columnNames(),()=>({all:[]}))}function eo(...e){return e=e.flat(),Lh(t=>{const r=en(t,e);return t.columnNames(n=>!r.has(n))},()=>({not:Bh(e)}))}function vr(e,t,r,n={window:!1}){const a=new Map,i=s=>{s=bn(s)?t.columnName(s):s,mr(s)?a.set(s,js(s)):xt(s)?en(t,s).forEach(i):wn(s)?Ph(a,s):Be(`Invalid ${e} value: ${s+""}`)};return Nr(r).forEach(i),n.preparse&&n.preparse(a),zt(a,{table:t,...n})}function gu(e,...t){return Yw(e,vr("groupby",e,t.flat()))}function Yw(e,t){return e.create({groups:Jw(e,t)})}function Jw(e,{names:t=[],exprs:r=[],ops:n=[]}){const a=t.length;if(a===0)return null;if(a===1&&!e.isFiltered()&&r[0].field){const d=e.column(r[0].field);if(d.groups)return d.groups(t)}let i=Gn(e,n,r);const s=Ls(i),c=e.totalRows(),f=new Uint32Array(c),u={},o=[],l=e.data(),h=e.mask();if(h)for(let d=h.next(0);d>=0;d=h.next(d+1)){const p=s(d,l)+"";f[d]=u[p]??(u[p]=o.push(d)-1)}else for(let d=0;d<c;++d){const p=s(d,l)+"";f[d]=u[p]??(u[p]=o.push(d)-1)}return n.length||(i=i.map(d=>p=>d(p,l))),{keys:f,get:i,names:t,rows:o,size:o.length}}function Gt(e){return e?new Mh({...e.data()},e.columnNames()):new Mh}class Mh{constructor(t,r){this.data=t||{},this.names=r||[]}add(t,r){return this.has(t)||this.names.push(t+""),this.data[t]=r}has(t){return Object.hasOwn(this.data,t)}groupby(t){return this.groups=t,this}new(t){const{data:r,names:n,groups:a=null}=this;return t.create({data:r,names:n,groups:a,filter:null,order:null})}derive(t){return t.create(this)}}function to(e,t){return vu(e,zt(t,{table:e,aggronly:!0,window:!1}))}function vu(e,{names:t,exprs:r,ops:n=[]}){const a=Gt(),i=e.groups();return i&&_l(a,i),Qw(t,r,i,Ca(e,n),a),a.new(e)}function Qw(e,t,r,n=[],a){if(!t.length)return;const i=r?r.size:1,s=(f,u)=>n[f][u],c=e.length;for(let f=0;f<c;++f){const u=t[f];if(u.field!=null)a.add(e[f],n[u.field]);else if(i>1){const o=a.add(e[f],Array(i));for(let l=0;l<i;++l)o[l]=u(l,null,s)}else a.add(e[f],[u(0,null,s)])}}function Uh(e,...t){return _u(e,en(e,t.flat()))}function _u(e,t){const r=Gt();return t.forEach((n,a)=>{const i=mr(n)?n:a;if(i){const s=e.column(a)||Be(`Unrecognized column: ${a}`);r.add(i,s)}}),r.derive(e)}function Zw(e,t){if(!e||!t)return e;const{keys:r,rows:n,size:a}=e,i=new Uint32Array(a);t.scan(o=>i[r[o]]=1);const s=i.reduce((o,l)=>o+l,0);if(s===a)return e;const c=Array(s);let f=0;for(let o=0;o<a;++o)i[o]&&(c[i[o]=f++]=n[o]);const u=new Uint32Array(r.length);return t.scan(o=>u[o]=i[r[o]]),{...e,keys:u,rows:c,size:f}}function jw(e,t,r,n){const{keys:a,rows:i,size:s}=e;let c=i,f=s,u=null;if(r){u=new Int32Array(s),t(p=>u[a[p]]=1);const d=u.reduce((p,m)=>p+m,0);if(d!==s){c=Array(d),f=0;for(let p=0;p<s;++p)u[p]&&(c[u[p]=f++]=i[p])}}let o=-1;const l=new Uint32Array(n);return t(f!==s?d=>l[++o]=u[a[d]]:d=>l[++o]=a[d]),{...e,keys:l,rows:c,size:f}}function eE(e,t,r,n){const a=n==="map"||n===!0?il:n==="entries"?ol:n==="object"?sl:Be('groups option must be "map", "entries", or "object".'),{names:i}=e.groups(),s=ty(e.columnNames(),"_");let c=Uh(e,{}).reify(t).create({data:{[s]:r}});c=to(c,{[s]:nl(s)});for(let f=i.length;--f>=0;)c=to(gu(c,i.slice(0,f)),{[s]:a(i[f],s)});return c.get(s)}function tE(e){return Rs(e)?e.constructor:Array}let yu=class{constructor(t,r,n,a,i,s){const c=Object.freeze({...t});r=(r==null?void 0:r.slice())??Object.keys(c);const f=r.length?c[r[0]].length:0;this._names=Object.freeze(r),this._data=c,this._total=f,this._nrows=(n==null?void 0:n.count())??f,this._mask=n??null,this._group=a??null,this._order=i??null,this._params=s,this._index=null,this._partitions=null}create({data:t=void 0,names:r=void 0,filter:n=void 0,groups:a=void 0,order:i=void 0}={}){const s=n!==void 0?n:this.mask();return new this.constructor(t||this._data,r||(t?null:this._names),s,a!==void 0?a:Zw(this._group,n&&s),i!==void 0?i:this._order,this._params)}params(t){return arguments.length?(t&&(this._params={...this._params,...t}),this):this._params}get[Symbol.toStringTag](){if(!this._names)return"Object";const t=this.numRows(),r=this.numCols(),n=a=>a!==1?"s":"";return`Table: ${r} col${n(r)} x ${t} row${n(t)}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames(t){return t?this._names.filter(t):this._names.slice()}columnName(t){return this._names[t]}columnIndex(t){return this._names.indexOf(t)}column(t){return this._data[t]}columnAt(t){return this._data[this._names[t]]}array(t,r=Array){const n=this.column(t),a=new r(this.numRows());let i=-1;return this.scan(s=>a[++i]=n.at(s),!0),a}get(t,r=0){const n=this.column(t);return this.isFiltered()||this.isOrdered()?n.at(this.indices()[r]):n.at(r)}getter(t){const r=this.column(t),n=this.isFiltered()||this.isOrdered()?this.indices():null;if(n)return a=>r.at(n[a]);if(r)return a=>r.at(a);Be(`Unrecognized column: ${t}`)}object(t=0){return Vh(this)(t)}objects(t={}){const{grouped:r,limit:n,offset:a}=t,i=en(this,t.columns||gi()),s=Dl(this,i),c=[];if(this.scan((f,u)=>c.push(s(f,u)),!0,n,a),r&&this.isGrouped()){const f=[];return this.scan(u=>f.push(u),!0,n,a),eE(this,f,c,r)}return c}*[Symbol.iterator](){const t=Vh(this),r=this.numRows();for(let n=0;n<r;++n)yield t(n)}*values(t){const r=this.getter(t),n=this.numRows();for(let a=0;a<n;++a)yield r(a)}print(t={}){const r=bn(t)?{limit:+t}:{...t,limit:10},n=this.objects({...r,grouped:!1}),a=`${this[Symbol.toStringTag]}. Showing ${n.length} rows.`;return console.log(a),console.table(n),this}indices(t=!0){if(this._index)return this._index;const r=this.numRows(),n=new Uint32Array(r),a=this.isOrdered(),i=this.mask();let s=-1;if(i)for(let c=i.next(0);c>=0;c=i.next(c+1))n[++s]=c;else for(let c=0;c<r;++c)n[++s]=c;if(t&&a){const{_order:c,_data:f}=this;n.sort((u,o)=>c(u,o,f))}return(t||!a)&&(this._index=n),n}partitions(t=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices(t)];const{keys:r,size:n}=this._group,a=ka(n,()=>[]),i=this._index,s=this.mask(),c=this.numRows();if(i&&this.isOrdered())for(let f=0,u;f<c;++f)u=i[f],a[r[u]].push(u);else if(s)for(let f=s.next(0);f>=0;f=s.next(f+1))a[r[f]].push(f);else for(let f=0;f<c;++f)a[r[f]].push(f);if(t&&!i&&this.isOrdered()){const f=this._order,u=this._data;for(let o=0;o<n;++o)a[o].sort((l,h)=>f(l,h,u))}return(t||!this.isOrdered())&&(this._partitions=a),a}reify(t){const r=t?t.length:this.numRows(),n=this._names;let a,i;if(!t&&!this.isOrdered())if(this.isFiltered())r===this.totalRows()&&(a=this.data());else return this;if(!a){const s=t?f=>t.forEach(f):f=>this.scan(f,!0),c=n.length;a={};for(let f=0;f<c;++f){const u=n[f],o=this.column(u),l=a[u]=new(tE(o))(r);let h=-1;En(o)?s(d=>l[++h]=o[d]):s(d=>l[++h]=o.at(d))}this.isGrouped()&&(i=jw(this.groups(),s,!!t,r))}return this.create({data:a,names:n,groups:i,filter:null,order:null})}scan(t,r,n=1/0,a=0){const i=this._mask,s=this._nrows,c=this._data;let f=a||0;if(f>s)return;const u=Math.min(s,f+n),o=()=>f=this._total;if(r&&this.isOrdered()||i&&this._index){const l=this.indices(),h=this._data;for(;f<u;++f)t(l[f],h,o)}else if(i){let l=u-f+1;for(f=i.nth(f);--l&&f>-1;f=i.next(f+1))t(f,c,o)}else for(;f<u;++f)t(f,c,o)}};function Vh(e){let t=e._builder;if(!t){const r=Dl(e),n=e.data();if(e.isOrdered()||e.isFiltered()){const a=e.indices();t=i=>r(a[i],n)}else t=a=>r(a,n);e._builder=t}return t}function rE(e,...t){t=t.flat();const r=e.numRows(),n=e.reify(),a=Gt(n).groupby(n.groups());return t.forEach(i=>{i=i instanceof yu?i:new yu(i),i.numRows()!==r&&Be("Assign row counts do not match"),i=i.reify(),i.columnNames(s=>a.add(s,i.column(s)))}),a.new(e)}function $h(e,...t){t=t.flat();const r=e.numRows(),n=r+t.reduce((s,c)=>s+c.numRows(),0);if(r===n)return e;const a=[e,...t],i=Gt();return e.columnNames().forEach(s=>{const c=Array(n);let f=0;a.forEach(u=>{const o=u.column(s)||{at:()=>Oe};u.scan(l=>c[f++]=o.at(l))}),i.add(s,c)}),i.new(e)}function Hh(e,t,{before:r=void 0,after:n=void 0}={}){const a=r!=null,i=n!=null;a||i||Be("relocate requires a before or after option."),a&&i&&Be("relocate accepts only one of the before or after options."),t=en(e,t);const s=[...en(e,a?r:n).keys()],c=a?s[0]:s.pop(),f=new Map;return e.columnNames().forEach(u=>{const o=!t.has(u);if(u===c){i&&o&&f.set(u,u);for(const[l,h]of t)f.set(l,h);if(i)return}o&&f.set(u,u)}),_u(e,f)}function Wh(e){return{left(t,r,n,a){for(n==null&&(n=0),a==null&&(a=t.length);n<a;){const i=n+a>>>1;e(t[i],r)<0?n=i+1:a=i}return n},right(t,r,n,a){for(n==null&&(n=0),a==null&&(a=t.length);n<a;){const i=n+a>>>1;e(t[i],r)>0?a=i:n=i+1}return n}}}const zh=Wh(Hc);function nE(e,t,r,n,a){let i,s,c,f,u;const o=m=>s[m-1]===s[m],l=n.length,h=a.length,d=n.length?Aa(["w","r","k"],"{"+ci(n,(m,x)=>`r[_${x}.id][k]=_${x}.value(w,_${x}.get);`)+"}",n):()=>{},p={i0:0,i1:0,index:0,size:0,peer:o,init(m,x,v,y){p.index=p.i0=p.i1=0,p.size=x.length,i=m,s=x,f=v,u=y,c=a?a.map(g=>g.init()):null;for(let g=0;g<l;++g)n[g].init();return p},value(m,x){return x(i[m],e)},step(m){const[x,v]=t,y=p.size,g=p.i0,_=p.i1;p.i0=x!=null?Math.max(0,m-Math.abs(x)):0,p.i1=v!=null?Math.min(y,m+Math.abs(v)+1):y,p.index=m,r&&(p.i0>0&&o(p.i0)&&(p.i0=zh.left(s,s[p.i0])),p.i1<y&&o(p.i1)&&(p.i1=zh.right(s,s[p.i1-1])));for(let w=0;w<h;++w){const E=a[w],k=c[w];for(let F=g;F<p.i0;++F)E.rem(k,i[F],e);for(let F=_;F<p.i1;++F)E.add(k,i[F],e);E.write(k,f,u)}return d(p,f,u),f}};return p}const aE=e=>(e.frame||[null,null]).map(t=>Number.isFinite(t)?Math.abs(t):null),iE=e=>!!e.peers;function sE(e){const{id:t,name:r,fields:n=[],params:a=[]}=e;return{...ml(r).create(...a),get:n.length?n[0]:null,id:t}}function oE(e,t,r,n={},a){const i=e.data(),s=cE(a,i),c=s.length,f=Aa(["r","d","op"],"{"+ci(t,(u,o)=>`_${o}[r] = $${o}(r, d, op);`)+"}",t,r);e.partitions().forEach((u,o)=>{const l=u.length,h=uE(e,u);for(let p=0;p<c;++p)s[p].init(u,h,n,o);const d=p=>n[p][o];for(let p=0;p<l;++p){for(let m=0;m<c;++m)s[m].step(p);f(u[p],i,d)}})}function cE(e,t){const r={};return e.forEach(n=>{const a=aE(n),i=iE(n),s=`${a},${i}`,{aggOps:c,winOps:f}=r[s]||(r[s]={frame:a,peers:i,aggOps:[],winOps:[]});Vc(n.name)?c.push(n):f.push(sE(n))}),Object.values(r).map(n=>nE(t,n.frame,n.peers,n.winOps,xl(n.aggOps,n.frame[0]!=null?-1:1)))}function uE(e,t){if(e.isOrdered()){const r=e.comparator(),n=e.data(),a=t.length,i=new Uint32Array(a);for(let s=1,c=0;s<a;++s)i[s]=r(t[s-1],t[s],n)?++c:c;return i}else return t}function fE(e){return $c(e.name)||e.frame&&(Number.isFinite(e.frame[0])||Number.isFinite(e.frame[1]))}function lE(e,t,r={}){const n=wu(e,zt(t,{table:e}),r);return r.drop||r.before==null&&r.after==null?n:Hh(n,Object.keys(t).filter(a=>!e.column(a)),r)}function wu(e,{names:t,exprs:r,ops:n=[]},a={}){const i=e.totalRows(),s=Gt(a.drop?null:e),c=t.map(h=>s.add(h,Array(i))),[f,u]=hE(n),o=e.isGrouped()?e.groups().size:1,l=Ca(e,f,ka(n.length,()=>Array(o)));return u.length?oE(e,c,r,l,u):dE(e,c,r,l),s.derive(e)}function hE(e){const t=[],r=[],n=e.length;for(let a=0;a<n;++a){const i=e[a];i.id=a,(fE(i)?r:t).push(i)}return[t,r]}function dE(e,t,r,n){const a=e.mask(),i=e.data(),{keys:s}=e.groups()||{},c=s?(u,o)=>n[u][s[o]]:u=>n[u][0],f=t.length;for(let u=0;u<f;++u){const o=r[u],l=t[u];if(a)for(let h=a.next(0);h>=0;h=a.next(h+1))l[h]=o(h,i,c);else{const h=e.totalRows();for(let d=0;d<h;++d)l[d]=o(d,i,c)}}}function Eu(e,t){const r=zt({p:t},{table:e});let n=r.exprs[0];if(r.ops.length){const a=wu(e,r,{drop:!0}).column("p");n=i=>a.at(i)}return pE(e,n)}function pE(e,t){const r=e.totalRows(),n=e.mask(),a=e.data(),i=new _n(r);if(n)for(let s=n.next(0);s>=0;s=n.next(s+1))t(s,a)&&i.set(s);else for(let s=0;s<r;++s)t(s,a)&&i.set(s);return e.create({filter:i})}function ro(e,...t){t=t.flat();const r=gu(e,t.length?t:e.columnNames());return Eu(r,"row_number() === 1").ungroup().reify()}function Gh(e,t){const r=new Map;return e.scan((n,a)=>{const i=t(n,a);i!=null&&i===i&&r.set(i,n)}),r}function mE(e,t,r){const n=new Map,a=e.length;for(let i=0;i<a;++i){const s=e[i],c=r(s,t);c!=null&&c===c&&(n.has(c)?n.get(c).push(i):n.set(c,[i]))}return n}function xE(e,t){const r=new Set(t);return e.filter(n=>r.has(n))}function no(e,t,r){const n=new Map;Nr(r).forEach((i,s)=>{i=bn(i)?t.columnName(i):i,mr(i)?n.set(s,js(i)):xt(i)||wn(i)&&i.expr?n.set(s,i):Be(`Invalid ${e} key value: ${i+""}`)});const a=zt(n,{table:t,aggregate:!1,window:!1});return Ls(a.exprs,!0)}function ku(e,t,r){if(r)mr(r)?r=[r,r]:Ot(r)&&r.length===1&&(r=[r[0],r[0]]);else{const n=xE(e.columnNames(),t.columnNames());n.length||Be("Natural join requires shared column names."),r=[n,n]}return r}function qh(e,t,r,n){return r.length!==n.length&&Be("Mismatched number of join keys"),[no("join",e,r),no("join",t,n)]}function Kh(e,t,r){return Yh(e,t,r,{anti:!1})}function Xh(e,t,r){return Yh(e,t,r,{anti:!0})}function Yh(e,t,r,n){r=ku(e,t,r);const a=Ot(r)?qh(e,t,...r.map(Nr)):zt({on:r},{join:[e,t]}).exprs[0];return gE(e,t,a,n)}function gE(e,t,r,n={}){const a=new _n(e.totalRows());return(Ot(r)?vE:_E)(a,e,t,r),n.anti&&a.not().and(e.mask()),e.create({filter:a})}function vE(e,t,r,[n,a]){const i=Gh(r,a);t.scan((s,c)=>{i.get(n(s,c))>=0&&e.set(s)})}function _E(e,t,r,n){const a=t.numRows(),i=r.numRows(),s=t.data(),c=r.data();if(t.isFiltered()||r.isFiltered()){const f=t.indices(!1),u=r.indices(!1);for(let o=0;o<a;++o){const l=f[o];for(let h=0;h<i;++h)if(n(l,s,u[h],c)){e.set(l);break}}}else for(let f=0;f<a;++f)for(let u=0;u<i;++u)if(n(f,s,u,c)){e.set(f);break}}function yE(e,...t){if(t=t.flat(),t.length===0)return e;const r=e.columnNames();return ro(t.reduce((n,a)=>Xh(n,a.select(r)),e))}function wE(e,t,r){return Jh(e,vr("unroll",e,t),r&&r.drop?{...r,drop:vr("unroll",e,r.drop).names}:r)}function Jh(e,{names:t=[],exprs:r=[],ops:n=[]},a={}){if(!t.length)return e;const i=a.limit>0?+a.limit:1/0,s=a.index?a.index===!0?"index":a.index+"":null,c=new Set(a.drop),f=Gn(e,n,r),u=Gt(),o=new Set(t),l=[],h=[],d=[];e.columnNames().forEach(_=>{if(!c.has(_)){const w=u.add(_,[]);o.has(_)||(l.push(e.column(_)),h.push(w))}}),t.forEach(_=>{c.has(_)||(u.has(_)||u.add(_,[]),d.push(u.data[_]))});const p=s?u.add(s,[]):null;let m=0;const x=l.length,v=d.length,y=(_,w)=>{for(let E=0;E<x;++E)h[E].length=m+w,h[E].fill(l[E].at(_),m,m+w)},g=p?(_,w)=>{for(let E=0;E<w;++E)p[_+E]=E}:()=>{};if(v===1){const _=f[0],w=d[0];e.scan((E,k)=>{const F=Nr(_(E,k)),b=Math.min(F.length,i);y(E,b);for(let L=0;L<b;++L)w[m+L]=F[L];g(m,b),m+=b})}else e.scan((_,w)=>{let E=0;const k=f.map(F=>{const b=Nr(F(_,w));return E=Math.min(Math.max(E,b.length),i),b});y(_,E);for(let F=0;F<v;++F){const b=d[F],L=k[F];for(let U=0;U<E;++U)b[m+U]=L[U]}g(m,E),m+=E});return u.new(e)}function EE(e,t,r){return kE(e,vr("fold",e,t),r)}function kE(e,{names:t=[],exprs:r=[],ops:n=[]},a={}){if(t.length===0)return e;const[i="key",s="value"]=a.as||[],c=Gn(e,n,r);return Jh(e,{names:[i,s],exprs:[()=>t,(f,u)=>c.map(o=>o(f,u))]},{...a,drop:t})}function Tu(e){return e.isGrouped()?e.create({groups:null}):e}function TE(e,t,r={}){if(t=zt(t,{table:e}),t.names.forEach(n=>e.column(n)?0:Be(`Invalid impute column ${jt(n)}`)),r.expand){const n={preparse:AE,window:!1,aggronly:!0},a=vr("impute",e,r.expand,n),i=vu(Tu(e),a);return Qh(e,t,a.names,a.names.map(s=>i.get(s,0)))}else return Qh(e,t)}function AE(e){e.forEach((t,r)=>t.field?e.set(r,al(t+"")):0)}function Qh(e,t,r,n){const a=r&&r.length;e=a?CE(e,r,n):e;const{names:i,exprs:s,ops:c}=t,f=Gn(e,c,s),u=a?null:Gt(e),o=e.totalRows();return i.forEach((l,h)=>{const d=e.column(l),p=a?d:u.add(l,Array(o)),m=f[h];e.scan(x=>{const v=d.at(x);p[x]=xr(v)?v:m(x)})}),a?e:e.create(u)}function CE(e,t,r){const n=e.groups(),a=e.data(),i=(n?n.names:[]).concat(t),s=(n?n.get:[]).concat(t.map(p=>e.getter(p))),c=new Set,f=Ls(s);e.scan((p,m)=>c.add(f(p,m)));const u=e.columnNames(),o=Gt(),l=u.map(p=>o.add(p,[]));u.forEach((p,m)=>{const x=a[p],v=l[m];e.scan(y=>v.push(x.at(y)))});const h=Ls(s.map((p,m)=>x=>x[m])),d=Aa("v","{"+l.map((p,m)=>`_${m}.push(v[$${m}]);`).join("")+"}",l,u.map(p=>i.indexOf(p)));if(n){let p=n.keys.length;const m=r.reduce((v,y)=>v*y.length,n.size),x=new Uint32Array(m+(p-c.size));x.set(n.keys),Zh(n,r,(v,y)=>{c.has(h(v))||(d(v),x[p++]=y[0])}),o.groupby({...n,keys:x})}else Zh(n,r,p=>{c.has(h(p))||d(p)});return o.new(e)}function Zh(e,t,r){const n=e?e.get.length:0,a=e?1:0,i=a+t.length,s=new Int32Array(i),c=new Int32Array(i),f=[];if(e){const{get:o,rows:l,size:h}=e;s[0]=h,f.push((d,p)=>{const m=l[p];for(let x=0;x<n;++x)d[x]=o[x](m)})}t.forEach((o,l)=>{const h=l+n;s[l+a]=o.length,f.push((d,p)=>d[h]=o[p])});const u=Array(n+t.length);for(let o=0;o<i;++o)f[o](u,0);r(u,c);for(let o=i-1;o>=0;){const l=++c[o];l<s[o]?(f[o](u,l),r(u,c),o=i-1):(c[o]=0,f[o](u,0),--o)}}function bE(e,...t){t=t.flat();const r=e.columnNames();return t.length?ro(t.reduce((n,a)=>Kh(n,a.select(r)),e)):e.reify([])}const SE={...{aggregate:!1,window:!1},index:1},jh=-1/0;function FE(e,t,r,n){return vi(e,t,()=>!0,r,{...n,left:!0,right:!0})}function vi(e,t,r,n,a={}){r=ku(e,t,r);const i={join:[e,t]};let s;if(Ot(r)){const[c,f]=r.map(Nr);s=qh(e,t,c,f),n||(n=IE(e,c,f,a))}else s=zt({on:r},i).exprs[0],n||(n=[gi(),gi()]);return NE(e,t,s,OE(e,t,n,i,a&&a.suffix),a)}function IE(e,t,r,n){const a=[];t.forEach((s,c)=>mr(s)&&s===r[c]?a.push(s):0);const i=eo(a);if(n.left&&n.right){const s=new Set(a);return[e.columnNames().map(c=>{const f=`[${jt(c)}]`;return s.has(c)?{[c]:`(a, b) => a${f} == null ? b${f} : a${f}`}:c}),i]}return n.right?[i,gi()]:[gi(),i]}function OE(e,t,r,n,a=[]){if(Ot(r)){let i,s,c,f=r.length;i=s=c={names:[],exprs:[]},f--&&(i=vr("join",e,r[0],n)),f--&&(s=vr("join",t,r[1],SE)),f--&&(c=zt(r[2],n));const u=new Set,o=new Set(i.names);return s.names.forEach(l=>{o.has(l)&&u.add(l)}),u.size&&(a[0]!==""&&ed(i.names,u,a[0]||"_1"),a[1]!==""&&ed(s.names,u,a[1]||"_2")),{names:i.names.concat(s.names,c.names),exprs:i.exprs.concat(s.exprs,c.exprs)}}else return zt(r,n)}function ed(e,t,r){e.forEach((n,a)=>t.has(n)?e[a]=n+r:0)}function RE(e,t){const r=["i","a","j","b"];return Aa(r,"{"+ci(e,(n,a)=>`_${a}.push($${a}(${r}));`)+"}",e,t)}function NE(e,t,r,{names:n,exprs:a},i={}){const s=e.data(),c=e.indices(!1),f=c.length,u=new Int32Array(f),o=t.data(),l=t.indices(!1),h=l.length,d=new Int32Array(h),p=n.length,m=Gt(),x=Array(p),v=Array(p);for(let _=0;_<n.length;++_)x[_]=m.add(n[_],[]),v[_]=a[_];const y=RE(x,v);if((Ot(r)?PE:DE)(y,r,s,o,c,l,u,d,f,h),i.left)for(let _=0;_<f;++_)u[_]||y(c[_],s,jh,o);if(i.right)for(let _=0;_<h;++_)d[_]||y(jh,s,l[_],o);return m.new(e)}function DE(e,t,r,n,a,i,s,c,f,u){for(let o=0;o<f;++o){const l=a[o];for(let h=0;h<u;++h){const d=i[h];t(l,r,d,n)&&(e(l,r,d,n),s[o]=1,c[h]=1)}}}function PE(e,[t,r],n,a,i,s,c,f,u,o){let l,h,d,p,m,x,v,y,g=e;u>=o?(l=n,h=t,d=c,p=i,m=a,x=r,v=f,y=s):(l=a,h=r,d=f,p=s,m=n,x=t,v=c,y=i,g=(E,k,F,b)=>e(F,b,E,k));const _=mE(y,m,x),w=p.length;for(let E=0;E<w;++E){const k=p[E],F=_.get(h(k,l));if(F){const b=F.length;for(let L=0;L<b;++L){const U=F[L];g(k,l,y[U],m),v[U]=1}d[E]=1}}}function LE(e,t,r,...n){return r=ku(e,t,r),n=n.length===0?[eo(e.columnNames())]:n.flat(),BE(e,t,[no("lookup",e,r[0]),no("lookup",t,r[1])],vr("lookup",t,n))}function BE(e,t,[r,n],{names:a,exprs:i,ops:s=[]}){const c=Gt(e),f=e.totalRows();a.forEach(h=>c.add(h,Array(f).fill(Oe)));const u=Gh(t,n),o=Aa(["lr","rr","data"],"{"+ci(a,(h,d)=>`_[${d}][lr] = $[${d}](rr, data);`)+"}",a.map(h=>c.data[h]),Gn(t,s,i)),l=t.data();return e.scan((h,d)=>{const p=u.get(r(h,d));p>=0&&o(h,p,l)}),c.derive(e)}const ME=(e,t,r,n)=>`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${r} : (u > v || v == null) && u != null ? ${n} : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${r} : v !== v && u === u ? ${n} : `,UE=(e,t,r,n,a)=>`(v = ${t}, (u = ${e}) == null && v == null) ? 0 : v == null ? ${n} : u == null ? ${r} : (u = ${a}(u,v)) ? u : `;function VE(e,t){const r=[],n=[],a=[];let i=null,s="0",c="0";e.isGrouped()&&(i=e.groups().keys,s="ka",c="kb");const{ops:f}=zt(t,{table:e,value:(d,p)=>{if(r.push(d),p.escape){const m=x=>`fn[${a.length}](${x}, data)`;n.push([m("a"),m("b")]),a.push(p.escape)}else n.push([$s(p,{index:"a",op:s}),$s(p,{index:"b",op:c})])},window:!1}),u=Ca(e,f),o=(d,p)=>u[d][p],l=r.length;let h="return (a, b) => {"+(o&&e.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let d=0;d<l;++d){const p=t.get(r[d]),m=p.desc?-1:1,[x,v]=n[d];p.collate?(h+=UE(x,v,-m,m,`${m<0?"-":""}fn[${a.length}]`),a.push(p.collate)):h+=ME(x,v,-m,m)}return h+="0;};",Function("op","keys","fn","data",h)(o,i,a,e.data())}function $E(e,...t){return WE(e,HE(e,t.flat()))}function HE(e,t){let r=-1;const n=new Map,a=i=>n.set(++r+"",i);return t.forEach(i=>{const s=i.expr!=null?i.expr:i;if(wn(s)&&!xt(s))for(const c in s)a(s[c]);else a(bn(s)?js(i,e.columnName(s)):mr(s)?js(i):xt(s)?i:Be(`Invalid orderby field: ${i+""}`))}),VE(e,n)}function WE(e,t){return e.create({order:t})}function zE(e,t,r,n){return qE(e,vr("fold",e,t),vr("fold",e,r,{preparse:GE,window:!1,aggronly:!0}),n)}function GE(e){e.forEach((t,r)=>t.field?e.set(r,tl(t+"")):0)}const Au=(e,t)=>e??t;function qE(e,t,r,n={}){const{keys:a,keyColumn:i}=KE(e,t,n),s=Au(n.valueSeparator,"_"),c=r.names.length>1?(u,o)=>o+s+a[u]:u=>a[u],f=a.map(u=>Ca(e,r.ops.map(o=>{if(o.name==="count"){const h=d=>u===i[d]?1:NaN;return h.toString=()=>u+":1",{...o,name:"sum",fields:[h]}}const l=o.fields.map(h=>{const d=(p,m)=>u===i[p]?h(p,m):NaN;return d.toString=()=>u+":"+h,d});return{...o,fields:l}})));return XE(r,c,e.groups(),f).new(e)}function KE(e,t,r){const n=r.limit>0?+r.limit:1/0,a=Au(r.sort,!0),i=Au(r.keySeparator,"_"),s=Gn(e,t.ops,t.exprs),c=s.length===1?s[0]:(l,h)=>s.map(d=>d(l,h)).join(i),f=Array(e.totalRows());e.scan((l,h)=>f[l]=c(l,h));const u=Ca(Tu(e),[{id:0,name:"array_agg_distinct",fields:[l=>f[l]],params:[]}])[0][0],o=a?u.sort():u;return{keys:Number.isFinite(n)?o.slice(0,n):o,keyColumn:f}}function XE({names:e,exprs:t},r,n,a){const i=n?n.size:1,s=Gt(),c=a.length,f=e.length;let u;const o=(l,h)=>u[l][h];n&&_l(s,n);for(let l=0;l<f;++l){const h=t[l];if(h.field!=null)for(let d=0;d<c;++d)s.add(r(d,e[l]),a[d][h.field]);else if(i>1)for(let d=0;d<c;++d){u=a[d];const p=s.add(r(d,e[l]),Array(i));for(let m=0;m<i;++m)p[m]=h(m,null,o)}else for(let d=0;d<c;++d)u=a[d],s.add(r(d,e[l]),[h(0,null,o)])}return s}function YE(e,t){const r=Gt(),n=e.groups(),{get:a,names:i=[],rows:s,size:c=1}=n||{},f=new Uint32Array(c+1);i.forEach(h=>r.add(h,null));const u=n?vl(e,t,n):[gl(e,t)];t.outputs().map(h=>r.add(h,[]));const o=f.length-1;let l=0;for(let h=0;h<o;++h)l+=f[h+1]=t.write(u[h],r.data,f[h]);if(n){const h=e.data();i.forEach((d,p)=>{const m=r.data[d]=Array(l),x=a[p];for(let v=0,y=0;v<c;++v)m.fill(x(s[v],h),y,y+=f[v+1])})}return r.new(e)}function JE(e,...t){const r=new Map;return e.columnNames(n=>(r.set(n,n),0)),_u(e,en(e,t.flat(),r))}function QE(e,t,r,n){return(t?n?jE:ZE:n?tk:ek)(e.length,e,r,n)}function ZE(e,t,r){const n=r.length;for(let a=0;a<e;++a)t[a]=r[n*Ea()|0];return t}function jE(e,t,r,n){const a=r.length,i=new Float64Array(a);let s=0;for(let f=0;f<a;++f)i[f]=s+=n(r[f]);const c=Wh(Hc).right;for(let f=0;f<e;++f)t[f]=r[c(i,s*Ea())];return t}function ek(e,t,r){const n=r.length;if(e>=n)return r;for(let a=0;a<e;++a)t[a]=r[a];for(let a=e;a<n;++a){const i=a*Ea();i<e&&(t[i|0]=r[a])}return t}function tk(e,t,r,n){const a=r.length;if(e>=a)return r;const i=new Float32Array(a),s=new Uint32Array(a);for(let c=0;c<a;++c)s[c]=c,i[c]=-Math.log(Ea())/n(r[c]);s.sort((c,f)=>i[c]-i[f]);for(let c=0;c<e;++c)t[c]=r[s[c]];return t}function rk(e,t=0,r=e.length){let n=r-(t=+t);for(;n;){const a=Ea()*n--|0,i=e[n+t];e[n+t]=e[a+t],e[a+t]=i}return e}function nk(e,t,r={}){return sk(e,ak(e,t),ik(e,r.weight),r)}const td=e=>t=>e.at(t)||0;function ak(e,t){return bn(t)?()=>t:td(vu(e,zt({size:t},{table:e,window:!1})).column("size"))}function ik(e,t){return t==null?null:(t=bn(t)?e.columnName(t):t,td(mr(t)?e.column(t):wu(e,zt({w:t},{table:e}),{drop:!0}).column("w")))}function sk(e,t,r,n={}){const{replace:a,shuffle:i}=n,s=e.partitions(!1);let c=0;t=s.map((o,l)=>{let h=t(l);return c+=h=a?h:Math.min(o.length,h),h});const f=new Uint32Array(c);let u=0;return s.forEach((o,l)=>{const h=t[l],d=f.subarray(u,u+=h);!a&&h===o.length?d.set(o):QE(d,a,o,r)}),i!==!1&&(s.length>1||!a)&&rk(f),e.reify(f)}function ok(e=0,t=1/0){return`${rd(e)} < row_number() && row_number() <= ${rd(t)}`}function rd(e){return e<0?`count() + ${e}`:e}function ck(e,t=0,r=1/0){if(e.isGrouped())return Eu(e,ok(t,r)).reify();const n=[],a=e.numRows();return t=Math.max(0,t+(t<0?a:0)),r=Math.min(a,Math.max(0,r+(r<0?a:0))),e.scan(i=>n.push(i),!0,r-t,t),e.reify(n)}function uk(e,t,r){return fk(e,vr("spread",e,t),r)}function fk(e,{names:t,exprs:r,ops:n=[]},a={}){if(t.length===0)return e;const i=t.length===1&&a.as||[],s=a.drop==null?!0:!!a.drop,c=a.limit==null?i.length||1/0:Math.max(1,+a.limit||1),f=Gn(e,n,r),u=Gt(),o=t.reduce((h,d,p)=>h.set(d,p),new Map),l=(h,d)=>{const p=lk(e,f[h],c),m=p.length;for(let x=0;x<m;++x)u.add(i[x]||`${d}_${x+1}`,p[x])};return e.columnNames().forEach(h=>{o.has(h)?(s||u.add(h,e.column(h)),l(o.get(h),h),o.delete(h)):u.add(h,e.column(h))}),o.forEach(l),u.derive(e)}function lk(e,t,r){const n=e.totalRows(),a=[];return e.scan((i,s)=>{const c=Nr(t(i,s)),f=Math.min(c.length,r);for(;a.length<f;)a.push(Array(n).fill(Oe));for(let u=0;u<f;++u)a[u][i]=c[u]}),a}function hk(e,...t){return ro($h(e,t.flat()))}function dk(e){return e.isOrdered()?e.create({order:null}):e}const nd=Uint8Array.of(65,82,82,79,87,49),pk=Uint8Array.of(255,255,255,255,0,0,0,0),_i={V1:0,V5:4},mk={Little:0},ao={NONE:0,Schema:1,DictionaryBatch:2,RecordBatch:3},Q={Dictionary:-1,NONE:0,Null:1,Int:2,Float:3,Binary:4,Utf8:5,Bool:6,Decimal:7,Date:8,Time:9,Timestamp:10,Interval:11,List:12,Struct:13,Union:14,FixedSizeBinary:15,FixedSizeList:16,Map:17,Duration:18,LargeBinary:19,LargeUtf8:20,LargeList:21,RunEndEncoded:22,BinaryView:23,Utf8View:24,ListView:25,LargeListView:26},io={HALF:0,SINGLE:1,DOUBLE:2},yi={DAY:0,MILLISECOND:1},_r={SECOND:0,MILLISECOND:1,MICROSECOND:2,NANOSECOND:3},wi={YEAR_MONTH:0,DAY_TIME:1,MONTH_DAY_NANO:2},ad={Sparse:0,Dense:1},Na=Uint8Array,Cu=Uint16Array,bu=Uint32Array,Su=BigUint64Array,Fu=Int8Array,id=Int16Array,Da=Int32Array,Pa=BigInt64Array,sd=Float32Array,Ei=Float64Array;function xk(e,t){const r=Math.log2(e)-3;return(t?[Fu,id,Da,Pa]:[Na,Cu,bu,Su])[r]}const gk=Object.getPrototypeOf(Int8Array);function od(e){return e instanceof gk}function cd(e){return Array.isArray(e)||od(e)}function Iu(e){return e===Pa||e===Su}function Ou(e,t){let r=0,n=e.length;if(n<=2147483648)do{const a=r+n>>>1;e[a]<=t?r=a+1:n=a}while(r<n);else do{const a=Math.trunc((r+n)/2);e[a]<=t?r=a+1:n=a}while(r<n);return r}function vk(e,t=1){return(e*t+7&-8)/t}function _k(e,t=e.length){const r=vk(t,e.BYTES_PER_ELEMENT);return e.length>r?e.subarray(0,r):e.length<r?ud(e,r):e}function ud(e,t,r=0){const n=new e.constructor(t);return n.set(e,r),n}function fd(e,t,r){for(;e.length<=t;)e=ud(e,e.length<<1,r?e.length:0);return e}function yk(e){return e instanceof Date}function wk(e){return typeof e[Symbol.iterator]=="function"}function ld(e,t,r){if(t(e))return e;throw new Error(r(e))}function ki(e,t,r){return t=Array.isArray(t)?t:Object.values(t),ld(e,n=>t.includes(n),r??(()=>`${e} must be one of ${t}`))}function Ek(e,t){for(const[r,n]of Object.entries(e))if(n===t)return r;return"<Unknown>"}const so=e=>`Unsupported data type: "${Ek(Q,e)}" (id ${e})`,oo=(e,t,r=!0,n=null)=>({name:e,type:t,nullable:r,metadata:n});function hd(e){return Object.hasOwn(e,"name")&&dd(e.type)}function dd(e){return typeof(e==null?void 0:e.typeId)=="number"}function pd(e,t="",r=!0){return hd(e)?e:oo(t,ld(e,dd,()=>"Data type expected."),r)}const md=e=>({typeId:e}),kk=(e,t,r=!1,n=-1)=>({typeId:Q.Dictionary,id:n,dictionary:e,indices:t||Ru(),ordered:r}),Tk=()=>md(Q.Null),Sn=(e=32,t=!0)=>({typeId:Q.Int,bitWidth:ki(e,[8,16,32,64]),signed:t,values:xk(e,t)}),xd=()=>Sn(8),gd=()=>Sn(16),Ru=()=>Sn(32),vd=()=>Sn(64),Ak=()=>Sn(8,!1),Ck=()=>Sn(16,!1),bk=()=>Sn(32,!1),Sk=()=>Sn(64,!1),_d=(e=2)=>({typeId:Q.Float,precision:ki(e,io),values:[Cu,sd,Ei][e]}),Fk=()=>_d(io.SINGLE),Nu=()=>_d(io.DOUBLE),Ik=()=>({typeId:Q.Utf8,offsets:Da}),Ok=()=>md(Q.Bool),Rk=e=>({typeId:Q.Date,unit:ki(e,yi),values:e===yi.DAY?Da:Pa}),Nk=()=>Rk(yi.DAY),Dk=(e=_r.MILLISECOND,t=null)=>({typeId:Q.Timestamp,unit:ki(e,_r),timezone:t,values:Pa}),Pk=e=>({typeId:Q.List,children:[pd(e)],offsets:Da}),Lk=e=>({typeId:Q.Struct,children:Array.isArray(e)&&hd(e[0])?e:Object.entries(e).map(([t,r])=>oo(t,r))}),Bk=(e,t)=>({typeId:Q.FixedSizeList,stride:t,children:[pd(e)]}),yd=new Ei(2),co=yd.buffer,Mk=new Pa(co),La=new bu(co),wd=new Da(co),Uk=new Na(co);function Vk(e){return e}function tn(e){return BigInt(e)}function Ed(e){return Iu(e)?tn:Vk}function $k(e){return e/864e5|0}function Hk(e){return e===_r.SECOND?t=>tn(t/1e3):e===_r.MILLISECOND?tn:e===_r.MICROSECOND?t=>tn(t*1e3):t=>tn(t*1e6)}function Wk([e,t,r]){return wd[0]=e,wd[1]=t,Mk[1]=tn(r),Uk}function Fn(e){if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error(`BigInt exceeds integer number representation: ${e}`);return Number(e)}function Du(e,t){return Number(e/t)+Number(e%t)/Number(t)}function zk(e,t,r,n,a){const i=typeof e=="bigint"?e:tn(Math.trunc(e*a));t[r]=i,t[r+1]=i>>64n,n>2&&(t[r+2]=i>>128n,t[r+3]=i>>192n)}const Ba=e=>BigInt.asUintN(64,e);function Gk(e,t){const r=t<<1;let n;return BigInt.asIntN(64,e[r+1])<0?(n=Ba(~e[r])|Ba(~e[r+1])<<64n,n=-(n+1n)):n=e[r]|e[r+1]<<64n,n}function qk(e,t){const r=t<<2;let n;return BigInt.asIntN(64,e[r+3])<0?(n=Ba(~e[r])|Ba(~e[r+1])<<64n|Ba(~e[r+2])<<128n|Ba(~e[r+3])<<192n,n=-(n+1n)):n=e[r]|e[r+1]<<64n|e[r+2]<<128n|e[r+3]<<192n,n}function Kk(e){if(e!==e)return 32256;yd[0]=e;const t=(La[1]&2147483648)>>16&65535;let r=La[1]&2146435072,n=0;return r>=1089470464?La[0]>0?r=31744:(r=(r&2080374784)>>16,n=(La[1]&1048575)>>10):r<=1056964608?(n=1048576+(La[1]&1048575),n=1048576+(n<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,n=(La[1]&1048575)+512>>10),t|r|n&65535}const Xk=new TextDecoder("utf-8"),Yk=new TextEncoder;function Pu(e){return Xk.decode(e)}function kd(e){return Yk.encode(e)}function uo(e){return`${typeof e!="object"||!e?e??null:yk(e)?+e:cd(e)?`[${e.map(uo)}]`:Jk(e)}`}function Jk(e){let t="",r=-1;for(const n in e)++r>0&&(t+=","),t+=`"${n}":${uo(e[n])}`;return`{${t}}`}const Ma=4,Lu=2;function Td(e,t){return(e[t>>3]&1<<t%8)!==0}function Bu(e,t){return Qk(e,t)<<16>>16}function Qk(e,t){return e[t]|e[t+1]<<8}function Ua(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function Ad(e,t){return Ua(e,t)>>>0}function Zk(e,t){return Fn(BigInt.asIntN(64,BigInt(Ad(e,t))+(BigInt(Ad(e,t+Ma))<<32n)))}const Mu=Symbol("rowIndex");function Uu(e,t){class r{constructor(i){this[Mu]=i}toJSON(){return bd(e,t,this[Mu])}}const n=r.prototype;for(let a=0;a<e.length;++a){if(Object.hasOwn(n,e[a]))continue;const i=t[a];Object.defineProperty(n,e[a],{get(){return i.at(this[Mu])},enumerable:!0})}return a=>new r(a)}function Cd(e,t){return r=>bd(e,t,r)}function bd(e,t,r){const n={};for(let a=0;a<e.length;++a)n[e[a]]=t[a].at(r);return n}function jk(e){return e instanceof Ai}class Ti{constructor({length:t,nullCount:r,type:n,validity:a,values:i,offsets:s,sizes:c,children:f}){this.length=t,this.nullCount=r,this.type=n,this.validity=a,this.values=i,this.offsets=s,this.sizes=c,this.children=f,(!r||!this.validity)&&(this.at=u=>this.value(u))}get[Symbol.toStringTag](){return"Batch"}at(t){return this.isValid(t)?this.value(t):null}isValid(t){return Td(this.validity,t)}value(t){return this.values[t]}slice(t,r){const n=r-t,a=Array(n);for(let i=0;i<n;++i)a[i]=this.at(t+i);return a}*[Symbol.iterator](){for(let t=0;t<this.length;++t)yield this.at(t)}}Wn(Ti,"ArrayType",null);class Ai extends Ti{constructor(t){super(t);const{length:r,values:n}=this;this.values=n.subarray(0,r)}slice(t,r){return this.nullCount?super.slice(t,r):this.values.subarray(t,r)}[Symbol.iterator](){return this.nullCount?super[Symbol.iterator]():this.values[Symbol.iterator]()}}class fo extends Ti{}Wn(fo,"ArrayType",Ei);class Ye extends Ti{}Wn(Ye,"ArrayType",Array);class Sd extends Ye{value(t){return null}}class Kn extends fo{value(t){return Fn(this.values[t])}}class eT extends fo{value(t){const r=this.values[t],n=(r&31744)>>10,a=(r&1023)/1024,i=(-1)**((r&32768)>>15);switch(n){case 31:return i*(a?Number.NaN:1/0);case 0:return i*(a?6103515625e-14*a:0)}return i*2**(n-15)*(1+a)}}class tT extends Ye{value(t){return Td(this.values,t)}}class Fd extends Ti{constructor(t){super(t);const{bitWidth:r,scale:n}=this.type;this.decimal=r===128?Gk:qk,this.scale=10n**BigInt(n)}}class Id extends Fd{value(t){return Du(this.decimal(this.values,t),this.scale)}}Wn(Id,"ArrayType",Ei);class Od extends Fd{value(t){return this.decimal(this.values,t)}}Wn(Od,"ArrayType",Array);class Rd extends Ye{constructor(t){super(t),this.source=t}value(t){return new Date(this.source.value(t))}}class rT extends fo{value(t){return 864e5*this.values[t]}}const nT=Kn;class aT extends Kn{value(t){return super.value(t)*1e3}}const iT=Kn;class sT extends Kn{value(t){return Du(this.values[t],1000n)}}class oT extends Kn{value(t){return Du(this.values[t],1000000n)}}class cT extends Ye{value(t){return this.values.subarray(t<<1,t+1<<1)}}class uT extends Ye{value(t){const r=this.values,n=t<<4;return Float64Array.of(Ua(r,n),Ua(r,n+4),Zk(r,n+8))}}const Nd=({values:e,offsets:t},r)=>e.subarray(t[r],t[r+1]),Dd=({values:e,offsets:t},r)=>e.subarray(Fn(t[r]),Fn(t[r+1]));class fT extends Ye{value(t){return Nd(this,t)}}class lT extends Ye{value(t){return Dd(this,t)}}class hT extends Ye{value(t){return Pu(Nd(this,t))}}class dT extends Ye{value(t){return Pu(Dd(this,t))}}class pT extends Ye{value(t){const r=this.offsets;return this.children[0].slice(r[t],r[t+1])}}class mT extends Ye{value(t){const r=this.offsets;return this.children[0].slice(Fn(r[t]),Fn(r[t+1]))}}class xT extends Ye{value(t){const r=this.offsets[t],n=r+this.sizes[t];return this.children[0].slice(r,n)}}class gT extends Ye{value(t){const r=this.offsets[t],n=r+this.sizes[t];return this.children[0].slice(Fn(r),Fn(n))}}class Pd extends Ye{constructor(t){super(t),this.stride=this.type.stride}}class vT extends Pd{value(t){const{stride:r,values:n}=this;return n.subarray(t*r,(t+1)*r)}}class _T extends Pd{value(t){const{children:r,stride:n}=this;return r[0].slice(t*n,(t+1)*n)}}function Ld({children:e,offsets:t},r){const[n,a]=e[0].children,i=t[r],s=t[r+1],c=[];for(let f=i;f<s;++f)c.push([n.at(f),a.at(f)]);return c}class yT extends Ye{value(t){return Ld(this,t)}}class wT extends Ye{value(t){return new Map(Ld(this,t))}}class Bd extends Ye{constructor({typeIds:t,...r}){super(r),this.typeIds=t,this.typeMap=this.type.typeMap}value(t,r=t){const{typeIds:n,children:a,typeMap:i}=this;return a[i[n[t]]].at(r)}}class ET extends Bd{value(t){return super.value(t,this.offsets[t])}}class Md extends Ye{constructor(t,r=Cd){super(t),this.names=this.type.children.map(n=>n.name),this.factory=r(this.names,this.children)}value(t){return this.factory(t)}}class kT extends Md{constructor(t){super(t,Uu)}}class TT extends Ye{value(t){const[{values:r},n]=this.children;return n.at(Ou(r,t))}}class AT extends Ye{setDictionary(t){return this.dictionary=t,this.cache=t.cache(),this}value(t){return this.cache[this.key(t)]}key(t){return this.values[t]}}class Ud extends Ye{constructor({data:t,...r}){super(r),this.data=t}view(t){const{values:r,data:n}=this,a=t<<4;let i=a+4,s=r;const c=Ua(s,a);return c>12&&(i=Ua(s,a+12),s=n[Ua(s,a+8)]),s.subarray(i,i+c)}}class CT extends Ud{value(t){return this.view(t)}}class bT extends Ud{value(t){return Pu(this.view(t))}}class Vu{constructor(t,r=(n=>(n=t[0])==null?void 0:n.type)()){this.type=r,this.length=t.reduce((s,c)=>s+c.length,0),this.nullCount=t.reduce((s,c)=>s+c.nullCount,0),this.data=t;const a=t.length,i=new Int32Array(a+1);if(a===1){const[s]=t;i[1]=s.length,this.at=c=>s.at(c)}else for(let s=0,c=0;s<a;++s)i[s+1]=c+=t[s].length;this.offsets=i}get[Symbol.toStringTag](){return"Column"}[Symbol.iterator](){const t=this.data;return t.length===1?t[0][Symbol.iterator]():ST(t)}at(t){var i;const{data:r,offsets:n}=this,a=Ou(n,t)-1;return(i=r[a])==null?void 0:i.at(t-n[a])}get(t){return this.at(t)}toArray(){const{length:t,nullCount:r,data:n}=this,a=!r&&jk(n[0]),i=n.length;if(a&&i===1)return n[0].values;const s=!i||r>0?Array:n[0].constructor.ArrayType??n[0].values.constructor,c=new s(t);return a?FT(c,n):IT(c,n)}cache(){return this._cache??(this._cache=this.toArray())}}function*ST(e){for(let t=0;t<e.length;++t){const r=e[t][Symbol.iterator]();for(let n=r.next();!n.done;n=r.next())yield n.value}}function FT(e,t){for(let r=0,n=0;r<t.length;++r){const{values:a}=t[r];e.set(a,n),n+=a.length}return e}function IT(e,t){let r=-1;for(let n=0;n<t.length;++n){const a=t[n];for(let i=0;i<a.length;++i)e[++r]=a.at(i)}return e}class $u{constructor(t,r,n=!1){const a=t.fields.map(s=>s.name);this.schema=t,this.names=a,this.children=r,this.factory=n?Uu:Cd;const i=[];this.getFactory=s=>i[s]??(i[s]=this.factory(a,r.map(c=>c.data[s])))}get[Symbol.toStringTag](){return"Table"}get numCols(){return this.names.length}get numRows(){var t;return((t=this.children[0])==null?void 0:t.length)??0}getChildAt(t){return this.children[t]}getChild(t){const r=this.names.findIndex(n=>n===t);return r>-1?this.children[r]:void 0}selectAt(t,r=[]){const{children:n,factory:a,schema:i}=this,{fields:s}=i;return new $u({...i,fields:t.map((c,f)=>OT(s[c],r[f]))},t.map(c=>n[c]),a===Uu)}select(t,r){const n=this.names,a=t.map(i=>n.indexOf(i));return this.selectAt(a,r)}toColumns(){const{children:t,names:r}=this,n={};return r.forEach((a,i)=>{var s;return n[a]=((s=t[i])==null?void 0:s.toArray())??[]}),n}toArray(){var s;const{children:t,getFactory:r,numRows:n}=this,a=((s=t[0])==null?void 0:s.data)??[],i=Array(n);for(let c=0,f=-1;c<a.length;++c){const u=r(c);for(let o=0;o<a[c].length;++o)i[++f]=u(o)}return i}*[Symbol.iterator](){var a;const{children:t,getFactory:r}=this,n=((a=t[0])==null?void 0:a.data)??[];for(let i=0;i<n.length;++i){const s=r(i);for(let c=0;c<n[i].length;++c)yield s(c)}}at(t){const{children:r,getFactory:n,numRows:a}=this;if(t<0||t>=a)return null;const[{offsets:i}]=r,s=Ou(i,t)-1;return n(s)(t-i[s])}get(t){return this.at(t)}}function OT(e,t){return t!=null&&t!==e.name?{...e,name:t}:e}function Vd(e,t={}){const{typeId:r,bitWidth:n,precision:a,unit:i}=e,{useBigInt:s,useDate:c,useDecimalBigInt:f,useMap:u,useProxy:o}=t;switch(r){case Q.Null:return Sd;case Q.Bool:return tT;case Q.Int:case Q.Time:case Q.Duration:return s||n<64?Ai:Kn;case Q.Float:return a?Ai:eT;case Q.Date:return $d(i===yi.DAY?rT:nT,c&&Rd);case Q.Timestamp:return $d(i===_r.SECOND?aT:i===_r.MILLISECOND?iT:i===_r.MICROSECOND?sT:oT,c&&Rd);case Q.Decimal:return f?Od:Id;case Q.Interval:return i===wi.DAY_TIME?cT:i===wi.YEAR_MONTH?Ai:uT;case Q.FixedSizeBinary:return vT;case Q.Utf8:return hT;case Q.LargeUtf8:return dT;case Q.Binary:return fT;case Q.LargeBinary:return lT;case Q.BinaryView:return CT;case Q.Utf8View:return bT;case Q.List:return pT;case Q.LargeList:return mT;case Q.Map:return u?wT:yT;case Q.ListView:return xT;case Q.LargeListView:return gT;case Q.FixedSizeList:return _T;case Q.Struct:return o?kT:Md;case Q.RunEndEncoded:return TT;case Q.Dictionary:return AT;case Q.Union:return e.mode?ET:Bd}throw new Error(so(r))}function $d(e,t){return t?class extends t{constructor(n){super(new e(n))}}:e}function Hu(e,t,r){e[t]=r,e[t+1]=r>>8,e[t+2]=r>>16,e[t+3]=r>>24}const lo=1024;class RT{constructor(t){this.sink=t,this.minalign=1,this.buf=new Uint8Array(lo),this.space=lo,this.vtables=[],this.outputBytes=0}offset(){return this.buf.length-this.space}writeInt8(t){this.buf[this.space-=1]=t}writeInt16(t){this.buf[this.space-=2]=t,this.buf[this.space+1]=t>>8}writeInt32(t){Hu(this.buf,this.space-=4,t)}writeInt64(t){const r=BigInt(t);this.writeInt32(Number(BigInt.asIntN(32,r>>BigInt(32)))),this.writeInt32(Number(BigInt.asIntN(32,r)))}addInt8(t){rn(this,1,0),this.writeInt8(t)}addInt16(t){rn(this,2,0),this.writeInt16(t)}addInt32(t){rn(this,4,0),this.writeInt32(t)}addInt64(t){rn(this,8,0),this.writeInt64(t)}addOffset(t){rn(this,Ma,0),this.writeInt32(this.offset()-t+Ma)}addObject(t,r){const n=NT(this,t);return r==null||r(n),n.finish()}addVector(t,r,n,a){const i=t==null?void 0:t.length;if(!i)return 0;rn(this,Ma,r*i),rn(this,n,r*i);for(let s=i;--s>=0;)a(this,t[s]);return this.writeInt32(i),this.offset()}addOffsetVector(t){return this.addVector(t,4,4,(r,n)=>r.addOffset(n))}addString(t){if(t==null)return 0;const r=kd(t),n=r.length;return this.addInt8(0),rn(this,Ma,n),this.buf.set(r,this.space-=n),this.writeInt32(n),this.offset()}finish(t){rn(this,this.minalign,Ma),this.addOffset(t)}flush(){const{buf:t,sink:r}=this,n=t.subarray(this.space,t.length);r.write(n),this.outputBytes+=n.byteLength,this.minalign=1,this.vtables=[],this.buf=new Uint8Array(lo),this.space=lo}addBuffer(t){const r=t.byteLength;if(!r)return 0;this.sink.write(t),this.outputBytes+=r;const n=(r+7&-8)-r;return this.addPadding(n),r+n}addPadding(t){t>0&&(this.sink.write(new Uint8Array(t)),this.outputBytes+=t)}}function rn(e,t,r){let{buf:n,space:a,minalign:i}=e;t>i&&(e.minalign=t);const s=n.length,c=s-a+r,f=~c+1&t-1;n=fd(n,c+f+t-1,!0),a+=n.length-s;for(let u=0;u<f;++u)n[--a]=0;e.buf=n,e.space=a}function NT(e,t){const r=Array(t).fill(0),n=e.offset();function a(i){r[i]=e.offset()}return{addInt8(i,s,c){s!=c&&(e.addInt8(s),a(i))},addInt16(i,s,c){s!=c&&(e.addInt16(s),a(i))},addInt32(i,s,c){s!=c&&(e.addInt32(s),a(i))},addInt64(i,s,c){s!=c&&(e.addInt64(s),a(i))},addOffset(i,s,c){s!=c&&(e.addOffset(s),a(i))},finish(){e.addInt32(0);const i=e.offset();let s=t;for(;--s>=0&&r[s]===0;);const c=s+1;for(;s>=0;--s)e.addInt16(r[s]?i-r[s]:0);const f=2;e.addInt16(i-n);const u=(c+f)*Lu;e.addInt16(u);let o=0;const{buf:l,vtables:h,space:d}=e;e:for(s=0;s<h.length;++s){const p=l.length-h[s];if(u==Bu(l,p)){for(let m=Lu;m<u;m+=Lu)if(Bu(l,d+m)!=Bu(l,p+m))continue e;o=h[s];break}}if(o)e.space=l.length-i,Hu(l,e.space,o-i);else{const p=e.offset();h.push(p),Hu(l,l.length-i,p-i)}return i}}}function Hd(e,t){const{nodes:r,regions:n,variadic:a}=t,i=e.addVector(r,16,8,(f,u)=>(f.writeInt64(u.nullCount),f.writeInt64(u.length),f.offset())),s=e.addVector(n,16,8,(f,u)=>(f.writeInt64(u.length),f.writeInt64(u.offset),f.offset())),c=e.addVector(a,8,8,(f,u)=>f.addInt64(u));return e.addObject(5,f=>{f.addInt64(0,r[0].length,0),f.addOffset(1,i,0),f.addOffset(2,s,0),f.addOffset(4,c,0)})}function DT(e,t){const r=Hd(e,t.data);return e.addObject(3,n=>{n.addInt64(0,t.id,0),n.addOffset(1,r,0),n.addInt8(2,+t.isDelta,0)})}function Wu(e,t){return(t==null?void 0:t.size)>0?e.addOffsetVector(Array.from(t,([r,n])=>{const a=e.addString(`${r}`),i=e.addString(`${n}`);return e.addObject(2,s=>{s.addOffset(0,a,0),s.addOffset(1,i,0)})})):0}function ho(e,t){switch(ki(t.typeId,Q,so)){case Q.Dictionary:return qT(e,t);case Q.Int:return VT(e,t);case Q.Float:return UT(e,t);case Q.Decimal:return LT(e,t);case Q.Date:return PT(e,t);case Q.Time:return WT(e,t);case Q.Timestamp:return zT(e,t);case Q.Interval:return $T(e,t);case Q.Duration:return BT(e,t);case Q.FixedSizeBinary:case Q.FixedSizeList:return MT(e,t);case Q.Map:return HT(e,t);case Q.Union:return GT(e,t)}return e.addObject(0)}function PT(e,t){return e.addObject(1,r=>{r.addInt16(0,t.unit,yi.MILLISECOND)})}function LT(e,t){return e.addObject(3,r=>{r.addInt32(0,t.precision,0),r.addInt32(1,t.scale,0),r.addInt32(2,t.bitWidth,128)})}function BT(e,t){return e.addObject(1,r=>{r.addInt16(0,t.unit,_r.MILLISECOND)})}function MT(e,t){return e.addObject(1,r=>{r.addInt32(0,t.stride,0)})}function UT(e,t){return e.addObject(1,r=>{r.addInt16(0,t.precision,io.HALF)})}function VT(e,t){return e.addObject(2,r=>{r.addInt32(0,t.bitWidth,0),r.addInt8(1,+t.signed,0)})}function $T(e,t){return e.addObject(1,r=>{r.addInt16(0,t.unit,wi.YEAR_MONTH)})}function HT(e,t){return e.addObject(1,r=>{r.addInt8(0,+t.keysSorted,0)})}function WT(e,t){return e.addObject(2,r=>{r.addInt16(0,t.unit,_r.MILLISECOND),r.addInt32(1,t.bitWidth,32)})}function zT(e,t){const r=e.addString(t.timezone);return e.addObject(2,n=>{n.addInt16(0,t.unit,_r.SECOND),n.addOffset(1,r,0)})}function GT(e,t){const r=e.addVector(t.typeIds,4,4,(n,a)=>n.addInt32(a));return e.addObject(2,n=>{n.addInt16(0,t.mode,ad.Sparse),n.addOffset(1,r,0)})}function qT(e,t){return e.addObject(4,r=>{r.addInt64(0,t.id,0),r.addOffset(1,ho(e,t.indices),0),r.addInt8(2,+t.ordered,0)})}const KT=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;function Wd(e,t){const{fields:r,metadata:n}=t,a=r.map(c=>zd(e,c)),i=e.addOffsetVector(a),s=Wu(e,n);return e.addObject(4,c=>{c.addInt16(0,+!KT,0),c.addOffset(1,i,0),c.addOffset(2,s,0)})}function zd(e,t){const{name:r,nullable:n,type:a,metadata:i}=t;let{typeId:s}=a,c=0,f=0;if(s!==Q.Dictionary)c=ho(e,a);else{const d=a.dictionary;s=d.typeId,f=ho(e,a),c=ho(e,d)}const u=(a.children||[]).map(d=>zd(e,d)),o=e.addOffsetVector(u),l=Wu(e,i),h=e.addString(r);return e.addObject(7,d=>{d.addOffset(0,h,0),d.addInt8(1,+n,0),d.addInt8(2,s,Q.NONE),d.addOffset(3,c,0),d.addOffset(4,f,0),d.addOffset(5,o,0),d.addOffset(6,l,0)})}function XT(e,t,r,n,a){const i=Wu(e,a),s=e.addVector(n,24,8,Gd),c=e.addVector(r,24,8,Gd),f=Wd(e,t);e.finish(e.addObject(5,o=>{o.addInt16(0,_i.V5,_i.V1),o.addOffset(1,f,0),o.addOffset(2,c,0),o.addOffset(3,s,0),o.addOffset(4,i,0)}));const u=e.offset();e.addInt32(0),e.addInt32(-1),e.flush(),e.sink.write(new Uint8Array(Int32Array.of(u).buffer)),e.sink.write(nd)}function Gd(e,{offset:t,metadataLength:r,bodyLength:n}){return e.writeInt64(n),e.writeInt32(0),e.writeInt32(r),e.writeInt64(t),e.offset()}function zu(e,t,r,n,a){e.finish(e.addObject(5,f=>{f.addInt16(0,_i.V5,_i.V1),f.addInt8(1,t,ao.NONE),f.addOffset(2,r,0),f.addInt64(3,n,0)}));const i=8,s=e.offset(),c=s+i+7&-8;a==null||a.push({offset:e.outputBytes,metadataLength:c,bodyLength:n}),e.addInt32(c-i),e.addInt32(-1),e.flush(),e.addPadding(c-s-i)}class YT{write(t){}pad(t){this.write(new Uint8Array(t))}finish(){return null}}class JT extends YT{constructor(){super(),this.buffers=[]}write(t){this.buffers.push(t)}finish(){const t=this.buffers,r=t.reduce((a,i)=>a+i.byteLength,0),n=new Uint8Array(r);for(let a=0,i=0;a<t.length;++a)n.set(t[a],i),i+=t[a].byteLength;return n}}const qd="stream",Kd="file";function QT(e,{sink:t,format:r=qd}={}){if(r!==qd&&r!==Kd)throw new Error(`Unrecognized Arrow IPC format: ${r}`);const{schema:n,dictionaries:a=[],records:i=[],metadata:s}=e,c=new RT(t||new JT),f=r===Kd,u=[],o=[];f&&c.addBuffer(nd),n&&zu(c,ao.Schema,Wd(c,n),0);for(const l of a){const{data:h}=l;zu(c,ao.DictionaryBatch,DT(c,l),h.byteLength,u),Xd(c,h.buffers)}for(const l of i)zu(c,ao.RecordBatch,Hd(c,l),l.byteLength,o),Xd(c,l.buffers);return c.addBuffer(pk),f&&XT(c,n,u,o,s),c.sink}function Xd(e,t){for(let r=0;r<t.length;++r)e.addBuffer(t[r])}function ZT(e,t){typeof t=="string"&&(t={format:t});const r=e.children;jT(r);const{dictionaries:n,idMap:a}=t4(r),i=n4(r),c={schema:r4(e.schema,a),dictionaries:n,records:i};return QT(c,t).finish()}function jT(e){var r;const t=(r=e[0])==null?void 0:r.data.map(n=>n.length);e.forEach(({data:n})=>{if(n.length!==t.length||n.some((a,i)=>a.length!==t[i]))throw new Error("Columns have inconsistent batch sizes.")})}function e4(){let e=0;const t=[],r=[],n=[],a=[];return{node(i,s){t.push({length:i,nullCount:s})},buffer(i){const s=i.byteLength,c=s+7&-8;r.push({offset:e,length:c}),e+=c,n.push(new Uint8Array(i.buffer,i.byteOffset,s))},variadic(i){a.push(i)},children(i,s){i.children.forEach((c,f)=>{Jd(c.type,s.children[f],this)})},done(){return{byteLength:e,nodes:t,regions:r,variadic:a,buffers:n}}}}function t4(e){const t=[],r=new Map,n=new Map;let a=-1;const i=s=>{if(r.has(s))n.set(s.type,r.get(s));else{r.set(s,++a);for(let c=0;c<s.data.length;++c)t.push({id:a,isDelta:c>0,data:Yd([s],c)});n.set(s.type,a)}};return e.forEach(s=>Gu(s.data[0],i)),{dictionaries:t,idMap:n}}function Gu(e,t){var r;if((e==null?void 0:e.type.typeId)===Q.Dictionary){const n=e.dictionary;t(n),Gu(n.data[0],t)}(r=e==null?void 0:e.children)==null||r.forEach(n=>Gu(n,t))}function r4(e,t){if(!t.size)return e;const r=i=>{i.typeId===Q.Dictionary&&(i.id=t.get(i.dictionary),a(i)),i.children&&(i.children=i.children.slice()).forEach(n)},n=(i,s,c)=>{const f={...i.type};c[s]={...i,type:f},r(f)},a=i=>{const s={...i.dictionary};i.dictionary=s,r(s)};return e={...e,fields:e.fields.slice()},e.fields.forEach(n),e}function n4(e){var t;return(((t=e[0])==null?void 0:t.data)||[]).map((r,n)=>Yd(e,n))}function Yd(e,t=0){const r=e4();return e.forEach(n=>{Jd(n.type,n.data[t],r)}),r.done()}function Jd(e,t,r){const{typeId:n}=e;if(n!==Q.Null)switch(r.node(t.length,t.nullCount),n){case Q.Bool:case Q.Int:case Q.Time:case Q.Duration:case Q.Float:case Q.Date:case Q.Timestamp:case Q.Decimal:case Q.Interval:case Q.FixedSizeBinary:case Q.Dictionary:r.buffer(t.validity),r.buffer(t.values);return;case Q.Utf8:case Q.LargeUtf8:case Q.Binary:case Q.LargeBinary:r.buffer(t.validity),r.buffer(t.offsets),r.buffer(t.values);return;case Q.BinaryView:case Q.Utf8View:r.buffer(t.validity),r.buffer(t.values),r.variadic(t.data.length),t.data.forEach(a=>r.buffer(a));return;case Q.List:case Q.LargeList:case Q.Map:r.buffer(t.validity),r.buffer(t.offsets),r.children(e,t);return;case Q.ListView:case Q.LargeListView:r.buffer(t.validity),r.buffer(t.offsets),r.buffer(t.sizes),r.children(e,t);return;case Q.FixedSizeList:case Q.Struct:r.buffer(t.validity),r.children(e,t);return;case Q.RunEndEncoded:r.children(e,t);return;case Q.Union:{r.buffer(t.typeIds),e.mode===ad.Dense&&r.buffer(t.offsets),r.children(e,t);return}default:throw new Error(so(n))}}function sr(e){return new Qd(e)}let Qd=class{constructor(t=Na){this.buf=new t(512)}array(t){return _k(this.buf,t)}prep(t){t>=this.buf.length&&(this.buf=fd(this.buf,t))}get(t){return this.buf[t]}set(t,r){this.prep(r),this.buf[r]=t}write(t,r){this.prep(r+t.length),this.buf.set(t,r)}};function Zd(){return new a4}class a4 extends Qd{set(t){const r=t>>3;this.prep(r),this.buf[r]|=1<<t%8}}class qu{constructor(t,r){this.type=t,this.ctx=r,this.batchClass=r.batchType(t)}init(){return this.index=-1,this}set(t,r){return this.index=r,!1}done(){return null}batch(){const t=new this.batchClass(this.done());return this.init(),t}}class yr extends qu{constructor(t,r){super(t,r)}init(){return this.nullCount=0,this.validity=Zd(),super.init()}set(t,r){this.index=r;const n=t!=null;return n?this.validity.set(r):this.nullCount++,n}done(){const{index:t,nullCount:r,type:n,validity:a}=this;return{length:t+1,nullCount:r,type:n,validity:r?a.array((t>>3)+1):new Na(0)}}}function i4(){const e=new Map,t=new Set;return{get(r,n){const a=r.id;if(a>=0&&e.has(a))return e.get(a);{const i=s4(r,n);return a>=0&&e.set(a,i),t.add(i),i}},finish(r){t.forEach(n=>n.finish(r))}}}function s4(e,t){const r=Object.create(null),n=t.builder(e.dictionary),a=[];n.init();let i=-1;return{type:e,values:n,add(s){return a.push(s),s},key(s){const c=uo(s);let f=r[c];return f===void 0&&(r[c]=f=++i,n.set(s,f)),f},finish(s){const c=e.dictionary,f=new(Vd(c,s))(n.done()),u=new Vu([f]);a.forEach(o=>o.setDictionary(u))}}}class o4 extends yr{constructor(t,r){super(t,r),this.dict=r.dictionary(t)}init(){return this.values=sr(this.type.indices.values),super.init()}set(t,r){super.set(t,r)&&this.values.set(this.dict.key(t),r)}done(){return{...super.done(),values:this.values.array(this.index+1)}}batch(){return this.dict.add(super.batch())}}function c4(e){const t=Ku();return e(r=>t.add(r)),t.type()}function Ku(){let e=0,t=0,r=0,n=0,a=0,i=0,s=0,c=0,f=0,u=0,o=0,l=1/0,h=-1/0,d=1/0,p=-1/0,m,x,v,y={};return{add(g){if(e++,g==null){t++;return}switch(typeof g){case"string":f++;break;case"number":n++,g<l&&(l=g),g>h&&(h=g),Number.isInteger(g)&&a++;break;case"bigint":i++,m===void 0?m=x=g:(g<m&&(m=g),g>x&&(x=g));break;case"boolean":r++;break;case"object":if(g instanceof Date)s++,+g%864e5===0&&c++;else if(cd(g)){u++;const _=g.length;_<d&&(d=_),_>p&&(p=_),v??(v=Ku()),g.forEach(v.add)}else{o++;for(const _ in g)(y[_]??(y[_]=Ku())).add(g[_])}}},type(){const g=e-t;return g===0?Tk():a===g?f4(l,h):n===g?Nu():i===g?l4(m,x):r===g?Ok():c===g?Nk():s===g?Dk():f===g?kk(Ik()):u===g?u4(v.type(),d,p):o===g?Lk(Object.entries(y).map(_=>oo(_[0],_[1].type()))):h4()}}}function u4(e,t,r){return r===t?Bk(e,t):Pk(e)}function f4(e,t){const r=Math.max(Math.abs(e)-1,t);return r<128?xd():r<32768?gd():r<2**31?Ru():Nu()}function l4(e,t){const r=-e>t?-e-1n:t;if(r>=2**63)throw new Error(`BigInt exceeds 64 bits: ${r}`);return vd()}function h4(){throw new Error("Mixed types detected, please define a union type.")}class jd extends yr{constructor(t,r){super(t,r),this.toOffset=Ed(t.offsets)}init(){return this.offsets=sr(this.type.offsets),this.values=sr(),this.pos=0,super.init()}set(t,r){const{offsets:n,values:a,toOffset:i}=this;super.set(t,r)&&(a.write(t,this.pos),this.pos+=t.length),n.set(i(this.pos),r+1)}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),values:this.values.array(this.pos+1)}}}class d4 extends yr{constructor(t,r){super(t,r)}init(){return this.values=Zd(),super.init()}set(t,r){super.set(t,r),t&&this.values.set(r)}done(){return{...super.done(),values:this.values.array((this.index>>3)+1)}}}class p4 extends yr{constructor(t,r){super(t,r),this.scale=10**t.scale,this.stride=t.bitWidth>>6}init(){return this.values=sr(this.type.values),super.init()}set(t,r){const{scale:n,stride:a,values:i}=this;super.set(t,r)&&(i.prep((r+1)*a),zk(t,i.buf,r*a,a,n))}done(){const{index:t,stride:r,values:n}=this;return{...super.done(),values:n.array((t+1)*r)}}}class m4 extends yr{constructor(t,r){super(t,r),this.stride=t.stride}init(){return this.values=sr(),super.init()}set(t,r){super.set(t,r)&&this.values.write(t,r*this.stride)}done(){const{stride:t,values:r}=this;return{...super.done(),values:r.array(t*(this.index+1))}}}class x4 extends yr{constructor(t,r){super(t,r),this.child=r.builder(this.type.children[0].type),this.stride=t.stride}init(){return this.child.init(),super.init()}set(t,r){const{child:n,stride:a}=this,i=r*a;if(super.set(t,r))for(let s=0;s<a;++s)n.set(t[s],i+s);else n.index=i+a}done(){const{child:t}=this;return{...super.done(),children:[t.batch()]}}}class g4 extends yr{init(){return this.values=sr(this.type.values),super.init()}set(t,r){if(super.set(t,r)){const n=r<<1;this.values.set(t[0],n),this.values.set(t[1],n+1)}}done(){return{...super.done(),values:this.values.array(this.index+1<<1)}}}class v4 extends yr{init(){return this.values=sr(),super.init()}set(t,r){super.set(t,r)&&this.values.write(Wk(t),r<<4)}done(){return{...super.done(),values:this.values.array(this.index+1<<4)}}}class ep extends yr{constructor(t,r,n){super(t,r),this.child=n}init(){this.child.init();const t=this.type.offsets;return this.offsets=sr(t),this.toOffset=Ed(t),this.pos=0,super.init()}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),children:[this.child.batch()]}}}class _4 extends ep{constructor(t,r){super(t,r,r.builder(t.children[0].type))}set(t,r){const{child:n,offsets:a,toOffset:i}=this;super.set(t,r)&&t.forEach(s=>n.set(s,this.pos++)),a.set(i(this.pos),r+1)}}class tp extends yr{constructor(t,r){super(t,r),this.children=t.children.map(n=>r.builder(n.type))}init(){return this.children.forEach(t=>t.init()),super.init()}done(){const{children:t}=this;return t.forEach(r=>r.index=this.index),{...super.done(),children:t.map(r=>r.batch())}}}class y4 extends tp{constructor(t,r){super(t,r),this.setters=this.children.map((n,a)=>{const i=t.children[a].name;return(s,c)=>n.set(s==null?void 0:s[i],c)})}set(t,r){super.set(t,r);const n=this.setters;for(let a=0;a<n.length;++a)n[a](t,r)}}class w4 extends ep{constructor(t,r){super(t,r,new E4(t.children[0].type,r))}set(t,r){const{child:n,offsets:a,toOffset:i}=this;if(super.set(t,r))for(const s of t)n.set(s,this.pos++);a.set(i(this.pos),r+1)}}class E4 extends tp{set(t,r){super.set(t,r);const[n,a]=this.children;n.set(t[0],r),a.set(t[1],r)}}const k4={};class T4 extends qu{constructor(t,r){super(t,r),this.children=t.children.map(n=>r.builder(n.type))}init(){return this.pos=0,this.key=null,this.value=k4,this.children.forEach(t=>t.init()),super.init()}next(){const[t,r]=this.children;t.set(this.index+1,this.pos),r.set(this.value,this.pos++)}set(t,r){if(t!==this.value){const n=uo(t);n!==this.key&&(this.key&&this.next(),this.key=n,this.value=t)}this.index=r}done(){this.next();const{children:t,index:r,type:n}=this;return{length:r+1,nullCount:0,type:n,children:t.map(a=>a.batch())}}}class rp extends qu{constructor(t,r){super(t,r),this.children=t.children.map(n=>r.builder(n.type)),this.typeMap=t.typeMap,this.lookup=t.typeIdForValue}init(){return this.nullCount=0,this.typeIds=sr(Fu),this.children.forEach(t=>t.init()),super.init()}set(t,r){const{children:n,lookup:a,typeMap:i,typeIds:s}=this;this.index=r;const c=a(t,r),f=n[i[c]];s.set(c,r),t==null&&++this.nullCount,this.update(t,r,f)}done(){const{children:t,nullCount:r,type:n,typeIds:a}=this,i=this.index+1;return{length:i,nullCount:r,type:n,typeIds:a.array(i),children:t.map(s=>s.batch())}}}class A4 extends rp{update(t,r,n){n.set(t,r),this.children.forEach(a=>{a!==n&&a.set(null,r)})}}class C4 extends rp{init(){return this.offsets=sr(this.type.offsets),super.init()}update(t,r,n){const a=n.index+1;n.set(t,a),this.offsets.set(a,r)}done(){return{...super.done(),offsets:this.offsets.array(this.index+1)}}}class b4 extends jd{set(t,r){super.set(t&&kd(t),r)}}class Ci extends yr{constructor(t,r){super(t,r),this.values=sr(t.values)}init(){return this.values=sr(this.type.values),super.init()}set(t,r){super.set(t,r)&&this.values.set(t,r)}done(){return{...super.done(),values:this.values.array(this.index+1)}}}class S4 extends Ci{set(t,r){super.set(t==null?t:tn(t),r)}}class Xu extends Ci{constructor(t,r,n){super(t,r),this.transform=n}set(t,r){super.set(t==null?t:this.transform(t),r)}}function np(e={},t=i4()){return{batchType:r=>Vd(r,e),builder(r){return ap(r,this)},dictionary(r){return t.get(r,this)},finish:()=>t.finish(e)}}function ap(e,t=np()){const{typeId:r}=e;switch(r){case Q.Int:case Q.Time:case Q.Duration:return Iu(e.values)?new S4(e,t):new Ci(e,t);case Q.Float:return e.precision?new Ci(e,t):new Xu(e,t,Kk);case Q.Binary:case Q.LargeBinary:return new jd(e,t);case Q.Utf8:case Q.LargeUtf8:return new b4(e,t);case Q.Bool:return new d4(e,t);case Q.Decimal:return new p4(e,t);case Q.Date:return new Xu(e,t,e.unit?tn:$k);case Q.Timestamp:return new Xu(e,t,Hk(e.unit));case Q.Interval:switch(e.unit){case wi.DAY_TIME:return new g4(e,t);case wi.MONTH_DAY_NANO:return new v4(e,t)}return new Ci(e,t);case Q.List:case Q.LargeList:return new _4(e,t);case Q.Struct:return new y4(e,t);case Q.Union:return e.mode?new C4(e,t):new A4(e,t);case Q.FixedSizeBinary:return new m4(e,t);case Q.FixedSizeList:return new x4(e,t);case Q.Map:return new w4(e,t);case Q.RunEndEncoded:return new T4(e,t);case Q.Dictionary:return new o4(e,t)}throw new Error(so(r))}function ip(e,t,r={},n){const a=wk(e)?f=>{for(const u of e)f(u)}:e;t??(t=c4(a));const{maxBatchRows:i=1/0,...s}=r;let c;if(t.typeId===Q.Null){let f=0;a(()=>++f),c=F4(t,f,i)}else{const f=np(s,n),u=ap(t,f).init(),o=h=>c.push(h.batch());c=[];let l=0;a(h=>{u.set(h,l++),l>=i&&(o(u),l=0)}),l&&o(u),f.finish()}return new Vu(c,t)}function F4(e,t,r){const n=[],a=c=>new Sd({length:c,nullCount:c,type:e}),i=Math.floor(t/r);for(let c=0;c<i;++c)n.push(a(r));const s=t%r;return s&&n.push(a(s)),n}function I4(e,t,r={},n){return!t&&od(e)?O4(e,r):ip(a=>e.forEach(a),t,r,n)}function O4(e,{maxBatchRows:t,useBigInt:r}){const n=e.constructor,a=R4(n),i=e.length,s=Math.min(t||1/0,i),c=Math.floor(i/s),f=[],u=Iu(n)&&!r?Kn:Ai,o=(h,d)=>f.push(new u({length:d-h,nullCount:0,type:a,validity:new Na(0),values:e.subarray(h,d)}));let l=0;for(let h=0;h<c;++h)o(l,l+=s);return l<i&&o(l,i),new Vu(f)}function R4(e){switch(e){case sd:return Fk();case Ei:return Nu();case Fu:return xd();case id:return gd();case Da:return Ru();case Pa:return vd();case Na:return Ak();case Cu:return Ck();case bu:return bk();case Su:return Sk()}}function N4(e,t){var c;const r=[],n=Array.isArray(e)?e:Object.entries(e),a=(c=n[0])==null?void 0:c[1].length,i=n.map(([f,u])=>{if(u.length!==a)throw new Error("All columns must have the same length.");return r.push(oo(f,u.type)),u}),s={version:_i.V5,endianness:mk.Little,fields:r,metadata:null};return new $u(s,i,t)}function bi(e,t){return xt(t)?t(e):t||e.columnNames()}function sp(e,t={}){const{columns:r,limit:n=1/0,offset:a=0,types:i={},...s}=t,c=bi(e,r),f=e.data(),u=a===0&&e.numRows()<=n&&!e.isFiltered()&&!e.isOrdered();return N4(c.map(o=>{const l=f[o],h=i[o],d=En(l);let p;if(u&&(d||xt(l.toArray)))p=I4(d?l:l.toArray(),h,s);else{const m=d?x=>l[x]:x=>l.at(x);p=ip(x=>e.scan(v=>x(m(v)),!0,n,a),h,s)}return[o,p]}))}function D4(e,t={}){const{format:r="stream",...n}=t;return ZT(sp(e,n),{format:r})}function Xn(e){return e}function Yu(e,t,r=100,n,a){const{start:i=Xn,cell:s,end:c=Xn}=a,f=e.data(),u=t.length;e.scan(o=>{i(o);for(let l=0;l<u;++l){const h=t[l];s(f[h].at(o),h,l)}c(o)},!0,r,n)}function P4(e,t={}){const r=bi(e,t.columns),n=t.format||{},a=t.delimiter||",",i=t.header??!0,s=new RegExp(`["${a}
\r]`),c=o=>o==null?"":yn(o)?Ds(o,!0):s.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o,f=r.map(c);let u=i?f.join(a)+`
`:"";return Yu(e,r,t.limit||1/0,t.offset,{cell(o,l,h){f[h]=c(n[l]?n[l](o):o)},end(){u+=f.join(a)+`
`}}),u}function L4(e,t,r={}){for(const n in e)r[n]=t(e[n],n);return r}function B4(e){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}function M4(e,t={}){let r=0,n=0,a=0,i=0,s=0,c=0;return e(f=>{if(++r,f==null){++n;return}const u=typeof f;if(u==="object"&&yn(f))++a,B4(f)&&++i;else if(u==="number"&&(++s,f===f&&(f|0)!==f)){const o=f+"",l=o.indexOf(".");if(l>=0){const h=o.indexOf("e"),d=h>0?h:o.length;c=Math.max(c,d-l-1)}}}),{align:(n+s+a)/r>.5?"r":"l",format:{utc:a===i,digits:Math.min(c,t.maxdigits||6)}}}function op(e,t,r){const n=r.format||{},a=r.align||{},i={},s={};return t.forEach(c=>{const f=M4(U4(e,c),r);s[c]=a[c]||f.align,i[c]=n[c]||f.format}),{align:s,format:i}}function U4(e,t){const r=e.column(t);return n=>e.scan(a=>n(r.at(a)))}function cp(e,t={}){if(xt(t))return t(e)+"";const r=typeof e;if(r==="object"){if(yn(e))return t.utc?Ds(e):Jf(e);{const n=JSON.stringify(e,(i,s)=>Rs(s)?Array.from(s):s),a=t.maxlen||30;return n.length>a?n.slice(0,28)+"…"+(n[0]==="["?"]":"}"):n}}else if(r==="number"){const n=t.digits||0;let a;return e!==0&&((a=Math.abs(e))>=1e18||a<Math.pow(10,-n))?e.toExponential(n):e.toFixed(n)}else return e+""}function V4(e,t={}){const r=bi(e,t.columns),{align:n,format:a}=op(e,r,t),i=$4(t),s=t.null,c=m=>m==="c"?"center":m==="r"?"right":"left",f=m=>m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),u=(m,x)=>f(cp(m,x)),o=s?(m,x)=>m==null?s(m):u(m,x):u;let l=-1,h=-1;const d=(m,x,v)=>{const y=v?c(n[x]):"",g=i[m]&&i[m](x,h,l)||"",_=(y?`text-align: ${y};`+(g?" ":""):"")+g;return`<${m}${_?` style="${_}"`:""}>`};let p=d("table")+d("thead")+d("tr",l)+r.map(m=>`${d("th",m,1)}${m}</th>`).join("")+"</tr></thead>"+d("tbody");return Yu(e,r,t.limit,t.offset,{start(m){l=m,++h,p+=d("tr")},cell(m,x){p+=d("td",x,1)+o(m,a[x])+"</td>"},end(){p+="</tr>"}}),p+"</tbody></table>"}function $4(e){return L4(e.style,t=>xt(t)?t:()=>t)}const up={},Va={},po=34,Si=10,fp=13,H4="columns",W4="ndjson",z4=e=>yn(e)?Ds(e,!0):e;function G4(e,{type:t,columns:r,format:n={},limit:a,offset:i}={}){const s=bi(e,r),c=s.map(u=>n[u]||z4),f=u=>e.scan(u,!0,a,i);return t===H4?q4(e,s,c,f):K4(e,s,c,f,t===W4)}function q4(e,t,r,n){let a="{";return t.forEach((i,s)=>{a+=(s?",":"")+JSON.stringify(i)+":[";const c=e.column(i),f=r[s];let u=-1;n(o=>{const l=c.at(o);a+=(++u?",":"")+JSON.stringify(f(l))}),a+="]"}),a+"}"}function K4(e,t,r,n,a=!1){const i=t.length,s=t.map(h=>`"${h}":`),c=t.map(h=>e.column(h)),f=a?h=>h.replaceAll(`
`,""):Xn,u=a?`
`:",";let o=a?"":"[",l=-1;return n(h=>{const d=[];for(let p=0;p<i;++p)d.push(s[p]+JSON.stringify(r[p](c[p].at(h))));o+=(++l?u:"")+f(`{${d.join(",")}}`)}),o+(a?"":"]")}function X4(e,t={}){const r=bi(e,t.columns),{align:n,format:a}=op(e,r,t),i=f=>f==="c"?":-:":f==="r"?"-:":":-",s=f=>f.replace(/\|/g,"\\|");let c="|"+r.map(s).join("|")+`|
|`+r.map(f=>i(n[f])).join("|")+`|
`;return Yu(e,r,t.limit,t.offset,{start(){c+="|"},cell(f,u){c+=s(cp(f,a[u]))+"|"},end(){c+=`
`}}),c}class mo extends yu{assign(...t){return rE(this,...t)}count(t={}){const{as:r="count"}=t;return to(this,{[r]:rl()})}derive(t,r){return lE(this,t,r)}filter(t){return Eu(this,t)}slice(t,r){return ck(this,t,r)}groupby(...t){return gu(this,...t)}orderby(...t){return $E(this,...t)}relocate(t,r){return Hh(this,Nr(t),r)}rename(...t){return JE(this,...t)}reduce(t){return YE(this,t)}rollup(t){return to(this,t)}sample(t,r){return nk(this,t,r)}select(...t){return Uh(this,...t)}ungroup(){return Tu(this)}unorder(){return dk(this)}dedupe(...t){return ro(this,...t)}impute(t,r){return TE(this,t,r)}fold(t,r){return EE(this,t,r)}pivot(t,r,n){return zE(this,t,r,n)}spread(t,r){return uk(this,t,r)}unroll(t,r){return wE(this,t,r)}lookup(t,r,...n){return LE(this,t,r,...n)}join(t,r,n,a){return vi(this,t,r,n,a)}join_left(t,r,n,a){const i={...a,left:!0,right:!1};return vi(this,t,r,n,i)}join_right(t,r,n,a){const i={...a,left:!1,right:!0};return vi(this,t,r,n,i)}join_full(t,r,n,a){const i={...a,left:!0,right:!0};return vi(this,t,r,n,i)}cross(t,r,n){return FE(this,t,r,n)}semijoin(t,r){return Kh(this,t,r)}antijoin(t,r){return Xh(this,t,r)}concat(...t){return $h(this,...t)}union(...t){return hk(this,...t)}intersect(...t){return bE(this,...t)}except(...t){return yE(this,...t)}toArrow(t){return sp(this,t)}toArrowIPC(t){return D4(this,t)}toCSV(t){return P4(this,t)}toHTML(t){return V4(this,t)}toJSON(t){return G4(this,t)}toMarkdown(t){return X4(this,t)}}function Y4(e){const t=e.slice(-3).toLowerCase();return t===".gz"?"gzip":t===".zz"?"deflate":null}async function J4(e,{fetch:t=void 0,decompress:r=Y4(e)}={}){const n=await fetch(e,t).then(a=>a.body);return r?n.pipeThrough(new DecompressionStream(r)):n}function Q4(e){if(xt(e[Symbol.asyncIterator]))return e[Symbol.asyncIterator]();{const t=e.getReader();return{next(){return t.read()},[Symbol.asyncIterator](){return this}}}}function Z4(e){return e.slice(1,-1).replace(/""/g,'"')}function j4(e=","){e.length!==1&&Be(`Text delimiter should be a single character, found "${e}"`);const t=e.charCodeAt(0);let r=0,n=0,a=!1,i=!1,s=!1,c=!1,f=null,u=null,o=[];function l(d){u=u?u+d:d}function h(){if(a)return a=!1,up;const d=r;let p;if(s||f.charCodeAt(d)===po){let x=c&&f.charCodeAt(d)!==po;if(c=!1,s=!0,!x){for(;++r<n;)if(f.charCodeAt(r)===po)if(++r<n){if(f.charCodeAt(r)!==po){x=!0;break}}else return l(f.slice(d,n)),c=!0,Va;if(!x)return l(f.slice(d,n)),Va}const v=Z4((u??"")+f.slice(d,r));return s=!1,u=null,r>=n?(u=v,Va):(p=f.charCodeAt(r++),p===Si?a=!0:p===fp&&(a=!0,r>=n?i=!0:f.charCodeAt(r)===Si&&++r),v)}let m;for(;r<n;){if(p=f.charCodeAt(m=r++),p===Si)a=!0;else if(p===fp)a=!0,r>=n?i=!0:f.charCodeAt(r)===Si&&++r;else if(p!==t)continue;return f.slice(d,m)}return l(f.slice(d,n)),Va}return{start(){},transform(d,p){f=d,n=f.length,r=0;const m=[];let x;if(i&&(f.charCodeAt(r)===Si&&++r,i=!1),u!=null)if((x=h())===Va){p.enqueue(m);return}else o.push((u??"")+x),u=null;for(;;)if((x=h())===Va){p.enqueue(m);return}else x===up?(m.push(o),o=[]):o.push(x)},flush(d){(o.length||u)&&(u!=null&&o.push(u),d.enqueue([o]))}}}function eA(e,t,r){return e>0?t?(n,a)=>a<e||r(n).startsWith(t):(n,a)=>a<e:t?n=>r(n).startsWith(t):null}function tA(e,t,r=Xn){const n=eA(e,t,r);if(!n)return null;let a=0;return{start(){},flush(){},transform(i,s){const c=i.length,f=new _n(c);for(let u=0;u<i.length;++u,++a)n(i[u],a)&&f.set(u);s.enqueue(f.count()?i.filter((u,o)=>!f.get(o)):i)}}}const rA=[e=>e==="true"||e==="false",e=>e!=="false"],lp=[e=>e==="NaN"||(e=+e)===e,e=>+e],nA=[Qf,e=>new Date(Date.parse(e))];function aA(e){return e&&e!=="."?lp.map(t=>r=>t(r&&r.replace(e,"."))):lp}function iA(e,t){const{decimal:r,limit:n=e.length}=t,a=[rA,aA(r),nA],i=a.length;for(let s=0;s<i;++s){const[c,f]=a[s];if(sA(e,c,n))return f}return Xn}function sA(e,t,r){for(let n=0;n<r;++n){const a=e[n];if(a!=null&&!t(a))return!1}return!0}function oA(e,t){let r=e;return t.forEach(n=>{n&&(r=r.pipeThrough(new TransformStream(n)))}),r}function cA(e,t){const r={};return e.forEach((n,a)=>r[n]=t[a]),new mo(r,e)}async function uA(e,t,r={}){const n=oA(e,t),a=+r.autoMax||1e3,i=Q4(n),s=[];let c=0;for(;c<a;){const h=await i.next(),d=h.value;if((d==null?void 0:d.length)>0&&(s.push(d),c+=d.length),h.done)break}const{names:f,values:u,parsers:o}=fA(s,r),l=f.length;for await(const h of i)for(let d=0;d<h.length;++d){const p=h[d];for(let m=0;m<l;++m)u[m].push(p[m]?o[m](p[m]):null)}return cA(f,u)}function fA(e,t){const[r]=e,n=r[0].length,a=+t.autoMax||1e3,i=ka(n,()=>[]);let s=t.header!==!1?r.shift():t.names;s=s?s.length<n?[...s,hp(n,s.length)]:s:hp(n);for(const f of e)for(let u=0;u<f.length;++u){const o=f[u];for(let l=0;l<n;++l)i[l].push(o[l]===""?null:o[l])}const c=lA(s,i,{...t,limit:a});return c.forEach((f,u)=>{if(f===Xn)return;const o=i[u];for(let l=0;l<o.length;++l)o[l]!=null&&(o[l]=f(o[l]))}),{names:s,values:i,parsers:c}}function hp(e,t=0){return ka(e-t,r=>`col${r+t+1}`)}function lA(e,t,r){const{parse:n={}}=r,a=r.autoType===!1;return e.map((i,s)=>xt(n[i])?n[i]:a?Xn:iA(t[s],r))}async function hA(e,t){return(await J4(e,t)).pipeThrough(new TextDecoderStream)}async function dA(e,t){return uA(e,pA(t),t)}async function dp(e,t){return dA(await hA(e,t),t)}function pA({delimiter:e=",",skip:t=0,comment:r=void 0}={}){return[j4(e),tA(t,r,n=>n[0])]}function mA(e){return Nh(e,{escape:!0,toString(){Be("Escaped values can not be serialized.")}})}const xA=(e,t)=>Be(`Illegal ${t} name: ${jt(e)}`),gA=(e,t)=>Be(`The ${t} ${jt(e)} is already defined. Use override option?`),vA=(e,t)=>Be(`The ${t} name ${jt(e)} is reserved and can not be overridden.`);function _A(e,t,r=zn,n="function"){e||xA(e,n),!t.override&&Object.hasOwn(r,e)&&gA(e,n)}function yA(e,t,r,n){return r[e]===t||_A(e,n)}function Ju(e,t,r={}){arguments.length===1&&(t=e,e=t.name,e===""||e==="anonymous"?Be("Anonymous function provided, please include a name argument."):e===Hs&&vA(Hs,"function")),!yA(e,t,kn,r)&&(kn[e]=t,zn[e]=t)}function wA(e,t){const r=n=>Be(`Illegal argument type: ${n||typeof e}`);return e instanceof Map?pp(e.entries(),t):yn(e)?r("Date"):Os(e)?r("RegExp"):mr(e)?r():Ot(e)?EA(e,t):xt(e[Symbol.iterator])?kA(e,t):wn(e)?pp(Object.entries(e),t):r()}function pp(e,t=["key","value"]){const r=[],n=[];for(const[i,s]of e)r.push(i),n.push(s);const a={};return t[0]&&(a[t[0]]=r),t[1]&&(a[t[1]]=n),a}function EA(e,t){const r=e.length,n={},a=i=>n[i]=Array(r);if(r){t=t||Object.keys(e[0]);const i=t.map(a),s=i.length;for(let c=0;c<r;++c){const f=e[c];for(let u=0;u<s;++u)i[u][c]=f[t[u]]}}else t&&t.forEach(a);return n}function kA(e,t){const r={},n=s=>r[s]=[];let a,i;for(const s of e){a||(t=t||Object.keys(s),a=t.map(n),i=a.length);for(let c=0;c<i;++c)a[c].push(s[t[c]])}return!a&&t&&t.forEach(n),r}function TA(e,t){if(e instanceof mo)return e;const r={},n=[];for(const[a,i]of Us(e))r[a]=i,n.push(a);return new mo(r,n)}function Vt(e,t){return new mo(wA(e,t),t)}function AA(e,t){let r=0,n=0;for(let a of e)a!=null&&(a=+a)>=a&&(++r,n+=a);if(r)return n/r}var CA={value:()=>{}};function mp(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new xo(r)}function xo(e){this._=e}function bA(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",a=r.indexOf(".");if(a>=0&&(n=r.slice(a+1),r=r.slice(0,a)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}xo.prototype=mp.prototype={constructor:xo,on:function(e,t){var r=this._,n=bA(e+"",r),a,i=-1,s=n.length;if(arguments.length<2){for(;++i<s;)if((a=(e=n[i]).type)&&(a=SA(r[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(a=(e=n[i]).type)r[a]=xp(r[a],e.name,t);else if(t==null)for(a in r)r[a]=xp(r[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new xo(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var r=new Array(a),n=0,a,i;n<a;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,a=i.length;n<a;++n)i[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,i=n.length;a<i;++a)n[a].value.apply(t,r)}};function SA(e,t){for(var r=0,n=e.length,a;r<n;++r)if((a=e[r]).name===t)return a.value}function xp(e,t,r){for(var n=0,a=e.length;n<a;++n)if(e[n].name===t){e[n]=CA,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var Qu="http://www.w3.org/1999/xhtml",gp={svg:"http://www.w3.org/2000/svg",xhtml:Qu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function go(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),gp.hasOwnProperty(t)?{space:gp[t],local:e}:e}function FA(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===Qu&&t.documentElement.namespaceURI===Qu?t.createElement(e):t.createElementNS(r,e)}}function IA(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function vp(e){var t=go(e);return(t.local?IA:FA)(t)}function OA(){}function Zu(e){return e==null?OA:function(){return this.querySelector(e)}}function RA(e){typeof e!="function"&&(e=Zu(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,c=n[a]=new Array(s),f,u,o=0;o<s;++o)(f=i[o])&&(u=e.call(f,f.__data__,o,i))&&("__data__"in f&&(u.__data__=f.__data__),c[o]=u);return new wr(n,this._parents)}function NA(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function DA(){return[]}function _p(e){return e==null?DA:function(){return this.querySelectorAll(e)}}function PA(e){return function(){return NA(e.apply(this,arguments))}}function LA(e){typeof e=="function"?e=PA(e):e=_p(e);for(var t=this._groups,r=t.length,n=[],a=[],i=0;i<r;++i)for(var s=t[i],c=s.length,f,u=0;u<c;++u)(f=s[u])&&(n.push(e.call(f,f.__data__,u,s)),a.push(f));return new wr(n,a)}function yp(e){return function(){return this.matches(e)}}function wp(e){return function(t){return t.matches(e)}}var BA=Array.prototype.find;function MA(e){return function(){return BA.call(this.children,e)}}function UA(){return this.firstElementChild}function VA(e){return this.select(e==null?UA:MA(typeof e=="function"?e:wp(e)))}var $A=Array.prototype.filter;function HA(){return Array.from(this.children)}function WA(e){return function(){return $A.call(this.children,e)}}function zA(e){return this.selectAll(e==null?HA:WA(typeof e=="function"?e:wp(e)))}function GA(e){typeof e!="function"&&(e=yp(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,c=n[a]=[],f,u=0;u<s;++u)(f=i[u])&&e.call(f,f.__data__,u,i)&&c.push(f);return new wr(n,this._parents)}function Ep(e){return new Array(e.length)}function qA(){return new wr(this._enter||this._groups.map(Ep),this._parents)}function vo(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}vo.prototype={constructor:vo,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function KA(e){return function(){return e}}function XA(e,t,r,n,a,i){for(var s=0,c,f=t.length,u=i.length;s<u;++s)(c=t[s])?(c.__data__=i[s],n[s]=c):r[s]=new vo(e,i[s]);for(;s<f;++s)(c=t[s])&&(a[s]=c)}function YA(e,t,r,n,a,i,s){var c,f,u=new Map,o=t.length,l=i.length,h=new Array(o),d;for(c=0;c<o;++c)(f=t[c])&&(h[c]=d=s.call(f,f.__data__,c,t)+"",u.has(d)?a[c]=f:u.set(d,f));for(c=0;c<l;++c)d=s.call(e,i[c],c,i)+"",(f=u.get(d))?(n[c]=f,f.__data__=i[c],u.delete(d)):r[c]=new vo(e,i[c]);for(c=0;c<o;++c)(f=t[c])&&u.get(h[c])===f&&(a[c]=f)}function JA(e){return e.__data__}function QA(e,t){if(!arguments.length)return Array.from(this,JA);var r=t?YA:XA,n=this._parents,a=this._groups;typeof e!="function"&&(e=KA(e));for(var i=a.length,s=new Array(i),c=new Array(i),f=new Array(i),u=0;u<i;++u){var o=n[u],l=a[u],h=l.length,d=ZA(e.call(o,o&&o.__data__,u,n)),p=d.length,m=c[u]=new Array(p),x=s[u]=new Array(p),v=f[u]=new Array(h);r(o,l,m,x,v,d,t);for(var y=0,g=0,_,w;y<p;++y)if(_=m[y]){for(y>=g&&(g=y+1);!(w=x[g])&&++g<p;);_._next=w||null}}return s=new wr(s,n),s._enter=c,s._exit=f,s}function ZA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function jA(){return new wr(this._exit||this._groups.map(Ep),this._parents)}function e3(e,t,r){var n=this.enter(),a=this,i=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),r==null?i.remove():r(i),n&&a?n.merge(a).order():a}function t3(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,a=r.length,i=n.length,s=Math.min(a,i),c=new Array(a),f=0;f<s;++f)for(var u=r[f],o=n[f],l=u.length,h=c[f]=new Array(l),d,p=0;p<l;++p)(d=u[p]||o[p])&&(h[p]=d);for(;f<a;++f)c[f]=r[f];return new wr(c,this._parents)}function r3(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],a=n.length-1,i=n[a],s;--a>=0;)(s=n[a])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function n3(e){e||(e=a3);function t(l,h){return l&&h?e(l.__data__,h.__data__):!l-!h}for(var r=this._groups,n=r.length,a=new Array(n),i=0;i<n;++i){for(var s=r[i],c=s.length,f=a[i]=new Array(c),u,o=0;o<c;++o)(u=s[o])&&(f[o]=u);f.sort(t)}return new wr(a,this._parents).order()}function a3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function i3(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function s3(){return Array.from(this)}function o3(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],a=0,i=n.length;a<i;++a){var s=n[a];if(s)return s}return null}function c3(){let e=0;for(const t of this)++e;return e}function u3(){return!this.node()}function f3(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var a=t[r],i=0,s=a.length,c;i<s;++i)(c=a[i])&&e.call(c,c.__data__,i,a);return this}function l3(e){return function(){this.removeAttribute(e)}}function h3(e){return function(){this.removeAttributeNS(e.space,e.local)}}function d3(e,t){return function(){this.setAttribute(e,t)}}function p3(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function m3(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function x3(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function g3(e,t){var r=go(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?h3:l3:typeof t=="function"?r.local?x3:m3:r.local?p3:d3)(r,t))}function kp(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function v3(e){return function(){this.style.removeProperty(e)}}function _3(e,t,r){return function(){this.style.setProperty(e,t,r)}}function y3(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function w3(e,t,r){return arguments.length>1?this.each((t==null?v3:typeof t=="function"?y3:_3)(e,t,r??"")):$a(this.node(),e)}function $a(e,t){return e.style.getPropertyValue(t)||kp(e).getComputedStyle(e,null).getPropertyValue(t)}function E3(e){return function(){delete this[e]}}function k3(e,t){return function(){this[e]=t}}function T3(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function A3(e,t){return arguments.length>1?this.each((t==null?E3:typeof t=="function"?T3:k3)(e,t)):this.node()[e]}function Tp(e){return e.trim().split(/^|\s+/)}function ju(e){return e.classList||new Ap(e)}function Ap(e){this._node=e,this._names=Tp(e.getAttribute("class")||"")}Ap.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Cp(e,t){for(var r=ju(e),n=-1,a=t.length;++n<a;)r.add(t[n])}function bp(e,t){for(var r=ju(e),n=-1,a=t.length;++n<a;)r.remove(t[n])}function C3(e){return function(){Cp(this,e)}}function b3(e){return function(){bp(this,e)}}function S3(e,t){return function(){(t.apply(this,arguments)?Cp:bp)(this,e)}}function F3(e,t){var r=Tp(e+"");if(arguments.length<2){for(var n=ju(this.node()),a=-1,i=r.length;++a<i;)if(!n.contains(r[a]))return!1;return!0}return this.each((typeof t=="function"?S3:t?C3:b3)(r,t))}function I3(){this.textContent=""}function O3(e){return function(){this.textContent=e}}function R3(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function N3(e){return arguments.length?this.each(e==null?I3:(typeof e=="function"?R3:O3)(e)):this.node().textContent}function D3(){this.innerHTML=""}function P3(e){return function(){this.innerHTML=e}}function L3(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function B3(e){return arguments.length?this.each(e==null?D3:(typeof e=="function"?L3:P3)(e)):this.node().innerHTML}function M3(){this.nextSibling&&this.parentNode.appendChild(this)}function U3(){return this.each(M3)}function V3(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $3(){return this.each(V3)}function H3(e){var t=typeof e=="function"?e:vp(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function W3(){return null}function z3(e,t){var r=typeof e=="function"?e:vp(e),n=t==null?W3:typeof t=="function"?t:Zu(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function G3(){var e=this.parentNode;e&&e.removeChild(this)}function q3(){return this.each(G3)}function K3(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function X3(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Y3(e){return this.select(e?X3:K3)}function J3(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Q3(e){return function(t){e.call(this,t,this.__data__)}}function Z3(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function j3(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,a=t.length,i;r<a;++r)i=t[r],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++n]=i;++n?t.length=n:delete this.__on}}}function eC(e,t,r){return function(){var n=this.__on,a,i=Q3(t);if(n){for(var s=0,c=n.length;s<c;++s)if((a=n[s]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=r),a.value=t;return}}this.addEventListener(e.type,i,r),a={type:e.type,name:e.name,value:t,listener:i,options:r},n?n.push(a):this.__on=[a]}}function tC(e,t,r){var n=Z3(e+""),a,i=n.length,s;if(arguments.length<2){var c=this.node().__on;if(c){for(var f=0,u=c.length,o;f<u;++f)for(a=0,o=c[f];a<i;++a)if((s=n[a]).type===o.type&&s.name===o.name)return o.value}return}for(c=t?eC:j3,a=0;a<i;++a)this.each(c(n[a],t,r));return this}function Sp(e,t,r){var n=kp(e),a=n.CustomEvent;typeof a=="function"?a=new a(t,r):(a=n.document.createEvent("Event"),r?(a.initEvent(t,r.bubbles,r.cancelable),a.detail=r.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function rC(e,t){return function(){return Sp(this,e,t)}}function nC(e,t){return function(){return Sp(this,e,t.apply(this,arguments))}}function aC(e,t){return this.each((typeof t=="function"?nC:rC)(e,t))}function*iC(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],a=0,i=n.length,s;a<i;++a)(s=n[a])&&(yield s)}var sC=[null];function wr(e,t){this._groups=e,this._parents=t}function Fi(){return new wr([[document.documentElement]],sC)}function oC(){return this}wr.prototype=Fi.prototype={constructor:wr,select:RA,selectAll:LA,selectChild:VA,selectChildren:zA,filter:GA,data:QA,enter:qA,exit:jA,join:e3,merge:t3,selection:oC,order:r3,sort:n3,call:i3,nodes:s3,node:o3,size:c3,empty:u3,each:f3,attr:g3,style:w3,property:A3,classed:F3,text:N3,html:B3,raise:U3,lower:$3,append:H3,insert:z3,remove:q3,clone:Y3,datum:J3,on:tC,dispatch:aC,[Symbol.iterator]:iC};function e0(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Fp(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Ii(){}var Oi=.7,_o=1/Oi,Ha="\\s*([+-]?\\d+)\\s*",Ri="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Mr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cC=/^#([0-9a-f]{3,8})$/,uC=new RegExp(`^rgb\\(${Ha},${Ha},${Ha}\\)$`),fC=new RegExp(`^rgb\\(${Mr},${Mr},${Mr}\\)$`),lC=new RegExp(`^rgba\\(${Ha},${Ha},${Ha},${Ri}\\)$`),hC=new RegExp(`^rgba\\(${Mr},${Mr},${Mr},${Ri}\\)$`),dC=new RegExp(`^hsl\\(${Ri},${Mr},${Mr}\\)$`),pC=new RegExp(`^hsla\\(${Ri},${Mr},${Mr},${Ri}\\)$`),Ip={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};e0(Ii,Ni,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Op,formatHex:Op,formatHex8:mC,formatHsl:xC,formatRgb:Rp,toString:Rp});function Op(){return this.rgb().formatHex()}function mC(){return this.rgb().formatHex8()}function xC(){return Bp(this).formatHsl()}function Rp(){return this.rgb().formatRgb()}function Ni(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=cC.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Np(t):r===3?new $t(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?yo(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?yo(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=uC.exec(e))?new $t(t[1],t[2],t[3],1):(t=fC.exec(e))?new $t(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=lC.exec(e))?yo(t[1],t[2],t[3],t[4]):(t=hC.exec(e))?yo(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=dC.exec(e))?Lp(t[1],t[2]/100,t[3]/100,1):(t=pC.exec(e))?Lp(t[1],t[2]/100,t[3]/100,t[4]):Ip.hasOwnProperty(e)?Np(Ip[e]):e==="transparent"?new $t(NaN,NaN,NaN,0):null}function Np(e){return new $t(e>>16&255,e>>8&255,e&255,1)}function yo(e,t,r,n){return n<=0&&(e=t=r=NaN),new $t(e,t,r,n)}function gC(e){return e instanceof Ii||(e=Ni(e)),e?(e=e.rgb(),new $t(e.r,e.g,e.b,e.opacity)):new $t}function t0(e,t,r,n){return arguments.length===1?gC(e):new $t(e,t,r,n??1)}function $t(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}e0($t,t0,Fp(Ii,{brighter(e){return e=e==null?_o:Math.pow(_o,e),new $t(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Oi:Math.pow(Oi,e),new $t(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new $t(Yn(this.r),Yn(this.g),Yn(this.b),wo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Dp,formatHex:Dp,formatHex8:vC,formatRgb:Pp,toString:Pp}));function Dp(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}`}function vC(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}${Jn((isNaN(this.opacity)?1:this.opacity)*255)}`}function Pp(){const e=wo(this.opacity);return`${e===1?"rgb(":"rgba("}${Yn(this.r)}, ${Yn(this.g)}, ${Yn(this.b)}${e===1?")":`, ${e})`}`}function wo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Yn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Jn(e){return e=Yn(e),(e<16?"0":"")+e.toString(16)}function Lp(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Er(e,t,r,n)}function Bp(e){if(e instanceof Er)return new Er(e.h,e.s,e.l,e.opacity);if(e instanceof Ii||(e=Ni(e)),!e)return new Er;if(e instanceof Er)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,c=i-a,f=(i+a)/2;return c?(t===i?s=(r-n)/c+(r<n)*6:r===i?s=(n-t)/c+2:s=(t-r)/c+4,c/=f<.5?i+a:2-i-a,s*=60):c=f>0&&f<1?0:s,new Er(s,c,f,e.opacity)}function _C(e,t,r,n){return arguments.length===1?Bp(e):new Er(e,t,r,n??1)}function Er(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}e0(Er,_C,Fp(Ii,{brighter(e){return e=e==null?_o:Math.pow(_o,e),new Er(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Oi:Math.pow(Oi,e),new Er(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new $t(r0(e>=240?e-240:e+120,a,n),r0(e,a,n),r0(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Er(Mp(this.h),Eo(this.s),Eo(this.l),wo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=wo(this.opacity);return`${e===1?"hsl(":"hsla("}${Mp(this.h)}, ${Eo(this.s)*100}%, ${Eo(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Mp(e){return e=(e||0)%360,e<0?e+360:e}function Eo(e){return Math.max(0,Math.min(1,e||0))}function r0(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var Up=e=>()=>e;function yC(e,t){return function(r){return e+r*t}}function wC(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function EC(e){return(e=+e)==1?Vp:function(t,r){return r-t?wC(t,r,e):Up(isNaN(t)?r:t)}}function Vp(e,t){var r=t-e;return r?yC(e,r):Up(isNaN(e)?t:e)}var $p=function e(t){var r=EC(t);function n(a,i){var s=r((a=t0(a)).r,(i=t0(i)).r),c=r(a.g,i.g),f=r(a.b,i.b),u=Vp(a.opacity,i.opacity);return function(o){return a.r=s(o),a.g=c(o),a.b=f(o),a.opacity=u(o),a+""}}return n.gamma=e,n}(1);function In(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var n0=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,a0=new RegExp(n0.source,"g");function kC(e){return function(){return e}}function TC(e){return function(t){return e(t)+""}}function AC(e,t){var r=n0.lastIndex=a0.lastIndex=0,n,a,i,s=-1,c=[],f=[];for(e=e+"",t=t+"";(n=n0.exec(e))&&(a=a0.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),c[s]?c[s]+=i:c[++s]=i),(n=n[0])===(a=a[0])?c[s]?c[s]+=a:c[++s]=a:(c[++s]=null,f.push({i:s,x:In(n,a)})),r=a0.lastIndex;return r<t.length&&(i=t.slice(r),c[s]?c[s]+=i:c[++s]=i),c.length<2?f[0]?TC(f[0].x):kC(t):(t=f.length,function(u){for(var o=0,l;o<t;++o)c[(l=f[o]).i]=l.x(u);return c.join("")})}var Hp=180/Math.PI,i0={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Wp(e,t,r,n,a,i){var s,c,f;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(f=e*r+t*n)&&(r-=e*f,n-=t*f),(c=Math.sqrt(r*r+n*n))&&(r/=c,n/=c,f/=c),e*n<t*r&&(e=-e,t=-t,f=-f,s=-s),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*Hp,skewX:Math.atan(f)*Hp,scaleX:s,scaleY:c}}var ko;function CC(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?i0:Wp(t.a,t.b,t.c,t.d,t.e,t.f)}function bC(e){return e==null||(ko||(ko=document.createElementNS("http://www.w3.org/2000/svg","g")),ko.setAttribute("transform",e),!(e=ko.transform.baseVal.consolidate()))?i0:(e=e.matrix,Wp(e.a,e.b,e.c,e.d,e.e,e.f))}function zp(e,t,r,n){function a(u){return u.length?u.pop()+" ":""}function i(u,o,l,h,d,p){if(u!==l||o!==h){var m=d.push("translate(",null,t,null,r);p.push({i:m-4,x:In(u,l)},{i:m-2,x:In(o,h)})}else(l||h)&&d.push("translate("+l+t+h+r)}function s(u,o,l,h){u!==o?(u-o>180?o+=360:o-u>180&&(u+=360),h.push({i:l.push(a(l)+"rotate(",null,n)-2,x:In(u,o)})):o&&l.push(a(l)+"rotate("+o+n)}function c(u,o,l,h){u!==o?h.push({i:l.push(a(l)+"skewX(",null,n)-2,x:In(u,o)}):o&&l.push(a(l)+"skewX("+o+n)}function f(u,o,l,h,d,p){if(u!==l||o!==h){var m=d.push(a(d)+"scale(",null,",",null,")");p.push({i:m-4,x:In(u,l)},{i:m-2,x:In(o,h)})}else(l!==1||h!==1)&&d.push(a(d)+"scale("+l+","+h+")")}return function(u,o){var l=[],h=[];return u=e(u),o=e(o),i(u.translateX,u.translateY,o.translateX,o.translateY,l,h),s(u.rotate,o.rotate,l,h),c(u.skewX,o.skewX,l,h),f(u.scaleX,u.scaleY,o.scaleX,o.scaleY,l,h),u=o=null,function(d){for(var p=-1,m=h.length,x;++p<m;)l[(x=h[p]).i]=x.x(d);return l.join("")}}}var SC=zp(CC,"px, ","px)","deg)"),FC=zp(bC,", ",")",")"),Wa=0,Di=0,Pi=0,Gp=1e3,To,Li,Ao=0,Qn=0,Co=0,Bi=typeof performance=="object"&&performance.now?performance:Date,qp=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function s0(){return Qn||(qp(IC),Qn=Bi.now()+Co)}function IC(){Qn=0}function bo(){this._call=this._time=this._next=null}bo.prototype=Kp.prototype={constructor:bo,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?s0():+r)+(t==null?0:+t),!this._next&&Li!==this&&(Li?Li._next=this:To=this,Li=this),this._call=e,this._time=r,o0()},stop:function(){this._call&&(this._call=null,this._time=1/0,o0())}};function Kp(e,t,r){var n=new bo;return n.restart(e,t,r),n}function OC(){s0(),++Wa;for(var e=To,t;e;)(t=Qn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Wa}function Xp(){Qn=(Ao=Bi.now())+Co,Wa=Di=0;try{OC()}finally{Wa=0,NC(),Qn=0}}function RC(){var e=Bi.now(),t=e-Ao;t>Gp&&(Co-=t,Ao=e)}function NC(){for(var e,t=To,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:To=r);Li=e,o0(n)}function o0(e){if(!Wa){Di&&(Di=clearTimeout(Di));var t=e-Qn;t>24?(e<1/0&&(Di=setTimeout(Xp,e-Bi.now()-Co)),Pi&&(Pi=clearInterval(Pi))):(Pi||(Ao=Bi.now(),Pi=setInterval(RC,Gp)),Wa=1,qp(Xp))}}function Yp(e,t,r){var n=new bo;return t=t==null?0:+t,n.restart(a=>{n.stop(),e(a+t)},t,r),n}var DC=mp("start","end","cancel","interrupt"),PC=[],Jp=0,Qp=1,c0=2,So=3,Zp=4,u0=5,Fo=6;function Io(e,t,r,n,a,i){var s=e.__transition;if(!s)e.__transition={};else if(r in s)return;LC(e,r,{name:t,index:n,group:a,on:DC,tween:PC,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Jp})}function f0(e,t){var r=kr(e,t);if(r.state>Jp)throw new Error("too late; already scheduled");return r}function Ur(e,t){var r=kr(e,t);if(r.state>So)throw new Error("too late; already running");return r}function kr(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function LC(e,t,r){var n=e.__transition,a;n[t]=r,r.timer=Kp(i,0,r.time);function i(u){r.state=Qp,r.timer.restart(s,r.delay,r.time),r.delay<=u&&s(u-r.delay)}function s(u){var o,l,h,d;if(r.state!==Qp)return f();for(o in n)if(d=n[o],d.name===r.name){if(d.state===So)return Yp(s);d.state===Zp?(d.state=Fo,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete n[o]):+o<t&&(d.state=Fo,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete n[o])}if(Yp(function(){r.state===So&&(r.state=Zp,r.timer.restart(c,r.delay,r.time),c(u))}),r.state=c0,r.on.call("start",e,e.__data__,r.index,r.group),r.state===c0){for(r.state=So,a=new Array(h=r.tween.length),o=0,l=-1;o<h;++o)(d=r.tween[o].value.call(e,e.__data__,r.index,r.group))&&(a[++l]=d);a.length=l+1}}function c(u){for(var o=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(f),r.state=u0,1),l=-1,h=a.length;++l<h;)a[l].call(e,o);r.state===u0&&(r.on.call("end",e,e.__data__,r.index,r.group),f())}function f(){r.state=Fo,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function BC(e,t){var r=e.__transition,n,a,i=!0,s;if(r){t=t==null?null:t+"";for(s in r){if((n=r[s]).name!==t){i=!1;continue}a=n.state>c0&&n.state<u0,n.state=Fo,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[s]}i&&delete e.__transition}}function MC(e){return this.each(function(){BC(this,e)})}function UC(e,t){var r,n;return function(){var a=Ur(this,e),i=a.tween;if(i!==r){n=r=i;for(var s=0,c=n.length;s<c;++s)if(n[s].name===t){n=n.slice(),n.splice(s,1);break}}a.tween=n}}function VC(e,t,r){var n,a;if(typeof r!="function")throw new Error;return function(){var i=Ur(this,e),s=i.tween;if(s!==n){a=(n=s).slice();for(var c={name:t,value:r},f=0,u=a.length;f<u;++f)if(a[f].name===t){a[f]=c;break}f===u&&a.push(c)}i.tween=a}}function $C(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=kr(this.node(),r).tween,a=0,i=n.length,s;a<i;++a)if((s=n[a]).name===e)return s.value;return null}return this.each((t==null?UC:VC)(r,e,t))}function l0(e,t,r){var n=e._id;return e.each(function(){var a=Ur(this,n);(a.value||(a.value={}))[t]=r.apply(this,arguments)}),function(a){return kr(a,n).value[t]}}function jp(e,t){var r;return(typeof t=="number"?In:t instanceof Ni?$p:(r=Ni(t))?(t=r,$p):AC)(e,t)}function HC(e){return function(){this.removeAttribute(e)}}function WC(e){return function(){this.removeAttributeNS(e.space,e.local)}}function zC(e,t,r){var n,a=r+"",i;return function(){var s=this.getAttribute(e);return s===a?null:s===n?i:i=t(n=s,r)}}function GC(e,t,r){var n,a=r+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===a?null:s===n?i:i=t(n=s,r)}}function qC(e,t,r){var n,a,i;return function(){var s,c=r(this),f;return c==null?void this.removeAttribute(e):(s=this.getAttribute(e),f=c+"",s===f?null:s===n&&f===a?i:(a=f,i=t(n=s,c)))}}function KC(e,t,r){var n,a,i;return function(){var s,c=r(this),f;return c==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),f=c+"",s===f?null:s===n&&f===a?i:(a=f,i=t(n=s,c)))}}function XC(e,t){var r=go(e),n=r==="transform"?FC:jp;return this.attrTween(e,typeof t=="function"?(r.local?KC:qC)(r,n,l0(this,"attr."+e,t)):t==null?(r.local?WC:HC)(r):(r.local?GC:zC)(r,n,t))}function YC(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function JC(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function QC(e,t){var r,n;function a(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&JC(e,i)),r}return a._value=t,a}function ZC(e,t){var r,n;function a(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&YC(e,i)),r}return a._value=t,a}function jC(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=go(e);return this.tween(r,(n.local?QC:ZC)(n,t))}function eb(e,t){return function(){f0(this,e).delay=+t.apply(this,arguments)}}function tb(e,t){return t=+t,function(){f0(this,e).delay=t}}function rb(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?eb:tb)(t,e)):kr(this.node(),t).delay}function nb(e,t){return function(){Ur(this,e).duration=+t.apply(this,arguments)}}function ab(e,t){return t=+t,function(){Ur(this,e).duration=t}}function ib(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?nb:ab)(t,e)):kr(this.node(),t).duration}function sb(e,t){if(typeof t!="function")throw new Error;return function(){Ur(this,e).ease=t}}function ob(e){var t=this._id;return arguments.length?this.each(sb(t,e)):kr(this.node(),t).ease}function cb(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Ur(this,e).ease=r}}function ub(e){if(typeof e!="function")throw new Error;return this.each(cb(this._id,e))}function fb(e){typeof e!="function"&&(e=yp(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,c=n[a]=[],f,u=0;u<s;++u)(f=i[u])&&e.call(f,f.__data__,u,i)&&c.push(f);return new nn(n,this._parents,this._name,this._id)}function lb(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,a=r.length,i=Math.min(n,a),s=new Array(n),c=0;c<i;++c)for(var f=t[c],u=r[c],o=f.length,l=s[c]=new Array(o),h,d=0;d<o;++d)(h=f[d]||u[d])&&(l[d]=h);for(;c<n;++c)s[c]=t[c];return new nn(s,this._parents,this._name,this._id)}function hb(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function db(e,t,r){var n,a,i=hb(t)?f0:Ur;return function(){var s=i(this,e),c=s.on;c!==n&&(a=(n=c).copy()).on(t,r),s.on=a}}function pb(e,t){var r=this._id;return arguments.length<2?kr(this.node(),r).on.on(e):this.each(db(r,e,t))}function mb(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function xb(){return this.on("end.remove",mb(this._id))}function gb(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Zu(e));for(var n=this._groups,a=n.length,i=new Array(a),s=0;s<a;++s)for(var c=n[s],f=c.length,u=i[s]=new Array(f),o,l,h=0;h<f;++h)(o=c[h])&&(l=e.call(o,o.__data__,h,c))&&("__data__"in o&&(l.__data__=o.__data__),u[h]=l,Io(u[h],t,r,h,u,kr(o,r)));return new nn(i,this._parents,t,r)}function vb(e){var t=this._name,r=this._id;typeof e!="function"&&(e=_p(e));for(var n=this._groups,a=n.length,i=[],s=[],c=0;c<a;++c)for(var f=n[c],u=f.length,o,l=0;l<u;++l)if(o=f[l]){for(var h=e.call(o,o.__data__,l,f),d,p=kr(o,r),m=0,x=h.length;m<x;++m)(d=h[m])&&Io(d,t,r,m,h,p);i.push(h),s.push(o)}return new nn(i,s,t,r)}var _b=Fi.prototype.constructor;function yb(){return new _b(this._groups,this._parents)}function wb(e,t){var r,n,a;return function(){var i=$a(this,e),s=(this.style.removeProperty(e),$a(this,e));return i===s?null:i===r&&s===n?a:a=t(r=i,n=s)}}function e1(e){return function(){this.style.removeProperty(e)}}function Eb(e,t,r){var n,a=r+"",i;return function(){var s=$a(this,e);return s===a?null:s===n?i:i=t(n=s,r)}}function kb(e,t,r){var n,a,i;return function(){var s=$a(this,e),c=r(this),f=c+"";return c==null&&(f=c=(this.style.removeProperty(e),$a(this,e))),s===f?null:s===n&&f===a?i:(a=f,i=t(n=s,c))}}function Tb(e,t){var r,n,a,i="style."+t,s="end."+i,c;return function(){var f=Ur(this,e),u=f.on,o=f.value[i]==null?c||(c=e1(t)):void 0;(u!==r||a!==o)&&(n=(r=u).copy()).on(s,a=o),f.on=n}}function Ab(e,t,r){var n=(e+="")=="transform"?SC:jp;return t==null?this.styleTween(e,wb(e,n)).on("end.style."+e,e1(e)):typeof t=="function"?this.styleTween(e,kb(e,n,l0(this,"style."+e,t))).each(Tb(this._id,e)):this.styleTween(e,Eb(e,n,t),r).on("end.style."+e,null)}function Cb(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function bb(e,t,r){var n,a;function i(){var s=t.apply(this,arguments);return s!==a&&(n=(a=s)&&Cb(e,s,r)),n}return i._value=t,i}function Sb(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,bb(e,t,r??""))}function Fb(e){return function(){this.textContent=e}}function Ib(e){return function(){var t=e(this);this.textContent=t??""}}function Ob(e){return this.tween("text",typeof e=="function"?Ib(l0(this,"text",e)):Fb(e==null?"":e+""))}function Rb(e){return function(t){this.textContent=e.call(this,t)}}function Nb(e){var t,r;function n(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&Rb(a)),t}return n._value=e,n}function Db(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Nb(e))}function Pb(){for(var e=this._name,t=this._id,r=t1(),n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],c=s.length,f,u=0;u<c;++u)if(f=s[u]){var o=kr(f,t);Io(f,e,r,u,s,{time:o.time+o.delay+o.duration,delay:0,duration:o.duration,ease:o.ease})}return new nn(n,this._parents,e,r)}function Lb(){var e,t,r=this,n=r._id,a=r.size();return new Promise(function(i,s){var c={value:s},f={value:function(){--a===0&&i()}};r.each(function(){var u=Ur(this,n),o=u.on;o!==e&&(t=(e=o).copy(),t._.cancel.push(c),t._.interrupt.push(c),t._.end.push(f)),u.on=t}),a===0&&i()})}var Bb=0;function nn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function t1(){return++Bb}var an=Fi.prototype;nn.prototype={constructor:nn,select:gb,selectAll:vb,selectChild:an.selectChild,selectChildren:an.selectChildren,filter:fb,merge:lb,selection:yb,transition:Pb,call:an.call,nodes:an.nodes,node:an.node,size:an.size,empty:an.empty,each:an.each,on:pb,attr:XC,attrTween:jC,style:Ab,styleTween:Sb,text:Ob,textTween:Db,remove:xb,tween:$C,delay:rb,duration:ib,ease:ob,easeVarying:ub,end:Lb,[Symbol.iterator]:an[Symbol.iterator]};function Mb(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ub={time:null,delay:0,duration:250,ease:Mb};function Vb(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function $b(e){var t,r;e instanceof nn?(t=e._id,e=e._name):(t=t1(),(r=Ub).time=s0(),e=e==null?null:e+"");for(var n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],c=s.length,f,u=0;u<c;++u)(f=s[u])&&Io(f,e,t,u,s,r||Vb(f,t));return new nn(n,this._parents,e,t)}Fi.prototype.interrupt=MC,Fi.prototype.transition=$b;function Mi(e,t,r){this.k=e,this.x=t,this.y=r}Mi.prototype={constructor:Mi,scale:function(e){return e===1?this:new Mi(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Mi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Mi.prototype;function Hb(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Oo={exports:{}},Wb=Oo.exports,r1;function zb(){return r1||(r1=1,function(e,t){(function(r,n){e.exports=n()})(Wb,function(){var r=function(n,a){var i=Array.prototype.concat,s=Array.prototype.slice,c=Object.prototype.toString;function f(y,g){var _=y>g?y:g;return n.pow(10,17-~~(n.log(_>0?_:-_)*n.LOG10E))}var u=Array.isArray||function(g){return c.call(g)==="[object Array]"};function o(y){return c.call(y)==="[object Function]"}function l(y){return typeof y=="number"?y-y===0:!1}function h(y){return i.apply([],y)}function d(){return new d._init(arguments)}d.fn=d.prototype,d._init=function(g){if(u(g[0]))if(u(g[0][0])){o(g[1])&&(g[0]=d.map(g[0],g[1]));for(var _=0;_<g[0].length;_++)this[_]=g[0][_];this.length=g[0].length}else this[0]=o(g[1])?d.map(g[0],g[1]):g[0],this.length=1;else if(l(g[0]))this[0]=d.seq.apply(null,g),this.length=1;else{if(g[0]instanceof d)return d(g[0].toArray());this[0]=[],this.length=1}return this},d._init.prototype=d.prototype,d._init.constructor=d,d.utils={calcRdx:f,isArray:u,isFunction:o,isNumber:l,toVector:h},d._random_fn=n.random,d.setRandom=function(g){if(typeof g!="function")throw new TypeError("fn is not a function");d._random_fn=g},d.extend=function(g){var _,w;if(arguments.length===1){for(w in g)d[w]=g[w];return this}for(_=1;_<arguments.length;_++)for(w in arguments[_])g[w]=arguments[_][w];return g},d.rows=function(g){return g.length||1},d.cols=function(g){return g[0].length||1},d.dimensions=function(g){return{rows:d.rows(g),cols:d.cols(g)}},d.row=function(g,_){return u(_)?_.map(function(w){return d.row(g,w)}):g[_]},d.rowa=function(g,_){return d.row(g,_)},d.col=function(g,_){if(u(_)){var w=d.arange(g.length).map(function(){return new Array(_.length)});return _.forEach(function(F,b){d.arange(g.length).forEach(function(L){w[L][b]=g[L][F]})}),w}for(var E=new Array(g.length),k=0;k<g.length;k++)E[k]=[g[k][_]];return E},d.cola=function(g,_){return d.col(g,_).map(function(w){return w[0]})},d.diag=function(g){for(var _=d.rows(g),w=new Array(_),E=0;E<_;E++)w[E]=[g[E][E]];return w},d.antidiag=function(g){for(var _=d.rows(g)-1,w=new Array(_),E=0;_>=0;_--,E++)w[E]=[g[E][_]];return w},d.transpose=function(g){var _=[],w,E,k,F,b;for(u(g[0])||(g=[g]),E=g.length,k=g[0].length,b=0;b<k;b++){for(w=new Array(E),F=0;F<E;F++)w[F]=g[F][b];_.push(w)}return _.length===1?_[0]:_},d.map=function(g,_,w){var E,k,F,b,L;for(u(g[0])||(g=[g]),k=g.length,F=g[0].length,b=w?g:new Array(k),E=0;E<k;E++)for(b[E]||(b[E]=new Array(F)),L=0;L<F;L++)b[E][L]=_(g[E][L],E,L);return b.length===1?b[0]:b},d.cumreduce=function(g,_,w){var E,k,F,b,L;for(u(g[0])||(g=[g]),k=g.length,F=g[0].length,b=w?g:new Array(k),E=0;E<k;E++)for(b[E]||(b[E]=new Array(F)),F>0&&(b[E][0]=g[E][0]),L=1;L<F;L++)b[E][L]=_(b[E][L-1],g[E][L]);return b.length===1?b[0]:b},d.alter=function(g,_){return d.map(g,_,!0)},d.create=function(g,_,w){var E=new Array(g),k,F;for(o(_)&&(w=_,_=g),k=0;k<g;k++)for(E[k]=new Array(_),F=0;F<_;F++)E[k][F]=w(k,F);return E};function p(){return 0}d.zeros=function(g,_){return l(_)||(_=g),d.create(g,_,p)};function m(){return 1}d.ones=function(g,_){return l(_)||(_=g),d.create(g,_,m)},d.rand=function(g,_){return l(_)||(_=g),d.create(g,_,d._random_fn)};function x(y,g){return y===g?1:0}d.identity=function(g,_){return l(_)||(_=g),d.create(g,_,x)},d.symmetric=function(g){var _=g.length,w,E;if(g.length!==g[0].length)return!1;for(w=0;w<_;w++)for(E=0;E<_;E++)if(g[E][w]!==g[w][E])return!1;return!0},d.clear=function(g){return d.alter(g,p)},d.seq=function(g,_,w,E){o(E)||(E=!1);var k=[],F=f(g,_),b=(_*F-g*F)/((w-1)*F),L=g,U;for(U=0;L<=_&&U<w;U++,L=(g*F+b*F*U)/F)k.push(E?E(L,U):L);return k},d.arange=function(g,_,w){var E=[],k;if(w=w||1,_===a&&(_=g,g=0),g===_||w===0)return[];if(g<_&&w<0)return[];if(g>_&&w>0)return[];if(w>0)for(k=g;k<_;k+=w)E.push(k);else for(k=g;k>_;k+=w)E.push(k);return E},d.slice=function(){function y(_,w,E,k){var F,b=[],L=_.length;if(w===a&&E===a&&k===a)return d.copy(_);if(w=w||0,E=E||_.length,w=w>=0?w:L+w,E=E>=0?E:L+E,k=k||1,w===E||k===0)return[];if(w<E&&k<0)return[];if(w>E&&k>0)return[];if(k>0)for(F=w;F<E;F+=k)b.push(_[F]);else for(F=w;F>E;F+=k)b.push(_[F]);return b}function g(_,w){var E,k;if(w=w||{},l(w.row)){if(l(w.col))return _[w.row][w.col];var F=d.rowa(_,w.row);return E=w.col||{},y(F,E.start,E.end,E.step)}if(l(w.col)){var b=d.cola(_,w.col);return k=w.row||{},y(b,k.start,k.end,k.step)}k=w.row||{},E=w.col||{};var L=y(_,k.start,k.end,k.step);return L.map(function(U){return y(U,E.start,E.end,E.step)})}return g}(),d.sliceAssign=function(g,_,w){var E,k;if(l(_.row)){if(l(_.col))return g[_.row][_.col]=w;_.col=_.col||{},_.col.start=_.col.start||0,_.col.end=_.col.end||g[0].length,_.col.step=_.col.step||1,E=d.arange(_.col.start,n.min(g.length,_.col.end),_.col.step);var F=_.row;return E.forEach(function(L,U){g[F][L]=w[U]}),g}if(l(_.col)){_.row=_.row||{},_.row.start=_.row.start||0,_.row.end=_.row.end||g.length,_.row.step=_.row.step||1,k=d.arange(_.row.start,n.min(g[0].length,_.row.end),_.row.step);var b=_.col;return k.forEach(function(L,U){g[L][b]=w[U]}),g}return w[0].length===a&&(w=[w]),_.row.start=_.row.start||0,_.row.end=_.row.end||g.length,_.row.step=_.row.step||1,_.col.start=_.col.start||0,_.col.end=_.col.end||g[0].length,_.col.step=_.col.step||1,k=d.arange(_.row.start,n.min(g.length,_.row.end),_.row.step),E=d.arange(_.col.start,n.min(g[0].length,_.col.end),_.col.step),k.forEach(function(L,U){E.forEach(function(B,Y){g[L][B]=w[U][Y]})}),g},d.diagonal=function(g){var _=d.zeros(g.length,g.length);return g.forEach(function(w,E){_[E][E]=w}),_},d.copy=function(g){return g.map(function(_){return l(_)?_:_.map(function(w){return w})})};var v=d.prototype;return v.length=0,v.push=Array.prototype.push,v.sort=Array.prototype.sort,v.splice=Array.prototype.splice,v.slice=Array.prototype.slice,v.toArray=function(){return this.length>1?s.call(this):s.call(this)[0]},v.map=function(g,_){return d(d.map(this,g,_))},v.cumreduce=function(g,_){return d(d.cumreduce(this,g,_))},v.alter=function(g){return d.alter(this,g),this},function(y){for(var g=0;g<y.length;g++)(function(_){v[_]=function(w){var E=this,k;return w?(setTimeout(function(){w.call(E,v[_].call(E))}),this):(k=d[_](this),u(k)?d(k):k)}})(y[g])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(y){for(var g=0;g<y.length;g++)(function(_){v[_]=function(w,E){var k=this;return E?(setTimeout(function(){E.call(k,v[_].call(k,w))}),this):d(d[_](this,w))}})(y[g])}("row col".split(" ")),function(y){for(var g=0;g<y.length;g++)(function(_){v[_]=function(){return d(d[_].apply(null,arguments))}})(y[g])}("create zeros ones rand identity".split(" ")),d}(Math);return function(n,a){var i=n.utils.isFunction;function s(u,o){return u-o}function c(u,o,l){return a.max(o,a.min(u,l))}n.sum=function(o){for(var l=0,h=o.length;--h>=0;)l+=o[h];return l},n.sumsqrd=function(o){for(var l=0,h=o.length;--h>=0;)l+=o[h]*o[h];return l},n.sumsqerr=function(o){for(var l=n.mean(o),h=0,d=o.length,p;--d>=0;)p=o[d]-l,h+=p*p;return h},n.sumrow=function(o){for(var l=0,h=o.length;--h>=0;)l+=o[h];return l},n.product=function(o){for(var l=1,h=o.length;--h>=0;)l*=o[h];return l},n.min=function(o){for(var l=o[0],h=0;++h<o.length;)o[h]<l&&(l=o[h]);return l},n.max=function(o){for(var l=o[0],h=0;++h<o.length;)o[h]>l&&(l=o[h]);return l},n.unique=function(o){for(var l={},h=[],d=0;d<o.length;d++)l[o[d]]||(l[o[d]]=!0,h.push(o[d]));return h},n.mean=function(o){return n.sum(o)/o.length},n.meansqerr=function(o){return n.sumsqerr(o)/o.length},n.geomean=function(o){var l=o.map(a.log),h=n.mean(l);return a.exp(h)},n.median=function(o){var l=o.length,h=o.slice().sort(s);return l&1?h[l/2|0]:(h[l/2-1]+h[l/2])/2},n.cumsum=function(o){return n.cumreduce(o,function(l,h){return l+h})},n.cumprod=function(o){return n.cumreduce(o,function(l,h){return l*h})},n.diff=function(o){var l=[],h=o.length,d;for(d=1;d<h;d++)l.push(o[d]-o[d-1]);return l},n.rank=function(u){var o,l=[],h={};for(o=0;o<u.length;o++){var d=u[o];h[d]?h[d]++:(h[d]=1,l.push(d))}var p=l.sort(s),m={},x=1;for(o=0;o<p.length;o++){var d=p[o],v=h[d],y=x,g=x+v-1,_=(y+g)/2;m[d]=_,x+=v}return u.map(function(w){return m[w]})},n.mode=function(o){var l=o.length,h=o.slice().sort(s),d=1,p=0,m=0,x=[],v;for(v=0;v<l;v++)h[v]===h[v+1]?d++:(d>p?(x=[h[v]],p=d,m=0):d===p&&(x.push(h[v]),m++),d=1);return m===0?x[0]:x},n.range=function(o){return n.max(o)-n.min(o)},n.variance=function(o,l){return n.sumsqerr(o)/(o.length-(l?1:0))},n.pooledvariance=function(o){var l=o.reduce(function(d,p){return d+n.sumsqerr(p)},0),h=o.reduce(function(d,p){return d+p.length},0);return l/(h-o.length)},n.deviation=function(u){for(var o=n.mean(u),l=u.length,h=new Array(l),d=0;d<l;d++)h[d]=u[d]-o;return h},n.stdev=function(o,l){return a.sqrt(n.variance(o,l))},n.pooledstdev=function(o){return a.sqrt(n.pooledvariance(o))},n.meandev=function(o){for(var l=n.mean(o),h=[],d=o.length-1;d>=0;d--)h.push(a.abs(o[d]-l));return n.mean(h)},n.meddev=function(o){for(var l=n.median(o),h=[],d=o.length-1;d>=0;d--)h.push(a.abs(o[d]-l));return n.median(h)},n.coeffvar=function(o){return n.stdev(o)/n.mean(o)},n.quartiles=function(o){var l=o.length,h=o.slice().sort(s);return[h[a.round(l/4)-1],h[a.round(l/2)-1],h[a.round(l*3/4)-1]]},n.quantiles=function(o,l,h,d){var p=o.slice().sort(s),m=[l.length],x=o.length,v,y,g,_,w,E;for(typeof h>"u"&&(h=3/8),typeof d>"u"&&(d=3/8),v=0;v<l.length;v++)y=l[v],g=h+y*(1-h-d),_=x*y+g,w=a.floor(c(_,1,x-1)),E=c(_-w,0,1),m[v]=(1-E)*p[w-1]+E*p[w];return m},n.percentile=function(o,l,h){var d=o.slice().sort(s),p=l*(d.length+(h?1:-1))+(h?0:1),m=parseInt(p),x=p-m;return m+1<d.length?d[m-1]+x*(d[m]-d[m-1]):d[m-1]},n.percentileOfScore=function(o,l,h){var d=0,p=o.length,m=!1,x,v;for(h==="strict"&&(m=!0),v=0;v<p;v++)x=o[v],(m&&x<l||!m&&x<=l)&&d++;return d/p},n.histogram=function(o,l){l=l||4;var h=n.min(o),d=(n.max(o)-h)/l,p=o.length,m=[],x;for(x=0;x<l;x++)m[x]=0;for(x=0;x<p;x++)m[a.min(a.floor((o[x]-h)/d),l-1)]+=1;return m},n.covariance=function(o,l){var h=n.mean(o),d=n.mean(l),p=o.length,m=new Array(p),x;for(x=0;x<p;x++)m[x]=(o[x]-h)*(l[x]-d);return n.sum(m)/(p-1)},n.corrcoeff=function(o,l){return n.covariance(o,l)/n.stdev(o,1)/n.stdev(l,1)},n.spearmancoeff=function(u,o){return u=n.rank(u),o=n.rank(o),n.corrcoeff(u,o)},n.stanMoment=function(o,l){for(var h=n.mean(o),d=n.stdev(o),p=o.length,m=0,x=0;x<p;x++)m+=a.pow((o[x]-h)/d,l);return m/o.length},n.skewness=function(o){return n.stanMoment(o,3)},n.kurtosis=function(o){return n.stanMoment(o,4)-3};var f=n.prototype;(function(u){for(var o=0;o<u.length;o++)(function(l){f[l]=function(h,d){var p=[],m=0,x=this;if(i(h)&&(d=h,h=!1),d)return setTimeout(function(){d.call(x,f[l].call(x,h))}),this;if(this.length>1){for(x=h===!0?this:this.transpose();m<x.length;m++)p[m]=n[l](x[m]);return p}return n[l](this[0],h)}})(u[o])})("cumsum cumprod".split(" ")),function(u){for(var o=0;o<u.length;o++)(function(l){f[l]=function(h,d){var p=[],m=0,x=this;if(i(h)&&(d=h,h=!1),d)return setTimeout(function(){d.call(x,f[l].call(x,h))}),this;if(this.length>1){for(l!=="sumrow"&&(x=h===!0?this:this.transpose());m<x.length;m++)p[m]=n[l](x[m]);return h===!0?n[l](n.utils.toVector(p)):p}return n[l](this[0],h)}})(u[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(u){for(var o=0;o<u.length;o++)(function(l){f[l]=function(){var h=[],d=0,p=this,m=Array.prototype.slice.call(arguments),x;if(i(m[m.length-1])){x=m[m.length-1];var v=m.slice(0,m.length-1);return setTimeout(function(){x.call(p,f[l].apply(p,v))}),this}else{x=void 0;var y=function(_){return n[l].apply(p,[_].concat(m))}}if(this.length>1){for(p=p.transpose();d<p.length;d++)h[d]=y(p[d]);return h}return y(this[0])}})(u[o])}("quantiles percentileOfScore".split(" "))}(r,Math),function(n,a){n.gammaln=function(s){var c=0,f=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015,o,l,h;for(h=(l=o=s)+5.5,h-=(o+.5)*a.log(h);c<6;c++)u+=f[c]/++l;return a.log(2.5066282746310007*u/o)-h},n.loggam=function(s){var c,f,u,o,l,h,d,p=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(c=s,d=0,s==1||s==2)return 0;for(s<=7&&(d=a.floor(7-s),c=s+d),f=1/(c*c),u=2*a.PI,l=p[9],h=8;h>=0;h--)l*=f,l+=p[h];if(o=l/c+.5*a.log(u)+(c-.5)*a.log(c)-c,s<=7)for(h=1;h<=d;h++)o-=a.log(c-1),c-=1;return o},n.gammafn=function(s){var c=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],f=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],u=!1,o=0,l=0,h=0,d=s,p,m,x,v;if(s>171.6243769536076)return 1/0;if(d<=0)if(v=d%1+36e-17,v)u=(d&1?-1:1)*a.PI/a.sin(a.PI*v),d=1-d;else return 1/0;for(x=d,d<1?m=d++:m=(d-=o=(d|0)-1)-1,p=0;p<8;++p)h=(h+c[p])*m,l=l*m+f[p];if(v=h/l+1,x<d)v/=x;else if(x>d)for(p=0;p<o;++p)v*=d,d++;return u&&(v=u/v),v},n.gammap=function(s,c){return n.lowRegGamma(s,c)*n.gammafn(s)},n.lowRegGamma=function(s,c){var f=n.gammaln(s),u=s,o=1/s,l=o,h=c+1-s,d=1/1e-30,p=1/h,m=p,x=1,v=-~(a.log(s>=1?s:1/s)*8.5+s*.4+17),y;if(c<0||s<=0)return NaN;if(c<s+1){for(;x<=v;x++)o+=l*=c/++u;return o*a.exp(-c+s*a.log(c)-f)}for(;x<=v;x++)y=-x*(x-s),h+=2,p=y*p+h,d=h+y/d,p=1/p,m*=p*d;return 1-m*a.exp(-c+s*a.log(c)-f)},n.factorialln=function(s){return s<0?NaN:n.gammaln(s+1)},n.factorial=function(s){return s<0?NaN:n.gammafn(s+1)},n.combination=function(s,c){return s>170||c>170?a.exp(n.combinationln(s,c)):n.factorial(s)/n.factorial(c)/n.factorial(s-c)},n.combinationln=function(s,c){return n.factorialln(s)-n.factorialln(c)-n.factorialln(s-c)},n.permutation=function(s,c){return n.factorial(s)/n.factorial(s-c)},n.betafn=function(s,c){if(!(s<=0||c<=0))return s+c>170?a.exp(n.betaln(s,c)):n.gammafn(s)*n.gammafn(c)/n.gammafn(s+c)},n.betaln=function(s,c){return n.gammaln(s)+n.gammaln(c)-n.gammaln(s+c)},n.betacf=function(s,c,f){var u=1e-30,o=1,l=c+f,h=c+1,d=c-1,p=1,m=1-l*s/h,x,v,y,g;for(a.abs(m)<u&&(m=u),m=1/m,g=m;o<=100&&(x=2*o,v=o*(f-o)*s/((d+x)*(c+x)),m=1+v*m,a.abs(m)<u&&(m=u),p=1+v/p,a.abs(p)<u&&(p=u),m=1/m,g*=m*p,v=-(c+o)*(l+o)*s/((c+x)*(h+x)),m=1+v*m,a.abs(m)<u&&(m=u),p=1+v/p,a.abs(p)<u&&(p=u),m=1/m,y=m*p,g*=y,!(a.abs(y-1)<3e-7));o++);return g},n.gammapinv=function(s,c){var f=0,u=c-1,o=1e-8,l=n.gammaln(c),h,d,p,m,x,v,y;if(s>=1)return a.max(100,c+100*a.sqrt(c));if(s<=0)return 0;for(c>1?(v=a.log(u),y=a.exp(u*(v-1)-l),x=s<.5?s:1-s,p=a.sqrt(-2*a.log(x)),h=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,s<.5&&(h=-h),h=a.max(.001,c*a.pow(1-1/(9*c)-h/(3*a.sqrt(c)),3))):(p=1-c*(.253+c*.12),s<p?h=a.pow(s/p,1/c):h=1-a.log(1-(s-p)/(1-p)));f<12;f++){if(h<=0)return 0;if(d=n.lowRegGamma(c,h)-s,c>1?p=y*a.exp(-(h-u)+u*(a.log(h)-v)):p=a.exp(-h+u*a.log(h)-l),m=d/p,h-=p=m/(1-.5*a.min(1,m*((c-1)/h-1))),h<=0&&(h=.5*(h+p)),a.abs(p)<o*h)break}return h},n.erf=function(s){var c=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],f=c.length-1,u=!1,o=0,l=0,h,d,p,m;for(s<0&&(s=-s,u=!0),h=2/(2+s),d=4*h-2;f>0;f--)p=o,o=d*o-l+c[f],l=p;return m=h*a.exp(-s*s+.5*(c[0]+d*o)-l),u?m-1:1-m},n.erfc=function(s){return 1-n.erf(s)},n.erfcinv=function(s){var c=0,f,u,o,l;if(s>=2)return-100;if(s<=0)return 100;for(l=s<1?s:2-s,o=a.sqrt(-2*a.log(l/2)),f=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);c<2;c++)u=n.erfc(f)-l,f+=u/(1.1283791670955126*a.exp(-f*f)-f*u);return s<1?f:-f},n.ibetainv=function(s,c,f){var u=1e-8,o=c-1,l=f-1,h=0,d,p,m,x,v,y,g,_,w,E,k;if(s<=0)return 0;if(s>=1)return 1;for(c>=1&&f>=1?(m=s<.5?s:1-s,x=a.sqrt(-2*a.log(m)),g=(2.30753+x*.27061)/(1+x*(.99229+x*.04481))-x,s<.5&&(g=-g),_=(g*g-3)/6,w=2/(1/(2*c-1)+1/(2*f-1)),E=g*a.sqrt(_+w)/w-(1/(2*f-1)-1/(2*c-1))*(_+5/6-2/(3*w)),g=c/(c+f*a.exp(2*E))):(d=a.log(c/(c+f)),p=a.log(f/(c+f)),x=a.exp(c*d)/c,v=a.exp(f*p)/f,E=x+v,s<x/E?g=a.pow(c*E*s,1/c):g=1-a.pow(f*E*(1-s),1/f)),k=-n.gammaln(c)-n.gammaln(f)+n.gammaln(c+f);h<10;h++){if(g===0||g===1)return g;if(y=n.ibeta(g,c,f)-s,x=a.exp(o*a.log(g)+l*a.log(1-g)+k),v=y/x,g-=x=v/(1-.5*a.min(1,v*(o/g-l/(1-g)))),g<=0&&(g=.5*(g+x)),g>=1&&(g=.5*(g+x+1)),a.abs(x)<u*g&&h>0)break}return g},n.ibeta=function(s,c,f){var u=s===0||s===1?0:a.exp(n.gammaln(c+f)-n.gammaln(c)-n.gammaln(f)+c*a.log(s)+f*a.log(1-s));return s<0||s>1?!1:s<(c+1)/(c+f+2)?u*n.betacf(s,c,f)/c:1-u*n.betacf(1-s,f,c)/f},n.randn=function(s,c){var f,u,o,l,h;if(c||(c=s),s)return n.create(s,c,function(){return n.randn()});do f=n._random_fn(),u=1.7156*(n._random_fn()-.5),o=f-.449871,l=a.abs(u)+.386595,h=o*o+l*(.196*l-.25472*o);while(h>.27597&&(h>.27846||u*u>-4*a.log(f)*f*f));return u/f},n.randg=function(s,c,f){var u=s,o,l,h,d,p,m;if(f||(f=c),s||(s=1),c)return m=n.zeros(c,f),m.alter(function(){return n.randg(s)}),m;s<1&&(s+=1),o=s-1/3,l=1/a.sqrt(9*o);do{do p=n.randn(),d=1+l*p;while(d<=0);d=d*d*d,h=n._random_fn()}while(h>1-.331*a.pow(p,4)&&a.log(h)>.5*p*p+o*(1-d+a.log(d)));if(s==u)return o*d;do h=n._random_fn();while(h===0);return a.pow(h,1/u)*o*d},function(i){for(var s=0;s<i.length;s++)(function(c){n.fn[c]=function(){return n(n.map(this,function(f){return n[c](f)}))}})(i[s])}("gammaln gammafn factorial factorialln".split(" ")),function(i){for(var s=0;s<i.length;s++)(function(c){n.fn[c]=function(){return n(n[c].apply(null,arguments))}})(i[s])}("randn".split(" "))}(r,Math),function(n,a){(function(u){for(var o=0;o<u.length;o++)(function(l){n[l]=function h(d,p,m){return this instanceof h?(this._a=d,this._b=p,this._c=m,this):new h(d,p,m)},n.fn[l]=function(h,d,p){var m=n[l](h,d,p);return m.data=this,m},n[l].prototype.sample=function(h){var d=this._a,p=this._b,m=this._c;return h?n.alter(h,function(){return n[l].sample(d,p,m)}):n[l].sample(d,p,m)},function(h){for(var d=0;d<h.length;d++)(function(p){n[l].prototype[p]=function(m){var x=this._a,v=this._b,y=this._c;return!m&&m!==0&&(m=this.data),typeof m!="number"?n.fn.map.call(m,function(g){return n[l][p](g,x,v,y)}):n[l][p](m,x,v,y)}})(h[d])}("pdf cdf inv".split(" ")),function(h){for(var d=0;d<h.length;d++)(function(p){n[l].prototype[p]=function(){return n[l][p](this._a,this._b,this._c)}})(h[d])}("mean median mode variance".split(" "))})(u[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),n.extend(n.beta,{pdf:function(o,l,h){return o>1||o<0?0:l==1&&h==1?1:l<512&&h<512?a.pow(o,l-1)*a.pow(1-o,h-1)/n.betafn(l,h):a.exp((l-1)*a.log(o)+(h-1)*a.log(1-o)-n.betaln(l,h))},cdf:function(o,l,h){return o>1||o<0?(o>1)*1:n.ibeta(o,l,h)},inv:function(o,l,h){return n.ibetainv(o,l,h)},mean:function(o,l){return o/(o+l)},median:function(o,l){return n.ibetainv(.5,o,l)},mode:function(o,l){return(o-1)/(o+l-2)},sample:function(o,l){var h=n.randg(o);return h/(h+n.randg(l))},variance:function(o,l){return o*l/(a.pow(o+l,2)*(o+l+1))}}),n.extend(n.centralF,{pdf:function(o,l,h){var d,p,m;return o<0?0:l<=2?o===0&&l<2?1/0:o===0&&l===2?1:1/n.betafn(l/2,h/2)*a.pow(l/h,l/2)*a.pow(o,l/2-1)*a.pow(1+l/h*o,-(l+h)/2):(d=l*o/(h+o*l),p=h/(h+o*l),m=l*p/2,m*n.binomial.pdf((l-2)/2,(l+h-2)/2,d))},cdf:function(o,l,h){return o<0?0:n.ibeta(l*o/(l*o+h),l/2,h/2)},inv:function(o,l,h){return h/(l*(1/n.ibetainv(o,l/2,h/2)-1))},mean:function(o,l){return l>2?l/(l-2):void 0},mode:function(o,l){return o>2?l*(o-2)/(o*(l+2)):void 0},sample:function(o,l){var h=n.randg(o/2)*2,d=n.randg(l/2)*2;return h/o/(d/l)},variance:function(o,l){if(!(l<=4))return 2*l*l*(o+l-2)/(o*(l-2)*(l-2)*(l-4))}}),n.extend(n.cauchy,{pdf:function(o,l,h){return h<0?0:h/(a.pow(o-l,2)+a.pow(h,2))/a.PI},cdf:function(o,l,h){return a.atan((o-l)/h)/a.PI+.5},inv:function(u,o,l){return o+l*a.tan(a.PI*(u-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,l){return n.randn()*a.sqrt(1/(2*n.randg(.5)))*l+o}}),n.extend(n.chisquare,{pdf:function(o,l){return o<0?0:o===0&&l===2?.5:a.exp((l/2-1)*a.log(o)-o/2-l/2*a.log(2)-n.gammaln(l/2))},cdf:function(o,l){return o<0?0:n.lowRegGamma(l/2,o/2)},inv:function(u,o){return 2*n.gammapinv(u,.5*o)},mean:function(u){return u},median:function(o){return o*a.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return n.randg(o/2)*2},variance:function(o){return 2*o}}),n.extend(n.exponential,{pdf:function(o,l){return o<0?0:l*a.exp(-l*o)},cdf:function(o,l){return o<0?0:1-a.exp(-l*o)},inv:function(u,o){return-a.log(1-u)/o},mean:function(u){return 1/u},median:function(u){return 1/u*a.log(2)},mode:function(){return 0},sample:function(o){return-1/o*a.log(n._random_fn())},variance:function(u){return a.pow(u,-2)}}),n.extend(n.gamma,{pdf:function(o,l,h){return o<0?0:o===0&&l===1?1/h:a.exp((l-1)*a.log(o)-o/h-n.gammaln(l)-l*a.log(h))},cdf:function(o,l,h){return o<0?0:n.lowRegGamma(l,o/h)},inv:function(u,o,l){return n.gammapinv(u,o)*l},mean:function(u,o){return u*o},mode:function(o,l){if(o>1)return(o-1)*l},sample:function(o,l){return n.randg(o)*l},variance:function(o,l){return o*l*l}}),n.extend(n.invgamma,{pdf:function(o,l,h){return o<=0?0:a.exp(-(l+1)*a.log(o)-h/o-n.gammaln(l)+l*a.log(h))},cdf:function(o,l,h){return o<=0?0:1-n.lowRegGamma(l,h/o)},inv:function(u,o,l){return l/n.gammapinv(1-u,o)},mean:function(u,o){return u>1?o/(u-1):void 0},mode:function(o,l){return l/(o+1)},sample:function(o,l){return l/n.randg(o)},variance:function(o,l){if(!(o<=2))return l*l/((o-1)*(o-1)*(o-2))}}),n.extend(n.kumaraswamy,{pdf:function(o,l,h){return o===0&&l===1?h:o===1&&h===1?l:a.exp(a.log(l)+a.log(h)+(l-1)*a.log(o)+(h-1)*a.log(1-a.pow(o,l)))},cdf:function(o,l,h){return o<0?0:o>1?1:1-a.pow(1-a.pow(o,l),h)},inv:function(o,l,h){return a.pow(1-a.pow(1-o,1/h),1/l)},mean:function(u,o){return o*n.gammafn(1+1/u)*n.gammafn(o)/n.gammafn(1+1/u+o)},median:function(o,l){return a.pow(1-a.pow(2,-1/l),1/o)},mode:function(o,l){if(o>=1&&l>=1&&o!==1&&l!==1)return a.pow((o-1)/(o*l-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),n.extend(n.lognormal,{pdf:function(o,l,h){return o<=0?0:a.exp(-a.log(o)-.5*a.log(2*a.PI)-a.log(h)-a.pow(a.log(o)-l,2)/(2*h*h))},cdf:function(o,l,h){return o<0?0:.5+.5*n.erf((a.log(o)-l)/a.sqrt(2*h*h))},inv:function(u,o,l){return a.exp(-1.4142135623730951*l*n.erfcinv(2*u)+o)},mean:function(o,l){return a.exp(o+l*l/2)},median:function(o){return a.exp(o)},mode:function(o,l){return a.exp(o-l*l)},sample:function(o,l){return a.exp(n.randn()*l+o)},variance:function(o,l){return(a.exp(l*l)-1)*a.exp(2*o+l*l)}}),n.extend(n.noncentralt,{pdf:function(o,l,h){var d=1e-14;return a.abs(h)<d?n.studentt.pdf(o,l):a.abs(o)<d?a.exp(n.gammaln((l+1)/2)-h*h/2-.5*a.log(a.PI*l)-n.gammaln(l/2)):l/o*(n.noncentralt.cdf(o*a.sqrt(1+2/l),l+2,h)-n.noncentralt.cdf(o,l,h))},cdf:function(o,l,h){var d=1e-14,p=200;if(a.abs(h)<d)return n.studentt.cdf(o,l);var m=!1;o<0&&(m=!0,h=-h);for(var x=n.normal.cdf(-h,0,1),v=d+1,y=v,g=o*o/(o*o+l),_=0,w=a.exp(-h*h/2),E=a.exp(-h*h/2-.5*a.log(2)-n.gammaln(3/2))*h;_<p||y>d||v>d;)y=v,_>0&&(w*=h*h/(2*_),E*=h*h/(2*(_+1/2))),v=w*n.beta.cdf(g,_+.5,l/2)+E*n.beta.cdf(g,_+1,l/2),x+=.5*v,_++;return m?1-x:x}}),n.extend(n.normal,{pdf:function(o,l,h){return a.exp(-.5*a.log(2*a.PI)-a.log(h)-a.pow(o-l,2)/(2*h*h))},cdf:function(o,l,h){return .5*(1+n.erf((o-l)/a.sqrt(2*h*h)))},inv:function(u,o,l){return-1.4142135623730951*l*n.erfcinv(2*u)+o},mean:function(u){return u},median:function(o){return o},mode:function(u){return u},sample:function(o,l){return n.randn()*l+o},variance:function(u,o){return o*o}}),n.extend(n.pareto,{pdf:function(o,l,h){return o<l?0:h*a.pow(l,h)/a.pow(o,h+1)},cdf:function(o,l,h){return o<l?0:1-a.pow(l/o,h)},inv:function(o,l,h){return l/a.pow(1-o,1/h)},mean:function(o,l){if(!(l<=1))return l*a.pow(o,l)/(l-1)},median:function(o,l){return o*(l*a.SQRT2)},mode:function(o){return o},variance:function(u,o){if(!(o<=2))return u*u*o/(a.pow(o-1,2)*(o-2))}}),n.extend(n.studentt,{pdf:function(o,l){return l=l>1e100?1e100:l,1/(a.sqrt(l)*n.betafn(.5,l/2))*a.pow(1+o*o/l,-((l+1)/2))},cdf:function(o,l){var h=l/2;return n.ibeta((o+a.sqrt(o*o+l))/(2*a.sqrt(o*o+l)),h,h)},inv:function(u,o){var l=n.ibetainv(2*a.min(u,1-u),.5*o,.5);return l=a.sqrt(o*(1-l)/l),u>.5?l:-l},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return n.randn()*a.sqrt(o/(2*n.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(o,l,h){return o<0||l<0||h<0?0:h/l*a.pow(o/l,h-1)*a.exp(-a.pow(o/l,h))},cdf:function(o,l,h){return o<0?0:1-a.exp(-a.pow(o/l,h))},inv:function(u,o,l){return o*a.pow(-a.log(1-u),1/l)},mean:function(u,o){return u*n.gammafn(1+1/o)},median:function(o,l){return o*a.pow(a.log(2),1/l)},mode:function(o,l){return l<=1?0:o*a.pow((l-1)/l,1/l)},sample:function(o,l){return o*a.pow(-a.log(n._random_fn()),1/l)},variance:function(o,l){return o*o*n.gammafn(1+2/l)-a.pow(n.weibull.mean(o,l),2)}}),n.extend(n.uniform,{pdf:function(o,l,h){return o<l||o>h?0:1/(h-l)},cdf:function(o,l,h){return o<l?0:o<h?(o-l)/(h-l):1},inv:function(u,o,l){return o+u*(l-o)},mean:function(o,l){return .5*(o+l)},median:function(o,l){return n.mean(o,l)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,l){return o/2+l/2+(l/2-o/2)*(2*n._random_fn()-1)},variance:function(o,l){return a.pow(l-o,2)/12}});function i(u,o,l,h){for(var d=0,p=1,m=1,x=1,v=0,y=0,g;a.abs((m-y)/m)>h;)y=m,g=-(o+v)*(o+l+v)*u/(o+2*v)/(o+2*v+1),d=m+g*d,p=x+g*p,v=v+1,g=v*(l-v)*u/(o+2*v-1)/(o+2*v),m=d+g*m,x=p+g*x,d=d/x,p=p/x,m=m/x,x=1;return m/o}n.extend(n.binomial,{pdf:function(o,l,h){return h===0||h===1?l*h===o?1:0:n.combination(l,o)*a.pow(h,o)*a.pow(1-h,l-o)},cdf:function(o,l,h){var d,p=1e-10;if(o<0)return 0;if(o>=l)return 1;if(h<0||h>1||l<=0)return NaN;o=a.floor(o);var m=h,x=o+1,v=l-o,y=x+v,g=a.exp(n.gammaln(y)-n.gammaln(v)-n.gammaln(x)+x*a.log(m)+v*a.log(1-m));return m<(x+1)/(y+2)?d=g*i(m,x,v,p):d=1-g*i(1-m,v,x,p),a.round((1-d)*(1/p))/(1/p)}}),n.extend(n.negbin,{pdf:function(o,l,h){return o!==o>>>0?!1:o<0?0:n.combination(o+l-1,l-1)*a.pow(1-h,o)*a.pow(h,l)},cdf:function(o,l,h){var d=0,p=0;if(o<0)return 0;for(;p<=o;p++)d+=n.negbin.pdf(p,l,h);return d}}),n.extend(n.hypgeom,{pdf:function(o,l,h,d){if(o!==o|0)return!1;if(o<0||o<h-(l-d))return 0;if(o>d||o>h)return 0;if(h*2>l)return d*2>l?n.hypgeom.pdf(l-h-d+o,l,l-h,l-d):n.hypgeom.pdf(d-o,l,l-h,d);if(d*2>l)return n.hypgeom.pdf(h-o,l,h,l-d);if(h<d)return n.hypgeom.pdf(o,l,d,h);for(var p=1,m=0,x=0;x<o;x++){for(;p>1&&m<d;)p*=1-h/(l-m),m++;p*=(d-x)*(h-x)/((x+1)*(l-h-d+x+1))}for(;m<d;m++)p*=1-h/(l-m);return a.min(1,a.max(0,p))},cdf:function(o,l,h,d){if(o<0||o<h-(l-d))return 0;if(o>=d||o>=h)return 1;if(h*2>l)return d*2>l?n.hypgeom.cdf(l-h-d+o,l,l-h,l-d):1-n.hypgeom.cdf(d-o-1,l,l-h,d);if(d*2>l)return 1-n.hypgeom.cdf(h-o-1,l,h,l-d);if(h<d)return n.hypgeom.cdf(o,l,d,h);for(var p=1,m=1,x=0,v=0;v<o;v++){for(;p>1&&x<d;){var y=1-h/(l-x);m*=y,p*=y,x++}m*=(d-v)*(h-v)/((v+1)*(l-h-d+v+1)),p+=m}for(;x<d;x++)p*=1-h/(l-x);return a.min(1,a.max(0,p))}}),n.extend(n.poisson,{pdf:function(o,l){return l<0||o%1!==0||o<0?0:a.pow(l,o)*a.exp(-l)/n.factorial(o)},cdf:function(o,l){var h=[],d=0;if(o<0)return 0;for(;d<=o;d++)h.push(n.poisson.pdf(d,l));return n.sum(h)},mean:function(u){return u},variance:function(u){return u},sampleSmall:function(o){var l=1,h=0,d=a.exp(-o);do h++,l*=n._random_fn();while(l>d);return h-1},sampleLarge:function(o){var l=o,h,d,p,m,x,v,y,g,_,w;for(m=a.sqrt(l),x=a.log(l),y=.931+2.53*m,v=-.059+.02483*y,g=1.1239+1.1328/(y-3.4),_=.9277-3.6224/(y-2);;){if(d=a.random()-.5,p=a.random(),w=.5-a.abs(d),h=a.floor((2*v/w+y)*d+l+.43),w>=.07&&p<=_)return h;if(!(h<0||w<.013&&p>w)&&a.log(p)+a.log(g)-a.log(v/(w*w)+y)<=-l+h*x-n.loggam(h+1))return h}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),n.extend(n.triangular,{pdf:function(o,l,h,d){return h<=l||d<l||d>h?NaN:o<l||o>h?0:o<d?2*(o-l)/((h-l)*(d-l)):o===d?2/(h-l):2*(h-o)/((h-l)*(h-d))},cdf:function(o,l,h,d){return h<=l||d<l||d>h?NaN:o<=l?0:o>=h?1:o<=d?a.pow(o-l,2)/((h-l)*(d-l)):1-a.pow(h-o,2)/((h-l)*(h-d))},inv:function(o,l,h,d){return h<=l||d<l||d>h?NaN:o<=(d-l)/(h-l)?l+(h-l)*a.sqrt(o*((d-l)/(h-l))):l+(h-l)*(1-a.sqrt((1-o)*(1-(d-l)/(h-l))))},mean:function(o,l,h){return(o+l+h)/3},median:function(o,l,h){if(h<=(o+l)/2)return l-a.sqrt((l-o)*(l-h))/a.sqrt(2);if(h>(o+l)/2)return o+a.sqrt((l-o)*(h-o))/a.sqrt(2)},mode:function(o,l,h){return h},sample:function(o,l,h){var d=n._random_fn();return d<(h-o)/(l-o)?o+a.sqrt(d*(l-o)*(h-o)):l-a.sqrt((1-d)*(l-o)*(l-h))},variance:function(o,l,h){return(o*o+l*l+h*h-o*l-o*h-l*h)/18}}),n.extend(n.arcsine,{pdf:function(o,l,h){return h<=l?NaN:o<=l||o>=h?0:2/a.PI*a.pow(a.pow(h-l,2)-a.pow(2*o-l-h,2),-.5)},cdf:function(o,l,h){return o<l?0:o<h?2/a.PI*a.asin(a.sqrt((o-l)/(h-l))):1},inv:function(u,o,l){return o+(.5-.5*a.cos(a.PI*u))*(l-o)},mean:function(o,l){return l<=o?NaN:(o+l)/2},median:function(o,l){return l<=o?NaN:(o+l)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,l){return(o+l)/2+(l-o)/2*a.sin(2*a.PI*n.uniform.sample(0,1))},variance:function(o,l){return l<=o?NaN:a.pow(l-o,2)/8}});function s(u){return u/a.abs(u)}n.extend(n.laplace,{pdf:function(o,l,h){return h<=0?0:a.exp(-a.abs(o-l)/h)/(2*h)},cdf:function(o,l,h){return h<=0?0:o<l?.5*a.exp((o-l)/h):1-.5*a.exp(-(o-l)/h)},mean:function(u){return u},median:function(u){return u},mode:function(u){return u},variance:function(u,o){return 2*o*o},sample:function(o,l){var h=n._random_fn()-.5;return o-l*s(h)*a.log(1-2*a.abs(h))}});function c(u,o,l){var h=12,d=6,p=-30,m=-50,x=60,v=8,y=3,g=2,_=3,w=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],E=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],k=u*.5;if(k>=v)return 1;var F=2*n.normal.cdf(k,0,1,1,0)-1;F>=a.exp(m/l)?F=a.pow(F,l):F=0;var b;u>y?b=g:b=_;for(var L=k,U=(v-k)/b,B=L+U,Y=0,se=l-1,re=1;re<=b;re++){for(var ue=0,ne=.5*(B+L),De=.5*(B-L),W=1;W<=h;W++){var pe,me;d<W?(pe=h-W+1,me=w[pe-1]):(pe=W,me=-w[pe-1]);var N=De*me,V=ne+N,M=V*V;if(M>x)break;var P=2*n.normal.cdf(V,0,1,1,0),J=2*n.normal.cdf(V,u,1,1,0),te=P*.5-J*.5;te>=a.exp(p/se)&&(te=E[pe-1]*a.exp(-(.5*M))*a.pow(te,se),ue+=te)}ue*=2*De*l/a.sqrt(2*a.PI),Y+=ue,L=B,B+=U}return F+=Y,F<=a.exp(p/o)?0:(F=a.pow(F,o),F>=1?1:F)}function f(u,o,l){var h=.322232421088,d=.099348462606,p=-1,m=.588581570495,x=-.342242088547,v=.531103462366,y=-.204231210125,g=.10353775285,_=-453642210148e-16,w=.0038560700634,E=.8832,k=.2368,F=1.208,b=1.4142,L=120,U=.5-.5*u,B=a.sqrt(a.log(1/(U*U))),Y=B+((((B*_+y)*B+x)*B+p)*B+h)/((((B*w+g)*B+v)*B+m)*B+d);l<L&&(Y+=(Y*Y*Y+Y)/l/4);var se=E-k*Y;return l<L&&(se+=-1.214/l+F*Y/l),Y*(se*a.log(o-1)+b)}n.extend(n.tukey,{cdf:function(o,l,h){var d=1,p=l,m=16,x=8,v=-30,y=1e-14,g=100,_=800,w=5e3,E=25e3,k=1,F=.5,b=.25,L=.125,U=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],B=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(h<2||d<1||p<2)return NaN;if(!Number.isFinite(o))return 1;if(h>E)return c(o,d,p);var Y=h*.5,se=Y*a.log(h)-h*a.log(2)-n.gammaln(Y),re=Y-1,ue=h*.25,ne;h<=g?ne=k:h<=_?ne=F:h<=w?ne=b:ne=L,se+=a.log(ne);for(var De=0,W=1;W<=50;W++){for(var pe=0,me=(2*W-1)*ne,N=1;N<=m;N++){var V,M;x<N?(V=N-x-1,M=se+re*a.log(me+U[V]*ne)-(U[V]*ne+me)*ue):(V=N-1,M=se+re*a.log(me-U[V]*ne)+(U[V]*ne-me)*ue);var P;if(M>=v){x<N?P=o*a.sqrt((U[V]*ne+me)*.5):P=o*a.sqrt((-(U[V]*ne)+me)*.5);var J=c(P,d,p),te=J*B[V]*a.exp(M);pe+=te}}if(W*ne>=1&&pe<=y)break;De+=pe}if(pe>y)throw new Error("tukey.cdf failed to converge");return De>1&&(De=1),De},inv:function(u,o,l){var h=1,d=o,p=1e-4,m=50;if(l<2||h<1||d<2)return NaN;if(u<0||u>1)return NaN;if(u===0)return 0;if(u===1)return 1/0;var x=f(u,d,l),v=n.tukey.cdf(x,o,l)-u,y;v>0?y=a.max(0,x-1):y=x+1;for(var g=n.tukey.cdf(y,o,l)-u,_,w=1;w<m;w++){_=y-g*(y-x)/(g-v),v=g,x=y,_<0&&(_=0,g=-u),g=n.tukey.cdf(_,o,l)-u,y=_;var E=a.abs(y-x);if(E<p)return _}throw new Error("tukey.inv failed to converge")}})}(r,Math),function(n,a){var i=Array.prototype.push,s=n.utils.isArray;function c(f){return s(f)||f instanceof n}n.extend({add:function(u,o){return c(o)?(c(o[0])||(o=[o]),n.map(u,function(l,h,d){return l+o[h][d]})):n.map(u,function(l){return l+o})},subtract:function(u,o){return c(o)?(c(o[0])||(o=[o]),n.map(u,function(l,h,d){return l-o[h][d]||0})):n.map(u,function(l){return l-o})},divide:function(u,o){return c(o)?(c(o[0])||(o=[o]),n.multiply(u,n.inv(o))):n.map(u,function(l){return l/o})},multiply:function(u,o){var l,h,d,p,m,x,v,y;if(u.length===void 0&&o.length===void 0)return u*o;if(m=u.length,x=u[0].length,v=n.zeros(m,d=c(o)?o[0].length:x),y=0,c(o)){for(;y<d;y++)for(l=0;l<m;l++){for(p=0,h=0;h<x;h++)p+=u[l][h]*o[h][y];v[l][y]=p}return m===1&&y===1?v[0][0]:v}return n.map(u,function(g){return g*o})},outer:function(u,o){return n.multiply(u.map(function(l){return[l]}),[o])},dot:function(u,o){c(u[0])||(u=[u]),c(o[0])||(o=[o]);for(var l=u[0].length===1&&u.length!==1?n.transpose(u):u,h=o[0].length===1&&o.length!==1?n.transpose(o):o,d=[],p=0,m=l.length,x=l[0].length,v,y;p<m;p++){for(d[p]=[],v=0,y=0;y<x;y++)v+=l[p][y]*h[p][y];d[p]=v}return d.length===1?d[0]:d},pow:function(u,o){return n.map(u,function(l){return a.pow(l,o)})},exp:function(u){return n.map(u,function(o){return a.exp(o)})},log:function(u){return n.map(u,function(o){return a.log(o)})},abs:function(u){return n.map(u,function(o){return a.abs(o)})},norm:function(u,o){var l=0,h=0;for(isNaN(o)&&(o=2),c(u[0])&&(u=u[0]);h<u.length;h++)l+=a.pow(a.abs(u[h]),o);return a.pow(l,1/o)},angle:function(u,o){return a.acos(n.dot(u,o)/(n.norm(u)*n.norm(o)))},aug:function(u,o){var l=[],h;for(h=0;h<u.length;h++)l.push(u[h].slice());for(h=0;h<l.length;h++)i.apply(l[h],o[h]);return l},inv:function(u){for(var o=u.length,l=u[0].length,h=n.identity(o,l),d=n.gauss_jordan(u,h),p=[],m=0,x;m<o;m++)for(p[m]=[],x=l;x<d[0].length;x++)p[m][x-l]=d[m][x];return p},det:function f(u){if(u.length===2)return u[0][0]*u[1][1]-u[0][1]*u[1][0];for(var o=0,l=0;l<u.length;l++){for(var h=[],d=1;d<u.length;d++){h[d-1]=[];for(var p=0;p<u.length;p++)p<l?h[d-1][p]=u[d][p]:p>l&&(h[d-1][p-1]=u[d][p])}var m=l%2?-1:1;o+=f(h)*u[0][l]*m}return o},gauss_elimination:function(u,o){var l=0,h=0,d=u.length,p=u[0].length,m=1,x=0,v=[],y,g,_,w;for(u=n.aug(u,o),y=u[0].length,l=0;l<d;l++){for(g=u[l][l],h=l,w=l+1;w<p;w++)g<a.abs(u[w][l])&&(g=u[w][l],h=w);if(h!=l)for(w=0;w<y;w++)_=u[l][w],u[l][w]=u[h][w],u[h][w]=_;for(h=l+1;h<d;h++)for(m=u[h][l]/u[l][l],w=l;w<y;w++)u[h][w]=u[h][w]-m*u[l][w]}for(l=d-1;l>=0;l--){for(x=0,h=l+1;h<=d-1;h++)x=x+v[h]*u[l][h];v[l]=(u[l][y-1]-x)/u[l][l]}return v},gauss_jordan:function(u,o){var l=n.aug(u,o),h=l.length,d=l[0].length,p=0,m,x,v;for(x=0;x<h;x++){var y=x;for(v=x+1;v<h;v++)a.abs(l[v][x])>a.abs(l[y][x])&&(y=v);var g=l[x];for(l[x]=l[y],l[y]=g,v=x+1;v<h;v++)for(p=l[v][x]/l[x][x],m=x;m<d;m++)l[v][m]-=l[x][m]*p}for(x=h-1;x>=0;x--){for(p=l[x][x],v=0;v<x;v++)for(m=d-1;m>x-1;m--)l[v][m]-=l[x][m]*l[v][x]/p;for(l[x][x]/=p,m=h;m<d;m++)l[x][m]/=p}return l},triaUpSolve:function(u,o){var l=u[0].length,h=n.zeros(1,l)[0],d,p=!1;return o[0].length!=null&&(o=o.map(function(m){return m[0]}),p=!0),n.arange(l-1,-1,-1).forEach(function(m){d=n.arange(m+1,l).map(function(x){return h[x]*u[m][x]}),h[m]=(o[m]-n.sum(d))/u[m][m]}),p?h.map(function(m){return[m]}):h},triaLowSolve:function(u,o){var l=u[0].length,h=n.zeros(1,l)[0],d,p=!1;return o[0].length!=null&&(o=o.map(function(m){return m[0]}),p=!0),n.arange(l).forEach(function(m){d=n.arange(m).map(function(x){return u[m][x]*h[x]}),h[m]=(o[m]-n.sum(d))/u[m][m]}),p?h.map(function(m){return[m]}):h},lu:function(u){var o=u.length,l=n.identity(o),h=n.zeros(u.length,u[0].length),d;return n.arange(o).forEach(function(p){h[0][p]=u[0][p]}),n.arange(1,o).forEach(function(p){n.arange(p).forEach(function(m){d=n.arange(m).map(function(x){return l[p][x]*h[x][m]}),l[p][m]=(u[p][m]-n.sum(d))/h[m][m]}),n.arange(p,o).forEach(function(m){d=n.arange(p).map(function(x){return l[p][x]*h[x][m]}),h[p][m]=u[d.length][m]-n.sum(d)})}),[l,h]},cholesky:function(u){var o=u.length,l=n.zeros(u.length,u[0].length),h;return n.arange(o).forEach(function(d){h=n.arange(d).map(function(p){return a.pow(l[d][p],2)}),l[d][d]=a.sqrt(u[d][d]-n.sum(h)),n.arange(d+1,o).forEach(function(p){h=n.arange(d).map(function(m){return l[d][m]*l[p][m]}),l[p][d]=(u[d][p]-n.sum(h))/l[d][d]})}),l},gauss_jacobi:function(u,o,l,h){for(var d=0,p=0,m=u.length,x=[],v=[],y=[],g,_,w,E;d<m;d++)for(x[d]=[],v[d]=[],y[d]=[],p=0;p<m;p++)d>p?(x[d][p]=u[d][p],v[d][p]=y[d][p]=0):d<p?(v[d][p]=u[d][p],x[d][p]=y[d][p]=0):(y[d][p]=u[d][p],x[d][p]=v[d][p]=0);for(w=n.multiply(n.multiply(n.inv(y),n.add(x,v)),-1),_=n.multiply(n.inv(y),o),g=l,E=n.add(n.multiply(w,l),_),d=2;a.abs(n.norm(n.subtract(E,g)))>h;)g=E,E=n.add(n.multiply(w,g),_),d++;return E},gauss_seidel:function(u,o,l,h){for(var d=0,p=u.length,m=[],x=[],v=[],y,g,_,w,E;d<p;d++)for(m[d]=[],x[d]=[],v[d]=[],y=0;y<p;y++)d>y?(m[d][y]=u[d][y],x[d][y]=v[d][y]=0):d<y?(x[d][y]=u[d][y],m[d][y]=v[d][y]=0):(v[d][y]=u[d][y],m[d][y]=x[d][y]=0);for(w=n.multiply(n.multiply(n.inv(n.add(v,m)),x),-1),_=n.multiply(n.inv(n.add(v,m)),o),g=l,E=n.add(n.multiply(w,l),_),d=2;a.abs(n.norm(n.subtract(E,g)))>h;)g=E,E=n.add(n.multiply(w,g),_),d=d+1;return E},SOR:function(u,o,l,h,d){for(var p=0,m=u.length,x=[],v=[],y=[],g,_,w,E,k;p<m;p++)for(x[p]=[],v[p]=[],y[p]=[],g=0;g<m;g++)p>g?(x[p][g]=u[p][g],v[p][g]=y[p][g]=0):p<g?(v[p][g]=u[p][g],x[p][g]=y[p][g]=0):(y[p][g]=u[p][g],x[p][g]=v[p][g]=0);for(E=n.multiply(n.inv(n.add(y,n.multiply(x,d))),n.subtract(n.multiply(y,1-d),n.multiply(v,d))),w=n.multiply(n.multiply(n.inv(n.add(y,n.multiply(x,d))),o),d),_=l,k=n.add(n.multiply(E,l),w),p=2;a.abs(n.norm(n.subtract(k,_)))>h;)_=k,k=n.add(n.multiply(E,_),w),p++;return k},householder:function(u){for(var o=u.length,l=u[0].length,h=0,d=[],p=[],m,x,v,y,g;h<o-1;h++){for(m=0,y=h+1;y<l;y++)m+=u[y][h]*u[y][h];for(g=u[h+1][h]>0?-1:1,m=g*a.sqrt(m),x=a.sqrt((m*m-u[h+1][h]*m)/2),d=n.zeros(o,1),d[h+1][0]=(u[h+1][h]-m)/(2*x),v=h+2;v<o;v++)d[v][0]=u[v][h]/(2*x);p=n.subtract(n.identity(o,l),n.multiply(n.multiply(d,n.transpose(d)),2)),u=n.multiply(p,n.multiply(u,p))}return u},QR:function(){var f=n.sum,u=n.arange;function o(l){var h=l.length,d=l[0].length,p=n.zeros(d,d);l=n.copy(l);var m,x,v;for(x=0;x<d;x++){for(p[x][x]=a.sqrt(f(u(h).map(function(y){return l[y][x]*l[y][x]}))),m=0;m<h;m++)l[m][x]=l[m][x]/p[x][x];for(v=x+1;v<d;v++)for(p[x][v]=f(u(h).map(function(y){return l[y][x]*l[y][v]})),m=0;m<h;m++)l[m][v]=l[m][v]-l[m][x]*p[x][v]}return[l,p]}return o}(),lstsq:function(){function f(o){o=n.copy(o);var l=o.length,h=n.identity(l);return n.arange(l-1,-1,-1).forEach(function(d){n.sliceAssign(h,{row:d},n.divide(n.slice(h,{row:d}),o[d][d])),n.sliceAssign(o,{row:d},n.divide(n.slice(o,{row:d}),o[d][d])),n.arange(d).forEach(function(p){var m=n.multiply(o[p][d],-1),x=n.slice(o,{row:p}),v=n.multiply(n.slice(o,{row:d}),m);n.sliceAssign(o,{row:p},n.add(x,v));var y=n.slice(h,{row:p}),g=n.multiply(n.slice(h,{row:d}),m);n.sliceAssign(h,{row:p},n.add(y,g))})}),h}function u(o,l){var h=!1;l[0].length===void 0&&(l=l.map(function(E){return[E]}),h=!0);var d=n.QR(o),p=d[0],m=d[1],x=o[0].length,v=n.slice(p,{col:{end:x}}),y=n.slice(m,{row:{end:x}}),g=f(y),_=n.transpose(v);_[0].length===void 0&&(_=[_]);var w=n.multiply(n.multiply(g,_),l);return w.length===void 0&&(w=[[w]]),h?w.map(function(E){return E[0]}):w}return u}(),jacobi:function(u){for(var o=1,l=u.length,h=n.identity(l,l),d=[],p,m,x,v,y,g,_,w;o===1;){for(g=u[0][1],v=0,y=1,m=0;m<l;m++)for(x=0;x<l;x++)m!=x&&g<a.abs(u[m][x])&&(g=a.abs(u[m][x]),v=m,y=x);for(u[v][v]===u[y][y]?_=u[v][y]>0?a.PI/4:-a.PI/4:_=a.atan(2*u[v][y]/(u[v][v]-u[y][y]))/2,w=n.identity(l,l),w[v][v]=a.cos(_),w[v][y]=-a.sin(_),w[y][v]=a.sin(_),w[y][y]=a.cos(_),h=n.multiply(h,w),p=n.multiply(n.multiply(n.inv(w),u),w),u=p,o=0,m=1;m<l;m++)for(x=1;x<l;x++)m!=x&&a.abs(u[m][x])>.001&&(o=1)}for(m=0;m<l;m++)d.push(u[m][m]);return[h,d]},rungekutta:function(u,o,l,h,d,p){var m,x,v,y,g;if(p===2)for(;h<=l;)m=o*u(h,d),x=o*u(h+o,d+m),v=d+(m+x)/2,d=v,h=h+o;if(p===4)for(;h<=l;)m=o*u(h,d),x=o*u(h+o/2,d+m/2),y=o*u(h+o/2,d+x/2),g=o*u(h+o,d+y),v=d+(m+2*x+2*y+g)/6,d=v,h=h+o;return d},romberg:function(u,o,l,h){for(var d=0,p=(l-o)/2,m=[],x=[],v=[],y,g,_,w,E;d<h/2;){for(E=u(o),_=o,w=0;_<=l;_=_+p,w++)m[w]=_;for(y=m.length,_=1;_<y-1;_++)E+=(_%2!==0?4:2)*u(m[_]);E=p/3*(E+u(l)),v[d]=E,p/=2,d++}for(g=v.length,y=1;g!==1;){for(_=0;_<g-1;_++)x[_]=(a.pow(4,y)*v[_+1]-v[_])/(a.pow(4,y)-1);g=x.length,v=x,x=[],y++}return v},richardson:function(u,o,l,h){function d(k,F){for(var b=0,L=k.length,U;b<L;b++)k[b]===F&&(U=b);return U}for(var p=a.abs(l-u[d(u,l)+1]),m=0,x=[],v=[],y,g,_,w,E;h>=p;)y=d(u,l+h),g=d(u,l),x[m]=(o[y]-2*o[g]+o[2*g-y])/(h*h),h/=2,m++;for(w=x.length,_=1;w!=1;){for(E=0;E<w-1;E++)v[E]=(a.pow(4,_)*x[E+1]-x[E])/(a.pow(4,_)-1);w=v.length,x=v,v=[],_++}return x},simpson:function(u,o,l,h){for(var d=(l-o)/h,p=u(o),m=[],x=o,v=0,y=1,g;x<=l;x=x+d,v++)m[v]=x;for(g=m.length;y<g-1;y++)p+=(y%2!==0?4:2)*u(m[y]);return d/3*(p+u(l))},hermite:function(u,o,l,h){for(var d=u.length,p=0,m=0,x=[],v=[],y=[],g=[],_;m<d;m++){for(x[m]=1,_=0;_<d;_++)m!=_&&(x[m]*=(h-u[_])/(u[m]-u[_]));for(v[m]=0,_=0;_<d;_++)m!=_&&(v[m]+=1/(u[m]-u[_]));y[m]=(1-2*(h-u[m])*v[m])*(x[m]*x[m]),g[m]=(h-u[m])*(x[m]*x[m]),p+=y[m]*o[m]+g[m]*l[m]}return p},lagrange:function(u,o,l){for(var h=0,d=0,p,m,x=u.length;d<x;d++){for(m=o[d],p=0;p<x;p++)d!=p&&(m*=(l-u[p])/(u[d]-u[p]));h+=m}return h},cubic_spline:function(u,o,l){for(var h=u.length,d=0,p,m=[],x=[],v=[],y=[],g=[],_=[],w=[];d<h-1;d++)g[d]=u[d+1]-u[d];for(v[0]=0,d=1;d<h-1;d++)v[d]=3/g[d]*(o[d+1]-o[d])-3/g[d-1]*(o[d]-o[d-1]);for(d=1;d<h-1;d++)m[d]=[],x[d]=[],m[d][d-1]=g[d-1],m[d][d]=2*(g[d-1]+g[d]),m[d][d+1]=g[d],x[d][0]=v[d];for(y=n.multiply(n.inv(m),x),p=0;p<h-1;p++)_[p]=(o[p+1]-o[p])/g[p]-g[p]*(y[p+1][0]+2*y[p][0])/3,w[p]=(y[p+1][0]-y[p][0])/(3*g[p]);for(p=0;p<h&&!(u[p]>l);p++);return p-=1,o[p]+(l-u[p])*_[p]+n.sq(l-u[p])*y[p]+(l-u[p])*n.sq(l-u[p])*w[p]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(u){var o=u.length,l=u[0].length,h=0,d,p,m=[],x=[],v=[],y=[],g=[],_=[],w=[],E=[],k=[],F=[];for(h=0;h<o;h++)m[h]=n.sum(u[h])/l;for(h=0;h<l;h++)for(w[h]=[],d=0;d<o;d++)w[h][d]=u[d][h]-m[d];for(w=n.transpose(w),h=0;h<o;h++)for(E[h]=[],d=0;d<o;d++)E[h][d]=n.dot([w[h]],[w[d]])/(l-1);for(v=n.jacobi(E),k=v[0],x=v[1],F=n.transpose(k),h=0;h<x.length;h++)for(d=h;d<x.length;d++)x[h]<x[d]&&(p=x[h],x[h]=x[d],x[d]=p,y=F[h],F[h]=F[d],F[d]=y);for(_=n.transpose(w),h=0;h<o;h++)for(g[h]=[],d=0;d<_.length;d++)g[h][d]=n.dot([F[h]],[_[d]]);return[u,x,F,g]}}),function(f){for(var u=0;u<f.length;u++)(function(o){n.fn[o]=function(l,h){var d=this;return h?(setTimeout(function(){h.call(d,n.fn[o].call(d,l))},15),this):typeof n[o](this,l)=="number"?n[o](this,l):n(n[o](this,l))}})(f[u])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(n,a){var i=[].slice,s=n.utils.isNumber,c=n.utils.isArray;n.extend({zscore:function(){var o=i.call(arguments);return s(o[1])?(o[0]-o[1])/o[2]:(o[0]-n.mean(o[1]))/n.stdev(o[1],o[2])},ztest:function(){var o=i.call(arguments),l;return c(o[1])?(l=n.zscore(o[0],o[1],o[3]),o[2]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2):o.length>2?(l=n.zscore(o[0],o[1],o[2]),o[3]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2):(l=o[0],o[1]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2)}}),n.extend(n.fn,{zscore:function(o,l){return(o-this.mean())/this.stdev(l)},ztest:function(o,l,h){var d=a.abs(this.zscore(o,h));return l===1?n.normal.cdf(-d,0,1):n.normal.cdf(-d,0,1)*2}}),n.extend({tscore:function(){var o=i.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/a.sqrt(o[3])):(o[0]-n.mean(o[1]))/(n.stdev(o[1],!0)/a.sqrt(o[1].length))},ttest:function(){var o=i.call(arguments),l;return o.length===5?(l=a.abs(n.tscore(o[0],o[1],o[2],o[3])),o[4]===1?n.studentt.cdf(-l,o[3]-1):n.studentt.cdf(-l,o[3]-1)*2):s(o[1])?(l=a.abs(o[0]),o[2]==1?n.studentt.cdf(-l,o[1]-1):n.studentt.cdf(-l,o[1]-1)*2):(l=a.abs(n.tscore(o[0],o[1])),o[2]==1?n.studentt.cdf(-l,o[1].length-1):n.studentt.cdf(-l,o[1].length-1)*2)}}),n.extend(n.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/a.sqrt(this.cols()))},ttest:function(o,l){return l===1?1-n.studentt.cdf(a.abs(this.tscore(o)),this.cols()-1):n.studentt.cdf(-a.abs(this.tscore(o)),this.cols()-1)*2}}),n.extend({anovafscore:function(){var o=i.call(arguments),l,h,d,p,m,x,v,y;if(o.length===1){for(m=new Array(o[0].length),v=0;v<o[0].length;v++)m[v]=o[0][v];o=m}for(h=new Array,v=0;v<o.length;v++)h=h.concat(o[v]);for(d=n.mean(h),l=0,v=0;v<o.length;v++)l=l+o[v].length*a.pow(n.mean(o[v])-d,2);for(l/=o.length-1,x=0,v=0;v<o.length;v++)for(p=n.mean(o[v]),y=0;y<o[v].length;y++)x+=a.pow(o[v][y]-p,2);return x/=h.length-o.length,l/x},anovaftest:function(){var o=i.call(arguments),l,h,d,p;if(s(o[0]))return 1-n.centralF.cdf(o[0],o[1],o[2]);var m=n.anovafscore(o);for(l=o.length-1,d=0,p=0;p<o.length;p++)d=d+o[p].length;return h=d-l-1,1-n.centralF.cdf(m,l,h)},ftest:function(o,l,h){return 1-n.centralF.cdf(o,l,h)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){var o=0,l;for(l=0;l<this.length;l++)o=o+this[l].length;return n.ftest(this.anovafscore(),this.length-1,o-this.length)}}),n.extend({qscore:function(){var o=i.call(arguments),l,h,d,p,m;return s(o[0])?(l=o[0],h=o[1],d=o[2],p=o[3],m=o[4]):(l=n.mean(o[0]),h=n.mean(o[1]),d=o[0].length,p=o[1].length,m=o[2]),a.abs(l-h)/(m*a.sqrt((1/d+1/p)/2))},qtest:function(){var o=i.call(arguments),l;o.length===3?(l=o[0],o=o.slice(1)):o.length===7?(l=n.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(l=n.qscore(o[0],o[1],o[2]),o=o.slice(3));var h=o[0],d=o[1];return 1-n.tukey.cdf(l,d,h-d)},tukeyhsd:function(o){for(var l=n.pooledstdev(o),h=o.map(function(y){return n.mean(y)}),d=o.reduce(function(y,g){return y+g.length},0),p=[],m=0;m<o.length;++m)for(var x=m+1;x<o.length;++x){var v=n.qtest(h[m],h[x],o[m].length,o[x].length,l,d,o.length);p.push([[m,x],v])}return p}}),n.extend({normalci:function(){var o=i.call(arguments),l=new Array(2),h;return o.length===4?h=a.abs(n.normal.inv(o[1]/2,0,1)*o[2]/a.sqrt(o[3])):h=a.abs(n.normal.inv(o[1]/2,0,1)*n.stdev(o[2])/a.sqrt(o[2].length)),l[0]=o[0]-h,l[1]=o[0]+h,l},tci:function(){var o=i.call(arguments),l=new Array(2),h;return o.length===4?h=a.abs(n.studentt.inv(o[1]/2,o[3]-1)*o[2]/a.sqrt(o[3])):h=a.abs(n.studentt.inv(o[1]/2,o[2].length-1)*n.stdev(o[2],!0)/a.sqrt(o[2].length)),l[0]=o[0]-h,l[1]=o[0]+h,l},significant:function(o,l){return o<l}}),n.extend(n.fn,{normalci:function(o,l){return n.normalci(o,l,this.toArray())},tci:function(o,l){return n.tci(o,l,this.toArray())}});function f(u,o,l,h){if(u>1||l>1||u<=0||l<=0)throw new Error("Proportions should be greater than 0 and less than 1");var d=(u*o+l*h)/(o+h),p=a.sqrt(d*(1-d)*(1/o+1/h));return(u-l)/p}n.extend(n.fn,{oneSidedDifferenceOfProportions:function(o,l,h,d){var p=f(o,l,h,d);return n.ztest(p,1)},twoSidedDifferenceOfProportions:function(o,l,h,d){var p=f(o,l,h,d);return n.ztest(p,2)}})}(r,Math),r.models=function(){function n(f){var u=f[0].length,o=r.arange(u).map(function(l){var h=r.arange(u).filter(function(d){return d!==l});return a(r.col(f,l).map(function(d){return d[0]}),r.col(f,h))});return o}function a(f,u){var o=f.length,l=u[0].length-1,h=o-l-1,d=r.lstsq(u,f),p=r.multiply(u,d.map(function(w){return[w]})).map(function(w){return w[0]}),m=r.subtract(f,p),x=r.mean(f),v=r.sum(p.map(function(w){return Math.pow(w-x,2)})),y=r.sum(f.map(function(w,E){return Math.pow(w-p[E],2)})),g=v+y,_=v/g;return{exog:u,endog:f,nobs:o,df_model:l,df_resid:h,coef:d,predict:p,resid:m,ybar:x,SST:g,SSE:v,SSR:y,R2:_}}function i(f){var u=n(f.exog),o=Math.sqrt(f.SSR/f.df_resid),l=u.map(function(x){var v=x.SST,y=x.R2;return o/Math.sqrt(v*(1-y))}),h=f.coef.map(function(x,v){return(x-0)/l[v]}),d=h.map(function(x){var v=r.studentt.cdf(x,f.df_resid);return(v>.5?1-v:v)*2}),p=r.studentt.inv(.975,f.df_resid),m=f.coef.map(function(x,v){var y=p*l[v];return[x-y,x+y]});return{se:l,t:h,p:d,sigmaHat:o,interval95:m}}function s(f){var u=f.R2/f.df_model/((1-f.R2)/f.df_resid),o=function(h,d,p){return r.beta.cdf(h/(p/d+h),d/2,p/2)},l=1-o(u,f.df_model,f.df_resid);return{F_statistic:u,pvalue:l}}function c(f,u){var o=a(f,u),l=i(o),h=s(o),d=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=l,o.f=h,o.adjust_R2=d,o}return{ols:c}}(),r.extend({buildxmatrix:function(){for(var a=new Array(arguments.length),i=0;i<arguments.length;i++){var s=[1];a[i]=s.concat(arguments[i])}return r(a)},builddxmatrix:function(){for(var a=new Array(arguments[0].length),i=0;i<arguments[0].length;i++){var s=[1];a[i]=s.concat(arguments[0][i])}return r(a)},buildjxmatrix:function(a){for(var i=new Array(a.length),s=0;s<a.length;s++)i[s]=a[s];return r.builddxmatrix(i)},buildymatrix:function(a){return r(a).transpose()},buildjymatrix:function(a){return a.transpose()},matrixmult:function(a,i){var s,c,f,u,o;if(a.cols()==i.rows()){if(i.rows()>1){for(u=[],s=0;s<a.rows();s++)for(u[s]=[],c=0;c<i.cols();c++){for(o=0,f=0;f<a.cols();f++)o+=a.toArray()[s][f]*i.toArray()[f][c];u[s][c]=o}return r(u)}for(u=[],s=0;s<a.rows();s++)for(u[s]=[],c=0;c<i.cols();c++){for(o=0,f=0;f<a.cols();f++)o+=a.toArray()[s][f]*i.toArray()[c];u[s][c]=o}return r(u)}},regress:function(a,i){var s=r.xtranspxinv(a),c=a.transpose(),f=r.matrixmult(r(s),c);return r.matrixmult(f,i)},regresst:function(a,i,s){var c=r.regress(a,i),f={};f.anova={};var u=r.jMatYBar(a,c);f.yBar=u;var o=i.mean();f.anova.residuals=r.residuals(i,u),f.anova.ssr=r.ssr(u,o),f.anova.msr=f.anova.ssr/(a[0].length-1),f.anova.sse=r.sse(i,u),f.anova.mse=f.anova.sse/(i.length-(a[0].length-1)-1),f.anova.sst=r.sst(i,o),f.anova.mst=f.anova.sst/(i.length-1),f.anova.r2=1-f.anova.sse/f.anova.sst,f.anova.r2<0&&(f.anova.r2=0),f.anova.fratio=f.anova.msr/f.anova.mse,f.anova.pvalue=r.anovaftest(f.anova.fratio,a[0].length-1,i.length-(a[0].length-1)-1),f.anova.rmse=Math.sqrt(f.anova.mse),f.anova.r2adj=1-f.anova.mse/f.anova.mst,f.anova.r2adj<0&&(f.anova.r2adj=0),f.stats=new Array(a[0].length);for(var l=r.xtranspxinv(a),h,d,p,m=0;m<c.length;m++)h=Math.sqrt(f.anova.mse*Math.abs(l[m][m])),d=Math.abs(c[m]/h),p=r.ttest(d,i.length-a[0].length-1,s),f.stats[m]=[c[m],h,d,p];return f.regress=c,f},xtranspx:function(a){return r.matrixmult(a.transpose(),a)},xtranspxinv:function(a){var i=r.matrixmult(a.transpose(),a),s=r.inv(i);return s},jMatYBar:function(a,i){var s=r.matrixmult(a,i);return new r(s)},residuals:function(a,i){return r.matrixsubtract(a,i)},ssr:function(a,i){for(var s=0,c=0;c<a.length;c++)s+=Math.pow(a[c]-i,2);return s},sse:function(a,i){for(var s=0,c=0;c<a.length;c++)s+=Math.pow(a[c]-i[c],2);return s},sst:function(a,i){for(var s=0,c=0;c<a.length;c++)s+=Math.pow(a[c]-i,2);return s},matrixsubtract:function(a,i){for(var s=new Array(a.length),c=0;c<a.length;c++){s[c]=new Array(a[c].length);for(var f=0;f<a[c].length;f++)s[c][f]=a[c][f]-i[c][f]}return r(s)}}),r.jStat=r,r})}(Oo)),Oo.exports}var h0=zb();function Gb(e){if(e.length===0)return 0;var t=e[0],r=0,n;if(typeof t!="number")return Number.NaN;for(var a=1;a<e.length;a++){if(typeof e[a]!="number")return Number.NaN;n=t+e[a],Math.abs(t)>=Math.abs(e[a])?r+=t-n+e[a]:r+=e[a]-n+t,t=n}return t+r}function d0(e){if(e.length===0)throw new Error("mean requires at least one data point");return Gb(e)/e.length}function qb(e,t){var r=d0(e),n=0,a,i;for(i=0;i<e.length;i++)a=e[i]-r,n+=a*a;return n}function Kb(e,t){if(e.length!==t.length)throw new Error("sampleCovariance requires samples with equal lengths");if(e.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var r=d0(e),n=d0(t),a=0,i=0;i<e.length;i++)a+=(e[i]-r)*(t[i]-n);var s=e.length-1;return a/s}function Xb(e){if(e.length<2)throw new Error("sampleVariance requires at least two data points");var t=qb(e),r=e.length-1;return t/r}function n1(e){var t=Xb(e);return Math.sqrt(t)}function Yb(e,t){var r=Kb(e,t),n=n1(e),a=n1(t);return r/n/a}function vt(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Jb=typeof Symbol=="function"&&Symbol.observable||"@@observable",a1=Jb,p0=()=>Math.random().toString(36).substring(7).split("").join("."),Qb={INIT:`@@redux/INIT${p0()}`,REPLACE:`@@redux/REPLACE${p0()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${p0()}`},Ro=Qb;function m0(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function i1(e,t,r){if(typeof e!="function")throw new Error(vt(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(vt(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(vt(1));return r(i1)(e,t)}let n=e,a=t,i=new Map,s=i,c=0,f=!1;function u(){s===i&&(s=new Map,i.forEach((x,v)=>{s.set(v,x)}))}function o(){if(f)throw new Error(vt(3));return a}function l(x){if(typeof x!="function")throw new Error(vt(4));if(f)throw new Error(vt(5));let v=!0;u();const y=c++;return s.set(y,x),function(){if(v){if(f)throw new Error(vt(6));v=!1,u(),s.delete(y),i=null}}}function h(x){if(!m0(x))throw new Error(vt(7));if(typeof x.type>"u")throw new Error(vt(8));if(typeof x.type!="string")throw new Error(vt(17));if(f)throw new Error(vt(9));try{f=!0,a=n(a,x)}finally{f=!1}return(i=s).forEach(y=>{y()}),x}function d(x){if(typeof x!="function")throw new Error(vt(10));n=x,h({type:Ro.REPLACE})}function p(){const x=l;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(vt(11));function y(){const _=v;_.next&&_.next(o())}return y(),{unsubscribe:x(y)}},[a1](){return this}}}return h({type:Ro.INIT}),{dispatch:h,subscribe:l,getState:o,replaceReducer:d,[a1]:p}}function Zb(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Ro.INIT})>"u")throw new Error(vt(12));if(typeof r(void 0,{type:Ro.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(vt(13))})}function s1(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{Zb(r)}catch(i){a=i}return function(s={},c){if(a)throw a;let f=!1;const u={};for(let o=0;o<n.length;o++){const l=n[o],h=r[l],d=s[l],p=h(d,c);if(typeof p>"u")throw c&&c.type,new Error(vt(14));u[l]=p,f=f||p!==d}return f=f||n.length!==Object.keys(s).length,f?u:s}}function No(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function jb(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(vt(15))};const s={getState:a.getState,dispatch:(f,...u)=>i(f,...u)},c=e.map(f=>f(s));return i=No(...c)(a.dispatch),{...a,dispatch:i}}}function eS(e){return m0(e)&&"type"in e&&typeof e.type=="string"}var o1=Symbol.for("immer-nothing"),c1=Symbol.for("immer-draftable"),qt=Symbol.for("immer-state");function Tr(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var za=Object.getPrototypeOf;function Zn(e){return!!e&&!!e[qt]}function sn(e){var t;return e?u1(e)||Array.isArray(e)||!!e[c1]||!!((t=e.constructor)!=null&&t[c1])||Lo(e)||Bo(e):!1}var tS=Object.prototype.constructor.toString();function u1(e){if(!e||typeof e!="object")return!1;const t=za(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===tS}function Do(e,t){Po(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Po(e){const t=e[qt];return t?t.type_:Array.isArray(e)?1:Lo(e)?2:Bo(e)?3:0}function x0(e,t){return Po(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function f1(e,t,r){const n=Po(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function rS(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Lo(e){return e instanceof Map}function Bo(e){return e instanceof Set}function jn(e){return e.copy_||e.base_}function g0(e,t){if(Lo(e))return new Map(e);if(Bo(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=u1(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[qt];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],c=n[s];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[s]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[s]})}return Object.create(za(e),n)}else{const n=za(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function v0(e,t=!1){return Mo(e)||Zn(e)||!sn(e)||(Po(e)>1&&(e.set=e.add=e.clear=e.delete=nS),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>v0(n,!0))),e}function nS(){Tr(2)}function Mo(e){return Object.isFrozen(e)}var aS={};function ea(e){const t=aS[e];return t||Tr(0,e),t}var Ui;function l1(){return Ui}function iS(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function h1(e,t){t&&(ea("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function _0(e){y0(e),e.drafts_.forEach(sS),e.drafts_=null}function y0(e){e===Ui&&(Ui=e.parent_)}function d1(e){return Ui=iS(Ui,e)}function sS(e){const t=e[qt];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function p1(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[qt].modified_&&(_0(t),Tr(4)),sn(e)&&(e=Uo(t,e),t.parent_||Vo(t,e)),t.patches_&&ea("Patches").generateReplacementPatches_(r[qt].base_,e,t.patches_,t.inversePatches_)):e=Uo(t,r,[]),_0(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==o1?e:void 0}function Uo(e,t,r){if(Mo(t))return t;const n=t[qt];if(!n)return Do(t,(a,i)=>m1(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Vo(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),Do(i,(c,f)=>m1(e,n,a,c,f,r,s)),Vo(e,a,!1),r&&e.patches_&&ea("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function m1(e,t,r,n,a,i,s){if(Zn(a)){const c=i&&t&&t.type_!==3&&!x0(t.assigned_,n)?i.concat(n):void 0,f=Uo(e,a,c);if(f1(r,n,f),Zn(f))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(sn(a)&&!Mo(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Uo(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Vo(e,a)}}function Vo(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&v0(t,r)}function oS(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:l1(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=w0;r&&(a=[n],i=Vi);const{revoke:s,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=s,c}var w0={get(e,t){if(t===qt)return e;const r=jn(e);if(!x0(r,t))return cS(e,r,t);const n=r[t];return e.finalized_||!sn(n)?n:n===E0(e.base_,t)?(T0(e),e.copy_[t]=A0(n,e)):n},has(e,t){return t in jn(e)},ownKeys(e){return Reflect.ownKeys(jn(e))},set(e,t,r){const n=x1(jn(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=E0(jn(e),t),i=a==null?void 0:a[qt];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(rS(r,a)&&(r!==void 0||x0(e.base_,t)))return!0;T0(e),k0(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return E0(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,T0(e),k0(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=jn(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Tr(11)},getPrototypeOf(e){return za(e.base_)},setPrototypeOf(){Tr(12)}},Vi={};Do(w0,(e,t)=>{Vi[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Vi.deleteProperty=function(e,t){return Vi.set.call(this,e,t,void 0)},Vi.set=function(e,t,r){return w0.set.call(this,e[0],t,r,e[0])};function E0(e,t){const r=e[qt];return(r?jn(r):e)[t]}function cS(e,t,r){var a;const n=x1(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function x1(e,t){if(!(t in e))return;let r=za(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=za(r)}}function k0(e){e.modified_||(e.modified_=!0,e.parent_&&k0(e.parent_))}function T0(e){e.copy_||(e.copy_=g0(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var uS=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(f=i,...u){return s.produce(f,o=>r.call(this,o,...u))}}typeof r!="function"&&Tr(6),n!==void 0&&typeof n!="function"&&Tr(7);let a;if(sn(t)){const i=d1(this),s=A0(t,void 0);let c=!0;try{a=r(s),c=!1}finally{c?_0(i):y0(i)}return h1(i,n),p1(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===o1&&(a=void 0),this.autoFreeze_&&v0(a,!0),n){const i=[],s=[];ea("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Tr(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...c)=>this.produceWithPatches(s,f=>t(f,...c));let n,a;return[this.produce(t,r,(s,c)=>{n=s,a=c}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){sn(e)||Tr(8),Zn(e)&&(e=fS(e));const t=d1(this),r=A0(e,void 0);return r[qt].isManual_=!0,y0(t),r}finishDraft(e,t){const r=e&&e[qt];(!r||!r.isManual_)&&Tr(9);const{scope_:n}=r;return h1(n,t),p1(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=ea("Patches").applyPatches_;return Zn(e)?n(e,t):this.produce(e,a=>n(a,t))}};function A0(e,t){const r=Lo(e)?ea("MapSet").proxyMap_(e,t):Bo(e)?ea("MapSet").proxySet_(e,t):oS(e,t);return(t?t.scope_:l1()).drafts_.push(r),r}function fS(e){return Zn(e)||Tr(10,e),g1(e)}function g1(e){if(!sn(e)||Mo(e))return e;const t=e[qt];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=g0(e,t.scope_.immer_.useStrictShallowCopy_)}else r=g0(e,!0);return Do(r,(n,a)=>{f1(r,n,g1(a))}),t&&(t.finalized_=!1),r}var Kt=new uS,v1=Kt.produce;Kt.produceWithPatches.bind(Kt),Kt.setAutoFreeze.bind(Kt),Kt.setUseStrictShallowCopy.bind(Kt),Kt.applyPatches.bind(Kt),Kt.createDraft.bind(Kt),Kt.finishDraft.bind(Kt);function _1(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var lS=_1(),hS=_1,dS=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?No:No.apply(null,arguments)},pS=e=>e&&typeof e.match=="function";function $i(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(on(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>eS(n)&&n.type===e,r}var y1=class Is extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Is.prototype)}static get[Symbol.species](){return Is}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Is(...t[0].concat(this)):new Is(...t.concat(this))}};function w1(e){return sn(e)?v1(e,()=>{}):e}function E1(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function mS(e){return typeof e=="boolean"}var xS=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new y1;return r&&(mS(r)?s.push(lS):s.push(hS(r.extraArgument))),s},gS="RTK_autoBatch",k1=e=>t=>{setTimeout(t,e)},vS=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const c=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:k1(10):e.type==="callback"?e.queueNotification:k1(e.timeout),u=()=>{s=!1,i&&(i=!1,c.forEach(o=>o()))};return Object.assign({},n,{subscribe(o){const l=()=>a&&o(),h=n.subscribe(l);return c.add(o),()=>{h(),c.delete(o)}},dispatch(o){var l;try{return a=!((l=o==null?void 0:o.meta)!=null&&l[gS]),i=!a,i&&(s||(s=!0,f(u))),n.dispatch(o)}finally{a=!0}}})},_S=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new y1(e);return n&&a.push(vS(typeof n=="object"?n:void 0)),a};function yS(e){const t=xS(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(m0(r))c=s1(r);else throw new Error(on(1));let f;typeof n=="function"?f=n(t):f=t();let u=No;a&&(u=dS({trace:!1,...typeof a=="object"&&a}));const o=jb(...f),l=_S(o);let h=typeof s=="function"?s(l):l();const d=u(...h);return i1(c,i,d)}function T1(e){const t={},r=[];let n;const a={addCase(i,s){const c=typeof i=="string"?i:i.type;if(!c)throw new Error(on(28));if(c in t)throw new Error(on(29));return t[c]=s,a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function wS(e){return typeof e=="function"}function ES(e,t){let[r,n,a]=T1(t),i;if(wS(e))i=()=>w1(e());else{const c=w1(e);i=()=>c}function s(c=i(),f){let u=[r[f.type],...n.filter(({matcher:o})=>o(f)).map(({reducer:o})=>o)];return u.filter(o=>!!o).length===0&&(u=[a]),u.reduce((o,l)=>{if(l)if(Zn(o)){const d=l(o,f);return d===void 0?o:d}else{if(sn(o))return v1(o,h=>l(h,f));{const h=l(o,f);if(h===void 0){if(o===null)return o;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return o},c)}return s.getInitialState=i,s}var kS=(e,t)=>pS(e)?e.match(t):e(t);function TS(...e){return t=>e.some(r=>kS(r,t))}var AS="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",CS=(e=21)=>{let t="",r=e;for(;r--;)t+=AS[Math.random()*64|0];return t},bS=["name","message","stack","code"],C0=class{constructor(e,t){Wn(this,"_type");this.payload=e,this.meta=t}},A1=class{constructor(e,t){Wn(this,"_type");this.payload=e,this.meta=t}},SS=e=>{if(typeof e=="object"&&e!==null){const t={};for(const r of bS)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},C1="External signal was aborted",Me=(()=>{function e(t,r,n){const a=$i(t+"/fulfilled",(f,u,o,l)=>({payload:f,meta:{...l||{},arg:o,requestId:u,requestStatus:"fulfilled"}})),i=$i(t+"/pending",(f,u,o)=>({payload:void 0,meta:{...o||{},arg:u,requestId:f,requestStatus:"pending"}})),s=$i(t+"/rejected",(f,u,o,l,h)=>({payload:l,error:(n&&n.serializeError||SS)(f||"Rejected"),meta:{...h||{},arg:o,requestId:u,rejectedWithValue:!!l,requestStatus:"rejected",aborted:(f==null?void 0:f.name)==="AbortError",condition:(f==null?void 0:f.name)==="ConditionError"}}));function c(f,{signal:u}={}){return(o,l,h)=>{const d=n!=null&&n.idGenerator?n.idGenerator(f):CS(),p=new AbortController;let m,x;function v(g){x=g,p.abort()}u&&(u.aborted?v(C1):u.addEventListener("abort",()=>v(C1),{once:!0}));const y=async function(){var w,E;let g;try{let k=(w=n==null?void 0:n.condition)==null?void 0:w.call(n,f,{getState:l,extra:h});if(IS(k)&&(k=await k),k===!1||p.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const F=new Promise((b,L)=>{m=()=>{L({name:"AbortError",message:x||"Aborted"})},p.signal.addEventListener("abort",m)});o(i(d,f,(E=n==null?void 0:n.getPendingMeta)==null?void 0:E.call(n,{requestId:d,arg:f},{getState:l,extra:h}))),g=await Promise.race([F,Promise.resolve(r(f,{dispatch:o,getState:l,extra:h,requestId:d,signal:p.signal,abort:v,rejectWithValue:(b,L)=>new C0(b,L),fulfillWithValue:(b,L)=>new A1(b,L)})).then(b=>{if(b instanceof C0)throw b;return b instanceof A1?a(b.payload,d,f,b.meta):a(b,d,f)})])}catch(k){g=k instanceof C0?s(null,d,f,k.payload,k.meta):s(k,d,f)}finally{m&&p.signal.removeEventListener("abort",m)}return n&&!n.dispatchConditionRejection&&s.match(g)&&g.meta.condition||o(g),g}();return Object.assign(y,{abort:v,requestId:d,arg:f,unwrap(){return y.then(FS)}})}}return Object.assign(c,{pending:i,rejected:s,fulfilled:a,settled:TS(s,a),typePrefix:t})}return e.withTypes=()=>e,e})();function FS(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function IS(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var OS=Symbol.for("rtk-slice-createasyncthunk");function RS(e,t){return`${e}/${t}`}function NS({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[OS];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(on(11));const c=(typeof a.reducers=="function"?a.reducers(PS()):a.reducers)||{},f=Object.keys(c),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},o={addCase(g,_){const w=typeof g=="string"?g:g.type;if(!w)throw new Error(on(12));if(w in u.sliceCaseReducersByType)throw new Error(on(13));return u.sliceCaseReducersByType[w]=_,o},addMatcher(g,_){return u.sliceMatchers.push({matcher:g,reducer:_}),o},exposeAction(g,_){return u.actionCreators[g]=_,o},exposeCaseReducer(g,_){return u.sliceCaseReducersByName[g]=_,o}};f.forEach(g=>{const _=c[g],w={reducerName:g,type:RS(i,g),createNotation:typeof a.reducers=="function"};BS(_)?US(w,_,o,t):LS(w,_,o)});function l(){const[g={},_=[],w=void 0]=typeof a.extraReducers=="function"?T1(a.extraReducers):[a.extraReducers],E={...g,...u.sliceCaseReducersByType};return ES(a.initialState,k=>{for(let F in E)k.addCase(F,E[F]);for(let F of u.sliceMatchers)k.addMatcher(F.matcher,F.reducer);for(let F of _)k.addMatcher(F.matcher,F.reducer);w&&k.addDefaultCase(w)})}const h=g=>g,d=new Map;let p;function m(g,_){return p||(p=l()),p(g,_)}function x(){return p||(p=l()),p.getInitialState()}function v(g,_=!1){function w(k){let F=k[g];return typeof F>"u"&&_&&(F=x()),F}function E(k=h){const F=E1(d,_,()=>new WeakMap);return E1(F,k,()=>{const b={};for(const[L,U]of Object.entries(a.selectors??{}))b[L]=DS(U,k,x,_);return b})}return{reducerPath:g,getSelectors:E,get selectors(){return E(w)},selectSlice:w}}const y={name:i,reducer:m,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:x,...v(s),injectInto(g,{reducerPath:_,...w}={}){const E=_??s;return g.inject({reducerPath:E,reducer:m},w),{...y,...v(E,!0)}}};return y}}function DS(e,t,r,n){function a(i,...s){let c=t(i);return typeof c>"u"&&n&&(c=r()),e(c,...s)}return a.unwrapped=e,a}var or=NS();function PS(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function LS({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!MS(n))throw new Error(on(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?$i(e,s):$i(e))}function BS(e){return e._reducerDefinitionType==="asyncThunk"}function MS(e){return e._reducerDefinitionType==="reducerWithPrepare"}function US({type:e,reducerName:t},r,n,a){if(!a)throw new Error(on(18));const{payloadCreator:i,fulfilled:s,pending:c,rejected:f,settled:u,options:o}=r,l=a(e,i,o);n.exposeAction(t,l),s&&n.addCase(l.fulfilled,s),c&&n.addCase(l.pending,c),f&&n.addCase(l.rejected,f),u&&n.addMatcher(l.settled,u),n.exposeCaseReducer(t,{fulfilled:s||$o,pending:c||$o,rejected:f||$o,settled:u||$o})}function $o(){}function on(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}const VS=[{value:"euclidean",label:"L2"},{value:"chebyshev",label:"Chebyshev"},{value:"hamming",label:"Hamming"},{value:"manhattan",label:"Manhattan"},{value:"jaccard",label:"Jaccard"},{value:"braycurtis",label:"Braycurtis"}],$S=[{value:"optimal_leaf",label:"Optimal"},{value:"anatomical",label:"Anatomical"},{value:"spectral",label:"Spectral"},{value:"pca",label:"PCA"},{value:"cuthill",label:"Cuthil"},{value:"rcm",label:"Inverse"}];function Ho(e,t,r){let n=[];return e.forEach(a=>{const i=t.some(c=>c.x_node===a.x_node&&c.y_node===a.y_node);if(r&&!i||!r&&i){const c=HS({x_node:a.x_node,y_node:a.y_node});n.push(c)}}),n}function HS(e){const t={};return t.key=e.x_node+e.y_node,t.x_node=e.x_node,t.y_node=e.y_node,t}function b1(e,t){return function(){return e.apply(t,arguments)}}const{toString:WS}=Object.prototype,{getPrototypeOf:b0}=Object,Wo=(e=>t=>{const r=WS.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ar=e=>(e=e.toLowerCase(),t=>Wo(t)===e),zo=e=>t=>typeof t===e,{isArray:Ga}=Array,Hi=zo("undefined");function zS(e){return e!==null&&!Hi(e)&&e.constructor!==null&&!Hi(e.constructor)&&Xt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const S1=Ar("ArrayBuffer");function GS(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&S1(e.buffer),t}const qS=zo("string"),Xt=zo("function"),F1=zo("number"),Go=e=>e!==null&&typeof e=="object",KS=e=>e===!0||e===!1,qo=e=>{if(Wo(e)!=="object")return!1;const t=b0(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},XS=Ar("Date"),YS=Ar("File"),JS=Ar("Blob"),QS=Ar("FileList"),ZS=e=>Go(e)&&Xt(e.pipe),jS=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Xt(e.append)&&((t=Wo(e))==="formdata"||t==="object"&&Xt(e.toString)&&e.toString()==="[object FormData]"))},eF=Ar("URLSearchParams"),[tF,rF,nF,aF]=["ReadableStream","Request","Response","Headers"].map(Ar),iF=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wi(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Ga(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let c;for(n=0;n<s;n++)c=i[n],t.call(null,e[c],c,e)}}function I1(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const ta=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,O1=e=>!Hi(e)&&e!==ta;function S0(){const{caseless:e}=O1(this)&&this||{},t={},r=(n,a)=>{const i=e&&I1(t,a)||a;qo(t[i])&&qo(n)?t[i]=S0(t[i],n):qo(n)?t[i]=S0({},n):Ga(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&Wi(arguments[n],r);return t}const sF=(e,t,r,{allOwnKeys:n}={})=>(Wi(t,(a,i)=>{r&&Xt(a)?e[i]=b1(a,r):e[i]=a},{allOwnKeys:n}),e),oF=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),cF=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},uF=(e,t,r,n)=>{let a,i,s;const c={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)s=a[i],(!n||n(s,e,t))&&!c[s]&&(t[s]=e[s],c[s]=!0);e=r!==!1&&b0(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},fF=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},lF=e=>{if(!e)return null;if(Ga(e))return e;let t=e.length;if(!F1(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},hF=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&b0(Uint8Array)),dF=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},pF=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},mF=Ar("HTMLFormElement"),xF=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),R1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),gF=Ar("RegExp"),N1=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Wi(r,(a,i)=>{let s;(s=t(a,i,e))!==!1&&(n[i]=s||a)}),Object.defineProperties(e,n)},vF=e=>{N1(e,(t,r)=>{if(Xt(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Xt(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},_F=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return Ga(e)?n(e):n(String(e).split(t)),r},yF=()=>{},wF=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function EF(e){return!!(e&&Xt(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const kF=e=>{const t=new Array(10),r=(n,a)=>{if(Go(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=Ga(n)?[]:{};return Wi(n,(s,c)=>{const f=r(s,a+1);!Hi(f)&&(i[c]=f)}),t[a]=void 0,i}}return n};return r(e,0)},TF=Ar("AsyncFunction"),AF=e=>e&&(Go(e)||Xt(e))&&Xt(e.then)&&Xt(e.catch),D1=((e,t)=>e?setImmediate:t?((r,n)=>(ta.addEventListener("message",({source:a,data:i})=>{a===ta&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),ta.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Xt(ta.postMessage)),CF=typeof queueMicrotask<"u"?queueMicrotask.bind(ta):typeof process<"u"&&process.nextTick||D1;var K={isArray:Ga,isArrayBuffer:S1,isBuffer:zS,isFormData:jS,isArrayBufferView:GS,isString:qS,isNumber:F1,isBoolean:KS,isObject:Go,isPlainObject:qo,isReadableStream:tF,isRequest:rF,isResponse:nF,isHeaders:aF,isUndefined:Hi,isDate:XS,isFile:YS,isBlob:JS,isRegExp:gF,isFunction:Xt,isStream:ZS,isURLSearchParams:eF,isTypedArray:hF,isFileList:QS,forEach:Wi,merge:S0,extend:sF,trim:iF,stripBOM:oF,inherits:cF,toFlatObject:uF,kindOf:Wo,kindOfTest:Ar,endsWith:fF,toArray:lF,forEachEntry:dF,matchAll:pF,isHTMLForm:mF,hasOwnProperty:R1,hasOwnProp:R1,reduceDescriptors:N1,freezeMethods:vF,toObjectSet:_F,toCamelCase:xF,noop:yF,toFiniteNumber:wF,findKey:I1,global:ta,isContextDefined:O1,isSpecCompliantForm:EF,toJSONObject:kF,isAsyncFn:TF,isThenable:AF,setImmediate:D1,asap:CF};function we(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}K.inherits(we,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:K.toJSONObject(this.config),code:this.code,status:this.status}}});const P1=we.prototype,L1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{L1[e]={value:e}}),Object.defineProperties(we,L1),Object.defineProperty(P1,"isAxiosError",{value:!0}),we.from=(e,t,r,n,a,i)=>{const s=Object.create(P1);return K.toFlatObject(e,s,function(f){return f!==Error.prototype},c=>c!=="isAxiosError"),we.call(s,e.message,t,r,n,a),s.cause=e,s.name=e.name,i&&Object.assign(s,i),s};var bF=null;function F0(e){return K.isPlainObject(e)||K.isArray(e)}function B1(e){return K.endsWith(e,"[]")?e.slice(0,-2):e}function M1(e,t,r){return e?e.concat(t).map(function(a,i){return a=B1(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function SF(e){return K.isArray(e)&&!e.some(F0)}const FF=K.toFlatObject(K,{},null,function(t){return/^is[A-Z]/.test(t)});function Ko(e,t,r){if(!K.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=K.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,x){return!K.isUndefined(x[m])});const n=r.metaTokens,a=r.visitor||o,i=r.dots,s=r.indexes,f=(r.Blob||typeof Blob<"u"&&Blob)&&K.isSpecCompliantForm(t);if(!K.isFunction(a))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(K.isDate(p))return p.toISOString();if(!f&&K.isBlob(p))throw new we("Blob is not supported. Use a Buffer instead.");return K.isArrayBuffer(p)||K.isTypedArray(p)?f&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function o(p,m,x){let v=p;if(p&&!x&&typeof p=="object"){if(K.endsWith(m,"{}"))m=n?m:m.slice(0,-2),p=JSON.stringify(p);else if(K.isArray(p)&&SF(p)||(K.isFileList(p)||K.endsWith(m,"[]"))&&(v=K.toArray(p)))return m=B1(m),v.forEach(function(g,_){!(K.isUndefined(g)||g===null)&&t.append(s===!0?M1([m],_,i):s===null?m:m+"[]",u(g))}),!1}return F0(p)?!0:(t.append(M1(x,m,i),u(p)),!1)}const l=[],h=Object.assign(FF,{defaultVisitor:o,convertValue:u,isVisitable:F0});function d(p,m){if(!K.isUndefined(p)){if(l.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));l.push(p),K.forEach(p,function(v,y){(!(K.isUndefined(v)||v===null)&&a.call(t,v,K.isString(y)?y.trim():y,m,h))===!0&&d(v,m?m.concat(y):[y])}),l.pop()}}if(!K.isObject(e))throw new TypeError("data must be an object");return d(e),t}function U1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function I0(e,t){this._pairs=[],e&&Ko(e,this,t)}const V1=I0.prototype;V1.append=function(t,r){this._pairs.push([t,r])},V1.toString=function(t){const r=t?function(n){return t.call(this,n,U1)}:U1;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function IF(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function $1(e,t,r){if(!t)return e;const n=r&&r.encode||IF;K.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=K.isURLSearchParams(t)?t.toString():new I0(t,r).toString(n),i){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class H1{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){K.forEach(this.handlers,function(n){n!==null&&t(n)})}}var W1={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},OF=typeof URLSearchParams<"u"?URLSearchParams:I0,RF=typeof FormData<"u"?FormData:null,NF=typeof Blob<"u"?Blob:null,DF={isBrowser:!0,classes:{URLSearchParams:OF,FormData:RF,Blob:NF},protocols:["http","https","file","blob","url","data"]};const O0=typeof window<"u"&&typeof document<"u",R0=typeof navigator=="object"&&navigator||void 0,PF=O0&&(!R0||["ReactNative","NativeScript","NS"].indexOf(R0.product)<0),LF=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",BF=O0&&window.location.href||"http://localhost";var MF=Object.freeze({__proto__:null,hasBrowserEnv:O0,hasStandardBrowserEnv:PF,hasStandardBrowserWebWorkerEnv:LF,navigator:R0,origin:BF}),Et={...MF,...DF};function UF(e,t){return Ko(e,new Et.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return Et.isNode&&K.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function VF(e){return K.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function $F(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function z1(e){function t(r,n,a,i){let s=r[i++];if(s==="__proto__")return!0;const c=Number.isFinite(+s),f=i>=r.length;return s=!s&&K.isArray(a)?a.length:s,f?(K.hasOwnProp(a,s)?a[s]=[a[s],n]:a[s]=n,!c):((!a[s]||!K.isObject(a[s]))&&(a[s]=[]),t(r,n,a[s],i)&&K.isArray(a[s])&&(a[s]=$F(a[s])),!c)}if(K.isFormData(e)&&K.isFunction(e.entries)){const r={};return K.forEachEntry(e,(n,a)=>{t(VF(n),a,r,0)}),r}return null}function HF(e,t,r){if(K.isString(e))try{return(t||JSON.parse)(e),K.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const zi={transitional:W1,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=K.isObject(t);if(i&&K.isHTMLForm(t)&&(t=new FormData(t)),K.isFormData(t))return a?JSON.stringify(z1(t)):t;if(K.isArrayBuffer(t)||K.isBuffer(t)||K.isStream(t)||K.isFile(t)||K.isBlob(t)||K.isReadableStream(t))return t;if(K.isArrayBufferView(t))return t.buffer;if(K.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return UF(t,this.formSerializer).toString();if((c=K.isFileList(t))||n.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Ko(c?{"files[]":t}:t,f&&new f,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),HF(t)):t}],transformResponse:[function(t){const r=this.transitional||zi.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(K.isResponse(t)||K.isReadableStream(t))return t;if(t&&K.isString(t)&&(n&&!this.responseType||a)){const s=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(c){if(s)throw c.name==="SyntaxError"?we.from(c,we.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Et.classes.FormData,Blob:Et.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};K.forEach(["delete","get","head","post","put","patch"],e=>{zi.headers[e]={}});const WF=K.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var zF=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(s){a=s.indexOf(":"),r=s.substring(0,a).trim().toLowerCase(),n=s.substring(a+1).trim(),!(!r||t[r]&&WF[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t};const G1=Symbol("internals");function Gi(e){return e&&String(e).trim().toLowerCase()}function Xo(e){return e===!1||e==null?e:K.isArray(e)?e.map(Xo):String(e)}function GF(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const qF=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function N0(e,t,r,n,a){if(K.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!K.isString(t)){if(K.isString(n))return t.indexOf(n)!==-1;if(K.isRegExp(n))return n.test(t)}}function KF(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function XF(e,t){const r=K.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,s){return this[n].call(this,t,a,i,s)},configurable:!0})})}let Ht=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(c,f,u){const o=Gi(f);if(!o)throw new Error("header name must be a non-empty string");const l=K.findKey(a,o);(!l||a[l]===void 0||u===!0||u===void 0&&a[l]!==!1)&&(a[l||f]=Xo(c))}const s=(c,f)=>K.forEach(c,(u,o)=>i(u,o,f));if(K.isPlainObject(t)||t instanceof this.constructor)s(t,r);else if(K.isString(t)&&(t=t.trim())&&!qF(t))s(zF(t),r);else if(K.isHeaders(t))for(const[c,f]of t.entries())i(f,c,n);else t!=null&&i(r,t,n);return this}get(t,r){if(t=Gi(t),t){const n=K.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return GF(a);if(K.isFunction(r))return r.call(this,a,n);if(K.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Gi(t),t){const n=K.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||N0(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(s){if(s=Gi(s),s){const c=K.findKey(n,s);c&&(!r||N0(n,n[c],c,r))&&(delete n[c],a=!0)}}return K.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||N0(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return K.forEach(this,(a,i)=>{const s=K.findKey(n,i);if(s){r[s]=Xo(a),delete r[i];return}const c=t?KF(i):String(i).trim();c!==i&&delete r[i],r[c]=Xo(a),n[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return K.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&K.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[G1]=this[G1]={accessors:{}}).accessors,a=this.prototype;function i(s){const c=Gi(s);n[c]||(XF(a,s),n[c]=!0)}return K.isArray(t)?t.forEach(i):i(t),this}};Ht.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),K.reduceDescriptors(Ht.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}}),K.freezeMethods(Ht);function D0(e,t){const r=this||zi,n=t||r,a=Ht.from(n.headers);let i=n.data;return K.forEach(e,function(c){i=c.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function q1(e){return!!(e&&e.__CANCEL__)}function qa(e,t,r){we.call(this,e??"canceled",we.ERR_CANCELED,t,r),this.name="CanceledError"}K.inherits(qa,we,{__CANCEL__:!0});function K1(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new we("Request failed with status code "+r.status,[we.ERR_BAD_REQUEST,we.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function YF(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function JF(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,s;return t=t!==void 0?t:1e3,function(f){const u=Date.now(),o=n[i];s||(s=u),r[a]=f,n[a]=u;let l=i,h=0;for(;l!==a;)h+=r[l++],l=l%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),u-s<t)return;const d=o&&u-o;return d?Math.round(h*1e3/d):void 0}}function QF(e,t){let r=0,n=1e3/t,a,i;const s=(u,o=Date.now())=>{r=o,a=null,i&&(clearTimeout(i),i=null),e.apply(null,u)};return[(...u)=>{const o=Date.now(),l=o-r;l>=n?s(u,o):(a=u,i||(i=setTimeout(()=>{i=null,s(a)},n-l)))},()=>a&&s(a)]}const Yo=(e,t,r=3)=>{let n=0;const a=JF(50,250);return QF(i=>{const s=i.loaded,c=i.lengthComputable?i.total:void 0,f=s-n,u=a(f),o=s<=c;n=s;const l={loaded:s,total:c,progress:c?s/c:void 0,bytes:f,rate:u||void 0,estimated:u&&c&&o?(c-s)/u:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(l)},r)},X1=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Y1=e=>(...t)=>K.asap(()=>e(...t));var ZF=Et.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Et.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Et.origin),Et.navigator&&/(msie|trident)/i.test(Et.navigator.userAgent)):()=>!0,jF=Et.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const s=[e+"="+encodeURIComponent(t)];K.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),K.isString(n)&&s.push("path="+n),K.isString(a)&&s.push("domain="+a),i===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function e6(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function t6(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function J1(e,t,r){let n=!e6(t);return e&&(n||r==!1)?t6(e,t):t}const Q1=e=>e instanceof Ht?{...e}:e;function ra(e,t){t=t||{};const r={};function n(u,o,l,h){return K.isPlainObject(u)&&K.isPlainObject(o)?K.merge.call({caseless:h},u,o):K.isPlainObject(o)?K.merge({},o):K.isArray(o)?o.slice():o}function a(u,o,l,h){if(K.isUndefined(o)){if(!K.isUndefined(u))return n(void 0,u,l,h)}else return n(u,o,l,h)}function i(u,o){if(!K.isUndefined(o))return n(void 0,o)}function s(u,o){if(K.isUndefined(o)){if(!K.isUndefined(u))return n(void 0,u)}else return n(void 0,o)}function c(u,o,l){if(l in t)return n(u,o);if(l in e)return n(void 0,u)}const f={url:i,method:i,data:i,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:c,headers:(u,o,l)=>a(Q1(u),Q1(o),l,!0)};return K.forEach(Object.keys(Object.assign({},e,t)),function(o){const l=f[o]||a,h=l(e[o],t[o],o);K.isUndefined(h)&&l!==c||(r[o]=h)}),r}var Z1=e=>{const t=ra({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:s,auth:c}=t;t.headers=s=Ht.from(s),t.url=$1(J1(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&s.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let f;if(K.isFormData(r)){if(Et.hasStandardBrowserEnv||Et.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((f=s.getContentType())!==!1){const[u,...o]=f?f.split(";").map(l=>l.trim()).filter(Boolean):[];s.setContentType([u||"multipart/form-data",...o].join("; "))}}if(Et.hasStandardBrowserEnv&&(n&&K.isFunction(n)&&(n=n(t)),n||n!==!1&&ZF(t.url))){const u=a&&i&&jF.read(i);u&&s.set(a,u)}return t},r6=typeof XMLHttpRequest<"u"&&function(e){return new Promise(function(r,n){const a=Z1(e);let i=a.data;const s=Ht.from(a.headers).normalize();let{responseType:c,onUploadProgress:f,onDownloadProgress:u}=a,o,l,h,d,p;function m(){d&&d(),p&&p(),a.cancelToken&&a.cancelToken.unsubscribe(o),a.signal&&a.signal.removeEventListener("abort",o)}let x=new XMLHttpRequest;x.open(a.method.toUpperCase(),a.url,!0),x.timeout=a.timeout;function v(){if(!x)return;const g=Ht.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),w={data:!c||c==="text"||c==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:g,config:e,request:x};K1(function(k){r(k),m()},function(k){n(k),m()},w),x=null}"onloadend"in x?x.onloadend=v:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(v)},x.onabort=function(){x&&(n(new we("Request aborted",we.ECONNABORTED,e,x)),x=null)},x.onerror=function(){n(new we("Network Error",we.ERR_NETWORK,e,x)),x=null},x.ontimeout=function(){let _=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const w=a.transitional||W1;a.timeoutErrorMessage&&(_=a.timeoutErrorMessage),n(new we(_,w.clarifyTimeoutError?we.ETIMEDOUT:we.ECONNABORTED,e,x)),x=null},i===void 0&&s.setContentType(null),"setRequestHeader"in x&&K.forEach(s.toJSON(),function(_,w){x.setRequestHeader(w,_)}),K.isUndefined(a.withCredentials)||(x.withCredentials=!!a.withCredentials),c&&c!=="json"&&(x.responseType=a.responseType),u&&([h,p]=Yo(u,!0),x.addEventListener("progress",h)),f&&x.upload&&([l,d]=Yo(f),x.upload.addEventListener("progress",l),x.upload.addEventListener("loadend",d)),(a.cancelToken||a.signal)&&(o=g=>{x&&(n(!g||g.type?new qa(null,e,x):g),x.abort(),x=null)},a.cancelToken&&a.cancelToken.subscribe(o),a.signal&&(a.signal.aborted?o():a.signal.addEventListener("abort",o)));const y=YF(a.url);if(y&&Et.protocols.indexOf(y)===-1){n(new we("Unsupported protocol "+y+":",we.ERR_BAD_REQUEST,e));return}x.send(i||null)})};const n6=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(u){if(!a){a=!0,c();const o=u instanceof Error?u:this.reason;n.abort(o instanceof we?o:new qa(o instanceof Error?o.message:o))}};let s=t&&setTimeout(()=>{s=null,i(new we(`timeout ${t} of ms exceeded`,we.ETIMEDOUT))},t);const c=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:f}=n;return f.unsubscribe=()=>K.asap(c),f}},a6=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},i6=async function*(e,t){for await(const r of s6(e))yield*a6(r,t)},s6=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},j1=(e,t,r,n)=>{const a=i6(e,t);let i=0,s,c=f=>{s||(s=!0,n&&n(f))};return new ReadableStream({async pull(f){try{const{done:u,value:o}=await a.next();if(u){c(),f.close();return}let l=o.byteLength;if(r){let h=i+=l;r(h)}f.enqueue(new Uint8Array(o))}catch(u){throw c(u),u}},cancel(f){return c(f),a.return()}},{highWaterMark:2})},Jo=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",em=Jo&&typeof ReadableStream=="function",o6=Jo&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),tm=(e,...t)=>{try{return!!e(...t)}catch{return!1}},c6=em&&tm(()=>{let e=!1;const t=new Request(Et.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),rm=64*1024,P0=em&&tm(()=>K.isReadableStream(new Response("").body)),Qo={stream:P0&&(e=>e.body)};Jo&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Qo[t]&&(Qo[t]=K.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new we(`Response type '${t}' is not supported`,we.ERR_NOT_SUPPORT,n)})})})(new Response);const u6=async e=>{if(e==null)return 0;if(K.isBlob(e))return e.size;if(K.isSpecCompliantForm(e))return(await new Request(Et.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(K.isArrayBufferView(e)||K.isArrayBuffer(e))return e.byteLength;if(K.isURLSearchParams(e)&&(e=e+""),K.isString(e))return(await o6(e)).byteLength},f6=async(e,t)=>{const r=K.toFiniteNumber(e.getContentLength());return r??u6(t)};var l6=Jo&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:s,onDownloadProgress:c,onUploadProgress:f,responseType:u,headers:o,withCredentials:l="same-origin",fetchOptions:h}=Z1(e);u=u?(u+"").toLowerCase():"text";let d=n6([a,i&&i.toAbortSignal()],s),p;const m=d&&d.unsubscribe&&(()=>{d.unsubscribe()});let x;try{if(f&&c6&&r!=="get"&&r!=="head"&&(x=await f6(o,n))!==0){let w=new Request(t,{method:"POST",body:n,duplex:"half"}),E;if(K.isFormData(n)&&(E=w.headers.get("content-type"))&&o.setContentType(E),w.body){const[k,F]=X1(x,Yo(Y1(f)));n=j1(w.body,rm,k,F)}}K.isString(l)||(l=l?"include":"omit");const v="credentials"in Request.prototype;p=new Request(t,{...h,signal:d,method:r.toUpperCase(),headers:o.normalize().toJSON(),body:n,duplex:"half",credentials:v?l:void 0});let y=await fetch(p);const g=P0&&(u==="stream"||u==="response");if(P0&&(c||g&&m)){const w={};["status","statusText","headers"].forEach(b=>{w[b]=y[b]});const E=K.toFiniteNumber(y.headers.get("content-length")),[k,F]=c&&X1(E,Yo(Y1(c),!0))||[];y=new Response(j1(y.body,rm,k,()=>{F&&F(),m&&m()}),w)}u=u||"text";let _=await Qo[K.findKey(Qo,u)||"text"](y,e);return!g&&m&&m(),await new Promise((w,E)=>{K1(w,E,{data:_,headers:Ht.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:p})})}catch(v){throw m&&m(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new we("Network Error",we.ERR_NETWORK,e,p),{cause:v.cause||v}):we.from(v,v&&v.code,e,p)}});const L0={http:bF,xhr:r6,fetch:l6};K.forEach(L0,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const nm=e=>`- ${e}`,h6=e=>K.isFunction(e)||e===null||e===!1;var am={getAdapter:e=>{e=K.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let s;if(n=r,!h6(r)&&(n=L0[(s=String(r)).toLowerCase()],n===void 0))throw new we(`Unknown adapter '${s}'`);if(n)break;a[s||"#"+i]=n}if(!n){const i=Object.entries(a).map(([c,f])=>`adapter ${c} `+(f===!1?"is not supported by the environment":"is not available in the build"));let s=t?i.length>1?`since :
`+i.map(nm).join(`
`):" "+nm(i[0]):"as no adapter specified";throw new we("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return n},adapters:L0};function B0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new qa(null,e)}function im(e){return B0(e),e.headers=Ht.from(e.headers),e.data=D0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),am.getAdapter(e.adapter||zi.adapter)(e).then(function(n){return B0(e),n.data=D0.call(e,e.transformResponse,n),n.headers=Ht.from(n.headers),n},function(n){return q1(n)||(B0(e),n&&n.response&&(n.response.data=D0.call(e,e.transformResponse,n.response),n.response.headers=Ht.from(n.response.headers))),Promise.reject(n)})}const sm="1.8.4",Zo={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Zo[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const om={};Zo.transitional=function(t,r,n){function a(i,s){return"[Axios v"+sm+"] Transitional option '"+i+"'"+s+(n?". "+n:"")}return(i,s,c)=>{if(t===!1)throw new we(a(s," has been removed"+(r?" in "+r:"")),we.ERR_DEPRECATED);return r&&!om[s]&&(om[s]=!0,console.warn(a(s," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,s,c):!0}},Zo.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function d6(e,t,r){if(typeof e!="object")throw new we("options must be an object",we.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],s=t[i];if(s){const c=e[i],f=c===void 0||s(c,i,e);if(f!==!0)throw new we("option "+i+" must be "+f,we.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new we("Unknown option "+i,we.ERR_BAD_OPTION)}}var jo={assertOptions:d6,validators:Zo};const Vr=jo.validators;let na=class{constructor(t){this.defaults=t,this.interceptors={request:new H1,response:new H1}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ra(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&jo.assertOptions(n,{silentJSONParsing:Vr.transitional(Vr.boolean),forcedJSONParsing:Vr.transitional(Vr.boolean),clarifyTimeoutError:Vr.transitional(Vr.boolean)},!1),a!=null&&(K.isFunction(a)?r.paramsSerializer={serialize:a}:jo.assertOptions(a,{encode:Vr.function,serialize:Vr.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),jo.assertOptions(r,{baseUrl:Vr.spelling("baseURL"),withXsrfToken:Vr.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let s=i&&K.merge(i.common,i[r.method]);i&&K.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),r.headers=Ht.concat(s,i);const c=[];let f=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(f=f&&m.synchronous,c.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let o,l=0,h;if(!f){const p=[im.bind(this),void 0];for(p.unshift.apply(p,c),p.push.apply(p,u),h=p.length,o=Promise.resolve(r);l<h;)o=o.then(p[l++],p[l++]);return o}h=c.length;let d=r;for(l=0;l<h;){const p=c[l++],m=c[l++];try{d=p(d)}catch(x){m.call(this,x);break}}try{o=im.call(this,d)}catch(p){return Promise.reject(p)}for(l=0,h=u.length;l<h;)o=o.then(u[l++],u[l++]);return o}getUri(t){t=ra(this.defaults,t);const r=J1(t.baseURL,t.url,t.allowAbsoluteUrls);return $1(r,t.params,t.paramsSerializer)}};K.forEach(["delete","get","head","options"],function(t){na.prototype[t]=function(r,n){return this.request(ra(n||{},{method:t,url:r,data:(n||{}).data}))}}),K.forEach(["post","put","patch"],function(t){function r(n){return function(i,s,c){return this.request(ra(c||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:s}))}}na.prototype[t]=r(),na.prototype[t+"Form"]=r(!0)});let p6=class Kv{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const s=new Promise(c=>{n.subscribe(c),i=c}).then(a);return s.cancel=function(){n.unsubscribe(i)},s},t(function(i,s,c){n.reason||(n.reason=new qa(i,s,c),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Kv(function(a){t=a}),cancel:t}}};function m6(e){return function(r){return e.apply(null,r)}}function x6(e){return K.isObject(e)&&e.isAxiosError===!0}const M0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(M0).forEach(([e,t])=>{M0[t]=e});function cm(e){const t=new na(e),r=b1(na.prototype.request,t);return K.extend(r,na.prototype,t,{allOwnKeys:!0}),K.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return cm(ra(e,a))},r}const je=cm(zi);je.Axios=na,je.CanceledError=qa,je.CancelToken=p6,je.isCancel=q1,je.VERSION=sm,je.toFormData=Ko,je.AxiosError=we,je.Cancel=je.CanceledError,je.all=function(t){return Promise.all(t)},je.spread=m6,je.isAxiosError=x6,je.mergeConfig=ra,je.AxiosHeaders=Ht,je.formToJSON=e=>z1(K.isHTMLForm(e)?new FormData(e):e),je.getAdapter=am.getAdapter,je.HttpStatusCode=M0,je.default=je;const{Axios:Z7,AxiosError:j7,CanceledError:eB,isCancel:tB,CancelToken:rB,VERSION:nB,all:aB,Cancel:iB,isAxiosError:sB,spread:oB,toFormData:cB,AxiosHeaders:uB,HttpStatusCode:fB,formToJSON:lB,getAdapter:hB,mergeConfig:dB}=je,g6={init:!1,atlases:[],selected_atlas:null,loading:!1,original_atlas:null,atlas_3d:null,loading_3d:!1,matrix_order:null,selected_ids:[],hovered_roi:null,links:[],edit_title:null,edit_view_policy:null,edit_description:null},v6=async e=>{const t=await fetch(`/server/api/vis/atlases/atlas_3d/${e}/`);if(!t.ok)throw new Error(`Error fetching scenario run data: ${t.statusText}`);return await t.json()},_6=async(e,t)=>{const r=await fetch(`/server/api/vis/atlases/${e}/`,t);if(!r.ok)throw new Error(`Error fetching scenario run data: ${r.statusText}`);return await r.json()},ec=Me("atlas/update3DAtlas",async(e,{rejectWithValue:t})=>{try{const r=await v6(e);return console.log("3D ATLAS TO UPDATE",r),r}catch(r){return t(r.message||"Error...")}}),tc=Me("atlas/updateAtlas",async(e,{rejectWithValue:t,getState:r,dispatch:n})=>{try{const a=r().atlas.atlas_3d;(a==null?void 0:a.base)!=e.atlas.base&&n(ec(e.atlas.base));const i=await _6(e.atlas.id,e.options);return console.log("CUSTOM ATLAS UPDATEx",i),i}catch(a){return t(a.message||"Error...")}}),um=or({name:"atlas",initialState:g6,reducers:{setInit:(e,t)=>{e.init=t.payload},setLinks:(e,t)=>{e.links=t.payload},hoveredRoiChanged:(e,t)=>{e.hovered_roi=t.payload},setSelectedIds:(e,t)=>{e.selected_ids=t.payload},resetIds:(e,t)=>{e.selected_ids=e.matrix_order},setAtlas:(e,t)=>{e.selected_atlas=t.payload},setAtlases:(e,t)=>{e.atlases=t.payload},updateAtlasOrder:(e,t)=>{e.matrix_order=t.payload},setAtlasEditTitle:(e,t)=>{e.edit_title=t.payload},setAtlasEditViewPolicy:(e,t)=>{e.edit_view_policy=t.payload},setAtlasEditDescription:(e,t)=>{e.edit_description=t.payload},resetEditAtlas:(e,t)=>{e.edit_title=e.selected_atlas.title,e.edit_view_policy=e.selected_atlas.view_policy,e.edit_description=e.selected_atlas.description}},extraReducers:e=>{e.addCase(ec.pending,(t,r)=>{t.loading_3d=!0,t.atlas_3d=null}),e.addCase(ec.fulfilled,(t,r)=>{t.atlas_3d=r.payload,t.loading_3d=!1}),e.addCase(ec.rejected,(t,r)=>{t.loading_3d=!1,console.error(r.payload)}),e.addCase(tc.pending,(t,r)=>{t.loading=!0}),e.addCase(tc.fulfilled,(t,r)=>{t.selected_atlas=r.payload,t.selected_ids=r.payload.rois.map(n=>n.acronim),t.edit_title=r.payload.title,t.edit_view_policy=r.payload.view_policy,t.edit_description=r.payload.description,t.loading=!1}),e.addCase(tc.rejected,(t,r)=>{t.loading=!1,console.error(r.payload)})}});var y6=um.reducer;const{setLinks:pB,hoveredRoiChanged:mB,setSelectedIds:xB,resetIds:gB,setAtlases:vB,setInit:_B,setAtlas:yB,updateAtlasOrder:w6,setAtlasEditTitle:wB,setAtlasEditDescription:EB,setAtlasEditViewPolicy:kB,resetEditAtlas:TB}=um.actions,On={events:{},publish:function(e,t){On.events[e]&&On.events[e].forEach(r=>r(t))}},{publish:E6}=On,k6={loading:!1,matrices:[],types:[],measures:[],diff_measures:[],bands:[],original_bands:[],filtering_expr:"",bool_matrix:[],populations:[],statistics:[],atlas:null,base:null,isAllowed:!1,scenarioRunId:null};function T6(e,t,r,n){var f;const a=e.matrix_order,i=e.base,s=(f=r().atlas.atlas_3d)==null?void 0:f.base,c=r().atlas.matrix_order;if(!(s===i&&JSON.stringify(c)===JSON.stringify(a))){if(s!=i){const o=r().atlas.atlases.find(l=>l.base===i);t(tc({atlas:o,options:n}))}JSON.stringify(c)!=JSON.stringify(a)&&t(w6(a))}}const rc=Me("main/updateData",async(e,{getState:t,rejectWithValue:r,dispatch:n})=>{try{console.log("data to request",e);const a=await je.post(e.url,e.data);console.log("response data",a.data);const i=a.data;return T6(i,n,t,e.options),i}catch(a){return r(a.message||"Error retrieving data")}}),fm=or({name:"main",initialState:k6,reducers:{setLoading:(e,t)=>{e.loading=t.payload},setIsAllowed:(e,t)=>{e.isAllowed=t.payload},setData:(e,t)=>{console.log("------> NEW DATA SETTED ON MAIN <------");const{matrices:r,bands:n,original_bands:a,statistics:i,measures:s,diff_measures:c,types:f,populations:u,atlas:o,base:l}=t.payload;e.matrices=r,e.bands=n,e.original_bands=a,e.statistics=i,e.measures=s,e.diff_measures=c,e.types=f,e.populations=u,e.atlas=o,e.base=l},setFilteringExpr:(e,t)=>{e.filtering_expr=t.payload},setBoolMatrix:(e,t)=>{e.bool_matrix=t.payload},setActiveMeasure:(e,t)=>{const r=t.payload;e.measures=e.measures.map(n=>n.acronim===r.acronim?{...n,active:r.active}:n)},setActiveBand:(e,t)=>{const r=t.payload;e.bands=e.bands.map(n=>n.acronim===r.acronim?{...n,active:r.active}:n)},setScenarioRunId(e,t){e.scenarioRunId=t.payload}},extraReducers:e=>{e.addCase(rc.pending,(t,r)=>{t.loading=!0}),e.addCase(rc.fulfilled,(t,r)=>{t.loading=!1;const{matrices:n,bands:a,original_bands:i,statistics:s,measures:c,diff_measures:f,types:u,populations:o,atlas:l,base:h}=r.payload;t.matrices=n,t.bands=a,t.original_bands=i,t.statistics=s,t.measures=c,t.diff_measures=f,t.types=u,t.populations=o,t.atlas=l,t.base=h,E6("notification",{message:"Data Loaded",description:"",placement:"bottomRight",type:"success"})}),e.addCase(rc.rejected,(t,r)=>{t.loading=!1,console.error(r.payload)})}});var A6=fm.reducer;const{setLoading:AB,setData:CB,setFilteringExpr:bB,setBoolMatrix:SB,setActiveMeasure:FB,setActiveBand:IB,setIsAllowed:OB,setScenarioRunId:RB}=fm.actions,C6={data:null,init:!1,processing:!1,processingError:null,vis_attr:null,diagonal:!0,divided:!1,is_filter:!1,is_vis_filter:!0,filter_attr:null,range:[],filter_value:0,filtering_expr:"",bool_matrix:[],specialFilterValues:{},reorder_attr:null,is_reorder:!1,is_vis_reorder:!0,algorithm:$S[0].value,distance:VS[0].value,multi_attrs:[],nodes:[],links:[],link_attrs:[],config:{tooltip:!0,select_links:!0,select_areas:!0,filter_zoom:!0,sync_select_nodes:!0,sync_select_links:!1,brush:!0}},lm=or({name:"matrix",initialState:C6,reducers:{setInit:(e,t)=>{e.init=t.payload},setLinks:(e,t)=>{e.links=t.payload},addLink:(e,t)=>{const r=t.payload;e.links=[...e.links,r]},addLinks:(e,t)=>{const r=t.payload,n=e.links,a=Ho(r,n,!0);e.links=[...e.links,...a]},removeLink:(e,t)=>{e.links=[...e.links.slice(0,t.payload),...e.links.slice(t.payload+1)]},removeLinks:(e,t)=>{const r=t.payload,n=e.links,a=Ho(r,n,!1);e.links=e.links.filter(i=>!a.some(s=>s.x_node===i.x_node&&s.y_node===i.y_node))},setData:(e,t)=>{e.data=t.payload},setVisAttr:(e,t)=>{e.vis_attr=t.payload},setDivided:(e,t)=>{e.divided=t.payload},setDiagonal:(e,t)=>{e.diagonal=t.payload},setIsFilter:(e,t)=>{e.is_filter=t.payload},setIsVisFilter:(e,t)=>{e.is_vis_filter=t.payload},setFilterRange:(e,t)=>{e.range=t.payload,e.filter_value=.7},setFilterAttr:(e,t)=>{e.filter_attr=t.payload},setFilterValue:(e,t)=>{e.filter_value=t.payload},setSpecialFilterValues:(e,t)=>{const r=t.payload.acronim,n=t.payload.value;e.specialFilterValues[r]=n},setFilteringExpr:(e,t)=>{e.filtering_expr=t.payload},setBoolMatrix:(e,t)=>{e.bool_matrix=t.payload},setIsReorder:(e,t)=>{e.is_reorder=t.payload},setIsVisReorder:(e,t)=>{e.is_vis_reorder=t.payload},setReorderAttr:(e,t)=>{e.reorder_attr=t.payload},setAlgorithm:(e,t)=>{e.algorithm=t.payload},setDistance:(e,t)=>{e.distance=t.payload},setConfig:(e,t)=>{e.config=t.payload},addMultiAttr:(e,t)=>{e.multi_attrs=[...e.multi_attrs,t.payload]},removeMultiAttr:(e,t)=>{e.multi_attrs=[...e.multi_attrs.slice(0,t.payload),...e.multi_attrs.slice(t.payload+1)]}},extraReducers:e=>{e.addCase(rc.fulfilled,(t,r)=>{t.multi_attrs=[]})}});var b6=lm.reducer;const{setInit:NB,setIsFilter:DB,setData:PB,setIsReorder:LB,setBands:BB,setFilterRange:MB,setAttributes:UB,setVisAttr:VB,setDivided:$B,setDiagonal:HB,setFilterAttr:WB,setReorderAttr:zB,setBand:GB,setFilterValue:qB,setAlgorithms:KB,setAlgorithm:XB,setConfig:YB,setSmallBands:JB,setDistance:QB,addMultiAttr:ZB,removeMultiAttr:jB,setFilteringExpr:eM,setBoolMatrix:tM,setIsVisFilter:rM,setLinks:nM,addLink:aM,addLinks:iM,removeLink:sM,removeLinks:oM,setIsVisReorder:cM,setSpecialFilterValues:uM}=lm.actions,hm=or({name:"list",initialState:{init:!1,links:[],link_attrs:[]},reducers:{setInit:(e,t)=>{e.init=t.payload},setLinks:(e,t)=>{e.links=t.payload},addLink:(e,t)=>{e.links.push(t.payload)},addLinks:(e,t)=>{e.links.push(...t.payload)},removeLink:(e,t)=>{e.links.splice(t.payload,1)},removeLinks:(e,t)=>{const r=t.payload;e.links=e.links.filter(n=>!r.some(a=>a.x_node===n.x_node&&a.y_node===n.y_node))},addLinkAttr:(e,t)=>{e.link_attrs.push(t.payload)},removeLinkAttr:(e,t)=>{e.link_attrs.splice(t.payload,1)}}});var S6=hm.reducer;const{setInit:lM,setLinks:hM,addLink:dM,addLinks:pM,removeLink:mM,removeLinks:xM,addLinkAttr:gM,removeLinkAttr:vM}=hm.actions,F6={populations:[],subjects:[],visits:[],measures:null,measure_range:[.3,1],diff_range:[1.6,7],atlas:null,bands:[],statistics:[],loading_populations:!1,loading_subjects:!1,error_populations:"",error_subjects:""},U0=Me("global/fetchAvailablePopulations",e=>(console.log("requesting data with payload ",e),axios.get(`${API_PATH}/populations/`,e).then(t=>t.data,t=>(console.log(t),[])))),dm=or({name:"selection",initialState:F6,reducers:{setPopulations:(e,t)=>{e.populations=t.payload},setSubjects:(e,t)=>{e.selected_subjects=t.payload},setVisits:(e,t)=>{const r=t.payload.index,n=t.payload.value;let a=[...e.visits];a[r]=n,e.visits=a},setMeasures:(e,t)=>{e.measures=t.payload},setMeasureRange:(e,t)=>{e.measure_range=t.payload},setDiffRange:(e,t)=>{e.diff_range=t.payload},setAtlas:(e,t)=>{e.atlas=t.payload},setBands:(e,t)=>{e.bands=t.payload},setStatistics:(e,t)=>{e.statistics=t.payload}},extraReducers:e=>{e.addCase(U0.pending,t=>{t.loading_populations=!0}),e.addCase(U0.fulfilled,(t,r)=>{t.loading_populations=!1,t.available_populations=r.payload.populations,t.error=""}),e.addCase(U0.rejected,(t,r)=>{t.loading_populations=!1,t.available_populations=[],t.error=r.error.message})}});var I6=dm.reducer;const{setPopulations:_M,setVisits:yM,setMeasures:wM,setAtlas:EM,setBands:kM,setStatistics:TM}=dm.actions,pm=or({name:"circular",initialState:{data:null,init:!1,processing:!1,processingError:null,vis_attr:null,link_opacity:.1,is_hipo:!1,is_hiper:!1,curve_value:.85,is_filter:!1,is_vis_filter:!0,is_complete:!1,is_fixed:!1,filter_attr:null,range:[],filter_value:null,filtering_expr:"",bool_matrix:[],multi_attrs:[],nodes:[],links:[],link_attrs:[],config:{tooltip:!0,select_links:!0,select_areas:!0}},reducers:{setInit:(e,t)=>{e.init=t.payload},setLinks:(e,t)=>{e.links=t.payload},addLink:(e,t)=>{const r=t.payload;e.links=[...e.links,r]},addLinks:(e,t)=>{const r=t.payload,n=e.links,a=Ho(r,n,!0);e.links=[...e.links,...a]},removeLink:(e,t)=>{e.links=[...e.links.slice(0,t.payload),...e.links.slice(t.payload+1)]},removeLinks:(e,t)=>{const r=t.payload,n=e.links,a=Ho(r,n,!1);e.links=e.links.filter(i=>!a.some(s=>s.x_node===i.x_node&&s.y_node===i.y_node))},setData:(e,t)=>{e.data=t.payload},setVisAttr:(e,t)=>{e.vis_attr=t.payload},setLinkOpacity:(e,t)=>{e.link_opacity=t.payload},setCurveValue:(e,t)=>{e.curve_value=t.payload},setIsFixed:(e,t)=>{e.is_fixed=t.payload},setIsHipo:(e,t)=>{e.is_hipo=t.payload},setIsHiper:(e,t)=>{e.is_hiper=t.payload},setIsComplete:(e,t)=>{e.is_complete=t.payload},setIsFilter:(e,t)=>{e.is_filter=t.payload},setIsVisFilter:(e,t)=>{e.is_vis_filter=t.payload},setFilterRange:(e,t)=>{e.range=t.payload,e.filter_value=.7},setFilterAttr:(e,t)=>{e.filter_attr=t.payload},setFilterValue:(e,t)=>{e.filter_value=t.payload},setConfig:(e,t)=>{e.config=t.payload},setFilteringExpr:(e,t)=>{e.filtering_expr=t.payload},setBoolMatrix:(e,t)=>{e.bool_matrix=t.payload},addMultiAttr:(e,t)=>{e.multi_attrs=[...e.multi_attrs,t.payload]},removeMultiAttr:(e,t)=>{e.multi_attrs=[...e.multi_attrs.slice(0,t.payload),...e.multi_attrs.slice(t.payload+1)]}}});var O6=pm.reducer;const{setInit:CM,setData:bM,setConfig:SM,setVisAttr:FM,setLinkOpacity:IM,setIsHipo:OM,setIsHiper:RM,setCurveValue:NM,setIsFilter:DM,setIsComplete:PM,setIsFixed:LM,setFilterRange:BM,setFilterAttr:MM,setFilterValue:UM,setFilteringExpr:VM,setBoolMatrix:$M,setIsVisFilter:HM,addMultiAttr:WM,removeMultiAttr:zM,setLinks:GM,addLink:qM,addLinks:KM,removeLink:XM,removeLinks:YM}=pm.actions;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var mm=1252,R6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],V0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$0=function(e){R6.indexOf(e)!=-1&&(mm=V0[0]=e)};function N6(){$0(1252)}var Cr=function(e){$0(e)};function xm(){Cr(1200),N6()}function gm(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function D6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function vm(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var qi=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?D6(e.slice(2)):t==254&&r==255?vm(e.slice(2)):t==65279?e.slice(1):e},nc=function(t){return String.fromCharCode(t)},_m=function(t){return String.fromCharCode(t)},H0,Rn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ym(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0,f=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),c=(n&15)<<2|a>>6,f=a&63,isNaN(n)?c=f=64:isNaN(a)&&(f=64),t+=Rn.charAt(i)+Rn.charAt(s)+Rn.charAt(c)+Rn.charAt(f);return t}function Yt(e){var t="",r=0,n=0,a=0,i=0,s=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Rn.indexOf(e.charAt(u++)),s=Rn.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),c=Rn.indexOf(e.charAt(u++)),n=(s&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),f=Rn.indexOf(e.charAt(u++)),a=(c&3)<<6|f,f!==64&&(t+=String.fromCharCode(a));return t}var be=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),aa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Nn(e){return be?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function wm(e){return be?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var br=function(t){return be?aa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ia(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function W0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return W0(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Dn=be?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:aa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function P6(e){for(var t=[],r=0,n=e.length+250,a=Nn(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var c=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|c>>6&15|(s&3)<<4,a[r++]=128|c&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Nn(65535),n=65530)}return t.push(a.slice(0,r)),Dn(t)}var Nt=/\u0000/g,Ki=/[\u0001-\u0006]/g;function Ka(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Sr(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}function z0(e,t){var r=""+e;return r.length>=t?r:Je(" ",t-r.length)+r}function ac(e,t){var r=""+e;return r.length>=t?r:r+Je(" ",t-r.length)}function L6(e,t){var r=""+Math.round(e);return r.length>=t?r:Je("0",t-r.length)+r}function B6(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}var Em=Math.pow(2,32);function Xa(e,t){if(e>Em||e<-Em)return L6(e,t);var r=Math.round(e);return B6(r,t)}function ic(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var km=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],G0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function M6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ee={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Tm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},U6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function sc(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,c=0,f=1,u=0,o=0,l=Math.floor(a);u<t&&(l=Math.floor(a),c=l*s+i,o=l*u+f,!(a-l<5e-8));)a=1/(a-l),i=s,s=c,f=u,u=o;if(o>t&&(u>t?(o=f,c=i):(o=u,c=s)),!r)return[0,n*c,o];var h=Math.floor(n*c/o);return[h,n*c-h*o,o]}function sa(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),s=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=G6(f,s))}return c.y=s[0],c.m=s[1],c.d=s[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var Am=new Date(1899,11,31,0,0,0),V6=Am.getTime(),$6=new Date(1900,2,1,0,0,0);function Cm(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=$6&&(r+=24*60*60*1e3),(r-(V6+(e.getTimezoneOffset()-Am.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function q0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function H6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function W6(e){var t=e<0?12:11,r=q0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function z6(e){var t=q0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Xi(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=W6(e):t===10?r=e.toFixed(10).substr(0,12):r=z6(e),q0(H6(r.toUpperCase()))}function oa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Xi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ur(14,Cm(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function G6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function q6(e,t,r,n){var a="",i=0,s=0,c=r.y,f,u=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:f=c%100,u=2;break;default:f=c%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,u=t.length;break;case 3:return G0[r.m-1][1];case 5:return G0[r.m-1][0];default:return G0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,u=t.length;break;case 3:return km[r.q][0];default:return km[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Sr(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Sr(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:f=c,u=1;break}var o=u>0?Sr(f,u):"";return o}function Pn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var bm=/%/g;function K6(e,t,r){var n=t.replace(bm,""),a=t.length-n.length;return cn(e,n,r*Math.pow(10,2*a))+Je("%",a)}function X6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return cn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Sm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Sm(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,u,o){return f+u+o.substr(0,(a+i)%a)+"."+o.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Fm=/# (\?+)( ?)\/( ?)(\d+)/;function Y6(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,c=n;return r+(i===0?"":""+i)+" "+(s===0?Je(" ",e[1].length+1+e[4].length):z0(s,e[1].length)+e[2]+"/"+e[3]+Sr(c,e[4].length))}function J6(e,t,r){return r+(t===0?"":""+t)+Je(" ",e[1].length+2+e[4].length)}var Im=/^#*0*\.([0#]+)/,Om=/\).*[0#]/,Rm=/\(###\) ###\\?-####/;function Dt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Nm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Dm(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Q6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Z6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Om)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cr("n",n,r):"("+cr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return X6(e,t,r);if(t.indexOf("%")!==-1)return K6(e,t,r);if(t.indexOf("E")!==-1)return Sm(t,r);if(t.charCodeAt(0)===36)return"$"+cr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,c,f=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Xa(f,t.length);if(t.match(/^[#?]+$/))return a=Xa(r,0),a==="0"&&(a=""),a.length>t.length?a:Dt(t.substr(0,t.length-a.length))+a;if(i=t.match(Fm))return Y6(i,f,u);if(t.match(/^#+0+$/))return u+Xa(f,t.length-t.indexOf("0"));if(i=t.match(Im))return a=Nm(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Dt(i[1])).replace(/\.$/,"."+Dt(i[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+Je("0",Dt(i[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+Nm(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Pn(Xa(f,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cr(e,t,-r):Pn(""+(Math.floor(r)+Q6(r,i[1].length)))+"."+Sr(Dm(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return cr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ka(cr(e,t.replace(/[\\-]/g,""),r)),s=0,Ka(Ka(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return s<a.length?a.charAt(s++):p==="0"?"0":""}));if(t.match(Rm))return a=cr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var o="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=sc(f,Math.pow(10,s)-1,!1),a=""+u,o=cn("n",i[1],c[1]),o.charAt(o.length-1)==" "&&(o=o.substr(0,o.length-1)+"0"),a+=o+i[2]+"/"+i[3],o=ac(c[2],s),o.length<i[4].length&&(o=Dt(i[4].substr(i[4].length-o.length))+o),a+=o,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=sc(f,Math.pow(10,s)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?z0(c[1],s)+i[2]+"/"+i[3]+ac(c[2],s):Je(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Xa(r,0),t.length<=a.length?a:Dt(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var l=t.indexOf(".")-s,h=t.length-a.length-l;return Dt(t.substr(0,l)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Dm(r,i[1].length),r<0?"-"+cr(e,t,-r):Pn(Z6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Sr(0,3-p.length):"")+p})+"."+Sr(s,i[1].length);switch(t){case"###,##0.00":return cr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Pn(Xa(f,0));return d!=="0"?u+d:"";case"###,###.00":return cr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return cr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function j6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return cn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function e8(e,t,r){var n=t.replace(bm,""),a=t.length-n.length;return cn(e,n,r*Math.pow(10,2*a))+Je("%",a)}function Pm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Pm(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,u,o){return f+u+o.substr(0,(a+i)%a)+"."+o.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function $r(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Om)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$r("n",n,r):"("+$r("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return j6(e,t,r);if(t.indexOf("%")!==-1)return e8(e,t,r);if(t.indexOf("E")!==-1)return Pm(t,r);if(t.charCodeAt(0)===36)return"$"+$r(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,c,f=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Sr(f,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Dt(t.substr(0,t.length-a.length))+a;if(i=t.match(Fm))return J6(i,f,u);if(t.match(/^#+0+$/))return u+Sr(f,t.length-t.indexOf("0"));if(i=t.match(Im))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Dt(i[1])).replace(/\.$/,"."+Dt(i[1])),a=a.replace(/\.(\d*)$/,function(p,m){return"."+m+Je("0",Dt(i[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Pn(""+f);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$r(e,t,-r):Pn(""+r)+"."+Je("0",i[1].length);if(i=t.match(/^#,#*,#0/))return $r(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ka($r(e,t.replace(/[\\-]/g,""),r)),s=0,Ka(Ka(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return s<a.length?a.charAt(s++):p==="0"?"0":""}));if(t.match(Rm))return a=$r(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var o="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=sc(f,Math.pow(10,s)-1,!1),a=""+u,o=cn("n",i[1],c[1]),o.charAt(o.length-1)==" "&&(o=o.substr(0,o.length-1)+"0"),a+=o+i[2]+"/"+i[3],o=ac(c[2],s),o.length<i[4].length&&(o=Dt(i[4].substr(i[4].length-o.length))+o),a+=o,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=sc(f,Math.pow(10,s)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?z0(c[1],s)+i[2]+"/"+i[3]+ac(c[2],s):Je(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Dt(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var l=t.indexOf(".")-s,h=t.length-a.length-l;return Dt(t.substr(0,l)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+$r(e,t,-r):Pn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Sr(0,3-p.length):"")+p})+"."+Sr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Pn(""+f);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return $r(e,t.slice(0,t.lastIndexOf(".")),r)+Dt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function cn(e,t,r){return(r|0)===r?$r(e,t,r):cr(e,t,r)}function t8(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Lm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ya(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ic(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Lm))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function r8(e,t,r,n){for(var a=[],i="",s=0,c="",f="t",u,o,l,h="H";s<e.length;)switch(c=e.charAt(s)){case"G":if(!ic(e,s))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(l=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(l);a[a.length]={t:"t",v:i},++s;break;case"\\":var d=e.charAt(++s),p=d==="("||d===")"?d:"t";a[a.length]={t:p,v:d},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=sa(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},f=c,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=sa(t,r),u==null))return"";for(i=c;++s<e.length&&e.charAt(s).toLowerCase()===c;)i+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),a[a.length]={t:c,v:i},f=c;break;case"A":case"a":case"上":var m={t:c,v:c};if(u==null&&(u=sa(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(u!=null&&(m.v=u.H>=12?"下午":"上午"),m.t="T",s+=5,h="h"):(m.t="t",++s),u==null&&m.t==="T")return"";a[a.length]=m,f=c;break;case"[":for(i=c;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Lm)){if(u==null&&(u=sa(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ya(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=c;++s<e.length&&(c=e.charAt(s))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++s<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(s))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++s)===c;)i+=c;a[a.length]={t:c,v:i},f=c;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++s;break}var x=0,v=0,y;for(s=a.length-1,f="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,f="h",x<1&&(x=1);break;case"s":(y=a[s].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":f=a[s].t;break;case"m":f==="s"&&(a[s].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[s].v.match(/[Hh]/)&&(x=1),x<2&&a[s].v.match(/[Mm]/)&&(x=2),x<3&&a[s].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var g="",_;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=q6(a[s].t.charCodeAt(0),a[s].v,u,v),a[s].t="t";break;case"n":case"?":for(_=s+1;a[_]!=null&&((c=a[_].t)==="?"||c==="D"||(c===" "||c==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[s].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[s].v+=a[_].v,a[_]={v:"",t:";"},++_;g+=a[s].v,s=_-1;break;case"G":a[s].t="t",a[s].v=oa(t,r);break}var w="",E,k;if(g.length>0){g.charCodeAt(0)==40?(E=t<0&&g.charCodeAt(0)===45?-t:t,k=cn("n",g,E)):(E=t<0&&n>1?-t:t,k=cn("n",g,E),E<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),_=k.length-1;var F=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){F=s;break}var b=a.length;if(F===a.length&&k.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(_>=a[s].v.length-1?(_-=a[s].v.length,a[s].v=k.substr(_+1,a[s].v.length)):_<0?a[s].v="":(a[s].v=k.substr(0,_+1),_=-1),a[s].t="t",b=s);_>=0&&b<a.length&&(a[b].v=k.substr(0,_+1)+a[b].v)}else if(F!==a.length&&k.indexOf("E")===-1){for(_=k.indexOf(".")-1,s=F;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(o=a[s].v.indexOf(".")>-1&&s===F?a[s].v.indexOf(".")-1:a[s].v.length-1,w=a[s].v.substr(o+1);o>=0;--o)_>=0&&(a[s].v.charAt(o)==="0"||a[s].v.charAt(o)==="#")&&(w=k.charAt(_--)+w);a[s].v=w,a[s].t="t",b=s}for(_>=0&&b<a.length&&(a[b].v=k.substr(0,_+1)+a[b].v),_=k.indexOf(".")+1,s=F;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==F)){for(o=a[s].v.indexOf(".")>-1&&s===F?a[s].v.indexOf(".")+1:0,w=a[s].v.substr(0,o);o<a[s].v.length;++o)_<k.length&&(w+=k.charAt(_++));a[s].v=w,a[s].t="t",b=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(E=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=cn(a[s].t,a[s].v,E),a[s].t="t");var L="";for(s=0;s!==a.length;++s)a[s]!=null&&(L+=a[s].v);return L}var Bm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Mm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function n8(e,t){var r=t8(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(Bm),c=r[1].match(Bm);return Mm(t,s)?[n,r[0]]:Mm(t,c)?[n,r[1]]:[n,r[s!=null&&c!=null?2:1]]}return[n,i]}function ur(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ee)[e],n==null&&(n=r.table&&r.table[Tm[e]]||Ee[Tm[e]]),n==null&&(n=U6[e]||"General");break}if(ic(n,0))return oa(t,r);t instanceof Date&&(t=Cm(t,r.date1904));var a=n8(n,t);if(ic(a[1]))return oa(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return r8(a[1],t,r,a[0])}function ca(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ee[r]==null){t<0&&(t=r);continue}if(Ee[r]==e){t=r;break}}t<0&&(t=391)}return Ee[t]=e,t}function Um(){Ee=M6()}var a8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Vm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function i8(e){var t=typeof e=="number"?Ee[e]:e;return t=t.replace(Vm,"(\\d+)"),new RegExp("^"+t+"$")}function s8(e,t,r){var n=-1,a=-1,i=-1,s=-1,c=-1,f=-1;(t.match(Vm)||[]).forEach(function(l,h){var d=parseInt(r[h+1],10);switch(l.toLowerCase().charAt(0)){case"y":n=d;break;case"d":i=d;break;case"h":s=d;break;case"s":f=d;break;case"m":s>=0?c=d:a=d;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var o=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return s==-1&&c==-1&&f==-1?u:n==-1&&a==-1&&i==-1?o:u+"T"+o}var o8=function(){var e={};e.version="1.2.0";function t(){for(var k=0,F=new Array(256),b=0;b!=256;++b)k=b,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,F[b]=k;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function n(k){var F=0,b=0,L=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)U[L]=k[L];for(L=0;L!=256;++L)for(b=k[L],F=256+L;F<4096;F+=256)b=U[F]=b>>>8^k[b&255];var B=[];for(L=1;L!=16;++L)B[L-1]=typeof Int32Array<"u"?U.subarray(L*256,L*256+256):U.slice(L*256,L*256+256);return B}var a=n(r),i=a[0],s=a[1],c=a[2],f=a[3],u=a[4],o=a[5],l=a[6],h=a[7],d=a[8],p=a[9],m=a[10],x=a[11],v=a[12],y=a[13],g=a[14];function _(k,F){for(var b=F^-1,L=0,U=k.length;L<U;)b=b>>>8^r[(b^k.charCodeAt(L++))&255];return~b}function w(k,F){for(var b=F^-1,L=k.length-15,U=0;U<L;)b=g[k[U++]^b&255]^y[k[U++]^b>>8&255]^v[k[U++]^b>>16&255]^x[k[U++]^b>>>24]^m[k[U++]]^p[k[U++]]^d[k[U++]]^h[k[U++]]^l[k[U++]]^o[k[U++]]^u[k[U++]]^f[k[U++]]^c[k[U++]]^s[k[U++]]^i[k[U++]]^r[k[U++]];for(L+=15;U<L;)b=b>>>8^r[(b^k[U++])&255];return~b}function E(k,F){for(var b=F^-1,L=0,U=k.length,B=0,Y=0;L<U;)B=k.charCodeAt(L++),B<128?b=b>>>8^r[(b^B)&255]:B<2048?(b=b>>>8^r[(b^(192|B>>6&31))&255],b=b>>>8^r[(b^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,Y=k.charCodeAt(L++)&1023,b=b>>>8^r[(b^(240|B>>8&7))&255],b=b>>>8^r[(b^(128|B>>2&63))&255],b=b>>>8^r[(b^(128|Y>>6&15|(B&3)<<4))&255],b=b>>>8^r[(b^(128|Y&63))&255]):(b=b>>>8^r[(b^(224|B>>12&15))&255],b=b>>>8^r[(b^(128|B>>6&63))&255],b=b>>>8^r[(b^(128|B&63))&255]);return~b}return e.table=r,e.bstr=_,e.buf=w,e.str=E,e}(),Fe=function(){var t={};t.version="1.2.1";function r(T,I){for(var C=T.split("/"),S=I.split("/"),O=0,R=0,z=Math.min(C.length,S.length);O<z;++O){if(R=C[O].length-S[O].length)return R;if(C[O]!=S[O])return C[O]<S[O]?-1:1}return C.length-S.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var I=T.lastIndexOf("/");return I===-1?T:T.slice(0,I+1)}function a(T){if(T.charAt(T.length-1)=="/")return a(T.slice(0,-1));var I=T.lastIndexOf("/");return I===-1?T:T.slice(I+1)}function i(T,I){typeof I=="string"&&(I=new Date(I));var C=I.getHours();C=C<<6|I.getMinutes(),C=C<<5|I.getSeconds()>>>1,T.write_shift(2,C);var S=I.getFullYear()-1980;S=S<<4|I.getMonth()+1,S=S<<5|I.getDate(),T.write_shift(2,S)}function s(T){var I=T.read_shift(2)&65535,C=T.read_shift(2)&65535,S=new Date,O=C&31;C>>>=5;var R=C&15;C>>>=4,S.setMilliseconds(0),S.setFullYear(C+1980),S.setMonth(R-1),S.setDate(O);var z=I&31;I>>>=5;var X=I&63;return I>>>=6,S.setHours(I),S.setMinutes(X),S.setSeconds(z<<1),S}function c(T){yt(T,0);for(var I={},C=0;T.l<=T.length-4;){var S=T.read_shift(2),O=T.read_shift(2),R=T.l+O,z={};switch(S){case 21589:C=T.read_shift(1),C&1&&(z.mtime=T.read_shift(4)),O>5&&(C&2&&(z.atime=T.read_shift(4)),C&4&&(z.ctime=T.read_shift(4))),z.mtime&&(z.mt=new Date(z.mtime*1e3));break}T.l=R,I[S]=z}return I}var f;function u(){return f||(f={})}function o(T,I){if(T[0]==80&&T[1]==75)return qv(T,I);if((T[0]|32)==109&&(T[1]|32)==105)return H7(T,I);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var C=3,S=512,O=0,R=0,z=0,X=0,H=0,G=[],q=T.slice(0,512);yt(q,0);var Z=l(q);switch(C=Z[0],C){case 3:S=512;break;case 4:S=4096;break;case 0:if(Z[1]==0)return qv(T,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}S!==512&&(q=T.slice(0,S),yt(q,28));var ie=T.slice(0,S);h(q,C);var le=q.read_shift(4,"i");if(C===3&&le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+le);q.l+=4,z=q.read_shift(4,"i"),q.l+=4,q.chk("00100000","Mini Stream Cutoff Size: "),X=q.read_shift(4,"i"),O=q.read_shift(4,"i"),H=q.read_shift(4,"i"),R=q.read_shift(4,"i");for(var ee=-1,ce=0;ce<109&&(ee=q.read_shift(4,"i"),!(ee<0));++ce)G[ce]=ee;var _e=d(T,S);x(H,R,_e,S,G);var Ge=y(_e,z,G,S);Ge[z].name="!Directory",O>0&&X!==Y&&(Ge[X].name="!MiniFAT"),Ge[G[0]].name="!FAT",Ge.fat_addrs=G,Ge.ssz=S;var qe={},It=[],bs=[],Ss=[];g(z,Ge,_e,It,O,qe,bs,X),p(bs,Ss,It),It.shift();var Fs={FileIndex:bs,FullPaths:Ss};return I&&I.raw&&(Fs.raw={header:ie,sectors:_e}),Fs}function l(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(se,"Header Signature: "),T.l+=16;var I=T.read_shift(2,"u");return[T.read_shift(2,"u"),I]}function h(T,I){var C=9;switch(T.l+=2,C=T.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function d(T,I){for(var C=Math.ceil(T.length/I)-1,S=[],O=1;O<C;++O)S[O-1]=T.slice(O*I,(O+1)*I);return S[C-1]=T.slice(C*I),S}function p(T,I,C){for(var S=0,O=0,R=0,z=0,X=0,H=C.length,G=[],q=[];S<H;++S)G[S]=q[S]=S,I[S]=C[S];for(;X<q.length;++X)S=q[X],O=T[S].L,R=T[S].R,z=T[S].C,G[S]===S&&(O!==-1&&G[O]!==O&&(G[S]=G[O]),R!==-1&&G[R]!==R&&(G[S]=G[R])),z!==-1&&(G[z]=S),O!==-1&&S!=G[S]&&(G[O]=G[S],q.lastIndexOf(O)<X&&q.push(O)),R!==-1&&S!=G[S]&&(G[R]=G[S],q.lastIndexOf(R)<X&&q.push(R));for(S=1;S<H;++S)G[S]===S&&(R!==-1&&G[R]!==R?G[S]=G[R]:O!==-1&&G[O]!==O&&(G[S]=G[O]));for(S=1;S<H;++S)if(T[S].type!==0){if(X=S,X!=G[X])do X=G[X],I[S]=I[X]+"/"+I[S];while(X!==0&&G[X]!==-1&&X!=G[X]);G[S]=-1}for(I[0]+="/",S=1;S<H;++S)T[S].type!==2&&(I[S]+="/")}function m(T,I,C){for(var S=T.start,O=T.size,R=[],z=S;C&&O>0&&z>=0;)R.push(I.slice(z*B,z*B+B)),O-=B,z=fa(C,z*4);return R.length===0?ft(0):Dn(R).slice(0,T.size)}function x(T,I,C,S,O){var R=Y;if(T===Y){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var z=C[T],X=(S>>>2)-1;if(!z)return;for(var H=0;H<X&&(R=fa(z,H*4))!==Y;++H)O.push(R);x(fa(z,S-4),I-1,C,S,O)}}function v(T,I,C,S,O){var R=[],z=[];O||(O=[]);var X=S-1,H=0,G=0;for(H=I;H>=0;){O[H]=!0,R[R.length]=H,z.push(T[H]);var q=C[Math.floor(H*4/S)];if(G=H*4&X,S<4+G)throw new Error("FAT boundary crossed: "+H+" 4 "+S);if(!T[q])break;H=fa(T[q],G)}return{nodes:R,data:ax([z])}}function y(T,I,C,S){var O=T.length,R=[],z=[],X=[],H=[],G=S-1,q=0,Z=0,ie=0,le=0;for(q=0;q<O;++q)if(X=[],ie=q+I,ie>=O&&(ie-=O),!z[ie]){H=[];var ee=[];for(Z=ie;Z>=0;){ee[Z]=!0,z[Z]=!0,X[X.length]=Z,H.push(T[Z]);var ce=C[Math.floor(Z*4/S)];if(le=Z*4&G,S<4+le)throw new Error("FAT boundary crossed: "+Z+" 4 "+S);if(!T[ce]||(Z=fa(T[ce],le),ee[Z]))break}R[ie]={nodes:X,data:ax([H])}}return R}function g(T,I,C,S,O,R,z,X){for(var H=0,G=S.length?2:0,q=I[T].data,Z=0,ie=0,le;Z<q.length;Z+=128){var ee=q.slice(Z,Z+128);yt(ee,64),ie=ee.read_shift(2),le=Z0(ee,0,ie-G),S.push(le);var ce={name:le,type:ee.read_shift(1),color:ee.read_shift(1),L:ee.read_shift(4,"i"),R:ee.read_shift(4,"i"),C:ee.read_shift(4,"i"),clsid:ee.read_shift(16),state:ee.read_shift(4,"i"),start:0,size:0},_e=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);_e!==0&&(ce.ct=_(ee,ee.l-8));var Ge=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);Ge!==0&&(ce.mt=_(ee,ee.l-8)),ce.start=ee.read_shift(4,"i"),ce.size=ee.read_shift(4,"i"),ce.size<0&&ce.start<0&&(ce.size=ce.type=0,ce.start=Y,ce.name=""),ce.type===5?(H=ce.start,O>0&&H!==Y&&(I[H].name="!StreamData")):ce.size>=4096?(ce.storage="fat",I[ce.start]===void 0&&(I[ce.start]=v(C,ce.start,I.fat_addrs,I.ssz)),I[ce.start].name=ce.name,ce.content=I[ce.start].data.slice(0,ce.size)):(ce.storage="minifat",ce.size<0?ce.size=0:H!==Y&&ce.start!==Y&&I[H]&&(ce.content=m(ce,I[H].data,(I[X]||{}).data))),ce.content&&yt(ce.content,0),R[le]=ce,z.push(ce)}}function _(T,I){return new Date((Qt(T,I+4)/1e7*Math.pow(2,32)+Qt(T,I)/1e7-11644473600)*1e3)}function w(T,I){return u(),o(f.readFileSync(T),I)}function E(T,I){var C=I&&I.type;switch(C||be&&Buffer.isBuffer(T)&&(C="buffer"),C||"base64"){case"file":return w(T,I);case"base64":return o(br(Yt(T)),I);case"binary":return o(br(T),I)}return o(T,I)}function k(T,I){var C=I||{},S=C.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=S+"/",T.FileIndex[0]={name:S,type:5}),C.CLSID&&(T.FileIndex[0].clsid=C.CLSID),F(T)}function F(T){var I="Sh33tJ5";if(!Fe.find(T,"/"+I)){var C=ft(4);C[0]=55,C[1]=C[3]=50,C[2]=54,T.FileIndex.push({name:I,type:2,content:C,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+I),b(T)}}function b(T,I){k(T);for(var C=!1,S=!1,O=T.FullPaths.length-1;O>=0;--O){var R=T.FileIndex[O];switch(R.type){case 0:S?C=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(R.R*R.L*R.C)&&(C=!0),R.R>-1&&R.L>-1&&R.R==R.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!I)){var z=new Date(1987,1,19),X=0,H=Object.create?Object.create(null):{},G=[];for(O=0;O<T.FullPaths.length;++O)H[T.FullPaths[O]]=!0,T.FileIndex[O].type!==0&&G.push([T.FullPaths[O],T.FileIndex[O]]);for(O=0;O<G.length;++O){var q=n(G[O][0]);S=H[q],S||(G.push([q,{name:a(q).replace("/",""),type:1,clsid:ue,ct:z,mt:z,content:null}]),H[q]=!0)}for(G.sort(function(le,ee){return r(le[0],ee[0])}),T.FullPaths=[],T.FileIndex=[],O=0;O<G.length;++O)T.FullPaths[O]=G[O][0],T.FileIndex[O]=G[O][1];for(O=0;O<G.length;++O){var Z=T.FileIndex[O],ie=T.FullPaths[O];if(Z.name=a(ie).replace("/",""),Z.L=Z.R=Z.C=-(Z.color=1),Z.size=Z.content?Z.content.length:0,Z.start=0,Z.clsid=Z.clsid||ue,O===0)Z.C=G.length>1?1:-1,Z.size=0,Z.type=5;else if(ie.slice(-1)=="/"){for(X=O+1;X<G.length&&n(T.FullPaths[X])!=ie;++X);for(Z.C=X>=G.length?-1:X,X=O+1;X<G.length&&n(T.FullPaths[X])!=n(ie);++X);Z.R=X>=G.length?-1:X,Z.type=1}else n(T.FullPaths[O+1]||"")==n(ie)&&(Z.R=O+1),Z.type=2}}}function L(T,I){var C=I||{};if(C.fileType=="mad")return W7(T,C);switch(b(T),C.fileType){case"zip":return L7(T,C)}var S=function(le){for(var ee=0,ce=0,_e=0;_e<le.FileIndex.length;++_e){var Ge=le.FileIndex[_e];if(Ge.content){var qe=Ge.content.length;qe>0&&(qe<4096?ee+=qe+63>>6:ce+=qe+511>>9)}}for(var It=le.FullPaths.length+3>>2,bs=ee+7>>3,Ss=ee+127>>7,Fs=bs+ce+It+Ss,ya=Fs+127>>7,Kf=ya<=109?0:Math.ceil((ya-109)/127);Fs+ya+Kf+127>>7>ya;)Kf=++ya<=109?0:Math.ceil((ya-109)/127);var gn=[1,Kf,ya,Ss,It,ce,ee,0];return le.FileIndex[0].size=ee<<6,gn[7]=(le.FileIndex[0].start=gn[0]+gn[1]+gn[2]+gn[3]+gn[4]+gn[5])+(gn[6]+7>>3),gn}(T),O=ft(S[7]<<9),R=0,z=0;{for(R=0;R<8;++R)O.write_shift(1,re[R]);for(R=0;R<8;++R)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),R=0;R<3;++R)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,S[2]),O.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:Y),O.write_shift(4,S[3]),O.write_shift(-4,S[1]?S[0]-1:Y),O.write_shift(4,S[1]),R=0;R<109;++R)O.write_shift(-4,R<S[2]?S[1]+R:-1)}if(S[1])for(z=0;z<S[1];++z){for(;R<236+z*127;++R)O.write_shift(-4,R<S[2]?S[1]+R:-1);O.write_shift(-4,z===S[1]-1?Y:z+1)}var X=function(le){for(z+=le;R<z-1;++R)O.write_shift(-4,R+1);le&&(++R,O.write_shift(-4,Y))};for(z=R=0,z+=S[1];R<z;++R)O.write_shift(-4,ne.DIFSECT);for(z+=S[2];R<z;++R)O.write_shift(-4,ne.FATSECT);X(S[3]),X(S[4]);for(var H=0,G=0,q=T.FileIndex[0];H<T.FileIndex.length;++H)q=T.FileIndex[H],q.content&&(G=q.content.length,!(G<4096)&&(q.start=z,X(G+511>>9)));for(X(S[6]+7>>3);O.l&511;)O.write_shift(-4,ne.ENDOFCHAIN);for(z=R=0,H=0;H<T.FileIndex.length;++H)q=T.FileIndex[H],q.content&&(G=q.content.length,!(!G||G>=4096)&&(q.start=z,X(G+63>>6)));for(;O.l&511;)O.write_shift(-4,ne.ENDOFCHAIN);for(R=0;R<S[4]<<2;++R){var Z=T.FullPaths[R];if(!Z||Z.length===0){for(H=0;H<17;++H)O.write_shift(4,0);for(H=0;H<3;++H)O.write_shift(4,-1);for(H=0;H<12;++H)O.write_shift(4,0);continue}q=T.FileIndex[R],R===0&&(q.start=q.size?q.start-1:Y);var ie=R===0&&C.root||q.name;if(G=2*(ie.length+1),O.write_shift(64,ie,"utf16le"),O.write_shift(2,G),O.write_shift(1,q.type),O.write_shift(1,q.color),O.write_shift(-4,q.L),O.write_shift(-4,q.R),O.write_shift(-4,q.C),q.clsid)O.write_shift(16,q.clsid,"hex");else for(H=0;H<4;++H)O.write_shift(4,0);O.write_shift(4,q.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,q.start),O.write_shift(4,q.size),O.write_shift(4,0)}for(R=1;R<T.FileIndex.length;++R)if(q=T.FileIndex[R],q.size>=4096)if(O.l=q.start+1<<9,be&&Buffer.isBuffer(q.content))q.content.copy(O,O.l,0,q.size),O.l+=q.size+511&-512;else{for(H=0;H<q.size;++H)O.write_shift(1,q.content[H]);for(;H&511;++H)O.write_shift(1,0)}for(R=1;R<T.FileIndex.length;++R)if(q=T.FileIndex[R],q.size>0&&q.size<4096)if(be&&Buffer.isBuffer(q.content))q.content.copy(O,O.l,0,q.size),O.l+=q.size+63&-64;else{for(H=0;H<q.size;++H)O.write_shift(1,q.content[H]);for(;H&63;++H)O.write_shift(1,0)}if(be)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function U(T,I){var C=T.FullPaths.map(function(H){return H.toUpperCase()}),S=C.map(function(H){var G=H.split("/");return G[G.length-(H.slice(-1)=="/"?2:1)]}),O=!1;I.charCodeAt(0)===47?(O=!0,I=C[0].slice(0,-1)+I):O=I.indexOf("/")!==-1;var R=I.toUpperCase(),z=O===!0?C.indexOf(R):S.indexOf(R);if(z!==-1)return T.FileIndex[z];var X=!R.match(Ki);for(R=R.replace(Nt,""),X&&(R=R.replace(Ki,"!")),z=0;z<C.length;++z)if((X?C[z].replace(Ki,"!"):C[z]).replace(Nt,"")==R||(X?S[z].replace(Ki,"!"):S[z]).replace(Nt,"")==R)return T.FileIndex[z];return null}var B=64,Y=-2,se="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function De(T,I,C){u();var S=L(T,C);f.writeFileSync(I,S)}function W(T){for(var I=new Array(T.length),C=0;C<T.length;++C)I[C]=String.fromCharCode(T[C]);return I.join("")}function pe(T,I){var C=L(T,I);switch(I&&I.type||"buffer"){case"file":return u(),f.writeFileSync(I.filename,C),C;case"binary":return typeof C=="string"?C:W(C);case"base64":return ym(typeof C=="string"?C:W(C));case"buffer":if(be)return Buffer.isBuffer(C)?C:aa(C);case"array":return typeof C=="string"?br(C):C}return C}var me;function N(T){try{var I=T.InflateRaw,C=new I;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)me=T;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function V(T,I){if(!me)return zv(T,I);var C=me.InflateRaw,S=new C,O=S._processChunk(T.slice(T.l),S._finishFlushFlag);return T.l+=S.bytesRead,O}function M(T){return me?me.deflateRawSync(T):ke(T)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(T){var I=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(I>>16|I>>8|I)&255}for(var ae=typeof Uint8Array<"u",j=ae?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)j[Pe]=fe(Pe);function D(T,I){var C=j[T&255];return I<=8?C>>>8-I:(C=C<<8|j[T>>8&255],I<=16?C>>>16-I:(C=C<<8|j[T>>16&255],C>>>24-I))}function tt(T,I){var C=I&7,S=I>>>3;return(T[S]|(C<=6?0:T[S+1]<<8))>>>C&3}function Le(T,I){var C=I&7,S=I>>>3;return(T[S]|(C<=5?0:T[S+1]<<8))>>>C&7}function Ve(T,I){var C=I&7,S=I>>>3;return(T[S]|(C<=4?0:T[S+1]<<8))>>>C&15}function Te(T,I){var C=I&7,S=I>>>3;return(T[S]|(C<=3?0:T[S+1]<<8))>>>C&31}function oe(T,I){var C=I&7,S=I>>>3;return(T[S]|(C<=1?0:T[S+1]<<8))>>>C&127}function rt(T,I,C){var S=I&7,O=I>>>3,R=(1<<C)-1,z=T[O]>>>S;return C<8-S||(z|=T[O+1]<<8-S,C<16-S)||(z|=T[O+2]<<16-S,C<24-S)||(z|=T[O+3]<<24-S),z&R}function dr(T,I,C){var S=I&7,O=I>>>3;return S<=5?T[O]|=(C&7)<<S:(T[O]|=C<<S&255,T[O+1]=(C&7)>>8-S),I+3}function Kr(T,I,C){var S=I&7,O=I>>>3;return C=(C&1)<<S,T[O]|=C,I+1}function mn(T,I,C){var S=I&7,O=I>>>3;return C<<=S,T[O]|=C&255,C>>>=8,T[O+1]=C,I+8}function As(T,I,C){var S=I&7,O=I>>>3;return C<<=S,T[O]|=C&255,C>>>=8,T[O+1]=C&255,T[O+2]=C>>>8,I+16}function $n(T,I){var C=T.length,S=2*C>I?2*C:I+5,O=0;if(C>=I)return T;if(be){var R=wm(S);if(T.copy)T.copy(R);else for(;O<T.length;++O)R[O]=T[O];return R}else if(ae){var z=new Uint8Array(S);if(z.set)z.set(T);else for(;O<C;++O)z[O]=T[O];return z}return T.length=S,T}function Zt(T){for(var I=new Array(T),C=0;C<T;++C)I[C]=0;return I}function xn(T,I,C){var S=1,O=0,R=0,z=0,X=0,H=T.length,G=ae?new Uint16Array(32):Zt(32);for(R=0;R<32;++R)G[R]=0;for(R=H;R<C;++R)T[R]=0;H=T.length;var q=ae?new Uint16Array(H):Zt(H);for(R=0;R<H;++R)G[O=T[R]]++,S<O&&(S=O),q[R]=0;for(G[0]=0,R=1;R<=S;++R)G[R+16]=X=X+G[R-1]<<1;for(R=0;R<H;++R)X=T[R],X!=0&&(q[R]=G[X+16]++);var Z=0;for(R=0;R<H;++R)if(Z=T[R],Z!=0)for(X=D(q[R],S)>>S-Z,z=(1<<S+4-Z)-1;z>=0;--z)I[X|z<<Z]=Z&15|R<<4;return S}var Hn=ae?new Uint16Array(512):Zt(512),Cs=ae?new Uint16Array(32):Zt(32);if(!ae){for(var Mt=0;Mt<512;++Mt)Hn[Mt]=0;for(Mt=0;Mt<32;++Mt)Cs[Mt]=0}(function(){for(var T=[],I=0;I<32;I++)T.push(5);xn(T,Cs,32);var C=[];for(I=0;I<=143;I++)C.push(8);for(;I<=255;I++)C.push(9);for(;I<=279;I++)C.push(7);for(;I<=287;I++)C.push(8);xn(C,Hn,288)})();var Xr=function(){for(var I=ae?new Uint8Array(32768):[],C=0,S=0;C<te.length-1;++C)for(;S<te[C+1];++S)I[S]=C;for(;S<32768;++S)I[S]=29;var O=ae?new Uint8Array(259):[];for(C=0,S=0;C<J.length-1;++C)for(;S<J[C+1];++S)O[S]=C;function R(X,H){for(var G=0;G<X.length;){var q=Math.min(65535,X.length-G),Z=G+q==X.length;for(H.write_shift(1,+Z),H.write_shift(2,q),H.write_shift(2,~q&65535);q-- >0;)H[H.l++]=X[G++]}return H.l}function z(X,H){for(var G=0,q=0,Z=ae?new Uint16Array(32768):[];q<X.length;){var ie=Math.min(65535,X.length-q);if(ie<10){for(G=dr(H,G,+(q+ie==X.length)),G&7&&(G+=8-(G&7)),H.l=G/8|0,H.write_shift(2,ie),H.write_shift(2,~ie&65535);ie-- >0;)H[H.l++]=X[q++];G=H.l*8;continue}G=dr(H,G,+(q+ie==X.length)+2);for(var le=0;ie-- >0;){var ee=X[q];le=(le<<5^ee)&32767;var ce=-1,_e=0;if((ce=Z[le])&&(ce|=q&-32768,ce>q&&(ce-=32768),ce<q))for(;X[ce+_e]==X[q+_e]&&_e<250;)++_e;if(_e>2){ee=O[_e],ee<=22?G=mn(H,G,j[ee+1]>>1)-1:(mn(H,G,3),G+=5,mn(H,G,j[ee-23]>>5),G+=3);var Ge=ee<8?0:ee-4>>2;Ge>0&&(As(H,G,_e-J[ee]),G+=Ge),ee=I[q-ce],G=mn(H,G,j[ee]>>3),G-=3;var qe=ee<4?0:ee-2>>1;qe>0&&(As(H,G,q-ce-te[ee]),G+=qe);for(var It=0;It<_e;++It)Z[le]=q&32767,le=(le<<5^X[q])&32767,++q;ie-=_e-1}else ee<=143?ee=ee+48:G=Kr(H,G,1),G=mn(H,G,j[ee]),Z[le]=q&32767,++q}G=mn(H,G,0)-1}return H.l=(G+7)/8|0,H.l}return function(H,G){return H.length<8?R(H,G):z(H,G)}}();function ke(T){var I=ft(50+Math.floor(T.length*1.1)),C=Xr(T,I);return I.slice(0,C)}var nt=ae?new Uint16Array(32768):Zt(32768),pr=ae?new Uint16Array(32768):Zt(32768),dt=ae?new Uint16Array(128):Zt(128),_a=1,Wv=1;function N7(T,I){var C=Te(T,I)+257;I+=5;var S=Te(T,I)+1;I+=5;var O=Ve(T,I)+4;I+=4;for(var R=0,z=ae?new Uint8Array(19):Zt(19),X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=1,G=ae?new Uint8Array(8):Zt(8),q=ae?new Uint8Array(8):Zt(8),Z=z.length,ie=0;ie<O;++ie)z[P[ie]]=R=Le(T,I),H<R&&(H=R),G[R]++,I+=3;var le=0;for(G[0]=0,ie=1;ie<=H;++ie)q[ie]=le=le+G[ie-1]<<1;for(ie=0;ie<Z;++ie)(le=z[ie])!=0&&(X[ie]=q[le]++);var ee=0;for(ie=0;ie<Z;++ie)if(ee=z[ie],ee!=0){le=j[X[ie]]>>8-ee;for(var ce=(1<<7-ee)-1;ce>=0;--ce)dt[le|ce<<ee]=ee&7|ie<<3}var _e=[];for(H=1;_e.length<C+S;)switch(le=dt[oe(T,I)],I+=le&7,le>>>=3){case 16:for(R=3+tt(T,I),I+=2,le=_e[_e.length-1];R-- >0;)_e.push(le);break;case 17:for(R=3+Le(T,I),I+=3;R-- >0;)_e.push(0);break;case 18:for(R=11+oe(T,I),I+=7;R-- >0;)_e.push(0);break;default:_e.push(le),H<le&&(H=le);break}var Ge=_e.slice(0,C),qe=_e.slice(C);for(ie=C;ie<286;++ie)Ge[ie]=0;for(ie=S;ie<30;++ie)qe[ie]=0;return _a=xn(Ge,nt,286),Wv=xn(qe,pr,30),I}function D7(T,I){if(T[0]==3&&!(T[1]&3))return[Nn(I),2];for(var C=0,S=0,O=wm(I||1<<18),R=0,z=O.length>>>0,X=0,H=0;(S&1)==0;){if(S=Le(T,C),C+=3,S>>>1)S>>1==1?(X=9,H=5):(C=N7(T,C),X=_a,H=Wv);else{C&7&&(C+=8-(C&7));var G=T[C>>>3]|T[(C>>>3)+1]<<8;if(C+=32,G>0)for(!I&&z<R+G&&(O=$n(O,R+G),z=O.length);G-- >0;)O[R++]=T[C>>>3],C+=8;continue}for(;;){!I&&z<R+32767&&(O=$n(O,R+32767),z=O.length);var q=rt(T,C,X),Z=S>>>1==1?Hn[q]:nt[q];if(C+=Z&15,Z>>>=4,(Z>>>8&255)===0)O[R++]=Z;else{if(Z==256)break;Z-=257;var ie=Z<8?0:Z-4>>2;ie>5&&(ie=0);var le=R+J[Z];ie>0&&(le+=rt(T,C,ie),C+=ie),q=rt(T,C,H),Z=S>>>1==1?Cs[q]:pr[q],C+=Z&15,Z>>>=4;var ee=Z<4?0:Z-2>>1,ce=te[Z];for(ee>0&&(ce+=rt(T,C,ee),C+=ee),!I&&z<le&&(O=$n(O,le+100),z=O.length);R<le;)O[R]=O[R-ce],++R}}}return I?[O,C+7>>>3]:[O.slice(0,R),C+7>>>3]}function zv(T,I){var C=T.slice(T.l||0),S=D7(C,I);return T.l+=S[1],S[0]}function Gv(T,I){if(T)typeof console<"u"&&console.error(I);else throw new Error(I)}function qv(T,I){var C=T;yt(C,0);var S=[],O=[],R={FileIndex:S,FullPaths:O};k(R,{root:I.root});for(var z=C.length-4;(C[z]!=80||C[z+1]!=75||C[z+2]!=5||C[z+3]!=6)&&z>=0;)--z;C.l=z+4,C.l+=4;var X=C.read_shift(2);C.l+=6;var H=C.read_shift(4);for(C.l=H,z=0;z<X;++z){C.l+=20;var G=C.read_shift(4),q=C.read_shift(4),Z=C.read_shift(2),ie=C.read_shift(2),le=C.read_shift(2);C.l+=8;var ee=C.read_shift(4),ce=c(C.slice(C.l+Z,C.l+Z+ie));C.l+=Z+ie+le;var _e=C.l;C.l=ee+4,P7(C,G,q,R,ce),C.l=_e}return R}function P7(T,I,C,S,O){T.l+=2;var R=T.read_shift(2),z=T.read_shift(2),X=s(T);if(R&8257)throw new Error("Unsupported ZIP encryption");for(var H=T.read_shift(4),G=T.read_shift(4),q=T.read_shift(4),Z=T.read_shift(2),ie=T.read_shift(2),le="",ee=0;ee<Z;++ee)le+=String.fromCharCode(T[T.l++]);if(ie){var ce=c(T.slice(T.l,T.l+ie));(ce[21589]||{}).mt&&(X=ce[21589].mt),((O||{})[21589]||{}).mt&&(X=O[21589].mt)}T.l+=ie;var _e=T.slice(T.l,T.l+G);switch(z){case 8:_e=V(T,q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+z)}var Ge=!1;R&8&&(H=T.read_shift(4),H==134695760&&(H=T.read_shift(4),Ge=!0),G=T.read_shift(4),q=T.read_shift(4)),G!=I&&Gv(Ge,"Bad compressed size: "+I+" != "+G),q!=C&&Gv(Ge,"Bad uncompressed size: "+C+" != "+q),qf(S,le,_e,{unsafe:!0,mt:X})}function L7(T,I){var C=I||{},S=[],O=[],R=ft(1),z=C.compression?8:0,X=0,H=0,G=0,q=0,Z=0,ie=T.FullPaths[0],le=ie,ee=T.FileIndex[0],ce=[],_e=0;for(H=1;H<T.FullPaths.length;++H)if(le=T.FullPaths[H].slice(ie.length),ee=T.FileIndex[H],!(!ee.size||!ee.content||le=="Sh33tJ5")){var Ge=q,qe=ft(le.length);for(G=0;G<le.length;++G)qe.write_shift(1,le.charCodeAt(G)&127);qe=qe.slice(0,qe.l),ce[Z]=o8.buf(ee.content,0);var It=ee.content;z==8&&(It=M(It)),R=ft(30),R.write_shift(4,67324752),R.write_shift(2,20),R.write_shift(2,X),R.write_shift(2,z),ee.mt?i(R,ee.mt):R.write_shift(4,0),R.write_shift(-4,ce[Z]),R.write_shift(4,It.length),R.write_shift(4,ee.content.length),R.write_shift(2,qe.length),R.write_shift(2,0),q+=R.length,S.push(R),q+=qe.length,S.push(qe),q+=It.length,S.push(It),R=ft(46),R.write_shift(4,33639248),R.write_shift(2,0),R.write_shift(2,20),R.write_shift(2,X),R.write_shift(2,z),R.write_shift(4,0),R.write_shift(-4,ce[Z]),R.write_shift(4,It.length),R.write_shift(4,ee.content.length),R.write_shift(2,qe.length),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(4,0),R.write_shift(4,Ge),_e+=R.l,O.push(R),_e+=qe.length,O.push(qe),++Z}return R=ft(22),R.write_shift(4,101010256),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,Z),R.write_shift(2,Z),R.write_shift(4,_e),R.write_shift(4,q),R.write_shift(2,0),Dn([Dn(S),Dn(O),R])}var Lc={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function B7(T,I){if(T.ctype)return T.ctype;var C=T.name||"",S=C.match(/\.([^\.]+)$/);return S&&Lc[S[1]]||I&&(S=(C=I).match(/[\.\\]([^\.\\])+$/),S&&Lc[S[1]])?Lc[S[1]]:"application/octet-stream"}function M7(T){for(var I=ym(T),C=[],S=0;S<I.length;S+=76)C.push(I.slice(S,S+76));return C.join(`\r
`)+`\r
`}function U7(T){var I=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(G){var q=G.charCodeAt(0).toString(16).toUpperCase();return"="+(q.length==1?"0"+q:q)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],S=I.split(`\r
`),O=0;O<S.length;++O){var R=S[O];if(R.length==0){C.push("");continue}for(var z=0;z<R.length;){var X=76,H=R.slice(z,z+X);H.charAt(X-1)=="="?X--:H.charAt(X-2)=="="?X-=2:H.charAt(X-3)=="="&&(X-=3),H=R.slice(z,z+X),z+=X,z<R.length&&(H+="="),C.push(H)}}return C.join(`\r
`)}function V7(T){for(var I=[],C=0;C<T.length;++C){for(var S=T[C];C<=T.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+T[++C];I.push(S)}for(var O=0;O<I.length;++O)I[O]=I[O].replace(/[=][0-9A-Fa-f]{2}/g,function(R){return String.fromCharCode(parseInt(R.slice(1),16))});return br(I.join(`\r
`))}function $7(T,I,C){for(var S="",O="",R="",z,X=0;X<10;++X){var H=I[X];if(!H||H.match(/^\s*$/))break;var G=H.match(/^(.*?):\s*([^\s].*)$/);if(G)switch(G[1].toLowerCase()){case"content-location":S=G[2].trim();break;case"content-type":R=G[2].trim();break;case"content-transfer-encoding":O=G[2].trim();break}}switch(++X,O.toLowerCase()){case"base64":z=br(Yt(I.slice(X).join("")));break;case"quoted-printable":z=V7(I.slice(X));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var q=qf(T,S.slice(C.length),z,{unsafe:!0});R&&(q.ctype=R)}function H7(T,I){if(W(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=I&&I.root||"",S=(be&&Buffer.isBuffer(T)?T.toString("binary"):W(T)).split(`\r
`),O=0,R="";for(O=0;O<S.length;++O)if(R=S[O],!!/^Content-Location:/i.test(R)&&(R=R.slice(R.indexOf("file")),C||(C=R.slice(0,R.lastIndexOf("/")+1)),R.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),R.slice(0,C.length)!=C););var z=(S[1]||"").match(/boundary="(.*?)"/);if(!z)throw new Error("MAD cannot find boundary");var X="--"+(z[1]||""),H=[],G=[],q={FileIndex:H,FullPaths:G};k(q);var Z,ie=0;for(O=0;O<S.length;++O){var le=S[O];le!==X&&le!==X+"--"||(ie++&&$7(q,S.slice(Z,O),C),Z=O)}return q}function W7(T,I){var C=I||{},S=C.boundary||"SheetJS";S="------="+S;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],R=T.FullPaths[0],z=R,X=T.FileIndex[0],H=1;H<T.FullPaths.length;++H)if(z=T.FullPaths[H].slice(R.length),X=T.FileIndex[H],!(!X.size||!X.content||z=="Sh33tJ5")){z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var G=X.content,q=be&&Buffer.isBuffer(G)?G.toString("binary"):W(G),Z=0,ie=Math.min(1024,q.length),le=0,ee=0;ee<=ie;++ee)(le=q.charCodeAt(ee))>=32&&le<128&&++Z;var ce=Z>=ie*4/5;O.push(S),O.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+z),O.push("Content-Transfer-Encoding: "+(ce?"quoted-printable":"base64")),O.push("Content-Type: "+B7(X,z)),O.push(""),O.push(ce?U7(q):M7(q))}return O.push(S+`--\r
`),O.join(`\r
`)}function z7(T){var I={};return k(I,T),I}function qf(T,I,C,S){var O=S&&S.unsafe;O||k(T);var R=!O&&Fe.find(T,I);if(!R){var z=T.FullPaths[0];I.slice(0,z.length)==z?z=I:(z.slice(-1)!="/"&&(z+="/"),z=(z+I).replace("//","/")),R={name:a(I),type:2},T.FileIndex.push(R),T.FullPaths.push(z),O||Fe.utils.cfb_gc(T)}return R.content=C,R.size=C?C.length:0,S&&(S.CLSID&&(R.clsid=S.CLSID),S.mt&&(R.mt=S.mt),S.ct&&(R.ct=S.ct)),R}function G7(T,I){k(T);var C=Fe.find(T,I);if(C){for(var S=0;S<T.FileIndex.length;++S)if(T.FileIndex[S]==C)return T.FileIndex.splice(S,1),T.FullPaths.splice(S,1),!0}return!1}function q7(T,I,C){k(T);var S=Fe.find(T,I);if(S){for(var O=0;O<T.FileIndex.length;++O)if(T.FileIndex[O]==S)return T.FileIndex[O].name=a(C),T.FullPaths[O]=C,!0}return!1}function K7(T){b(T,!0)}return t.find=U,t.read=E,t.parse=o,t.write=pe,t.writeFile=De,t.utils={cfb_new:z7,cfb_add:qf,cfb_del:G7,cfb_mov:q7,cfb_gc:K7,ReadShift:es,CheckField:wx,prep_blob:yt,bconcat:Dn,use_zlib:N,_deflateRaw:ke,_inflateRaw:zv,consts:ne},t}();function c8(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Hr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function K0(e){for(var t=[],r=Hr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var oc=new Date(1899,11,30,0,0,0);function Pt(e,t){var r=e.getTime(),n=oc.getTime()+(e.getTimezoneOffset()-oc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var $m=new Date,u8=oc.getTime()+($m.getTimezoneOffset()-oc.getTimezoneOffset())*6e4,Hm=$m.getTimezoneOffset();function cc(e){var t=new Date;return t.setTime(e*24*60*60*1e3+u8),t.getTimezoneOffset()!==Hm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Hm)*6e4),t}function f8(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var Wm=new Date("2017-02-19T19:06:09.000Z"),zm=isNaN(Wm.getFullYear())?new Date("2/19/17"):Wm,l8=zm.getFullYear()==2017;function pt(e,t){var r=new Date(e);if(l8)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(zm.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ua(e,t){if(be&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ji(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ji(vm(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ji(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ji(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function _t(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=_t(e[r]));return t}function Je(e,t){for(var r="";r.length<t;)r+=e;return r}function Fr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var h8=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ja(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&h8.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var d8=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],c=1;c<i.length;++c)s.push(a),s.push(i[c]);return s}}();function Gm(e){return e?e.content&&e.type?ua(e.content,!0):e.data?qi(e.data):e.asNodeBuffer&&be?qi(e.asNodeBuffer().toString("binary")):e.asBinary?qi(e.asBinary()):e._data&&e._data.getContent?qi(ua(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function qm(e){if(!e)return null;if(e.data)return gm(e.data);if(e.asNodeBuffer&&be)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?gm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function p8(e){return e&&e.name.slice(-4)===".bin"?qm(e):Gm(e)}function fr(e,t){for(var r=e.FullPaths||Hr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function X0(e,t){var r=fr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function at(e,t,r){if(!r)return p8(X0(e,t));if(!t)return null;try{return at(e,t)}catch{return null}}function Jt(e,t,r){if(!r)return Gm(X0(e,t));if(!t)return null;try{return Jt(e,t)}catch{return null}}function m8(e,t,r){return qm(X0(e,t))}function Km(e){for(var t=e.FullPaths||Hr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function x8(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return be?n=aa(r):n=P6(r),Fe.utils.cfb_add(e,t,n)}Fe.utils.cfb_add(e,t,r)}else e.file(t,r)}function Xm(e,t){switch(t.type){case"base64":return Fe.read(e,{type:"base64"});case"binary":return Fe.read(e,{type:"binary"});case"buffer":case"array":return Fe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Yi(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Ym=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,g8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Jm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,v8=/<[^>]*>/g,kt=Ym.match(Jm)?Jm:v8,_8=/<\w*:/,y8=/<(\/?)\w+:/;function xe(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(g8),c=0,f="",u=0,o="",l="",h=1;if(s)for(u=0;u!=s.length;++u){for(l=s[u],i=0;i!=l.length&&l.charCodeAt(i)!==61;++i);for(o=l.slice(0,i).trim();l.charCodeAt(i+1)==32;)++i;for(h=(a=l.charCodeAt(i+1))==34||a==39?1:0,f=l.slice(i+1+h,l.length-h),c=0;c!=o.length&&o.charCodeAt(c)!==58;++c);if(c===o.length)o.indexOf("_")>0&&(o=o.slice(0,o.indexOf("_"))),n[o]=f,n[o.toLowerCase()]=f;else{var d=(c===5&&o.slice(0,5)==="xmlns"?"xmlns":"")+o.slice(c+1);if(n[d]&&o.slice(c-3,c)=="ext")continue;n[d]=f,n[d.toLowerCase()]=f}}return n}function Wr(e){return e.replace(y8,"<$1")}var Qm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},w8=K0(Qm),Ne=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(c,f){return Qm[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,f){return String.fromCharCode(parseInt(f,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),E8=/[&<>'"]/g,k8=/[\u0000-\u001f]/g;function Y0(e){var t=e+"";return t.replace(E8,function(r){return w8[r]}).replace(/\n/g,"<br/>").replace(k8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Zm=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function ze(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function J0(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),c=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function jm(e){var t=Nn(2*e.length),r,n,a=1,i=0,s=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(r=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function ex(e){return aa(e,"binary").toString("utf8")}var uc="foo bar bazâð£",He=be&&(ex(uc)==J0(uc)&&ex||jm(uc)==J0(uc)&&jm)||J0,Ji=be?function(e){return aa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Qi=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),tx=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),T8=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),A8=/<\/?(?:vt:)?variant>/g,C8=/<(?:vt:)([^>]*)>([\s\S]*)</;function rx(e,t){var r=xe(e),n=e.match(T8(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(A8,"").match(C8);s&&a.push({v:He(s[2]),t:s[1]})}),a}var b8=/(^\s|\s$|\n)/;function S8(e){return Hr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function F8(e,t,r){return"<"+e+(r!=null?S8(r):"")+(t!=null?(t.match(b8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Q0(e){if(be&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return He(ia(W0(e)));throw new Error("Bad input format: expected Buffer or string")}var Zi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,I8={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},O8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function R8(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function N8(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var nx=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},ax=be?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:aa(t)})):nx(e)}:nx,ix=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(un(e,a)));return n.join("").replace(Nt,"")},Z0=be?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Nt,""):ix(e,t,r)}:ix,sx=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},ox=be?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):sx(e,t,r)}:sx,cx=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Qa(e,a)));return n.join("")},ji=be?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):cx(t,r,n)}:cx,ux=function(e,t){var r=Qt(e,t);return r>0?ji(e,t+4,t+4+r-1):""},fx=ux,lx=function(e,t){var r=Qt(e,t);return r>0?ji(e,t+4,t+4+r-1):""},hx=lx,dx=function(e,t){var r=2*Qt(e,t);return r>0?ji(e,t+4,t+4+r-1):""},px=dx,mx=function(t,r){var n=Qt(t,r);return n>0?Z0(t,r+4,r+4+n):""},xx=mx,gx=function(e,t){var r=Qt(e,t);return r>0?ji(e,t+4,t+4+r):""},vx=gx,_x=function(e,t){return R8(e,t)},fc=_x,yx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};be&&(fx=function(t,r){if(!Buffer.isBuffer(t))return ux(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},hx=function(t,r){if(!Buffer.isBuffer(t))return lx(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},px=function(t,r){if(!Buffer.isBuffer(t))return dx(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},xx=function(t,r){if(!Buffer.isBuffer(t))return mx(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},vx=function(t,r){if(!Buffer.isBuffer(t))return gx(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},fc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_x(t,r)},yx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Qa=function(e,t){return e[t]},un=function(e,t){return e[t+1]*256+e[t]},D8=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},fa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},P8=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function es(e,t){var r="",n,a,i=[],s,c,f,u;switch(t){case"dbcs":if(u=this.l,be&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(un(this,u)),u+=2;e*=2;break;case"utf8":r=ji(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Z0(this,this.l,this.l+e);break;case"wstr":return es.call(this,e,"dbcs");case"lpstr-ansi":r=fx(this,this.l),e=4+Qt(this,this.l);break;case"lpstr-cp":r=hx(this,this.l),e=4+Qt(this,this.l);break;case"lpwstr":r=px(this,this.l),e=4+2*Qt(this,this.l);break;case"lpp4":e=4+Qt(this,this.l),r=xx(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qt(this,this.l),r=vx(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Qa(this,this.l+e++))!==0;)i.push(nc(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=un(this,this.l+e))!==0;)i.push(nc(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Qa(this,u),this.l=u+1,c=es.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(nc(un(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Qa(this,u),this.l=u+1,c=es.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(nc(Qa(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Qa(this,this.l),this.l++,n;case 2:return n=(t==="i"?D8:un)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?fa:P8)(this,this.l),this.l+=4,n):(a=Qt(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=fc(this,this.l):a=fc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=ox(this,this.l,e);break}}return this.l+=e,r}var L8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},B8=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},M8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function U8(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)M8(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,L8(this,t,this.l);break;case 8:if(n=8,r==="f"){N8(this,t,this.l);break}case 16:break;case-4:n=4,B8(this,t,this.l);break}return this.l+=n,this}function wx(e,t){var r=ox(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function yt(e,t){e.l=t,e.read_shift=es,e.chk=wx,e.write_shift=U8}function Tt(e,t){e.l+=t}function ft(e){var t=Nn(e);return yt(t,0),t}function fn(e,t,r){if(e){var n,a,i;yt(e,e.l||0);for(var s=e.length,c=0,f=0;e.l<s;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var u=Cc[c]||Cc[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;f=e.l+i;var o=u.f&&u.f(e,i,r);if(e.l=f,t(o,u,c))return}}}function j0(){var e=[],t=be?256:2048,r=function(u){var o=ft(u);return yt(o,0),o},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),Dn(e)},c=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:s,_bufs:e}}function ts(e,t,r){var n=_t(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ex(e,t,r){var n=_t(e);return n.s=ts(n.s,t.s,r),n.e=ts(n.e,t.s,r),n}function rs(e,t){if(e.cRel&&e.c<0)for(e=_t(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=_t(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ve(e);return!e.cRel&&e.cRel!=null&&(r=H8(r)),!e.rRel&&e.rRel!=null&&(r=V8(r)),r}function ef(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+lt(e.s.c)+":"+(e.e.cRel?"":"$")+lt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+wt(e.s.r)+":"+(e.e.rRel?"":"$")+wt(e.e.r):rs(e.s,t.biff)+":"+rs(e.e,t.biff)}function tf(e){return parseInt($8(e),10)-1}function wt(e){return""+(e+1)}function V8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $8(e){return e.replace(/\$(\d+)$/,"$1")}function rf(e){for(var t=W8(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function lt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function H8(e){return e.replace(/^([A-Z])/,"$$$1")}function W8(e){return e.replace(/^\$([A-Z])/,"$1")}function z8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Lt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function ve(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Za(e){var t=e.indexOf(":");return t==-1?{s:Lt(e),e:Lt(e)}:{s:Lt(e.slice(0,t)),e:Lt(e.slice(t+1))}}function Ie(e,t){return typeof t>"u"||typeof t=="number"?Ie(e.s,e.e):(typeof e!="string"&&(e=ve(e)),typeof t!="string"&&(t=ve(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function kx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ur(e.z,r?Pt(t):t)}catch{}try{return e.w=ur((e.XF||{}).numFmtId||(r?14:0),r?Pt(t):t)}catch{return""+t}}function ln(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?pa[e.v]||e.v:t==null?kx(e,e.v):kx(e,t))}function Ln(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Tx(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?Lt(n.origin):n.origin;s=f.r,c=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var o=Qe(i["!ref"]);u.s.c=o.s.c,u.s.r=o.s.r,u.e.c=Math.max(u.e.c,o.e.c),u.e.r=Math.max(u.e.r,o.e.r),s==-1&&(u.e.r=s=o.e.r+1)}for(var l=0;l!=t.length;++l)if(t[l]){if(!Array.isArray(t[l]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[l].length;++h)if(!(typeof t[l][h]>"u")){var d={v:t[l][h]},p=s+l,m=c+h;if(u.s.r>p&&(u.s.r=p),u.s.c>m&&(u.s.c=m),u.e.r<p&&(u.e.r=p),u.e.c<m&&(u.e.c=m),t[l][h]&&typeof t[l][h]=="object"&&!Array.isArray(t[l][h])&&!(t[l][h]instanceof Date))d=t[l][h];else if(Array.isArray(d.v)&&(d.f=t[l][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ee[14],n.cellDates?(d.t="d",d.w=ur(d.z,Pt(d.v))):(d.t="n",d.v=Pt(d.v),d.w=ur(d.z,d.v))):d.t="s";if(a)i[p]||(i[p]=[]),i[p][m]&&i[p][m].z&&(d.z=i[p][m].z),i[p][m]=d;else{var x=ve({c:m,r:p});i[x]&&i[x].z&&(d.z=i[x].z),i[x]=d}}}return u.s.c<1e7&&(i["!ref"]=Ie(u)),i}function ja(e,t){return Tx(null,e,t)}function G8(e){return e.read_shift(4,"i")}function At(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function q8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function nf(e,t){var r=e.l,n=e.read_shift(1),a=At(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)i.push(q8(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var K8=nf;function lr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function la(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var X8=At;function af(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var Y8=At,sf=af;function of(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?fc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):fa(t,0)>>2;return r?a/100:a}function Ax(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ha=Ax;function Ct(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function J8(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=da[a];u&&(t.rgb=us(u));break;case 2:t.rgb=us([s,c,f]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Q8(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Cx(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Z8(e){return Cx(e,1)}function j8(e){return Cx(e,2)}var cf=2,Wt=3,lc=11,bx=12,hc=19,dc=64,eI=65,tI=71,rI=4108,nI=4126,mt=80,Sx=81,aI=[mt,Sx],iI={1:{n:"CodePage",t:cf},2:{n:"Category",t:mt},3:{n:"PresentationFormat",t:mt},4:{n:"ByteCount",t:Wt},5:{n:"LineCount",t:Wt},6:{n:"ParagraphCount",t:Wt},7:{n:"SlideCount",t:Wt},8:{n:"NoteCount",t:Wt},9:{n:"HiddenCount",t:Wt},10:{n:"MultimediaClipCount",t:Wt},11:{n:"ScaleCrop",t:lc},12:{n:"HeadingPairs",t:rI},13:{n:"TitlesOfParts",t:nI},14:{n:"Manager",t:mt},15:{n:"Company",t:mt},16:{n:"LinksUpToDate",t:lc},17:{n:"CharacterCount",t:Wt},19:{n:"SharedDoc",t:lc},22:{n:"HyperlinksChanged",t:lc},23:{n:"AppVersion",t:Wt,p:"version"},24:{n:"DigSig",t:eI},26:{n:"ContentType",t:mt},27:{n:"ContentStatus",t:mt},28:{n:"Language",t:mt},29:{n:"Version",t:mt},255:{},2147483648:{n:"Locale",t:hc},2147483651:{n:"Behavior",t:hc},1919054434:{}},sI={1:{n:"CodePage",t:cf},2:{n:"Title",t:mt},3:{n:"Subject",t:mt},4:{n:"Author",t:mt},5:{n:"Keywords",t:mt},6:{n:"Comments",t:mt},7:{n:"Template",t:mt},8:{n:"LastAuthor",t:mt},9:{n:"RevNumber",t:mt},10:{n:"EditTime",t:dc},11:{n:"LastPrinted",t:dc},12:{n:"CreatedDate",t:dc},13:{n:"ModifiedDate",t:dc},14:{n:"PageCount",t:Wt},15:{n:"WordCount",t:Wt},16:{n:"CharCount",t:Wt},17:{n:"Thumbnail",t:tI},18:{n:"Application",t:mt},19:{n:"DocSecurity",t:Wt},255:{},2147483648:{n:"Locale",t:hc},2147483651:{n:"Behavior",t:hc},1919054434:{}},Fx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},oI=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var uI=cI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),da=_t(uI),pa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ix={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ox={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function fI(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lI(e){var t=fI();if(!e||!e.match)return t;var r={};if((e.match(kt)||[]).forEach(function(n){var a=xe(n);switch(a[0].replace(_8,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Ox[a.ContentType]]!==void 0&&t[Ox[a.ContentType]].push(a.PartName);break}}),t.xmlns!==I8.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var ei={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function uf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ns(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(kt)||[]).forEach(function(a){var i=xe(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Yi(i.Target,t);r[c]=s,n[i.Id]=s}}),r["!id"]=n,r}var hI="application/vnd.oasis.opendocument.spreadsheet";function dI(e,t){for(var r=Q0(e),n,a;n=Zi.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=xe(n[0],!1),a.path=="/"&&a.type!==hI)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var as=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],pI=function(){for(var e=new Array(as.length),t=0;t<as.length;++t){var r=as[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Rx(e){var t={};e=He(e);for(var r=0;r<as.length;++r){var n=as[r],a=e.match(pI[r]);a!=null&&a.length>0&&(t[n[1]]=Ne(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=pt(t[n[1]]))}return t}var mI=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Nx(e,t,r,n){var a=[];if(typeof e=="string")a=rx(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(o){return{v:o}}));var s=typeof t=="string"?rx(t,n).map(function(o){return o.v}):t,c=0,f=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(f=+a[u+1].v,a[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=s.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=f,r.DefinedNames=s.slice(c,c+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=s.slice(c,c+f);break}c+=f}}function xI(e,t,r){var n={};return t||(t={}),e=He(e),mI.forEach(function(a){var i=(e.match(Qi(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Ne(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Nx(n.HeadingPairs,n.TitlesOfParts,t,r),t}var gI=/<[^>]+>[^<]*/g;function vI(e,t){var r={},n="",a=e.match(gI);if(a)for(var i=0;i!=a.length;++i){var s=a[i],c=xe(s);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ne(c.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var f=s.split(">"),u=f[0].slice(4),o=f[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ne(o);break;case"bool":r[n]=ze(o);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(o,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(o);break;case"filetime":case"date":r[n]=pt(o);break;case"cy":case"error":r[n]=Ne(o);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,f)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var _I={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ff;function yI(e,t,r){ff||(ff=K0(_I)),t=ff[t]||t,e[t]=r}function lf(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Dx(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Px(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Lx(e,t,r){return t===31?Px(e):Dx(e,t,r)}function hf(e,t,r){return Lx(e,t,r===!1?0:4)}function wI(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Lx(e,t,0)}function EI(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Nt,""),e.l-a&2&&(e.l+=2)}return r}function kI(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Nt,"");return r}function TI(e){var t=e.l,r=pc(e,Sx);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=pc(e,Wt);return[r,n]}function AI(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(TI(e));return r}function Bx(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Nt,"").replace(Ki,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Mx(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function CI(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function pc(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==bx&&n!==t&&aI.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===bx?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Dx(e,n,4).replace(Nt,"");case 31:return Px(e);case 64:return lf(e);case 65:return Mx(e);case 71:return CI(e);case 80:return hf(e,n,!i.raw).replace(Nt,"");case 81:return wI(e,n).replace(Nt,"");case 4108:return AI(e);case 4126:case 4127:return n==4127?EI(e):kI(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Ux(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,c=0,f=-1,u={};for(s=0;s!=a;++s){var o=e.read_shift(4),l=e.read_shift(4);i[s]=[o,l+r]}i.sort(function(y,g){return y[1]-g[1]});var h={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var d=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,d=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],d=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],d=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(d=!1,e.l=i[s][1]),d)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var p=t[i[s][0]];if(h[p.n]=pc(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Cr(c=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(i[s][0]===1){if(c=h.CodePage=pc(e,cf),Cr(c),f!==-1){var m=e.l;e.l=i[f][1],u=Bx(e,c),e.l=m}}else if(i[s][0]===0){if(c===0){f=s,e.l=i[s+1][1];continue}u=Bx(e,c)}else{var x=u[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=Mx(e);break;case 30:e.l+=4,v=hf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=hf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=et(e,4);break;case 64:e.l+=4,v=pt(lf(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=v}}return e.l=r+n,h}function Vx(e,t,r){var n=e.content;if(!n)return{};yt(n,0);var a,i,s,c,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),o=n.read_shift(16);if(o!==Fe.utils.consts.HEADER_CLSID&&o!==r)throw new Error("Bad PropertySet CLSID "+o);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(s=n.read_shift(16),f=n.read_shift(4));var l=Ux(n,t),h={SystemIdentifier:u};for(var d in l)h[d]=l[d];if(h.FMTID=i,a===1)return h;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var p;try{p=Ux(n,null)}catch{}for(d in p)h[d]=p[d];return h.FMTID=[i,s],h}function Bn(e,t){return e.read_shift(t),null}function bI(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function et(e,t){return e.read_shift(t)===1}function it(e){return e.read_shift(2,"u")}function $x(e,t){return bI(e,t,it)}function SI(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function is(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function FI(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,c,f={};a&&(s=e.read_shift(2)),n&&(c=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",o=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*s),n&&(e.l+=c),f.t=o,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function ma(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ss(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ma(e,n,r)}function xa(e,t,r){if(r.biff>5)return ss(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function II(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function OI(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Nt,"");return n&&(e.l+=24),a}function RI(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Nt,"");return r+s}function NI(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return OI(e);case"0303000000000000c000000000000046":return RI(e);default:throw new Error("Unsupported Moniker "+r)}}function mc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Nt,""):"";return r}function DI(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,c,f,u="",o,l;a&16&&(i=mc(e,r-e.l)),a&128&&(s=mc(e,r-e.l)),(a&257)===257&&(c=mc(e,r-e.l)),(a&257)===1&&(f=NI(e,r-e.l)),a&8&&(u=mc(e,r-e.l)),a&32&&(o=e.read_shift(16)),a&64&&(l=lf(e)),e.l=r;var h=s||c||f||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return o&&(d.guid=o),l&&(d.time=l),i&&(d.Tooltip=i),d}function Hx(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Wx(e,t){var r=Hx(e);return r[3]=0,r}function zr(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function PI(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function LI(e,t,r){return t===0?"":xa(e,t,r)}function BI(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function zx(e){var t=e.read_shift(2),r=of(e);return[t,r]}function MI(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=is(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function xc(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Gx(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var UI=Gx;function qx(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function VI(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function $I(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function bt(e){e.l+=2,e.l+=e.read_shift(2)}var HI={0:bt,4:bt,5:bt,6:bt,7:$I,8:bt,9:bt,10:bt,11:bt,12:bt,13:VI,14:bt,15:bt,16:bt,17:bt,18:bt,19:bt,20:bt,21:qx};function WI(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(HI[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function gc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function zI(e,t){return t===0||e.read_shift(2),1200}function GI(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=xa(e,0,r);return e.read_shift(t+n-e.l),a}function qI(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function KI(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=is(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function XI(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(FI(e));return i.Count=n,i.Unique=a,i}function YI(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function JI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function QI(e){var t=PI(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function ZI(e){return e.read_shift(2),e.read_shift(4)}function Kx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function jI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:c,Selected:f,TabRatio:u}}function e5(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function t5(){}function r5(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=is(e,0,r),n}function n5(e){var t=zr(e);return t.isst=e.read_shift(4),t}function a5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=zr(e);r.biff==2&&e.l++;var i=ss(e,n-e.l,r);return a.val=i,a}function i5(e,t,r){var n=e.read_shift(2),a=xa(e,0,r);return[n,a]}var s5=xa;function Xx(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:i,c},e:{r:s,c:f}}}function o5(e){var t=e.read_shift(2),r=e.read_shift(2),n=zx(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function c5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(zx(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function u5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function f5(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=oI[c>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function l5(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=f5(e,t,n.fStyle,r),n}function h5(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Yx(e,t,r){var n=zr(e);(r.biff==2||t==9)&&++e.l;var a=SI(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function d5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=zr(e),a=Ct(e);return n.val=a,n}var Jx=LI;function p5(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=ma(e,i),c=[];n>e.l;)c.push(ss(e));return[i,a,s,c]}function Qx(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=MI(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var m5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Zx(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),f=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=ma(e,s,r);a&32&&(u=m5[u.charCodeAt(0)]);var o=n-e.l;r&&r.biff==2&&--o;var l=n==e.l||c===0||!(o>0)?[]:JN(e,o,r,c);return{chKey:i,Name:u,itab:f,rgce:l}}function jx(e,t,r){if(r.biff<8)return x5(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(BI(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function x5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=is(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function g5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=ma(e,n,r),s=ma(e,a,r);return[i,s]}function v5(e,t,r){var n=Gx(e);e.l++;var a=e.read_shift(1);return t-=8,[QN(e,t,r),a,n]}function eg(e,t,r){var n=UI(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,XN(e,t,r)]}function _5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function y5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=xa(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},c,s,i]}}function w5(e,t,r){return y5(e,t,r)}function E5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(xc(e));return r}function k5(e,t,r){if(r&&r.biff<8)return A5(e,t,r);var n=qx(e),a=WI(e,t-22,n[1]);return{cmo:n,ft:a}}var T5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function A5(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((T5[n]||Tt)(e,t,r)),{cmo:[a,n,i],ft:s}}function C5(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=II(e,6,r);var c=e.read_shift(2);e.read_shift(2),it(e,2);var f=e.read_shift(2);e.l+=f;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var o=e[e.l],l=ma(e,e.lens[u+1]-e.lens[u]-1);if(a+=l,a.length>=(o?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function b5(e,t){var r=xc(e);e.l+=16;var n=DI(e,t-24);return[r,n]}function S5(e,t){e.read_shift(2);var r=xc(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Nt,""),[r,n]}function F5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Fx[r]||r,r=e.read_shift(2),t[1]=Fx[r]||r,t}function I5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Wx(e));return r}function O5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Wx(e));return r}function R5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function tg(e,t,r){if(!r.cellStyles)return Tt(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:c,flags:f};return(r.biff>=5||!r.biff)&&(u.level=f>>8&7),u}function N5(e,t){var r={};return t<32||(e.l+=16,r.header=Ct(e),r.footer=Ct(e),e.l+=2),r}function D5(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var P5=zr,L5=$x,B5=ss;function M5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function U5(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=zr(e);++e.l;var a=xa(e,t-7,r);return n.t="str",n.val=a,n}function V5(e){var t=zr(e);++e.l;var r=Ct(e);return t.t="n",t.val=r,t}function $5(e){var t=zr(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function H5(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function W5(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function z5(e,t,r){var n=e.l+t,a=zr(e),i=e.read_shift(2),s=ma(e,i,r);return e.l=n,a.t="str",a.val=s,a}var G5=[2,3,48,49,131,139,140,245],rg=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=K0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,f){var u=[],o=Nn(1);switch(f.type){case"base64":o=br(Yt(c));break;case"binary":o=br(c);break;case"buffer":case"array":o=c;break}yt(o,0);var l=o.read_shift(1),h=!!(l&136),d=!1,p=!1;switch(l){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+l.toString(16))}var m=0,x=521;l==2&&(m=o.read_shift(2)),o.l+=3,l!=2&&(m=o.read_shift(4)),m>1048576&&(m=1e6),l!=2&&(x=o.read_shift(2));var v=o.read_shift(2),y=f.codepage||1252;l!=2&&(o.l+=16,o.read_shift(1),o[o.l]!==0&&(y=e[o[o.l]]),o.l+=1,o.l+=2),p&&(o.l+=36);for(var g=[],_={},w=Math.min(o.length,l==2?521:x-10-(d?264:0)),E=p?32:11;o.l<w&&o[o.l]!=13;)switch(_={},_.name=H0.utils.decode(y,o.slice(o.l,o.l+E)).replace(/[\u0000\r\n].*$/g,""),o.l+=E,_.type=String.fromCharCode(o.read_shift(1)),l!=2&&!p&&(_.offset=o.read_shift(4)),_.len=o.read_shift(1),l==2&&(_.offset=o.read_shift(2)),_.dec=o.read_shift(1),_.name.length&&g.push(_),l!=2&&(o.l+=p?13:14),_.type){case"B":(!d||_.len!=8)&&f.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(o[o.l]!==13&&(o.l=x-1),o.read_shift(1)!==13)throw new Error("DBF Terminator not found "+o.l+" "+o[o.l]);o.l=x;var k=0,F=0;for(u[0]=[],F=0;F!=g.length;++F)u[0][F]=g[F].name;for(;m-- >0;){if(o[o.l]===42){o.l+=v;continue}for(++o.l,u[++k]=[],F=0,F=0;F!=g.length;++F){var b=o.slice(o.l,o.l+g[F].len);o.l+=g[F].len,yt(b,0);var L=H0.utils.decode(y,b);switch(g[F].type){case"C":L.trim().length&&(u[k][F]=L.replace(/\s+$/,""));break;case"D":L.length===8?u[k][F]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):u[k][F]=L;break;case"F":u[k][F]=parseFloat(L.trim());break;case"+":case"I":u[k][F]=p?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":u[k][F]=!0;break;case"N":case"F":u[k][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+l.toString(16));u[k][F]="##MEMO##"+(p?parseInt(L.trim(),10):b.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(u[k][F]=+L||0);break;case"@":u[k][F]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":u[k][F]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":u[k][F]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][F]=-b.read_shift(-8,"f");break;case"B":if(d&&g[F].len==8){u[k][F]=b.read_shift(8,"f");break}case"G":case"P":b.l+=g[F].len;break;case"0":if(g[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[F].type)}}}if(l!=2&&o.l<o.length&&o[o.l++]!=26)throw new Error("DBF EOF Marker missing "+(o.l-1)+" of "+o.length+" "+o[o.l-1].toString(16));return f&&f.sheetRows&&(u=u.slice(0,f.sheetRows)),f.DBF=g,u}function n(c,f){var u=f||{};u.dateNF||(u.dateNF="yyyymmdd");var o=ja(r(c,u),u);return o["!cols"]=u.DBF.map(function(l){return{wch:l.len,DBF:l}}),delete u.DBF,o}function a(c,f){try{return Ln(n(c,f),f)}catch(u){if(f&&f.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(c,f){var u=f||{};if(+u.codepage>=0&&Cr(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var o=j0(),l=Rf(c,{header:1,raw:!0,cellDates:!0}),h=l[0],d=l.slice(1),p=c["!cols"]||[],m=0,x=0,v=0,y=1;for(m=0;m<h.length;++m){if(((p[m]||{}).DBF||{}).name){h[m]=p[m].DBF.name,++v;continue}if(h[m]!=null){if(++v,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(x=0;x<1024;++x)if(h.indexOf(h[m]+"_"+x)==-1){h[m]+="_"+x;break}}}}var g=Qe(c["!ref"]),_=[],w=[],E=[];for(m=0;m<=g.e.c-g.s.c;++m){var k="",F="",b=0,L=[];for(x=0;x<d.length;++x)d[x][m]!=null&&L.push(d[x][m]);if(L.length==0||h[m]==null){_[m]="?";continue}for(x=0;x<L.length;++x){switch(typeof L[x]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=L[x]instanceof Date?"D":"C";break;default:F="C"}b=Math.max(b,String(L[x]).length),k=k&&k!=F?"C":F}b>250&&(b=250),F=((p[m]||{}).DBF||{}).type,F=="C"&&p[m].DBF.len>b&&(b=p[m].DBF.len),k=="B"&&F=="N"&&(k="N",E[m]=p[m].DBF.dec,b=p[m].DBF.len),w[m]=k=="C"||F=="N"?b:i[k]||0,y+=w[m],_[m]=k}var U=o.next(32);for(U.write_shift(4,318902576),U.write_shift(4,d.length),U.write_shift(2,296+32*v),U.write_shift(2,y),m=0;m<4;++m)U.write_shift(4,0);for(U.write_shift(4,0|(+t[mm]||3)<<8),m=0,x=0;m<h.length;++m)if(h[m]!=null){var B=o.next(32),Y=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,Y,"sbcs"),B.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),B.write_shift(4,x),B.write_shift(1,w[m]||i[_[m]]||0),B.write_shift(1,E[m]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),x+=w[m]||i[_[m]]||0}var se=o.next(264);for(se.write_shift(4,13),m=0;m<65;++m)se.write_shift(4,0);for(m=0;m<d.length;++m){var re=o.next(y);for(re.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(_[x]){case"L":re.write_shift(1,d[m][x]==null?63:d[m][x]?84:70);break;case"B":re.write_shift(8,d[m][x]||0,"f");break;case"N":var ue="0";for(typeof d[m][x]=="number"&&(ue=d[m][x].toFixed(E[x]||0)),v=0;v<w[x]-ue.length;++v)re.write_shift(1,32);re.write_shift(1,ue,"sbcs");break;case"D":d[m][x]?(re.write_shift(4,("0000"+d[m][x].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(d[m][x].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+d[m][x].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(d[m][x]!=null?d[m][x]:"").slice(0,w[x]);for(re.write_shift(1,ne,"sbcs"),v=0;v<w[x]-ne.length;++v)re.write_shift(1,32);break}}return o.next(1).write_shift(1,26),o.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),q5=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Hr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var p=e[d];return typeof p=="number"?_m(p):p},n=function(h,d,p){var m=d.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?h:_m(m)};e["|"]=254;function a(h,d){switch(d.type){case"base64":return i(Yt(h),d);case"binary":return i(h,d);case"buffer":return i(be&&Buffer.isBuffer(h)?h.toString("binary"):ia(h),d);case"array":return i(ua(h),d)}throw new Error("Unrecognized type "+d.type)}function i(h,d){var p=h.split(/[\n\r]+/),m=-1,x=-1,v=0,y=0,g=[],_=[],w=null,E={},k=[],F=[],b=[],L=0,U;for(+d.codepage>=0&&Cr(+d.codepage);v!==p.length;++v){L=0;var B=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Y=B.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),se=Y[0],re;if(B.length>0)switch(se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&_.push(B.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,ne=!1,De=!1,W=!1,pe=-1,me=-1;for(y=1;y<Y.length;++y)switch(Y[y].charAt(0)){case"A":break;case"X":x=parseInt(Y[y].slice(1))-1,ne=!0;break;case"Y":for(m=parseInt(Y[y].slice(1))-1,ne||(x=0),U=g.length;U<=m;++U)g[U]=[];break;case"K":re=Y[y].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Fr(re))?isNaN(Ja(re).getDate())||(re=pt(re)):(re=Fr(re),w!==null&&Ya(w)&&(re=cc(re))),ue=!0;break;case"E":W=!0;var N=ri(Y[y].slice(1),{r:m,c:x});g[m][x]=[g[m][x],N];break;case"S":De=!0,g[m][x]=[g[m][x],"S5S"];break;case"G":break;case"R":pe=parseInt(Y[y].slice(1))-1;break;case"C":me=parseInt(Y[y].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}if(ue&&(g[m][x]&&g[m][x].length==2?g[m][x][0]=re:g[m][x]=re,w=null),De){if(W)throw new Error("SYLK shared formula cannot have own formula");var V=pe>-1&&g[pe][me];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");g[m][x][1]=dg(V[1],{r:m-pe,c:x-me})}break;case"F":var M=0;for(y=1;y<Y.length;++y)switch(Y[y].charAt(0)){case"X":x=parseInt(Y[y].slice(1))-1,++M;break;case"Y":for(m=parseInt(Y[y].slice(1))-1,U=g.length;U<=m;++U)g[U]=[];break;case"M":L=parseInt(Y[y].slice(1))/20;break;case"F":break;case"G":break;case"P":w=_[parseInt(Y[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=Y[y].slice(1).split(" "),U=parseInt(b[0],10);U<=parseInt(b[1],10);++U)L=parseInt(b[2],10),F[U-1]=L===0?{hidden:!0}:{wch:L},ti(F[U-1]);break;case"C":x=parseInt(Y[y].slice(1))-1,F[x]||(F[x]={});break;case"R":m=parseInt(Y[y].slice(1))-1,k[m]||(k[m]={}),L>0?(k[m].hpt=L,k[m].hpx=fs(L)):L===0&&(k[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}M<1&&(w=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}}return k.length>0&&(E["!rows"]=k),F.length>0&&(E["!cols"]=F),d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),[g,E]}function s(h,d){var p=a(h,d),m=p[0],x=p[1],v=ja(m,d);return Hr(x).forEach(function(y){v[y]=x[y]}),v}function c(h,d){return Ln(s(h,d),d)}function f(h,d,p,m){var x="C;Y"+(p+1)+";X"+(m+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+RR(h.f,{r:p,c:m}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(h,d){d.forEach(function(p,m){var x="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?x+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=_c(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=yc(p.wpx)),typeof p.wch=="number"&&(x+=Math.round(p.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function o(h,d){d.forEach(function(p,m){var x="F;";p.hidden?x+="M0;":p.hpt?x+="M"+20*p.hpt+";":p.hpx&&(x+="M"+20*ug(p.hpx)+";"),x.length>2&&h.push(x+"R"+(m+1))})}function l(h,d){var p=["ID;PWXL;N;E"],m=[],x=Qe(h["!ref"]),v,y=Array.isArray(h),g=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&u(p,h["!cols"]),h["!rows"]&&o(p,h["!rows"]),p.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var _=x.s.r;_<=x.e.r;++_)for(var w=x.s.c;w<=x.e.c;++w){var E=ve({r:_,c:w});v=y?(h[_]||[])[w]:h[E],!(!v||v.v==null&&(!v.f||v.F))&&m.push(f(v,h,_,w))}return p.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:c,to_sheet:s,from_sheet:l}}(),K5=function(){function e(i,s){switch(s.type){case"base64":return t(Yt(i),s);case"binary":return t(i,s);case"buffer":return t(be&&Buffer.isBuffer(i)?i.toString("binary"):ia(i),s);case"array":return t(ua(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var c=i.split(`
`),f=-1,u=-1,o=0,l=[];o!==c.length;++o){if(c[o].trim()==="BOT"){l[++f]=[],u=0;continue}if(!(f<0)){var h=c[o].trim().split(","),d=h[0],p=h[1];++o;for(var m=c[o]||"";(m.match(/["]/g)||[]).length&1&&o<c.length-1;)m+=`
`+c[++o];switch(m=m.trim(),+d){case-1:if(m==="BOT"){l[++f]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?l[f][u]=!0:m==="FALSE"?l[f][u]=!1:isNaN(Fr(p))?isNaN(Ja(p).getDate())?l[f][u]=p:l[f][u]=pt(p):l[f][u]=Fr(p),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),l[f][u++]=m!==""?m:null;break}if(m==="EOD")break}}return s&&s.sheetRows&&(l=l.slice(0,s.sheetRows)),l}function r(i,s){return ja(e(i,s),s)}function n(i,s){return Ln(r(i,s),s)}var a=function(){var i=function(f,u,o,l,h){f.push(u),f.push(o+","+l),f.push('"'+h.replace(/"/g,'""')+'"')},s=function(f,u,o,l){f.push(u+","+o),f.push(u==1?'"'+l.replace(/"/g,'""')+'"':l)};return function(f){var u=[],o=Qe(f["!ref"]),l,h=Array.isArray(f);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,o.e.r-o.s.r+1,""),i(u,"TUPLES",0,o.e.c-o.s.c+1,""),i(u,"DATA",0,0,"");for(var d=o.s.r;d<=o.e.r;++d){s(u,-1,0,"BOT");for(var p=o.s.c;p<=o.e.c;++p){var m=ve({r:d,c:p});if(l=h?(f[d]||[])[p]:f[m],!l){s(u,1,0,"");continue}switch(l.t){case"n":var x=l.w;!x&&l.v!=null&&(x=l.v),x==null?l.f&&!l.F?s(u,1,0,"="+l.f):s(u,1,0,""):s(u,0,x,"V");break;case"b":s(u,0,l.v?1:0,l.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(l.v)?l.v:'="'+l.v+'"');break;case"d":l.w||(l.w=ur(l.z||Ee[14],Pt(pt(l.v)))),s(u,0,l.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),X5=function(){function e(l){return l.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(l){return l.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(l,h){for(var d=l.split(`
`),p=-1,m=-1,x=0,v=[];x!==d.length;++x){var y=d[x].trim().split(":");if(y[0]==="cell"){var g=Lt(y[1]);if(v.length<=g.r)for(p=v.length;p<=g.r;++p)v[p]||(v[p]=[]);switch(p=g.r,m=g.c,y[2]){case"t":v[p][m]=e(y[3]);break;case"v":v[p][m]=+y[3];break;case"vtf":var _=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[p][m]=!!+y[4];break;default:v[p][m]=+y[4];break}y[2]=="vtf"&&(v[p][m]=[v[p][m],_])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(l,h){return ja(r(l,h),h)}function a(l,h){return Ln(n(l,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function u(l){if(!l||!l["!ref"])return"";for(var h=[],d=[],p,m="",x=Za(l["!ref"]),v=Array.isArray(l),y=x.s.r;y<=x.e.r;++y)for(var g=x.s.c;g<=x.e.c;++g)if(m=ve({r:y,c:g}),p=v?(l[y]||[])[g]:l[m],!(!p||p.v==null||p.t==="z")){switch(d=["cell",m,"t"],p.t){case"s":case"str":d.push(t(p.v));break;case"n":p.f?(d[2]="vtf",d[3]="n",d[4]=p.v,d[5]=t(p.f)):(d[2]="v",d[3]=p.v);break;case"b":d[2]="vt"+(p.f?"f":"c"),d[3]="nl",d[4]=p.v?"1":"0",d[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var _=Pt(pt(p.v));d[2]="vtc",d[3]="nd",d[4]=""+_,d[5]=p.w||ur(p.z||Ee[14],_);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function o(l){return[i,s,c,s,u(l),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),os=function(){function e(o,l,h,d,p){p.raw?l[h][d]=o:o===""||(o==="TRUE"?l[h][d]=!0:o==="FALSE"?l[h][d]=!1:isNaN(Fr(o))?isNaN(Ja(o).getDate())?l[h][d]=o:l[h][d]=pt(o):l[h][d]=Fr(o))}function t(o,l){var h=l||{},d=[];if(!o||o.length===0)return d;for(var p=o.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var x=10,v=0,y=0;y<=m;++y)v=p[y].indexOf(" "),v==-1?v=p[y].length:v++,x=Math.max(x,v);for(y=0;y<=m;++y){d[y]=[];var g=0;for(e(p[y].slice(0,x).trim(),d,y,g,h),g=1;g<=(p[y].length-x)/10+1;++g)e(p[y].slice(x+(g-1)*10,x+g*10).trim(),d,y,g,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(o){for(var l={},h=!1,d=0,p=0;d<o.length;++d)(p=o.charCodeAt(d))==34?h=!h:!h&&p in r&&(l[p]=(l[p]||0)+1);p=[];for(d in l)Object.prototype.hasOwnProperty.call(l,d)&&p.push([l[d],d]);if(!p.length){l=n;for(d in l)Object.prototype.hasOwnProperty.call(l,d)&&p.push([l[d],d])}return p.sort(function(m,x){return m[0]-x[0]||n[m[1]]-n[x[1]]}),r[p.pop()[1]]||44}function i(o,l){var h=l||{},d="",p=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};o.slice(0,4)=="sep="?o.charCodeAt(5)==13&&o.charCodeAt(6)==10?(d=o.charAt(4),o=o.slice(7)):o.charCodeAt(5)==13||o.charCodeAt(5)==10?(d=o.charAt(4),o=o.slice(6)):d=a(o.slice(0,1024)):h&&h.FS?d=h.FS:d=a(o.slice(0,1024));var x=0,v=0,y=0,g=0,_=0,w=d.charCodeAt(0),E=!1,k=0,F=o.charCodeAt(0);o=o.replace(/\r\n/mg,`
`);var b=h.dateNF!=null?i8(h.dateNF):null;function L(){var U=o.slice(g,_),B={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)B.t="z";else if(h.raw)B.t="s",B.v=U;else if(U.trim().length===0)B.t="s",B.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(B.t="s",B.v=U.slice(2,-1).replace(/""/g,'"')):DR(U)?(B.t="n",B.f=U.slice(1)):(B.t="s",B.v=U);else if(U=="TRUE")B.t="b",B.v=!0;else if(U=="FALSE")B.t="b",B.v=!1;else if(!isNaN(y=Fr(U)))B.t="n",h.cellText!==!1&&(B.w=U),B.v=y;else if(!isNaN(Ja(U).getDate())||b&&U.match(b)){B.z=h.dateNF||Ee[14];var Y=0;b&&U.match(b)&&(U=s8(U,h.dateNF,U.match(b)||[]),Y=1),h.cellDates?(B.t="d",B.v=pt(U,Y)):(B.t="n",B.v=Pt(pt(U,Y))),h.cellText!==!1&&(B.w=ur(B.z,B.v instanceof Date?Pt(B.v):B.v)),h.cellNF||delete B.z}else B.t="s",B.v=U;if(B.t=="z"||(h.dense?(p[x]||(p[x]=[]),p[x][v]=B):p[ve({c:v,r:x})]=B),g=_+1,F=o.charCodeAt(g),m.e.c<v&&(m.e.c=v),m.e.r<x&&(m.e.r=x),k==w)++v;else if(v=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;_<o.length;++_)switch(k=o.charCodeAt(_)){case 34:F===34&&(E=!E);break;case w:case 10:case 13:if(!E&&L())break e;break}return _-g>0&&L(),p["!ref"]=Ie(m),p}function s(o,l){return!(l&&l.PRN)||l.FS||o.slice(0,4)=="sep="||o.indexOf("	")>=0||o.indexOf(",")>=0||o.indexOf(";")>=0?i(o,l):ja(t(o,l),l)}function c(o,l){var h="",d=l.type=="string"?[0,0,0,0]:If(o,l);switch(l.type){case"base64":h=Yt(o);break;case"binary":h=o;break;case"buffer":l.codepage==65001?h=o.toString("utf8"):(l.codepage,h=be&&Buffer.isBuffer(o)?o.toString("binary"):ia(o));break;case"array":h=ua(o);break;case"string":h=o;break;default:throw new Error("Unrecognized type "+l.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=He(h.slice(3)):l.type!="string"&&l.type!="buffer"&&l.codepage==65001?h=He(h):l.type=="binary",h.slice(0,19)=="socialcalc:version:"?X5.to_sheet(l.type=="string"?h:He(h),l):s(h,l)}function f(o,l){return Ln(c(o,l),l)}function u(o){for(var l=[],h=Qe(o["!ref"]),d,p=Array.isArray(o),m=h.s.r;m<=h.e.r;++m){for(var x=[],v=h.s.c;v<=h.e.c;++v){var y=ve({r:m,c:v});if(d=p?(o[m]||[])[v]:o[y],!d||d.v==null){x.push("          ");continue}for(var g=(d.w||(ln(d),d.w)||"").slice(0,10);g.length<10;)g+=" ";x.push(g+(v===0?" ":""))}l.push(x.join(""))}return l.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:u}}();function Y5(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=q5.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return os.to_workbook(e,t)}}var cs=function(){function e(N,V,M){if(N){yt(N,N.l||0);for(var P=M.Enum||pe;N.l<N.length;){var J=N.read_shift(2),te=P[J]||P[65535],fe=N.read_shift(2),ae=N.l+fe,j=te.f&&te.f(N,fe,M);if(N.l=ae,V(j,te,J))return}}}function t(N,V){switch(V.type){case"base64":return r(br(Yt(N)),V);case"binary":return r(br(N),V);case"buffer":case"array":return r(N,V)}throw"Unsupported type "+V.type}function r(N,V){if(!N)return N;var M=V||{},P=M.dense?[]:{},J="Sheet1",te="",fe=0,ae={},j=[],Pe=[],D={s:{r:0,c:0},e:{r:0,c:0}},tt=M.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)M.Enum=pe,e(N,function(oe,rt,dr){switch(dr){case 0:M.vers=oe,oe>=4096&&(M.qpro=!0);break;case 6:D=oe;break;case 204:oe&&(te=oe);break;case 222:te=oe;break;case 15:case 51:M.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:dr==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=M.dateNF||Ee[14],M.cellDates&&(oe[1].t="d",oe[1].v=cc(oe[1].v))),M.qpro&&oe[3]>fe&&(P["!ref"]=Ie(D),ae[J]=P,j.push(J),P=M.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},fe=oe[3],J=te||"Sheet"+(fe+1),te="");var Kr=M.dense?(P[oe[0].r]||[])[oe[0].c]:P[ve(oe[0])];if(Kr){Kr.t=oe[1].t,Kr.v=oe[1].v,oe[1].z!=null&&(Kr.z=oe[1].z),oe[1].f!=null&&(Kr.f=oe[1].f);break}M.dense?(P[oe[0].r]||(P[oe[0].r]=[]),P[oe[0].r][oe[0].c]=oe[1]):P[ve(oe[0])]=oe[1];break}},M);else if(N[2]==26||N[2]==14)M.Enum=me,N[2]==14&&(M.qpro=!0,N.l=0),e(N,function(oe,rt,dr){switch(dr){case 204:J=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>fe&&(P["!ref"]=Ie(D),ae[J]=P,j.push(J),P=M.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},fe=oe[3],J="Sheet"+(fe+1)),tt>0&&oe[0].r>=tt)break;M.dense?(P[oe[0].r]||(P[oe[0].r]=[]),P[oe[0].r][oe[0].c]=oe[1]):P[ve(oe[0])]=oe[1],D.e.c<oe[0].c&&(D.e.c=oe[0].c),D.e.r<oe[0].r&&(D.e.r=oe[0].r);break;case 27:oe[14e3]&&(Pe[oe[14e3][0]]=oe[14e3][1]);break;case 1537:Pe[oe[0]]=oe[1],oe[0]==fe&&(J=oe[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(P["!ref"]=Ie(D),ae[te||J]=P,j.push(te||J),!Pe.length)return{SheetNames:j,Sheets:ae};for(var Le={},Ve=[],Te=0;Te<Pe.length;++Te)ae[j[Te]]?(Ve.push(Pe[Te]||j[Te]),Le[Pe[Te]]=ae[Pe[Te]]||ae[j[Te]]):(Ve.push(Pe[Te]),Le[Pe[Te]]={"!ref":"A1"});return{SheetNames:Ve,Sheets:Le}}function n(N,V){var M=V||{};if(+M.codepage>=0&&Cr(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var P=j0(),J=Qe(N["!ref"]),te=Array.isArray(N),fe=[];Or(P,0,i(1030)),Or(P,6,f(J));for(var ae=Math.min(J.e.r,8191),j=J.s.r;j<=ae;++j)for(var Pe=wt(j),D=J.s.c;D<=J.e.c;++D){j===J.s.r&&(fe[D]=lt(D));var tt=fe[D]+Pe,Le=te?(N[j]||[])[D]:N[tt];if(!(!Le||Le.t=="z"))if(Le.t=="n")(Le.v|0)==Le.v&&Le.v>=-32768&&Le.v<=32767?Or(P,13,d(j,D,Le.v)):Or(P,14,m(j,D,Le.v));else{var Ve=ln(Le);Or(P,15,l(j,D,Ve.slice(0,239)))}}return Or(P,1),P.end()}function a(N,V){var M=V||{};if(+M.codepage>=0&&Cr(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var P=j0();Or(P,0,s(N));for(var J=0,te=0;J<N.SheetNames.length;++J)(N.Sheets[N.SheetNames[J]]||{})["!ref"]&&Or(P,27,W(N.SheetNames[J],te++));var fe=0;for(J=0;J<N.SheetNames.length;++J){var ae=N.Sheets[N.SheetNames[J]];if(!(!ae||!ae["!ref"])){for(var j=Qe(ae["!ref"]),Pe=Array.isArray(ae),D=[],tt=Math.min(j.e.r,8191),Le=j.s.r;Le<=tt;++Le)for(var Ve=wt(Le),Te=j.s.c;Te<=j.e.c;++Te){Le===j.s.r&&(D[Te]=lt(Te));var oe=D[Te]+Ve,rt=Pe?(ae[Le]||[])[Te]:ae[oe];if(!(!rt||rt.t=="z"))if(rt.t=="n")Or(P,23,L(Le,Te,fe,rt.v));else{var dr=ln(rt);Or(P,22,k(Le,Te,fe,dr.slice(0,239)))}}++fe}}return Or(P,1),P.end()}function i(N){var V=ft(2);return V.write_shift(2,N),V}function s(N){var V=ft(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var M=0,P=0,J=0,te=0;te<N.SheetNames.length;++te){var fe=N.SheetNames[te],ae=N.Sheets[fe];if(!(!ae||!ae["!ref"])){++J;var j=Za(ae["!ref"]);M<j.e.r&&(M=j.e.r),P<j.e.c&&(P=j.e.c)}}return M>8191&&(M=8191),V.write_shift(2,M),V.write_shift(1,J),V.write_shift(1,P),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function c(N,V,M){var P={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&M.qpro?(P.s.c=N.read_shift(1),N.l++,P.s.r=N.read_shift(2),P.e.c=N.read_shift(1),N.l++,P.e.r=N.read_shift(2),P):(P.s.c=N.read_shift(2),P.s.r=N.read_shift(2),V==12&&M.qpro&&(N.l+=2),P.e.c=N.read_shift(2),P.e.r=N.read_shift(2),V==12&&M.qpro&&(N.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function f(N){var V=ft(8);return V.write_shift(2,N.s.c),V.write_shift(2,N.s.r),V.write_shift(2,N.e.c),V.write_shift(2,N.e.r),V}function u(N,V,M){var P=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(P[0].c=N.read_shift(1),P[3]=N.read_shift(1),P[0].r=N.read_shift(2),N.l+=2):(P[2]=N.read_shift(1),P[0].c=N.read_shift(2),P[0].r=N.read_shift(2)),P}function o(N,V,M){var P=N.l+V,J=u(N,V,M);if(J[1].t="s",M.vers==20768){N.l++;var te=N.read_shift(1);return J[1].v=N.read_shift(te,"utf8"),J}return M.qpro&&N.l++,J[1].v=N.read_shift(P-N.l,"cstr"),J}function l(N,V,M){var P=ft(7+M.length);P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,N),P.write_shift(1,39);for(var J=0;J<P.length;++J){var te=M.charCodeAt(J);P.write_shift(1,te>=128?95:te)}return P.write_shift(1,0),P}function h(N,V,M){var P=u(N,V,M);return P[1].v=N.read_shift(2,"i"),P}function d(N,V,M){var P=ft(7);return P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,N),P.write_shift(2,M,"i"),P}function p(N,V,M){var P=u(N,V,M);return P[1].v=N.read_shift(8,"f"),P}function m(N,V,M){var P=ft(13);return P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,N),P.write_shift(8,M,"f"),P}function x(N,V,M){var P=N.l+V,J=u(N,V,M);if(J[1].v=N.read_shift(8,"f"),M.qpro)N.l=P;else{var te=N.read_shift(2);_(N.slice(N.l,N.l+te),J),N.l+=te}return J}function v(N,V,M){var P=V&32768;return V&=-32769,V=(P?N:0)+(V>=8192?V-16384:V),(P?"":"$")+(M?lt(V):wt(V))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(N,V){yt(N,0);for(var M=[],P=0,J="",te="",fe="",ae="";N.l<N.length;){var j=N[N.l++];switch(j){case 0:M.push(N.read_shift(8,"f"));break;case 1:te=v(V[0].c,N.read_shift(2),!0),J=v(V[0].r,N.read_shift(2),!1),M.push(te+J);break;case 2:{var Pe=v(V[0].c,N.read_shift(2),!0),D=v(V[0].r,N.read_shift(2),!1);te=v(V[0].c,N.read_shift(2),!0),J=v(V[0].r,N.read_shift(2),!1),M.push(Pe+D+":"+te+J)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(N.read_shift(2));break;case 6:{for(var tt="";j=N[N.l++];)tt+=String.fromCharCode(j);M.push('"'+tt.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ae=M.pop(),fe=M.pop(),M.push(["AND","OR"][j-20]+"("+fe+","+ae+")");break;default:if(j<32&&g[j])ae=M.pop(),fe=M.pop(),M.push(fe+g[j]+ae);else if(y[j]){if(P=y[j][1],P==69&&(P=N[N.l++]),P>M.length){console.error("WK1 bad formula parse 0x"+j.toString(16)+":|"+M.join("|")+"|");return}var Le=M.slice(-P);M.length-=P,M.push(y[j][0]+"("+Le.join(",")+")")}else return j<=7?console.error("WK1 invalid opcode "+j.toString(16)):j<=24?console.error("WK1 unsupported op "+j.toString(16)):j<=30?console.error("WK1 invalid opcode "+j.toString(16)):j<=115?console.error("WK1 unsupported function opcode "+j.toString(16)):console.error("WK1 unrecognized opcode "+j.toString(16))}}M.length==1?V[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function w(N){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=N.read_shift(2),V[3]=N[N.l++],V[0].c=N[N.l++],V}function E(N,V){var M=w(N);return M[1].t="s",M[1].v=N.read_shift(V-4,"cstr"),M}function k(N,V,M,P){var J=ft(6+P.length);J.write_shift(2,N),J.write_shift(1,M),J.write_shift(1,V),J.write_shift(1,39);for(var te=0;te<P.length;++te){var fe=P.charCodeAt(te);J.write_shift(1,fe>=128?95:fe)}return J.write_shift(1,0),J}function F(N,V){var M=w(N);M[1].v=N.read_shift(2);var P=M[1].v>>1;if(M[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return M[1].v=P,M}function b(N,V){var M=w(N),P=N.read_shift(4),J=N.read_shift(4),te=N.read_shift(2);if(te==65535)return P===0&&J===3221225472?(M[1].t="e",M[1].v=15):P===0&&J===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var fe=te&32768;return te=(te&32767)-16446,M[1].v=(1-fe*2)*(J*Math.pow(2,te+32)+P*Math.pow(2,te)),M}function L(N,V,M,P){var J=ft(14);if(J.write_shift(2,N),J.write_shift(1,M),J.write_shift(1,V),P==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var te=0,fe=0,ae=0,j=0;return P<0&&(te=1,P=-P),fe=Math.log2(P)|0,P/=Math.pow(2,fe-31),j=P>>>0,(j&2147483648)==0&&(P/=2,++fe,j=P>>>0),P-=j,j|=2147483648,j>>>=0,P*=Math.pow(2,32),ae=P>>>0,J.write_shift(4,ae),J.write_shift(4,j),fe+=16383+(te?32768:0),J.write_shift(2,fe),J}function U(N,V){var M=b(N);return N.l+=V-14,M}function B(N,V){var M=w(N),P=N.read_shift(4);return M[1].v=P>>6,M}function Y(N,V){var M=w(N),P=N.read_shift(8,"f");return M[1].v=P,M}function se(N,V){var M=Y(N);return N.l+=V-10,M}function re(N,V){return N[N.l+V-1]==0?N.read_shift(V,"cstr"):""}function ue(N,V){var M=N[N.l++];M>V-1&&(M=V-1);for(var P="";P.length<M;)P+=String.fromCharCode(N[N.l++]);return P}function ne(N,V,M){if(!(!M.qpro||V<21)){var P=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var J=N.read_shift(V-21,"cstr");return[P,J]}}function De(N,V){for(var M={},P=N.l+V;N.l<P;){var J=N.read_shift(2);if(J==14e3){for(M[J]=[0,""],M[J][0]=N.read_shift(2);N[N.l];)M[J][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return M}function W(N,V){var M=ft(5+N.length);M.write_shift(2,14e3),M.write_shift(2,V);for(var P=0;P<N.length;++P){var J=N.charCodeAt(P);M[M.l++]=J>127?95:J}return M[M.l++]=0,M}var pe={0:{n:"BOF",f:it},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:o},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:o},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:De},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function J5(e){var t={},r=e.match(kt),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=xe(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=V0[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var Q5=function(){var e=Qi("t"),t=Qi("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var c={t:"s",v:Ne(s[1])},f=i.match(t);return f&&(c.s=J5(f[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(c){return c.v})}}(),Z5=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),s.push("</"+f+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),j5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eO=/<(?:\w+:)?r>/,tO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function df(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ne(He(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=He(e),r&&(n.h=Y0(n.t))):e.match(eO)&&(n.r=He(e),n.t=Ne(He((e.replace(tO,"").match(j5)||[]).join("").replace(kt,""))),r&&(n.h=Z5(Q5(n.r)))),n):{t:""}}var rO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nO=/<(?:\w+:)?(?:si|sstItem)>/g,aO=/<\/(?:\w+:)?(?:si|sstItem)>/;function iO(e,t){var r=[],n="";if(!e)return r;var a=e.match(rO);if(a){n=a[2].replace(nO,"").split(aO);for(var i=0;i!=n.length;++i){var s=df(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=xe(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function sO(e){return[e.read_shift(4),e.read_shift(4)]}function oO(e,t){var r=[],n=!1;return fn(e,function(i,s,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function ng(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function hn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function cO(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=hn(e,4),t.U=hn(e,4),t.W=hn(e,4),t}function uO(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function fO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(uO(e));return t}function lO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function hO(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=hn(e,4),t.U=hn(e,4),t.W=hn(e,4),t}function dO(e){var t=hO(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function ag(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function ig(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function pO(e){var t=hn(e);switch(t.Minor){case 2:return[t.Minor,mO(e)];case 3:return[t.Minor,xO()];case 4:return[t.Minor,gO(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function mO(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=ag(e,r),a=ig(e,e.length-e.l);return{t:"Std",h:n,v:a}}function xO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function gO(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(kt,function(i){var s=xe(i);switch(Wr(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){n[c]=s[c]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function vO(e,t){var r={},n=r.EncryptionVersionInfo=hn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=ag(e,a),t-=a,r.EncryptionVerifier=ig(e,t),r}function _O(e){var t={},r=t.EncryptionVersionInfo=hn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function yO(e){var t=0,r,n=ng(e),a=n.length+1,i,s,c,f,u;for(r=Nn(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],c=(t&16384)===0?0:1,f=t<<1&32767,u=c|f,t=u^s;return t^52811}var sg=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,c){return n(s^c)},i=function(s){for(var c=t[s.length-1],f=104,u=s.length-1;u>=0;--u)for(var o=s[u],l=0;l!=7;++l)o&64&&(c^=r[f]),o*=2,--f;return c};return function(s){for(var c=ng(s),f=i(c),u=c.length,o=Nn(16),l=0;l!=16;++l)o[l]=0;var h,d,p;for((u&1)===1&&(h=f>>8,o[u]=a(e[0],h),--u,h=f&255,d=c[c.length-1],o[u]=a(d,h));u>0;)--u,h=f>>8,o[u]=a(c[u],h),--u,h=f&255,o[u]=a(c[u],h);for(u=15,p=15-c.length;p>0;)h=f>>8,o[u]=a(e[p],h),--u,--p,h=f&255,o[u]=a(c[u],h),--u,--p;return o}}(),wO=function(e,t,r,n,a){a||(a=t),n||(n=sg(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},EO=function(e){var t=0,r=sg(e);return function(n){var a=wO("",n,t,r);return t=a[1],a[0]}};function kO(e,t,r,n){var a={key:it(e),verificationBytes:it(e)};return r.password&&(a.verifier=yO(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=EO(r.password)),a}function TO(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=_O(e):n.Data=vO(e,t),n}function AO(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?TO(e,t-2,n):kO(e,r.biff>=8?t:t-2,r,n),n}var CO=function(){function e(a,i){switch(i.type){case"base64":return t(Yt(a),i);case"binary":return t(a,i);case"buffer":return t(be&&Buffer.isBuffer(a)?a.toString("binary"):ia(a),i);case"array":return t(ua(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},c=s.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(o,l){Array.isArray(c)&&(c[l]=[]);for(var h=/\\\w+\b/g,d=0,p,m=-1;p=h.exec(o);){switch(p[0]){case"\\cell":var x=o.slice(d,h.lastIndex-p[0].length);if(x[0]==" "&&(x=x.slice(1)),++m,x.length){var v={v:x,t:"s"};Array.isArray(c)?c[l][m]=v:c[ve({r:l,c:m})]=v}break}d=h.lastIndex}m>u.e.c&&(u.e.c=m)}),c["!ref"]=Ie(u),c}function r(a,i){return Ln(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Qe(a["!ref"]),c,f=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var o=s.s.c;o<=s.e.c;++o)i.push("\\cellx"+(o+1));for(i.push("\\pard\\intbl"),o=s.s.c;o<=s.e.c;++o){var l=ve({r:u,c:o});c=f?(a[u]||[])[o]:a[l],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(ln(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function bO(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function us(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function SO(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var c=0,f=0,u=a+i;switch(f=s/(u>1?2-u:u),a){case t:c=((r-n)/s+6)%6;break;case r:c=(n-t)/s+2;break;case n:c=(t-r)/s+4;break}return[c/6,f,u/2]}function FO(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],c=6*t,f;if(r!==0)switch(c|0){case 0:case 6:f=a*c,s[0]+=a,s[1]+=f;break;case 1:f=a*(2-c),s[0]+=f,s[1]+=a;break;case 2:f=a*(c-2),s[1]+=a,s[2]+=f;break;case 3:f=a*(4-c),s[1]+=f,s[2]+=a;break;case 4:f=a*(c-4),s[2]+=a,s[0]+=f;break;case 5:f=a*(6-c),s[2]+=f,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function vc(e,t){if(t===0)return e;var r=SO(bO(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),us(FO(r))}var og=6,IO=15,OO=1,Bt=og;function _c(e){return Math.floor((e+Math.round(128/Bt)/256)*Bt)}function yc(e){return Math.floor((e-5)/Bt*100+.5)/100}function pf(e){return Math.round((e*Bt+5)/Bt*256)/256}function mf(e){return pf(yc(_c(e)))}function xf(e){var t=Math.abs(e-mf(e)),r=Bt;if(t>.005)for(Bt=OO;Bt<IO;++Bt)Math.abs(e-mf(e))<=t&&(t=Math.abs(e-mf(e)),r=Bt);Bt=r}function ti(e){e.width?(e.wpx=_c(e.width),e.wch=yc(e.wpx),e.MDW=Bt):e.wpx?(e.wch=yc(e.wpx),e.width=pf(e.wch),e.MDW=Bt):typeof e.wch=="number"&&(e.width=pf(e.wch),e.wpx=_c(e.width),e.MDW=Bt),e.customWidth&&delete e.customWidth}var RO=96,cg=RO;function ug(e){return e*96/cg}function fs(e){return e*cg/96}var NO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function DO(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(kt)||[]).forEach(function(s){var c=xe(s);switch(Wr(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=ze(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=ze(c.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function PO(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(kt)||[]).forEach(function(s){var c=xe(s);switch(Wr(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function LO(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(kt)||[]).forEach(function(s){var c=xe(s);switch(Wr(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=He(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?ze(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?ze(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?ze(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?ze(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?ze(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?ze(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?ze(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=V0[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=ze(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=da[a.color.index];a.color.index==81&&(f=da[1]),f||(f=da[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=vc(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function BO(e,t,r){t.NumberFmt=[];for(var n=Hr(Ee),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ee[n[a]];var i=e[0].match(kt);if(i)for(a=0;a<i.length;++a){var s=xe(i[a]);switch(Wr(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ne(He(s.formatCode)),f=parseInt(s.numFmtId,10);if(t.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=c}ca(c,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var wc=["numFmtId","fillId","fontId","borderId","xfId"],Ec=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function MO(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(kt)||[]).forEach(function(i){var s=xe(i),c=0;switch(Wr(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],c=0;c<wc.length;++c)n[wc[c]]&&(n[wc[c]]=parseInt(n[wc[c]],10));for(c=0;c<Ec.length;++c)n[Ec[c]]&&(n[Ec[c]]=ze(n[Ec[c]]));if(t.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[c]){n.numFmtId=c;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};s.vertical&&(f.vertical=s.vertical),s.horizontal&&(f.horizontal=s.horizontal),s.textRotation!=null&&(f.textRotation=s.textRotation),s.indent&&(f.indent=s.indent),s.wrapText&&(f.wrapText=ze(s.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var UO=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,u){var o={};if(!c)return o;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var l;return(l=c.match(t))&&BO(l,o,u),(l=c.match(a))&&LO(l,o,f,u),(l=c.match(n))&&PO(l,o,f,u),(l=c.match(i))&&DO(l,o,f,u),(l=c.match(r))&&MO(l,o,u),o}}();function VO(e,t){var r=e.read_shift(2),n=At(e);return[r,n]}function $O(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Q8(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var c=e.read_shift(1);c>0&&(n.family=c);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=J8(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=At(e),n}var HO=Tt;function WO(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var zO=Tt;function GO(e,t,r){var n={};n.NumberFmt=[];for(var a in Ee)n.NumberFmt[a]=Ee[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return fn(e,function(f,u,o){switch(o){case 44:n.NumberFmt[f[0]]=f[1],ca(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=vc(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(o),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(o);else if(u.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}var qO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function KO(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(kt)||[]).forEach(function(a){var i=xe(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[qO.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function XO(){}function YO(){}var JO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,QO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ZO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function jO(e,t,r){t.themeElements={};var n;[["clrScheme",JO,KO],["fontScheme",QO,XO],["fmtScheme",ZO,YO]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var eR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function fg(e,t){(!e||e.length===0)&&(e=tR());var r,n={};if(!(r=e.match(eR)))throw new Error("themeElements not found in theme");return jO(r[0],n,t),n.raw=e,n}function tR(e,t){var r=[Ym];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rR(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=Xm(i,{type:"array"})}catch{return}var c=Jt(s,"theme/theme/theme1.xml",!0);if(c)return fg(c,r)}}function nR(e){return e.read_shift(4)}function aR(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=iR(e,4);break;case 2:t.xclrValue=Hx(e);break;case 3:t.xclrValue=nR(e);break;case 4:e.l+=4;break}return e.l+=8,t}function iR(e,t){return Tt(e,t)}function sR(e,t){return Tt(e,t)}function oR(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=aR(e);break;case 6:n[1]=sR(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function cR(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(oR(e,r-e.l));return{ixfe:n,ext:i}}function uR(e,t){t.forEach(function(r){r[0]})}function fR(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:At(e)}}function lR(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function hR(e){return e.l+=4,e.read_shift(4)!=0}function dR(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,c=2;return fn(e,function(f,u,o){switch(o){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(l){c==1?n.Cell.push({type:n.Types[l[0]-1].name,index:l[1]}):c==0&&n.Value.push({type:n.Types[l[0]-1].name,index:l[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:i.push(o),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+o.toString(16))}}}),n}function pR(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(kt,function(c){var f=xe(c);switch(Wr(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==f.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),n}function mR(e){var t=[];if(!e)return t;var r=1;return(e.match(kt)||[]).forEach(function(n){var a=xe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function xR(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ve(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function gR(e,t,r){var n=[];return fn(e,function(i,s,c){switch(c){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function JM(){}function vR(e,t,r,n){if(!e)return e;var a=n||{},i=!1;fn(e,function(c,f,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function _R(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function lg(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var c=Lt(s.ref);if(a?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[s.ref],!i){i={t:"z"},a?e[c.r][c.c]=i:e[s.ref]=i;var f=Qe(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var u=Ie(f);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var o={a:s.author,t:s.t,r:s.r,T:r};s.h&&(o.h=s.h);for(var l=i.c.length-1;l>=0;--l){if(!r&&i.c[l].T)return;r&&!i.c[l].T&&i.c.splice(l,1)}if(r&&n){for(l=0;l<n.length;++l)if(o.a==n[l].id){o.a=n[l].name||o.a;break}}i.c.push(o)})}function yR(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=xe(c[0]),u={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},o=Lt(f.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!l&&!!l[1]&&df(l[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function wR(e,t){var r=[],n=!1,a={},i=0;return e.replace(kt,function(c,f){var u=xe(c);switch(Wr(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+c.length;break;case"</text>":a.t=e.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return c}),r}function ER(e,t){var r=[],n=!1;return e.replace(kt,function(i){var s=xe(i);switch(Wr(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function kR(e){var t={};t.iauthor=e.read_shift(4);var r=ha(e);return t.rfx=r.s,t.ref=ve(r.s),e.l+=16,t}var TR=At;function AR(e,t){var r=[],n=[],a={},i=!1;return fn(e,function(c,f,u){switch(u){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var CR="application/vnd.ms-office.vbaProject";function bR(e){var t=Fe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Fe.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Fe.write(t)}function SR(){return{"!type":"dialog"}}function FR(){return{"!type":"dialog"}}function IR(){return{"!type":"macro"}}function OR(){return{"!type":"macro"}}var ri=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var c=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,o=s.length>0?parseInt(s,10)|0:0;return c?o+=t.c:--o,f?u+=t.r:--u,a+(c?"":"$")+lt(o)+(f?"":"$")+wt(u)}return function(a,i){return t=i,a.replace(e,r)}}(),hg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,RR=function(){return function(t,r){return t.replace(hg,function(n,a,i,s,c,f){var u=rf(s)-(i?0:r.c),o=tf(f)-(c?0:r.r),l=o==0?"":c?o+1:"["+o+"]",h=u==0?"":i?u+1:"["+u+"]";return a+"R"+l+"C"+h})}}();function dg(e,t){return e.replace(hg,function(r,n,a,i,s,c){return n+(a=="$"?a+i:lt(rf(i)+t.c))+(s=="$"?s+c:wt(tf(c)+t.r))})}function NR(e,t,r){var n=Za(t),a=n.s,i=Lt(r),s={r:i.r-a.r,c:i.c-a.c};return dg(e,s)}function DR(e){return e.length!=1}function pg(e){return e.replace(/_xlfn\./g,"")}function st(e){e.l+=1}function Mn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function mg(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return xg(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Mn(e),c=Mn(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function xg(e){var t=Mn(e),r=Mn(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function PR(e,t,r){if(r.biff<8)return xg(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Mn(e),s=Mn(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function gg(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return LR(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Mn(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function LR(e){var t=Mn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function BR(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function MR(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return UR(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:c}}function UR(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function VR(e,t,r){var n=(e[e.l++]&96)>>5,a=mg(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function $R(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=mg(e,i,r);return[n,a,s]}function HR(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function WR(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function zR(e,t,r){var n=(e[e.l++]&96)>>5,a=PR(e,t-1,r);return[n,a]}function GR(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function vg(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function qR(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function KR(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function XR(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function YR(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function JR(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function _g(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function QR(e){return e.read_shift(2),_g(e)}function ZR(e){return e.read_shift(2),_g(e)}function jR(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=gg(e,0,r);return[n,a]}function eN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=MR(e,0,r);return[n,a]}function tN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=gg(e,0,r);return[n,a,i]}function rN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[nD[a],Tg[a],n]}function nN(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:aN(e);return[a,(i[0]===0?Tg:rD)[i[1]]]}function aN(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function iN(e,t,r){e.l+=r&&r.biff==2?3:4}function sN(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function oN(e){return e.l++,pa[e.read_shift(1)]}function cN(e){return e.l++,e.read_shift(2)}function uN(e){return e.l++,e.read_shift(1)!==0}function fN(e){return e.l++,Ct(e)}function lN(e,t,r){return e.l++,is(e,t-1,r)}function hN(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=et(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=pa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ct(e);break;case 2:r[1]=xa(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function dN(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?ha:xc)(e));return a}function pN(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var c=0;c!=a;++c)s[i][c]=hN(e,r.biff);return s}function mN(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function xN(e,t,r){if(r.biff==5)return gN(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function gN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function vN(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function _N(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function yN(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function wN(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var EN=Tt,kN=Tt,TN=Tt;function ls(e,t,r){return e.l+=2,[BR(e)]}function gf(e){return e.l+=6,[]}var AN=ls,CN=gf,bN=gf,SN=ls;function yg(e){return e.l+=2,[it(e),e.read_shift(2)&1]}var FN=ls,IN=yg,ON=gf,RN=ls,NN=ls,DN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function PN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=DN[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function LN(e){return e.l+=2,[e.read_shift(4)]}function BN(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function MN(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function UN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function $N(e){return e.l+=4,[0,0]}var wg={1:{n:"PtgExp",f:sN},2:{n:"PtgTbl",f:TN},3:{n:"PtgAdd",f:st},4:{n:"PtgSub",f:st},5:{n:"PtgMul",f:st},6:{n:"PtgDiv",f:st},7:{n:"PtgPower",f:st},8:{n:"PtgConcat",f:st},9:{n:"PtgLt",f:st},10:{n:"PtgLe",f:st},11:{n:"PtgEq",f:st},12:{n:"PtgGe",f:st},13:{n:"PtgGt",f:st},14:{n:"PtgNe",f:st},15:{n:"PtgIsect",f:st},16:{n:"PtgUnion",f:st},17:{n:"PtgRange",f:st},18:{n:"PtgUplus",f:st},19:{n:"PtgUminus",f:st},20:{n:"PtgPercent",f:st},21:{n:"PtgParen",f:st},22:{n:"PtgMissArg",f:st},23:{n:"PtgStr",f:lN},26:{n:"PtgSheet",f:BN},27:{n:"PtgEndSheet",f:MN},28:{n:"PtgErr",f:oN},29:{n:"PtgBool",f:uN},30:{n:"PtgInt",f:cN},31:{n:"PtgNum",f:fN},32:{n:"PtgArray",f:GR},33:{n:"PtgFunc",f:rN},34:{n:"PtgFuncVar",f:nN},35:{n:"PtgName",f:mN},36:{n:"PtgRef",f:jR},37:{n:"PtgArea",f:VR},38:{n:"PtgMemArea",f:vN},39:{n:"PtgMemErr",f:EN},40:{n:"PtgMemNoMem",f:kN},41:{n:"PtgMemFunc",f:_N},42:{n:"PtgRefErr",f:yN},43:{n:"PtgAreaErr",f:HR},44:{n:"PtgRefN",f:eN},45:{n:"PtgAreaN",f:zR},46:{n:"PtgMemAreaN",f:UN},47:{n:"PtgMemNoMemN",f:VN},57:{n:"PtgNameX",f:xN},58:{n:"PtgRef3d",f:tN},59:{n:"PtgArea3d",f:$R},60:{n:"PtgRefErr3d",f:wN},61:{n:"PtgAreaErr3d",f:WR},255:{}},HN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},WN={1:{n:"PtgElfLel",f:yg},2:{n:"PtgElfRw",f:RN},3:{n:"PtgElfCol",f:AN},6:{n:"PtgElfRwV",f:NN},7:{n:"PtgElfColV",f:SN},10:{n:"PtgElfRadical",f:FN},11:{n:"PtgElfRadicalS",f:ON},13:{n:"PtgElfColS",f:CN},15:{n:"PtgElfColSV",f:bN},16:{n:"PtgElfRadicalLel",f:IN},25:{n:"PtgList",f:PN},29:{n:"PtgSxName",f:LN},255:{}},zN={0:{n:"PtgAttrNoop",f:$N},1:{n:"PtgAttrSemi",f:JR},2:{n:"PtgAttrIf",f:XR},4:{n:"PtgAttrChoose",f:qR},8:{n:"PtgAttrGoto",f:KR},16:{n:"PtgAttrSum",f:iN},32:{n:"PtgAttrBaxcel",f:vg},33:{n:"PtgAttrBaxcel",f:vg},64:{n:"PtgAttrSpace",f:QR},65:{n:"PtgAttrSpaceSemi",f:ZR},128:{n:"PtgAttrIfError",f:YR},255:{}};function hs(e,t,r,n){if(n.biff<8)return Tt(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=pN(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=dN(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Tt(e,t)),i}function ds(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=wg[i]||wg[HN[i]],(i===24||i===25)&&(a=(i===24?WN:zN)[e[e.l+1]]),!a||!a.f?Tt(e,t):s.push([a.n,a.f(e,t,r)]);return s}function GN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var qN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Eg(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function kg(e,t,r){var n=Eg(e,t,r);return n=="#REF"?n:KN(n,r)}function St(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},c=[],f,u,o,l=0,h=0,d,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,x="",v=0,y=e[0].length;v<y;++v){var g=e[0][v];switch(g[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),u=c.pop(),m>=0){switch(e[0][m][1][0]){case 0:x=Je(" ",e[0][m][1][1]);break;case 1:x=Je("\r",e[0][m][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+x,m=-1}c.push(u+qN[g[0]]+f);break;case"PtgIsect":f=c.pop(),u=c.pop(),c.push(u+" "+f);break;case"PtgUnion":f=c.pop(),u=c.pop(),c.push(u+","+f);break;case"PtgRange":f=c.pop(),u=c.pop(),c.push(u+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":o=ts(g[1][1],s,a),c.push(rs(o,i));break;case"PtgRefN":o=r?ts(g[1][1],r,a):g[1][1],c.push(rs(o,i));break;case"PtgRef3d":l=g[1][1],o=ts(g[1][2],s,a),p=kg(n,l,a),c.push(p+"!"+rs(o,i));break;case"PtgFunc":case"PtgFuncVar":var _=g[1][0],w=g[1][1];_||(_=0),_&=127;var E=_==0?[]:c.slice(-_);c.length-=_,w==="User"&&(w=E.shift()),c.push(w+"("+E.join(",")+")");break;case"PtgBool":c.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(g[1]);break;case"PtgNum":c.push(String(g[1]));break;case"PtgStr":c.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(g[1]);break;case"PtgAreaN":d=Ex(g[1][1],r?{s:r}:s,a),c.push(ef(d,a));break;case"PtgArea":d=Ex(g[1][1],s,a),c.push(ef(d,a));break;case"PtgArea3d":l=g[1][1],d=g[1][2],p=kg(n,l,a),c.push(p+"!"+ef(d,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],F=k?k.Name:"SH33TJSNAME"+String(h);F&&F.slice(0,6)=="_xlfn."&&!a.xlfn&&(F=F.slice(6)),c.push(F);break;case"PtgNameX":var b=g[1][1];h=g[1][2];var L;if(a.biff<=5)b<0&&(b=-b),n[b]&&(L=n[b][h]);else{var U="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][h]&&n[b][h].itab>0&&(U=n.SheetNames[n[b][h].itab-1]+"!"):U=n.SheetNames[h-1]+"!"),n[b]&&n[b][h])U+=n[b][h].Name;else if(n[0]&&n[0][h])U+=n[0][h].Name;else{var B=(Eg(n,b,a)||"").split(";;");B[h-1]?U=B[h-1]:U+="SH33TJSERRX"}c.push(U);break}L||(L={Name:"SH33TJSERRY"}),c.push(L.Name);break;case"PtgParen":var Y="(",se=")";if(m>=0){switch(x="",e[0][m][1][0]){case 2:Y=Je(" ",e[0][m][1][1])+Y;break;case 3:Y=Je("\r",e[0][m][1][1])+Y;break;case 4:se=Je(" ",e[0][m][1][1])+se;break;case 5:se=Je("\r",e[0][m][1][1])+se;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}c.push(Y+c.pop()+se);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":o={c:g[1][1],r:g[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[ve(o)]){var ue=n.sharedf[ve(o)];c.push(St(ue,s,re,n,a))}else{var ne=!1;for(f=0;f!=n.arrayf.length;++f)if(u=n.arrayf[f],!(o.c<u[0].s.c||o.c>u[0].e.c)&&!(o.r<u[0].s.r||o.r>u[0].e.r)){c.push(St(u[1],s,re,n,a)),ne=!0;break}ne||c.push(g[1])}break;case"PtgArray":c.push("{"+GN(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var De=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&De.indexOf(e[0][v][0])==-1){g=e[0][m];var W=!0;switch(g[1][0]){case 4:W=!1;case 0:x=Je(" ",g[1][1]);break;case 5:W=!1;case 1:x=Je("\r",g[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}c.push((W?x:"")+c.pop()+(W?"":x)),m=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function XN(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Tt(e,t-2)];var c=ds(e,s,r);return t!==s+a&&(i=hs(e,t-s-a,c,r)),e.l=n,[c,i]}function YN(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Tt(e,t-2)];var c=ds(e,s,r);return t!==s+a&&(i=hs(e,t-s-a,c,r)),e.l=n,[c,i]}function JN(e,t,r,n){var a=e.l+t,i=ds(e,n,r),s;return a!==e.l&&(s=hs(e,a-e.l,i,r)),[i,s]}function QN(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=ds(e,i,r);return i==65535?[[],Tt(e,t-2)]:(t!==i+2&&(a=hs(e,n-i-2,s,r)),[s,a])}function ZN(e){var t;if(un(e,e.l+6)!==65535)return[Ct(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function vf(e,t,r){var n=e.l+t,a=zr(e);r.biff==2&&++e.l;var i=ZN(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=YN(e,n-e.l,r);return{cell:a,val:i[0],formula:c,shared:s>>3&1,tt:i[1]}}function kc(e,t,r){var n=e.read_shift(4),a=ds(e,n,r),i=e.read_shift(4),s=i>0?hs(e,i,a,r):null;return[a,s]}var jN=kc,Tc=kc,eD=kc,tD=kc,rD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Tg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ag(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function _f(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var ps={},ni={};function ms(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Cg(e,t,r,n,a,i){try{n.cellNF&&(e.z=Ee[t])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=pt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ee[t]==null&&ca(a8[t]||"General",t),e.t==="e")e.w=e.w||pa[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xi(e.v);else if(e.t==="d"){var s=Pt(e.v);(s|0)===s?e.w=s.toString(10):e.w=Xi(s)}else{if(e.v===void 0)return"";e.w=oa(e.v,ni)}else e.t==="d"?e.w=ur(t,Pt(e.v),ni):e.w=ur(t,e.v,ni)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=vc(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=vc(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function aD(e,t){var r=Qe(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ie(r))}var iD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sD=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,oD=/<(?:\w:)?hyperlink [^>]*>/mg,cD=/"(\w*:\w*)"/,uD=/<(?:\w:)?col\b[^>]*[\/]?>/g,fD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,lD=/<(?:\w:)?pageMargins[^>]*\/>/g,bg=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pD(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var c=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",o="",l=e.match(sD);l?(u=e.slice(0,l.index),o=e.slice(l.index+l[0].length)):u=o=e;var h=u.match(bg);h?yf(h[0],c,a,r):(h=u.match(hD))&&mD(h[0],h[1]||"",c,a,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=u.slice(d,d+50).match(cD);p&&aD(c,p[1])}var m=u.match(dD);m&&m[1]&&wD(m[1],a);var x=[];if(t.cellStyles){var v=u.match(uD);v&&vD(x,v)}l&&ED(l[1],c,t,f,i,s);var y=o.match(fD);y&&(c["!autofilter"]=_D(y[0]));var g=[],_=o.match(iD);if(_)for(d=0;d!=_.length;++d)g[d]=Qe(_[d].slice(_[d].indexOf('"')+1));var w=o.match(oD);w&&xD(c,w,n);var E=o.match(lD);if(E&&(c["!margins"]=gD(xe(E[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=Ie(f)),t.sheetRows>0&&c["!ref"]){var k=Qe(c["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>f.e.r&&(k.e.r=f.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>f.e.c&&(k.e.c=f.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ie(k))}return x.length>0&&(c["!cols"]=x),g.length>0&&(c["!merges"]=g),c}function yf(e,t,r,n){var a=xe(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ne(He(a.codeName)))}function mD(e,t,r,n,a){yf(e.slice(0,e.indexOf(">")),r,n,a)}function xD(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=xe(He(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Ne(i.location))):(i.Target="#"+Ne(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=Qe(i.ref),f=c.s.r;f<=c.e.r;++f)for(var u=c.s.c;u<=c.e.c;++u){var o=ve({c:u,r:f});n?(e[f]||(e[f]=[]),e[f][u]||(e[f][u]={t:"z",v:void 0}),e[f][u].l=i):(e[o]||(e[o]={t:"z",v:void 0}),e[o].l=i)}}}function gD(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function vD(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=xe(t[n],!0);a.hidden&&(a.hidden=ze(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,xf(a.width)),ti(a);i<=s;)e[i++]=_t(a)}}function _D(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var yD=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function wD(e,t){t.Views||(t.Views=[{}]),(e.match(yD)||[]).forEach(function(r,n){var a=xe(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),ze(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var ED=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Qi("v"),s=Qi("f");return function(f,u,o,l,h,d){for(var p=0,m="",x=[],v=[],y=0,g=0,_=0,w="",E,k,F=0,b=0,L,U,B=0,Y=0,se=Array.isArray(d.CellXf),re,ue=[],ne=[],De=Array.isArray(u),W=[],pe={},me=!1,N=!!o.sheetStubs,V=f.split(t),M=0,P=V.length;M!=P;++M){m=V[M].trim();var J=m.length;if(J!==0){var te=0;e:for(p=0;p<J;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(o&&o.cellStyles){if(k=xe(m.slice(te,p),!0),F=k.r!=null?parseInt(k.r,10):F+1,b=-1,o.sheetRows&&o.sheetRows<F)continue;pe={},me=!1,k.ht&&(me=!0,pe.hpt=parseFloat(k.ht),pe.hpx=fs(pe.hpt)),k.hidden=="1"&&(me=!0,pe.hidden=!0),k.outlineLevel!=null&&(me=!0,pe.level=+k.outlineLevel),me&&(W[F-1]=pe)}break;case"<":te=p;break}if(te>=p)break;if(k=xe(m.slice(te,p),!0),F=k.r!=null?parseInt(k.r,10):F+1,b=-1,!(o.sheetRows&&o.sheetRows<F)){l.s.r>F-1&&(l.s.r=F-1),l.e.r<F-1&&(l.e.r=F-1),o&&o.cellStyles&&(pe={},me=!1,k.ht&&(me=!0,pe.hpt=parseFloat(k.ht),pe.hpx=fs(pe.hpt)),k.hidden=="1"&&(me=!0,pe.hidden=!0),k.outlineLevel!=null&&(me=!0,pe.level=+k.outlineLevel),me&&(W[F-1]=pe)),x=m.slice(p).split(e);for(var fe=0;fe!=x.length&&x[fe].trim().charAt(0)=="<";++fe);for(x=x.slice(fe),p=0;p!=x.length;++p)if(m=x[p].trim(),m.length!==0){if(v=m.match(r),y=p,g=0,_=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(y=0,w=v[1],g=0;g!=w.length&&!((_=w.charCodeAt(g)-64)<1||_>26);++g)y=26*y+_;--y,b=y}else++b;for(g=0;g!=m.length&&m.charCodeAt(g)!==62;++g);if(++g,k=xe(m.slice(0,g),!0),k.r||(k.r=ve({r:F-1,c:b})),w=m.slice(g),E={t:""},(v=w.match(i))!=null&&v[1]!==""&&(E.v=Ne(v[1])),o.cellFormula){if((v=w.match(s))!=null&&v[1]!==""){if(E.f=Ne(He(v[1])).replace(/\r\n/g,`
`),o.xlfn||(E.f=pg(E.f)),v[0].indexOf('t="array"')>-1)E.F=(w.match(a)||[])[1],E.F.indexOf(":")>-1&&ue.push([Qe(E.F),E.F]);else if(v[0].indexOf('t="shared"')>-1){U=xe(v[0]);var ae=Ne(He(v[1]));o.xlfn||(ae=pg(ae)),ne[parseInt(U.si,10)]=[U,ae,k.r]}}else(v=w.match(/<f[^>]*\/>/))&&(U=xe(v[0]),ne[U.si]&&(E.f=NR(ne[U.si][1],ne[U.si][2],k.r)));var j=Lt(k.r);for(g=0;g<ue.length;++g)j.r>=ue[g][0].s.r&&j.r<=ue[g][0].e.r&&j.c>=ue[g][0].s.c&&j.c<=ue[g][0].e.c&&(E.F=ue[g][1])}if(k.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(N)E.t="z";else continue;else E.t=k.t||"n";switch(l.s.c>b&&(l.s.c=b),l.e.c<b&&(l.e.c=b),E.t){case"n":if(E.v==""||E.v==null){if(!N)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!N)continue;E.t="z"}else L=ps[parseInt(E.v,10)],E.v=L.t,E.r=L.r,o.cellHTML&&(E.h=L.h);break;case"str":E.t="s",E.v=E.v!=null?He(E.v):"",o.cellHTML&&(E.h=Y0(E.v));break;case"inlineStr":v=w.match(n),E.t="s",v!=null&&(L=df(v[1]))?(E.v=L.t,o.cellHTML&&(E.h=L.h)):E.v="";break;case"b":E.v=ze(E.v);break;case"d":o.cellDates?E.v=pt(E.v,1):(E.v=Pt(pt(E.v,1)),E.t="n");break;case"e":(!o||o.cellText!==!1)&&(E.w=E.v),E.v=Ix[E.v];break}if(B=Y=0,re=null,se&&k.s!==void 0&&(re=d.CellXf[k.s],re!=null&&(re.numFmtId!=null&&(B=re.numFmtId),o.cellStyles&&re.fillId!=null&&(Y=re.fillId))),Cg(E,B,Y,o,h,d),o.cellDates&&se&&E.t=="n"&&Ya(Ee[B])&&(E.t="d",E.v=cc(E.v)),k.cm&&o.xlmeta){var Pe=(o.xlmeta.Cell||[])[+k.cm-1];Pe&&Pe.type=="XLDAPR"&&(E.D=!0)}if(De){var D=Lt(k.r);u[D.r]||(u[D.r]=[]),u[D.r][D.c]=E}else u[k.r]=E}}}}W.length>0&&(u["!rows"]=W)}}();function kD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var TD=ha;function AD(){}function CD(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=X8(e),r}function bD(e){var t=lr(e);return[t]}function SD(e){var t=la(e);return[t]}function FD(e){var t=lr(e),r=e.read_shift(1);return[t,r,"b"]}function ID(e){var t=la(e),r=e.read_shift(1);return[t,r,"b"]}function OD(e){var t=lr(e),r=e.read_shift(1);return[t,r,"e"]}function RD(e){var t=la(e),r=e.read_shift(1);return[t,r,"e"]}function ND(e){var t=lr(e),r=e.read_shift(4);return[t,r,"s"]}function DD(e){var t=la(e),r=e.read_shift(4);return[t,r,"s"]}function PD(e){var t=lr(e),r=Ct(e);return[t,r,"n"]}function Sg(e){var t=la(e),r=Ct(e);return[t,r,"n"]}function LD(e){var t=lr(e),r=of(e);return[t,r,"n"]}function BD(e){var t=la(e),r=of(e);return[t,r,"n"]}function MD(e){var t=lr(e),r=nf(e);return[t,r,"is"]}function UD(e){var t=lr(e),r=At(e);return[t,r,"str"]}function VD(e){var t=la(e),r=At(e);return[t,r,"str"]}function $D(e,t,r){var n=e.l+t,a=lr(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var c=Tc(e,n-e.l,r);s[3]=St(c,null,a,r.supbooks,r)}else e.l=n;return s}function HD(e,t,r){var n=e.l+t,a=lr(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var c=Tc(e,n-e.l,r);s[3]=St(c,null,a,r.supbooks,r)}else e.l=n;return s}function WD(e,t,r){var n=e.l+t,a=lr(e);a.r=r["!row"];var i=Ct(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var c=Tc(e,n-e.l,r);s[3]=St(c,null,a,r.supbooks,r)}else e.l=n;return s}function zD(e,t,r){var n=e.l+t,a=lr(e);a.r=r["!row"];var i=At(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var c=Tc(e,n-e.l,r);s[3]=St(c,null,a,r.supbooks,r)}else e.l=n;return s}var GD=ha;function qD(e,t){var r=e.l+t,n=ha(e),a=af(e),i=At(e),s=At(e),c=At(e);e.l=r;var f={rfx:n,relId:a,loc:i,display:c};return s&&(f.Tooltip=s),f}function KD(){}function XD(e,t,r){var n=e.l+t,a=Ax(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var c=jN(e,n-e.l,r);s[1]=c}else e.l=n;return s}function YD(e,t,r){var n=e.l+t,a=ha(e),i=[a];if(r.cellFormula){var s=tD(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}var JD=["left","right","top","bottom","header","footer"];function QD(e){var t={};return JD.forEach(function(r){t[r]=Ct(e)}),t}function ZD(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function jD(){}function eP(){}function tP(e,t,r,n,a,i,s){if(!e)return e;var c=t||{};n||(n={"!id":{}});var f=c.dense?[]:{},u,o={s:{r:2e6,c:2e6},e:{r:0,c:0}},l=!1,h=!1,d,p,m,x,v,y,g,_,w,E=[];c.biff=12,c["!row"]=0;var k=0,F=!1,b=[],L={},U=c.supbooks||a.supbooks||[[]];if(U.sharedf=L,U.arrayf=b,U.SheetNames=a.SheetNames||a.Sheets.map(function(De){return De.name}),!c.supbooks&&(c.supbooks=U,a.Names))for(var B=0;B<a.Names.length;++B)U[0][B+1]=a.Names[B];var Y=[],se=[],re=!1;Cc[16]={n:"BrtShortReal",f:Sg};var ue;if(fn(e,function(W,pe,me){if(!h)switch(me){case 148:u=W;break;case 0:d=W,c.sheetRows&&c.sheetRows<=d.r&&(h=!0),_=wt(x=d.r),c["!row"]=d.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=fs(W.hpt)),se[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:W[2]},W[2]){case"n":p.v=W[1];break;case"s":g=ps[W[1]],p.v=g.t,p.r=g.r;break;case"b":p.v=!!W[1];break;case"e":p.v=W[1],c.cellText!==!1&&(p.w=pa[p.v]);break;case"str":p.t="s",p.v=W[1];break;case"is":p.t="s",p.v=W[1].t;break}if((m=s.CellXf[W[0].iStyleRef])&&Cg(p,m.numFmtId,null,c,i,s),v=W[0].c==-1?v+1:W[0].c,c.dense?(f[x]||(f[x]=[]),f[x][v]=p):f[lt(v)+_]=p,c.cellFormula){for(F=!1,k=0;k<b.length;++k){var N=b[k];d.r>=N[0].s.r&&d.r<=N[0].e.r&&v>=N[0].s.c&&v<=N[0].e.c&&(p.F=Ie(N[0]),F=!0)}!F&&W.length>3&&(p.f=W[3])}if(o.s.r>d.r&&(o.s.r=d.r),o.s.c>v&&(o.s.c=v),o.e.r<d.r&&(o.e.r=d.r),o.e.c<v&&(o.e.c=v),c.cellDates&&m&&p.t=="n"&&Ya(Ee[m.numFmtId])){var V=sa(p.v);V&&(p.t="d",p.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}ue&&(ue.type=="XLDAPR"&&(p.D=!0),ue=void 0);break;case 1:case 12:if(!c.sheetStubs||l)break;p={t:"z",v:void 0},v=W[0].c==-1?v+1:W[0].c,c.dense?(f[x]||(f[x]=[]),f[x][v]=p):f[lt(v)+_]=p,o.s.r>d.r&&(o.s.r=d.r),o.s.c>v&&(o.s.c=v),o.e.r<d.r&&(o.e.r=d.r),o.e.c<v&&(o.e.c=v),ue&&(ue.type=="XLDAPR"&&(p.D=!0),ue=void 0);break;case 176:E.push(W);break;case 49:ue=((c.xlmeta||{}).Cell||[])[W-1];break;case 494:var M=n["!id"][W.relId];for(M?(W.Target=M.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=M):W.relId==""&&(W.Target="#"+W.loc),x=W.rfx.s.r;x<=W.rfx.e.r;++x)for(v=W.rfx.s.c;v<=W.rfx.e.c;++v)c.dense?(f[x]||(f[x]=[]),f[x][v]||(f[x][v]={t:"z",v:void 0}),f[x][v].l=W):(y=ve({c:v,r:x}),f[y]||(f[y]={t:"z",v:void 0}),f[y].l=W);break;case 426:if(!c.cellFormula)break;b.push(W),w=c.dense?f[x][v]:f[lt(v)+_],w.f=St(W[1],o,{r:d.r,c:v},U,c),w.F=Ie(W[0]);break;case 427:if(!c.cellFormula)break;L[ve(W[0].s)]=W[1],w=c.dense?f[x][v]:f[lt(v)+_],w.f=St(W[1],o,{r:d.r,c:v},U,c);break;case 60:if(!c.cellStyles)break;for(;W.e>=W.s;)Y[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},re||(re=!0,xf(W.w/256)),ti(Y[W.e+1]);break;case 161:f["!autofilter"]={ref:Ie(W)};break;case 476:f["!margins"]=W;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),W.name&&(a.Sheets[r].CodeName=W.name),(W.above||W.left)&&(f["!outline"]={above:W.above,left:W.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),W.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:l=!0;break;case 36:l=!1;break;case 37:l=!0;break;case 38:l=!1;break;default:if(!pe.T){if(!l||c.WTF)throw new Error("Unexpected record 0x"+me.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(o.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(f["!ref"]=Ie(u||o)),c.sheetRows&&f["!ref"]){var ne=Qe(f["!ref"]);c.sheetRows<=+ne.e.r&&(ne.e.r=c.sheetRows-1,ne.e.r>o.e.r&&(ne.e.r=o.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>o.e.c&&(ne.e.c=o.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Ie(ne))}return E.length>0&&(f["!merges"]=E),Y.length>0&&(f["!cols"]=Y),se.length>0&&(f["!rows"]=se),f}function rP(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Ne((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function nP(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var c=0,f=0,u="A",o={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(l){var h=rP(l);o.s.r=o.s.c=0,o.e.c=c,u=lt(c),h[0].forEach(function(d,p){s[u+wt(p)]={t:"n",v:d,z:h[1]},f=p}),o.e.r<f&&(o.e.r=f),++c}),c>0&&(s["!ref"]=Ie(o)),s}function aP(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,c=e.match(bg);return c&&yf(c[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function iP(e,t){e.l+=10;var r=At(e);return{name:r}}function sP(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return fn(e,function(f,u,o){switch(o){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Fg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],oP=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],cP=[],uP=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ig(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=ze(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Og(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ze(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Rg(e){Og(e.WBProps,Fg),Og(e.CalcPr,uP),Ig(e.WBView,oP),Ig(e.Sheets,cP),ni.date1904=ze(e.WBProps.date1904)}var fP="][*?/\\".split("");function lP(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return fP.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var hP=/<\w+:workbook/;function dP(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(kt,function(f,u){var o=xe(f);switch(Wr(o[0])){case"<?xml":break;case"<workbook":f.match(hP)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=o[a];break;case"</workbook>":break;case"<fileVersion":delete o[0],r.AppVersion=o;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Fg.forEach(function(l){if(o[l[0]]!=null)switch(l[2]){case"bool":r.WBProps[l[0]]=ze(o[l[0]]);break;case"int":r.WBProps[l[0]]=parseInt(o[l[0]],10);break;default:r.WBProps[l[0]]=o[l[0]]}}),o.codeName&&(r.WBProps.CodeName=He(o.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete o[0],r.WBView.push(o);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(o.state){case"hidden":o.Hidden=1;break;case"veryHidden":o.Hidden=2;break;default:o.Hidden=0}delete o.state,o.name=Ne(He(o.name)),delete o[0],r.Sheets.push(o);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=He(o.name),o.comment&&(i.Comment=o.comment),o.localSheetId&&(i.Sheet=+o.localSheetId),ze(o.hidden||"0")&&(i.Hidden=!0),s=u+f.length;break;case"</definedName>":i.Ref=Ne(He(e.slice(s,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete o[0],r.CalcPr=o;break;case"<calcPr/>":delete o[0],r.CalcPr=o;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in workbook")}return f}),O8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Rg(r),r}function pP(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=sf(e),r.name=At(e),r}function mP(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?At(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function xP(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function gP(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Y8(e),s=eD(e,0,r),c=af(e);e.l=n;var f={Name:i,Ptg:s};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function vP(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Cc[16]={n:"BrtFRTArchID$",f:xP},fn(e,function(f,u,o){switch(o){case 156:s.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=St(f.Ptg,null,null,s,t),delete t.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([o,f]):s[0]=[o,f],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(f),s.XTI=s.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(o),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(o),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+o.toString(16))}}},t),Rg(r),r.Names=i,r.supbooks=s,r}function _P(e,t,r){return t.slice(-4)===".bin"?vP(e,r):dP(e,r)}function yP(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?tP(e,n,r,a,i,s,c):pD(e,n,r,a,i,s,c)}function wP(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?sP(e,n,r,a,i):aP(e,n,r,a,i)}function EP(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?IR():OR()}function kP(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?SR():FR()}function TP(e,t,r,n){return t.slice(-4)===".bin"?GO(e,r,n):UO(e,r,n)}function AP(e,t,r){return fg(e,r)}function CP(e,t,r){return t.slice(-4)===".bin"?oO(e,r):iO(e,r)}function bP(e,t,r){return t.slice(-4)===".bin"?AR(e,r):yR(e,r)}function SP(e,t,r){return t.slice(-4)===".bin"?gR(e):mR(e)}function FP(e,t,r,n){return r.slice(-4)===".bin"?vR(e,t,r,n):void 0}function IP(e,t,r){return t.slice(-4)===".bin"?dR(e,t,r):pR(e,t,r)}var Ng=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Dg=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ir(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(Ng),i,s,c,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(Dg),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(s+1),n[c]=i[2].slice(1,i[2].length-1));return n}function OP(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Ng),a,i,s,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(Dg),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var xs;function RP(e,t){var r=xs[e]||Ne(e);return r==="General"?oa(t):ur(r,t)}function NP(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ze(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=pt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ne(t)]=a}function DP(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||pa[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xi(e.v):e.w=oa(e.v):e.w=RP(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=xs[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ya(n)){var a=sa(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function PP(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=NO[n.Pattern]||n.Pattern)}e[t.ID]=t}function LP(e,t,r,n,a,i,s,c,f,u){var o="General",l=n.StyleID,h={};u=u||{};var d=[],p=0;for(l===void 0&&c&&(l=c.StyleID),l===void 0&&s&&(l=s.StyleID);i[l]!==void 0&&(i[l].nf&&(o=i[l].nf),i[l].Interior&&d.push(i[l].Interior),!!i[l].Parent);)l=i[l].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ze(e);break;case"String":n.t="s",n.r=Zm(Ne(e)),n.v=e.indexOf("<")>-1?Ne(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(pt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ne(e):n.v<60&&(n.v=n.v-1),(!o||o=="General")&&(o="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Ix[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Zm(t||e));break}if(DP(n,o,u),u.cellFormula!==!1)if(n.Formula){var m=Ne(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ri(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ri("RC:RC",a):n.ArrayRange&&(n.F=ri(n.ArrayRange,a),f.push([Qe(n.F),n.F]))}else for(p=0;p<f.length;++p)a.r>=f[p][0].s.r&&a.r<=f[p][0].e.r&&a.c>=f[p][0].s.c&&a.c<=f[p][0].e.c&&(n.F=f[p][1]);u.cellStyles&&(d.forEach(function(x){!h.patternType&&x.patternType&&(h.patternType=x.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function BP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function wf(e,t){var r=t||{};Um();var n=qi(Q0(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=He(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=_t(r);return s.type="string",os.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(rt){a.indexOf("<"+rt)>=0&&(i=!0)}),i)return qP(n,r);xs={"General Number":"General","General Date":Ee[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ee[15],"Short Date":Ee[14],"Long Time":Ee[19],"Medium Time":Ee[18],"Short Time":Ee[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ee[2],Standard:Ee[4],Percent:Ee[10],Scientific:Ee[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],u,o={},l=[],h=r.dense?[]:{},d="",p={},m={},x=Ir('<Data ss:Type="String">'),v=0,y=0,g=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},E={},k="",F=0,b=[],L={},U={},B=0,Y=[],se=[],re={},ue=[],ne,De=!1,W=[],pe=[],me={},N=0,V=0,M={Sheets:[],WBProps:{date1904:!1}},P={};Zi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";c=Zi.exec(n);)switch(c[3]=(J=c[3]).toLowerCase()){case"data":if(J=="data"){if(c[1]==="/"){if((u=f.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?LP(n.slice(v,c.index),k,x,f[f.length-1][0]=="comment"?re:p,{c:y,r:g},w,ue[y],m,W,r):(k="",x=Ir(c[0]),v=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(se.length>0&&(p.c=se),(!r.sheetRows||r.sheetRows>g)&&p.v!==void 0&&(r.dense?(h[g]||(h[g]=[]),h[g][y]=p):h[lt(y)+wt(g)]=p),p.HRef&&(p.l={Target:Ne(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(N=y+(parseInt(p.MergeAcross,10)|0),V=g+(parseInt(p.MergeDown,10)|0),b.push({s:{c:y,r:g},e:{c:N,r:V}})),!r.sheetStubs)p.MergeAcross?y=N+1:++y;else if(p.MergeAcross||p.MergeDown){for(var te=y;te<=N;++te)for(var fe=g;fe<=V;++fe)(te>y||fe>g)&&(r.dense?(h[fe]||(h[fe]=[]),h[fe][te]={t:"z"}):h[lt(te)+wt(fe)]={t:"z"});y=N+1}else++y;else p=OP(c[0]),p.Index&&(y=+p.Index-1),y<_.s.c&&(_.s.c=y),y>_.e.c&&(_.e.c=y),c[0].slice(-2)==="/>"&&++y,se=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(g<_.s.r&&(_.s.r=g),g>_.e.r&&(_.e.r=g),c[0].slice(-2)==="/>"&&(m=Ir(c[0]),m.Index&&(g=+m.Index-1)),y=0,++g):(m=Ir(c[0]),m.Index&&(g=+m.Index-1),me={},(m.AutoFitHeight=="0"||m.Height)&&(me.hpx=parseInt(m.Height,10),me.hpt=ug(me.hpx),pe[g]=me),m.Hidden=="1"&&(me.hidden=!0,pe[g]=me));break;case"worksheet":if(c[1]==="/"){if((u=f.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));l.push(d),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=Ie(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=Ie(_))),b.length&&(h["!merges"]=b),ue.length>0&&(h["!cols"]=ue),pe.length>0&&(h["!rows"]=pe),o[d]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=y=0,f.push([c[3],!1]),u=Ir(c[0]),d=Ne(u.Name),h=r.dense?[]:{},b=[],W=[],pe=[],P={name:d,Hidden:0},M.Sheets.push(P);break;case"table":if(c[1]==="/"){if((u=f.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),ue=[],De=!1}break;case"style":c[1]==="/"?PP(w,E,r):E=Ir(c[0]);break;case"numberformat":E.nf=Ne(Ir(c[0]).Format||"General"),xs[E.nf]&&(E.nf=xs[E.nf]);for(var ae=0;ae!=392&&Ee[ae]!=E.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(Ee[ae]==null){ca(E.nf,ae);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ne=Ir(c[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!De&&ne.wpx>10){De=!0,Bt=og;for(var j=0;j<ue.length;++j)ue[j]&&ti(ue[j])}De&&ti(ne),ue[ne.Index-1||ue.length]=ne;for(var Pe=0;Pe<+ne.Span;++Pe)ue[ue.length]=_t(ne);break;case"namedrange":if(c[1]==="/")break;M.Names||(M.Names=[]);var D=xe(c[0]),tt={Name:D.Name,Ref:ri(D.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(tt.Sheet=M.Sheets.length-1),M.Names.push(tt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?k+=n.slice(F,c.index):F=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=Ir(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?yI(L,J,n.slice(B,c.index)):B=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((u=f.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((u=f.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));BP(re),se.push(re)}else f.push([c[3],!1]),u=Ir(c[0]),re={a:u.Author};break;case"autofilter":if(c[1]==="/"){if((u=f.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Le=Ir(c[0]);h["!autofilter"]={ref:ri(Le.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((u=f.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((u=f.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return zg(n,r);var Ve=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ve=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ve=!1}break;case"excelworkbook":switch(c[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ve=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Ve=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(B,c.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else B=c.index+c[0].length;break;case"header":h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+xe(c[0]).Margin)||(h["!margins"].header=+xe(c[0]).Margin);break;case"footer":h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+xe(c[0]).Margin)||(h["!margins"].footer=+xe(c[0]).Margin);break;case"pagemargins":var Te=xe(c[0]);h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+Te.Top)||(h["!margins"].top=+Te.Top),isNaN(+Te.Left)||(h["!margins"].left=+Te.Left),isNaN(+Te.Right)||(h["!margins"].right=+Te.Right),isNaN(+Te.Bottom)||(h["!margins"].bottom=+Te.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ve=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ve=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ve=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ve=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ve=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ve=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ve=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ve=!1}break;case"smarttags":break;default:Ve=!1;break}if(Ve||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?NP(U,J,Y,n.slice(B,c.index)):(Y=c,B=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var oe={};return!r.bookSheets&&!r.bookProps&&(oe.Sheets=o),oe.SheetNames=l,oe.Workbook=M,oe.SSF=_t(Ee),oe.Props=L,oe.Custprops=U,oe}function Ef(e,t){switch(Ff(t=t||{}),t.type||"base64"){case"base64":return wf(Yt(e),t);case"binary":case"buffer":case"file":return wf(e,t);case"array":return wf(ia(e),t)}}function MP(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Z8(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=j8(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var UP=[60,1084,2066,2165,2175];function VP(e,t,r,n,a){var i=n,s=[],c=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}s.push(c),r.l+=i;for(var f=un(r,r.l),u=kf[f],o=0;u!=null&&UP.indexOf(f)>-1;)i=un(r,r.l+2),o=r.l+4,f==2066?o+=4:(f==2165||f==2175)&&(o+=12),c=r.slice(o,r.l+4+i),s.push(c),r.l+=4+i,u=kf[f=un(r,r.l)];var l=Dn(s);yt(l,0);var h=0;l.lens=[];for(var d=0;d<s.length;++d)l.lens.push(h),h+=s[d].length;if(l.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+l.length+" < "+n;return t.f(l,l.length,a)}function Gr(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ee[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||pa[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xi(e.v):e.w=oa(e.v):e.w=ur(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Ya(Ee[n]||String(n))){var a=sa(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Ac(e,t,r){return{v:e,ixfe:t,t:r}}function $P(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},c=null,f=[],u="",o={},l,h="",d,p,m,x,v={},y=[],g,_,w=[],E=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},b=function(ke){return ke<8?da[ke]:ke<64&&E[ke-8]||da[ke]},L=function(ke,nt,pr){var dt=nt.XF.data;if(!(!dt||!dt.patternType||!pr||!pr.cellStyles)){nt.s={},nt.s.patternType=dt.patternType;var _a;(_a=us(b(dt.icvFore)))&&(nt.s.fgColor={rgb:_a}),(_a=us(b(dt.icvBack)))&&(nt.s.bgColor={rgb:_a})}},U=function(ke,nt,pr){if(!(me>1)&&!(pr.sheetRows&&ke.r>=pr.sheetRows)){if(pr.cellStyles&&nt.XF&&nt.XF.data&&L(ke,nt,pr),delete nt.ixfe,delete nt.XF,l=ke,h=ve(ke),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),ke.r<s.s.r&&(s.s.r=ke.r),ke.c<s.s.c&&(s.s.c=ke.c),ke.r+1>s.e.r&&(s.e.r=ke.r+1),ke.c+1>s.e.c&&(s.e.c=ke.c+1),pr.cellFormula&&nt.f){for(var dt=0;dt<y.length;++dt)if(!(y[dt][0].s.c>ke.c||y[dt][0].s.r>ke.r)&&!(y[dt][0].e.c<ke.c||y[dt][0].e.r<ke.r)){nt.F=Ie(y[dt][0]),(y[dt][0].s.c!=ke.c||y[dt][0].s.r!=ke.r)&&delete nt.f,nt.f&&(nt.f=""+St(y[dt][1],s,ke,W,B));break}}pr.dense?(a[ke.r]||(a[ke.r]=[]),a[ke.r][ke.c]=nt):a[h]=nt}},B={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(B.password=t.password);var Y,se=[],re=[],ue=[],ne=[],De=!1,W=[];W.SheetNames=B.snames,W.sharedf=B.sharedf,W.arrayf=B.arrayf,W.names=[],W.XTI=[];var pe=0,me=0,N=0,V=[],M=[],P;B.codepage=1200,Cr(1200);for(var J=!1;e.l<e.length-1;){var te=e.l,fe=e.read_shift(2);if(fe===0&&pe===10)break;var ae=e.l===e.length?0:e.read_shift(2),j=kf[fe];if(j&&j.f){if(t.bookSheets&&pe===133&&fe!==133)break;if(pe=fe,j.r===2||j.r==12){var Pe=e.read_shift(2);if(ae-=2,!B.enc&&Pe!==fe&&((Pe&255)<<8|Pe>>8)!==fe)throw new Error("rt mismatch: "+Pe+"!="+fe);j.r==12&&(e.l+=10,ae-=10)}var D={};if(fe===10?D=j.f(e,ae,B):D=VP(fe,j,e,ae,B),me==0&&[9,521,1033,2057].indexOf(pe)===-1)continue;switch(fe){case 34:r.opts.Date1904=k.WBProps.date1904=D;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(B.enc||(e.l=0),B.enc=D,!t.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=D;break;case 66:var tt=Number(D);switch(tt){case 21010:tt=1200;break;case 32768:tt=1e4;break;case 32769:tt=1252;break}Cr(B.codepage=tt),J=!0;break;case 317:B.rrtabid=D;break;case 25:B.winlocked=D;break;case 439:r.opts.RefreshAll=D;break;case 12:r.opts.CalcCount=D;break;case 16:r.opts.CalcDelta=D;break;case 17:r.opts.CalcIter=D;break;case 13:r.opts.CalcMode=D;break;case 14:r.opts.CalcPrecision=D;break;case 95:r.opts.CalcSaveRecalc=D;break;case 15:B.CalcRefMode=D;break;case 2211:r.opts.FullCalc=D;break;case 129:D.fDialog&&(a["!type"]="dialog"),D.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),D.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:w.push(D);break;case 430:W.push([D]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(D);break;case 24:case 536:P={Name:D.Name,Ref:St(D.rgce,s,null,W,B)},D.itab>0&&(P.Sheet=D.itab-1),W.names.push(P),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(M[D.itab-1]={ref:Ie(D.rgce[0][0][1][2])});break;case 22:B.ExternCount=D;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(D),W.XTI=W.XTI.concat(D);break;case 2196:if(B.biff<8)break;P!=null&&(P.Comment=D[1]);break;case 18:a["!protect"]=D;break;case 19:D!==0&&B.WTF&&console.error("Password verifier: "+D);break;case 133:i[D.pos]=D,B.snames.push(D.name);break;case 10:{if(--me)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Ie(s),t.sheetRows&&t.sheetRows<=s.e.r){var Le=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ie(s),s.e.r=Le}s.e.r++,s.e.c++}se.length>0&&(a["!merges"]=se),re.length>0&&(a["!objects"]=re),ue.length>0&&(a["!cols"]=ue),ne.length>0&&(a["!rows"]=ne),k.Sheets.push(F)}u===""?o=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),B.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(B.biff=5,J=!0,Cr(B.codepage=28591)),B.biff==8&&D.BIFFVer==0&&D.dt==16&&(B.biff=2),me++)break;if(a=t.dense?[]:{},B.biff<8&&!J&&(J=!0,Cr(B.codepage=t.codepage||1252)),B.biff<5||D.BIFFVer==0&&D.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ve={pos:e.l-ae,name:u};i[Ve.pos]=Ve,B.snames.push(u)}else u=(i[te]||{name:""}).name;D.dt==32&&(a["!type"]="chart"),D.dt==64&&(a["!type"]="macro"),se=[],re=[],B.arrayf=y=[],ue=[],ne=[],De=!1,F={Hidden:(i[te]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[D.r]||[])[D.c]:a[ve({c:D.c,r:D.r})])&&++D.c,g={ixfe:D.ixfe,XF:w[D.ixfe]||{},v:D.val,t:"n"},N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U({c:D.c,r:D.r},g,t);break;case 5:case 517:g={ixfe:D.ixfe,XF:w[D.ixfe],v:D.val,t:D.t},N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U({c:D.c,r:D.r},g,t);break;case 638:g={ixfe:D.ixfe,XF:w[D.ixfe],v:D.rknum,t:"n"},N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U({c:D.c,r:D.r},g,t);break;case 189:for(var Te=D.c;Te<=D.C;++Te){var oe=D.rkrec[Te-D.c][0];g={ixfe:oe,XF:w[oe],v:D.rkrec[Te-D.c][1],t:"n"},N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U({c:Te,r:D.r},g,t)}break;case 6:case 518:case 1030:{if(D.val=="String"){c=D;break}if(g=Ac(D.val,D.cell.ixfe,D.tt),g.XF=w[g.ixfe],t.cellFormula){var rt=D.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var dr=rt[0][0][1][0],Kr=rt[0][0][1][1],mn=ve({r:dr,c:Kr});v[mn]?g.f=""+St(D.formula,s,D.cell,W,B):g.F=((t.dense?(a[dr]||[])[Kr]:a[mn])||{}).F}else g.f=""+St(D.formula,s,D.cell,W,B)}N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U(D.cell,g,t),c=D}break;case 7:case 519:if(c)c.val=D,g=Ac(D,c.cell.ixfe,"s"),g.XF=w[g.ixfe],t.cellFormula&&(g.f=""+St(c.formula,s,c.cell,W,B)),N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U(c.cell,g,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(D);var As=ve(D[0].s);if(d=t.dense?(a[D[0].s.r]||[])[D[0].s.c]:a[As],t.cellFormula&&d){if(!c||!As||!d)break;d.f=""+St(D[1],s,D[0],W,B),d.F=Ie(D[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!c)break;v[ve(c.cell)]=D[0],d=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[ve(c.cell)],(d||{}).f=""+St(D[0],s,l,W,B)}}break;case 253:g=Ac(f[D.isst].t,D.ixfe,"s"),f[D.isst].h&&(g.h=f[D.isst].h),g.XF=w[g.ixfe],N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U({c:D.c,r:D.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:D.ixfe,XF:w[D.ixfe],t:"z"},N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U({c:D.c,r:D.r},g,t));break;case 190:if(t.sheetStubs)for(var $n=D.c;$n<=D.C;++$n){var Zt=D.ixfe[$n-D.c];g={ixfe:Zt,XF:w[Zt],t:"z"},N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U({c:$n,r:D.r},g,t)}break;case 214:case 516:case 4:g=Ac(D.val,D.ixfe,"s"),g.XF=w[g.ixfe],N>0&&(g.z=V[g.ixfe>>8&63]),Gr(g,t,r.opts.Date1904),U({c:D.c,r:D.r},g,t);break;case 0:case 512:me===1&&(s=D);break;case 252:f=D;break;case 1054:if(B.biff==4){V[N++]=D[1];for(var xn=0;xn<N+163&&Ee[xn]!=D[1];++xn);xn>=163&&ca(D[1],N+163)}else ca(D[1],D[0]);break;case 30:{V[N++]=D;for(var Hn=0;Hn<N+163&&Ee[Hn]!=D;++Hn);Hn>=163&&ca(D,N+163)}break;case 229:se=se.concat(D);break;case 93:re[D.cmo[0]]=B.lastobj=D;break;case 438:B.lastobj.TxO=D;break;case 127:B.lastobj.ImData=D;break;case 440:for(x=D[0].s.r;x<=D[0].e.r;++x)for(m=D[0].s.c;m<=D[0].e.c;++m)d=t.dense?(a[x]||[])[m]:a[ve({c:m,r:x})],d&&(d.l=D[1]);break;case 2048:for(x=D[0].s.r;x<=D[0].e.r;++x)for(m=D[0].s.c;m<=D[0].e.c;++m)d=t.dense?(a[x]||[])[m]:a[ve({c:m,r:x})],d&&d.l&&(d.l.Tooltip=D[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;d=t.dense?(a[D[0].r]||[])[D[0].c]:a[ve(D[0])];var Cs=re[D[2]];d||(t.dense?(a[D[0].r]||(a[D[0].r]=[]),d=a[D[0].r][D[0].c]={t:"z"}):d=a[ve(D[0])]={t:"z"},s.e.r=Math.max(s.e.r,D[0].r),s.s.r=Math.min(s.s.r,D[0].r),s.e.c=Math.max(s.e.c,D[0].c),s.s.c=Math.min(s.s.c,D[0].c)),d.c||(d.c=[]),p={a:D[1],t:Cs.TxO.t},d.c.push(p)}break;case 2173:uR(w[D.ixfe],D.ext);break;case 125:{if(!B.cellStyles)break;for(;D.e>=D.s;)ue[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},De||(De=!0,xf(D.w/256)),ti(ue[D.e+1])}break;case 520:{var Mt={};D.level!=null&&(ne[D.r]=Mt,Mt.level=D.level),D.hidden&&(ne[D.r]=Mt,Mt.hidden=!0),D.hpt&&(ne[D.r]=Mt,Mt.hpt=D.hpt,Mt.hpx=fs(D.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ms(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=D;break;case 161:a["!margins"]||ms(a["!margins"]={}),a["!margins"].header=D.header,a["!margins"].footer=D.footer;break;case 574:D.RTL&&(k.Views[0].RTL=!0);break;case 146:E=D;break;case 2198:Y=D;break;case 140:_=D;break;case 442:u?F.CodeName=D||F.name:k.WBProps.CodeName=D||"ThisWorkbook";break}}else j||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),e.l+=ae}return r.SheetNames=Hr(i).sort(function(Xr,ke){return Number(Xr)-Number(ke)}).map(function(Xr){return i[Xr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&o["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=o)):r.Preamble=o,r.Sheets&&M.forEach(function(Xr,ke){r.Sheets[r.SheetNames[ke]]["!autofilter"]=Xr}),r.Strings=f,r.SSF=_t(Ee),B.enc&&(r.Encryption=B.enc),Y&&(r.Themes=Y),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),W.names.length>0&&(k.Names=W.names),r.Workbook=k,r}var Pg={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function HP(e,t,r){var n=Fe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Vx(n,iI,Pg.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var s=Fe.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var c=Vx(s,sI,Pg.SI);for(var f in c)t[f]==null&&(t[f]=c[f])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Nx(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Lg(e,t){t||(t={}),Ff(t),xm(),t.codepage&&$0(t.codepage);var r,n;if(e.FullPaths){if(Fe.find(e,"/encryption"))throw new Error("File is password-protected");r=Fe.find(e,"!CompObj"),n=Fe.find(e,"/Workbook")||Fe.find(e,"/Book")}else{switch(t.type){case"base64":e=br(Yt(e));break;case"binary":e=br(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yt(e,0),n={content:e}}var a,i;if(r&&MP(r),t.bookProps&&!t.bookSheets)a={};else{var s=be?"buffer":"array";if(n&&n.content)a=$P(n.content,t);else if((i=Fe.find(e,"PerfectOffice_MAIN"))&&i.content)a=cs.to_workbook(i.content,(t.type=s,t));else if((i=Fe.find(e,"NativeContent_MAIN"))&&i.content)a=cs.to_workbook(i.content,(t.type=s,t));else throw(i=Fe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Fe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=bR(e))}var c={};return e.FullPaths&&HP(e,c,t),a.Props=a.Custprops=c,t.bookFiles&&(a.cfb=e),a}var Cc={0:{f:kD},1:{f:bD},2:{f:LD},3:{f:OD},4:{f:FD},5:{f:PD},6:{f:UD},7:{f:ND},8:{f:zD},9:{f:WD},10:{f:$D},11:{f:HD},12:{f:SD},13:{f:BD},14:{f:RD},15:{f:ID},16:{f:Sg},17:{f:VD},18:{f:DD},19:{f:nf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:gP},40:{},42:{},43:{f:$O},44:{f:VO},45:{f:HO},46:{f:zO},47:{f:WO},48:{},49:{f:G8},50:{},51:{f:lR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tg},62:{f:MD},63:{f:xR},64:{f:jD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ZD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CD},148:{f:TD,p:16},151:{f:KD},152:{},153:{f:mP},154:{},155:{},156:{f:pP},157:{},158:{},159:{T:1,f:sO},160:{T:-1},161:{T:1,f:ha},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fR},336:{T:-1},337:{f:hR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:sf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jx},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:XD},427:{f:YD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:QD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:AD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:qD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:sf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:TR},633:{T:1},634:{T:-1},635:{T:1,f:kR},636:{T:-1},637:{f:K8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},kf={6:{f:vf},10:{f:Bn},12:{f:it},13:{f:it},14:{f:et},15:{f:et},16:{f:Ct},17:{f:et},18:{f:et},19:{f:it},20:{f:Jx},21:{f:Jx},23:{f:jx},24:{f:Zx},25:{f:et},26:{},27:{},28:{f:w5},29:{},34:{f:et},35:{f:Qx},38:{f:Ct},39:{f:Ct},40:{f:Ct},41:{f:Ct},42:{f:et},43:{f:et},47:{f:AO},49:{f:r5},51:{f:it},60:{},61:{f:jI},64:{f:et},65:{f:t5},66:{f:it},77:{},80:{},81:{},82:{},85:{f:it},89:{},90:{},91:{},92:{f:GI},93:{f:k5},94:{},95:{f:et},96:{},97:{},99:{f:et},125:{f:tg},128:{f:h5},129:{f:qI},130:{f:it},131:{f:et},132:{f:et},133:{f:KI},134:{},140:{f:F5},141:{f:it},144:{},146:{f:O5},151:{},152:{},153:{},154:{},155:{},156:{f:it},157:{},158:{},160:{f:L5},161:{f:N5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:c5},190:{f:u5},193:{f:Bn},197:{},198:{},199:{},200:{},201:{},202:{f:et},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:it},220:{},221:{f:et},222:{},224:{f:l5},225:{f:zI},226:{f:Bn},227:{},229:{f:E5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:XI},253:{f:n5},255:{f:YI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:$x},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:et},353:{f:Bn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:p5},431:{f:et},432:{},433:{},434:{},437:{},438:{f:C5},439:{f:et},440:{f:b5},441:{},442:{f:ss},443:{},444:{f:it},445:{},446:{},448:{f:Bn},449:{f:ZI,r:2},450:{f:Bn},512:{f:Xx},513:{f:P5},515:{f:d5},516:{f:a5},517:{f:Yx},519:{f:B5},520:{f:JI},523:{},545:{f:eg},549:{f:Kx},566:{},574:{f:e5},638:{f:o5},659:{},1048:{},1054:{f:i5},1084:{},1212:{f:v5},2048:{f:S5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:gc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:R5,r:12},2173:{f:cR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:et,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:g5,r:12},2197:{},2198:{f:rR,r:12},2199:{},2200:{},2201:{},2202:{f:_5,r:12},2203:{f:Bn},2204:{},2205:{},2206:{},2207:{},2211:{f:QI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:it},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:D5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:I5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Xx},1:{},2:{f:$5},3:{f:V5},4:{f:U5},5:{f:Yx},7:{f:H5},8:{},9:{f:gc},11:{},22:{f:it},30:{f:s5},31:{},32:{},33:{f:eg},36:{},37:{f:Kx},50:{f:W5},62:{},52:{},67:{},68:{f:it},69:{},86:{},126:{},127:{f:M5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:z5},223:{},234:{},354:{},421:{},518:{f:vf},521:{f:gc},536:{f:Zx},547:{f:Qx},561:{},579:{},1030:{f:vf},1033:{f:gc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Or(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&yx(r)&&e.push(r)}}function Bg(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,c=i&&i.index||e.length,f=d8(e.slice(s,c),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,o=0,l=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(s=0;s<f.length;++s){var m=f[s].trim(),x=m.slice(0,3).toLowerCase();if(x=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}o=0;continue}if(!(x!="<td"&&x!="<th")){var v=m.split(/<\/t[dh]>/i);for(c=0;c<v.length;++c){var y=v[c].trim();if(y.match(/<t[dh]/i)){for(var g=y,_=0;g.charAt(0)=="<"&&(_=g.indexOf(">"))>-1;)g=g.slice(_+1);for(var w=0;w<p.length;++w){var E=p[w];E.s.c==o&&E.s.r<u&&u<=E.e.r&&(o=E.e.c+1,w=-1)}var k=xe(y.slice(0,y.indexOf(">")));h=k.colspan?+k.colspan:1,((l=+k.rowspan)>1||h>1)&&p.push({s:{r:u,c:o},e:{r:u+(l||1)-1,c:o+h-1}});var F=k.t||k["data-t"]||"";if(!g.length){o+=h;continue}if(g=tx(g),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>o&&(d.s.c=o),d.e.c<o&&(d.e.c=o),!g.length){o+=h;continue}var b={t:"s",v:g};r.raw||!g.trim().length||F=="s"||(g==="TRUE"?b={t:"b",v:!0}:g==="FALSE"?b={t:"b",v:!1}:isNaN(Fr(g))?isNaN(Ja(g).getDate())||(b={t:"d",v:pt(g)},r.cellDates||(b={t:"n",v:Pt(b.v)}),b.z=r.dateNF||Ee[14]):b={t:"n",v:Fr(g)}),r.dense?(n[u]||(n[u]=[]),n[u][o]=b):n[ve({r:u,c:o})]=b,o+=h}}}}return n["!ref"]=Ie(d),p.length&&(n["!merges"]=p),n}function WP(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var c=0,f=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){c=-1;break}c=a[u].e.r-a[u].s.r+1,f=a[u].e.c-a[u].s.c+1;break}if(!(c<0)){var o=ve({r,c:s}),l=n.dense?(e[r]||[])[s]:e[o],h=l&&l.v!=null&&(l.h||Y0(l.w||(ln(l),l.w)||""))||"",d={};c>1&&(d.rowspan=c),f>1&&(d.colspan=f),n.editable?h='<span contenteditable="true">'+h+"</span>":l&&(d["data-t"]=l&&l.t||"z",l.v!=null&&(d["data-v"]=l.v),l.z!=null&&(d["data-z"]=l.z),l.l&&(l.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+l.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+o,i.push(F8("td",h,d))}}var p="<tr>";return p+i.join("")+"</tr>"}var zP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',GP="</body></html>";function qP(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ln(Bg(r[0],t),t);var n=Nf();return r.forEach(function(a,i){Df(n,Bg(a,t),"Sheet"+(i+1))}),n}function KP(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function XP(e,t){var r=t||{},n=r.header!=null?r.header:zP,a=r.footer!=null?r.footer:GP,i=[n],s=Za(e["!ref"]);r.dense=Array.isArray(e),i.push(KP(e,s,r));for(var c=s.s.r;c<=s.e.r;++c)i.push(WP(e,s,c,r));return i.push("</table>"+a),i.join("")}function Mg(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Lt(n.origin):n.origin;a=s.r,i=s.c}var c=t.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var o=Za(e["!ref"]);u.s.r=Math.min(u.s.r,o.s.r),u.s.c=Math.min(u.s.c,o.s.c),u.e.r=Math.max(u.e.r,o.e.r),u.e.c=Math.max(u.e.c,o.e.c),a==-1&&(u.e.r=a=o.e.r+1)}var l=[],h=0,d=e["!rows"]||(e["!rows"]=[]),p=0,m=0,x=0,v=0,y=0,g=0;for(e["!cols"]||(e["!cols"]=[]);p<c.length&&m<f;++p){var _=c[p];if(Vg(_)){if(n.display)continue;d[m]={hidden:!0}}var w=_.children;for(x=v=0;x<w.length;++x){var E=w[x];if(!(n.display&&Vg(E))){var k=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):tx(E.innerHTML),F=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<l.length;++h){var b=l[h];b.s.c==v+i&&b.s.r<m+a&&m+a<=b.e.r&&(v=b.e.c+1-i,h=-1)}g=+E.getAttribute("colspan")||1,((y=+E.getAttribute("rowspan")||1)>1||g>1)&&l.push({s:{r:m+a,c:v+i},e:{r:m+a+(y||1)-1,c:v+i+(g||1)-1}});var L={t:"s",v:k},U=E.getAttribute("data-t")||E.getAttribute("t")||"";k!=null&&(k.length==0?L.t=U||"z":n.raw||k.trim().length==0||U=="s"||(k==="TRUE"?L={t:"b",v:!0}:k==="FALSE"?L={t:"b",v:!1}:isNaN(Fr(k))?isNaN(Ja(k).getDate())||(L={t:"d",v:pt(k)},n.cellDates||(L={t:"n",v:Pt(L.v)}),L.z=n.dateNF||Ee[14]):L={t:"n",v:Fr(k)})),L.z===void 0&&F!=null&&(L.z=F);var B="",Y=E.getElementsByTagName("A");if(Y&&Y.length)for(var se=0;se<Y.length&&!(Y[se].hasAttribute("href")&&(B=Y[se].getAttribute("href"),B.charAt(0)!="#"));++se);B&&B.charAt(0)!="#"&&(L.l={Target:B}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+i]=L):e[ve({c:v+i,r:m+a})]=L,u.e.c<v+i&&(u.e.c=v+i),v+=g}}++m}return l.length&&(e["!merges"]=(e["!merges"]||[]).concat(l)),u.e.r=Math.max(u.e.r,m-1+a),e["!ref"]=Ie(u),m>=f&&(e["!fullref"]=Ie((u.e.r=c.length-p+m-1+a,u))),e}function Ug(e,t){var r=t||{},n=r.dense?[]:{};return Mg(n,e,t)}function YP(e,t){return Ln(Ug(e,t),t)}function Vg(e){var t="",r=JP(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function JP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function QP(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ne(t.replace(/<[^>]*>/g,""));return[r]}var $g={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Hg(e,t){var r=t||{},n=Q0(e),a=[],i,s,c={name:""},f="",u=0,o,l,h={},d=[],p=r.dense?[]:{},m,x,v={value:""},y="",g=0,_=[],w=-1,E=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,b={},L=[],U={},B=0,Y=0,se=[],re=1,ue=1,ne=[],De={Names:[]},W={},pe=["",""],me=[],N={},V="",M=0,P=!1,J=!1,te=0;for(Zi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Zi.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?p["!ref"]=Ie(k):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(p["!fullref"]=p["!ref"],k.e.r=r.sheetRows-1,p["!ref"]=Ie(k)),L.length&&(p["!merges"]=L),se.length&&(p["!rows"]=se),o.name=o.名称||o.name,typeof JSON<"u"&&JSON.stringify(o),d.push(o.name),h[o.name]=p,J=!1):m[0].charAt(m[0].length-2)!=="/"&&(o=xe(m[0],!1),w=E=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,p=r.dense?[]:{},L=[],se=[],J=!0);break;case"table-row-group":m[1]==="/"?--F:++F;break;case"table-row":case"行":if(m[1]==="/"){w+=re,re=1;break}if(l=xe(m[0],!1),l.行号?w=l.行号-1:w==-1&&(w=0),re=+l["number-rows-repeated"]||1,re<10)for(te=0;te<re;++te)F>0&&(se[w+te]={level:F});E=-1;break;case"covered-table-cell":m[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(p[w]||(p[w]=[]),p[w][E]={t:"z"}):p[ve({r:w,c:E})]={t:"z"}),y="",_=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++E,v=xe(m[0],!1),ue=parseInt(v["number-columns-repeated"]||"1",10),x={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(x.f=Ag(Ne(v.formula))),(v.数据类型||v["value-type"])=="string"&&(x.t="s",x.v=Ne(v["string-value"]||""),r.dense?(p[w]||(p[w]=[]),p[w][E]=x):p[ve({r:w,c:E})]=x),E+=ue-1;else if(m[1]!=="/"){++E,y="",g=0,_=[],ue=1;var fe=re?w+re-1:w;if(E>k.e.c&&(k.e.c=E),E<k.s.c&&(k.s.c=E),w<k.s.r&&(k.s.r=w),fe>k.e.r&&(k.e.r=fe),v=xe(m[0],!1),me=[],N={},x={t:v.数据类型||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ne(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(B=parseInt(v["number-matrix-rows-spanned"],10)||0,Y=parseInt(v["number-matrix-columns-spanned"],10)||0,U={s:{r:w,c:E},e:{r:w+B-1,c:E+Y-1}},x.F=Ie(U),ne.push([U,x.F])),v.formula)x.f=Ag(v.formula);else for(te=0;te<ne.length;++te)w>=ne[te][0].s.r&&w<=ne[te][0].e.r&&E>=ne[te][0].s.c&&E<=ne[te][0].e.c&&(x.F=ne[te][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(B=parseInt(v["number-rows-spanned"],10)||0,Y=parseInt(v["number-columns-spanned"],10)||0,U={s:{r:w,c:E},e:{r:w+B-1,c:E+Y-1}},L.push(U)),v["number-columns-repeated"]&&(ue=parseInt(v["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=ze(v["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(v.value);break;case"percentage":x.t="n",x.v=parseFloat(v.value);break;case"currency":x.t="n",x.v=parseFloat(v.value);break;case"date":x.t="d",x.v=pt(v["date-value"]),r.cellDates||(x.t="n",x.v=Pt(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=f8(v["time-value"])/86400,r.cellDates&&(x.t="d",x.v=cc(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(v.数据数值);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",v["string-value"]!=null&&(y=Ne(v["string-value"]),_=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(P=!1,x.t==="s"&&(x.v=y||"",_.length&&(x.R=_),P=g==0),W.Target&&(x.l=W),me.length>0&&(x.c=me,me=[]),y&&r.cellText!==!1&&(x.w=y),P&&(x.t="z",delete x.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var ae=0;ae<re;++ae){if(ue=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[w+ae]||(p[w+ae]=[]),p[w+ae][E]=ae==0?x:_t(x);--ue>0;)p[w+ae][E+ue]=_t(x);else for(p[ve({r:w+ae,c:E})]=x;--ue>0;)p[ve({r:w+ae,c:E+ue})]=_t(x);k.e.c<=E&&(k.e.c=E)}ue=parseInt(v["number-columns-repeated"]||"1",10),E+=ue-1,ue=0,x={},y="",_=[]}W={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i;N.t=y,_.length&&(N.R=_),N.a=V,me.push(N)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);V="",M=0,y="",g=0,_=[];break;case"creator":m[1]==="/"?V=n.slice(M,m.index):M=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);y="",g=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(b[c.name]=f,(i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(f="",c=xe(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=xe(m[0],!1),f+=$g[m[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=xe(m[0],!1),f+=$g[m[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":s=xe(m[0],!1),pe=_f(s["cell-range-address"]);var j={Name:s.name,Ref:pe[0]+"!"+pe[1]};J&&(j.Sheet=d.length),De.Names.push(j);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var Pe=QP(n.slice(g,m.index));y=(y.length>0?y+`
`:"")+Pe[0]}else xe(m[0],!1),g=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{pe=_f(xe(m[0])["target-range-address"]),h[pe[0]]["!autofilter"]={ref:pe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(W=xe(m[0],!1),!W.href)break;W.Target=Ne(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(pe=_f(W.Target.slice(1)),W.Target="#"+pe[0]+"!"+pe[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var D={Sheets:h,SheetNames:d,Workbook:De};return r.bookSheets&&delete D.Sheets,D}function Wg(e,t){t=t||{},fr(e,"META-INF/manifest.xml")&&dI(at(e,"META-INF/manifest.xml"),t);var r=Jt(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Hg(He(r),t);return fr(e,"meta.xml")&&(n.Props=Rx(at(e,"meta.xml"))),n}function zg(e,t){return Hg(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Tf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Af(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):He(ia(e))}function Cf(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Gg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function ZP(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function gs(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ht(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ft(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=gs(e,r),i=a&7;a=Math.floor(a/8);var s=0,c;if(a==0)break;switch(i){case 0:{for(var f=r[0];e[r[0]++]>=128;);c=e.slice(f,r[0])}break;case 5:s=4,c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=gs(e,r),c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:c,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function bf(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function jP(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=gs(e,n),i=Ft(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:ht(i[1][0].data),messages:[]};i[2].forEach(function(c){var f=Ft(c.data),u=ht(f[3][0].data);s.messages.push({meta:f,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=ht(i[3][0].data)>>>0>0),r.push(s)}return r}function e9(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=gs(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var c=s-59;s=t[r[0]],c>1&&(s|=t[r[0]+1]<<8),c>2&&(s|=t[r[0]+2]<<16),c>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=c}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var f=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,f=(t[r[0]++]&224)<<3,f|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(f=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(f=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Cf(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(u>=f)for(a.push(a[0].slice(-f)),u-=f;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-f,-f+u))}}var o=Cf(a);if(o.length!=n)throw new Error("Unexpected length: ".concat(o.length," != ").concat(n));return o}function t9(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(e9(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Cf(t)}function r9(e,t,r,n){var a=Tf(e),i=a.getUint32(4,!0),s=(n>1?12:8)+Gg(i&(n>1?3470:398))*4,c=-1,f=-1,u=NaN,o=new Date(2001,0,1);i&512&&(c=a.getUint32(s,!0),s+=4),s+=Gg(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(o.setTime(o.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var l;switch(e[2]){case 0:break;case 2:l={t:"n",v:u};break;case 3:l={t:"s",v:t[f]};break;case 5:l={t:"d",v:o};break;case 6:l={t:"b",v:u>0};break;case 7:l={t:"n",v:u/86400};break;case 8:l={t:"e",v:0};break;case 9:if(c>-1)l={t:"s",v:r[c]};else if(f>-1)l={t:"s",v:t[f]};else if(!isNaN(u))l={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return l}function n9(e,t,r){var n=Tf(e),a=n.getUint32(8,!0),i=12,s=-1,c=-1,f=NaN,u=NaN,o=new Date(2001,0,1);a&1&&(f=ZP(e,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(o.setTime(o.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var l;switch(e[1]){case 0:break;case 2:l={t:"n",v:f};break;case 3:l={t:"s",v:t[c]};break;case 5:l={t:"d",v:o};break;case 6:l={t:"b",v:u>0};break;case 7:l={t:"n",v:u/86400};break;case 8:l={t:"e",v:0};break;case 9:if(s>-1)l={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:l={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return l}function a9(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return r9(e,t,r,e[0]);case 5:return n9(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Un(e){var t=Ft(e);return gs(t[1][0].data)}function qg(e,t){var r=Ft(t.data),n=ht(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var c=Ft(s.data),f=ht(c[1][0].data)>>>0;switch(n){case 1:i[f]=Af(c[3][0].data);break;case 8:{var u=e[Un(c[9][0].data)][0],o=Ft(u.data),l=e[Un(o[1][0].data)][0],h=ht(l.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=Ft(l.data);i[f]=d[3].map(function(p){return Af(p.data)}).join("")}break}}),i}function i9(e,t){var r,n,a,i,s,c,f,u,o,l,h,d,p,m,x=Ft(e),v=ht(x[1][0].data)>>>0,y=ht(x[2][0].data)>>>0,g=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&ht(x[8][0].data)>0||!1,_,w;if((i=(a=x[7])==null?void 0:a[0])!=null&&i.data&&t!=0)_=(c=(s=x[7])==null?void 0:s[0])==null?void 0:c.data,w=(u=(f=x[6])==null?void 0:f[0])==null?void 0:u.data;else if((l=(o=x[4])==null?void 0:o[0])!=null&&l.data&&t!=1)_=(d=(h=x[4])==null?void 0:h[0])==null?void 0:d.data,w=(m=(p=x[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=g?4:1,k=Tf(_),F=[],b=0;b<_.length/2;++b){var L=k.getUint16(b*2,!0);L<65535&&F.push([b,L])}if(F.length!=y)throw"Expected ".concat(y," cells, found ").concat(F.length);var U=[];for(b=0;b<F.length-1;++b)U[F[b][0]]=w.subarray(F[b][1]*E,F[b+1][1]*E);return F.length>=1&&(U[F[F.length-1][0]]=w.subarray(F[F.length-1][1]*E)),{R:v,cells:U}}function s9(e,t){var r,n=Ft(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?ht(n[7][0].data)>>>0>0?1:0:-1,i=bf(n[5],function(s){return i9(s,a)});return{nrows:ht(n[4][0].data)>>>0,data:i.reduce(function(s,c){return s[c.R]||(s[c.R]=[]),c.cells.forEach(function(f,u){if(s[c.R][u])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(u));s[c.R][u]=f}),s},[])}}function o9(e,t,r){var n,a=Ft(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(ht(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(ht(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ie(i);var s=Ft(a[4][0].data),c=qg(e,e[Un(s[4][0].data)][0]),f=(n=s[17])!=null&&n[0]?qg(e,e[Un(s[17][0].data)][0]):[],u=Ft(s[3][0].data),o=0;u[1].forEach(function(l){var h=Ft(l.data),d=e[Un(h[2][0].data)][0],p=ht(d.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=s9(e,d);m.data.forEach(function(x,v){x.forEach(function(y,g){var _=ve({r:o+v,c:g}),w=a9(y,c,f);w&&(r[_]=w)})}),o+=m.nrows})}function c9(e,t){var r=Ft(t.data),n={"!ref":"A1"},a=e[Un(r[2][0].data)],i=ht(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return o9(e,a[0],n),n}function u9(e,t){var r,n=Ft(t.data),a={name:(r=n[1])!=null&&r[0]?Af(n[1][0].data):"",sheets:[]},i=bf(n[2],Un);return i.forEach(function(s){e[s].forEach(function(c){var f=ht(c.meta[1][0].data);f==6e3&&a.sheets.push(c9(e,c))})}),a}function f9(e,t){var r=Nf(),n=Ft(t.data),a=bf(n[1],Un);if(a.forEach(function(i){e[i].forEach(function(s){var c=ht(s.meta[1][0].data);if(c==2){var f=u9(e,s);f.sheets.forEach(function(u,o){Df(r,u,o==0?f.name:f.name+"_"+o,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Sf(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var u;try{u=t9(f.content)}catch(l){return console.log("?? "+f.content.length+" "+(l.message||l))}var o;try{o=jP(u)}catch(l){return console.log("## "+(l.message||l))}o.forEach(function(l){i[l.id]=l.messages,s.push(l.id)})}}),!s.length)throw new Error("File has no messages");var c=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&ht(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||s.forEach(function(f){i[f].forEach(function(u){var o=ht(u.meta[1][0].data)>>>0;if(o==1)if(!c)c=u;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return f9(i,c)}function l9(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Ff(e){l9([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function h9(e){return ei.WS.indexOf(e)>-1?"sheet":e==ei.CS?"chart":e==ei.DS?"dialog":e==ei.MS?"macro":e&&e.length?e:"sheet"}function d9(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,h9(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function p9(e,t,r,n,a,i,s,c,f,u,o,l){try{i[n]=ns(Jt(e,r,!0),t);var h=at(e,t),d;switch(c){case"sheet":d=yP(h,t,a,f,i[n],u,o,l);break;case"chart":if(d=wP(h,t,a,f,i[n],u,o,l),!d||!d["!drawel"])break;var p=Yi(d["!drawel"].Target,t),m=uf(p),x=_R(Jt(e,p,!0),ns(Jt(e,m,!0),p)),v=Yi(x,p),y=uf(v);d=nP(Jt(e,v,!0),v,f,ns(Jt(e,y,!0),v),u,d);break;case"macro":d=EP(h,t,a,f,i[n],u,o,l);break;case"dialog":d=kP(h,t,a,f,i[n],u,o,l);break;default:throw new Error("Unrecognized sheet type "+c)}s[n]=d;var g=[];i&&i[n]&&Hr(i[n]).forEach(function(_){var w="";if(i[n][_].Type==ei.CMNT){w=Yi(i[n][_].Target,t);var E=bP(at(e,w,!0),w,f);if(!E||!E.length)return;lg(d,E,!1)}i[n][_].Type==ei.TCMNT&&(w=Yi(i[n][_].Target,t),g=g.concat(wR(at(e,w,!0),f)))}),g&&g.length&&lg(d,g,!0,f.people||[])}catch(_){if(f.WTF)throw _}}function hr(e){return e.charAt(0)=="/"?e.slice(1):e}function m9(e,t){if(Um(),t=t||{},Ff(t),fr(e,"META-INF/manifest.xml")||fr(e,"objectdata.xml"))return Wg(e,t);if(fr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sf<"u"){if(e.FileIndex)return Sf(e);var r=Fe.utils.cfb_new();return Km(e).forEach(function(se){x8(r,se,m8(e,se))}),Sf(r)}throw new Error("Unsupported NUMBERS file")}if(!fr(e,"[Content_Types].xml"))throw fr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):fr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Km(e),a=lI(Jt(e,"[Content_Types].xml")),i=!1,s,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",at(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!at(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},u={};if(!t.bookSheets&&!t.bookProps){if(ps=[],a.sst)try{ps=CP(at(e,hr(a.sst)),a.sst,t)}catch(se){if(t.WTF)throw se}t.cellStyles&&a.themes.length&&(f=AP(Jt(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=TP(at(e,hr(a.style)),a.style,f,t))}a.links.map(function(se){try{var re=ns(Jt(e,uf(hr(se))),se);return FP(at(e,hr(se)),re,se,t)}catch{}});var o=_P(at(e,hr(a.workbooks[0])),a.workbooks[0],t),l={},h="";a.coreprops.length&&(h=at(e,hr(a.coreprops[0]),!0),h&&(l=Rx(h)),a.extprops.length!==0&&(h=at(e,hr(a.extprops[0]),!0),h&&xI(h,l,t)));var d={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=Jt(e,hr(a.custprops[0]),!0),h&&(d=vI(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(o.Sheets?s=o.Sheets.map(function(re){return re.name}):l.Worksheets&&l.SheetNames.length>0&&(s=l.SheetNames),t.bookProps&&(p.Props=l,p.Custprops=d),t.bookSheets&&typeof s<"u"&&(p.SheetNames=s),t.bookSheets?p.SheetNames:t.bookProps))return p;s={};var m={};t.bookDeps&&a.calcchain&&(m=SP(at(e,hr(a.calcchain)),a.calcchain));var x=0,v={},y,g;{var _=o.Sheets;l.Worksheets=_.length,l.SheetNames=[];for(var w=0;w!=_.length;++w)l.SheetNames[w]=_[w].name}var E=i?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),F=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");fr(e,F)||(F="xl/_rels/workbook."+E+".rels");var b=ns(Jt(e,F,!0),F.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=IP(at(e,hr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=ER(at(e,hr(a.people[0])),t)),b&&(b=d9(b,o.Sheets));var L=at(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=l.Worksheets;++x){var U="sheet";if(b&&b[x]?(y="xl/"+b[x][1].replace(/[\/]?xl\//,""),fr(e,y)||(y=b[x][1]),fr(e,y)||(y=F.replace(/_rels\/.*$/,"")+b[x][1]),U=b[x][2]):(y="xl/worksheets/sheet"+(x+1-L)+"."+E,y=y.replace(/sheet0\./,"sheet.")),g=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(l.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var B=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==x&&(B=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==l.SheetNames[x].toLowerCase()&&(B=1);if(!B)continue e}}p9(e,y,g,l.SheetNames[x],x,v,s,U,t,o,f,u)}return p={Directory:a,Workbook:o,Props:l,Custprops:d,Deps:m,Sheets:s,SheetNames:l.SheetNames,Strings:ps,Styles:u,Themes:f,SSF:_t(Ee)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(se,re){se=se.replace(/^Root Entry[\/]/,""),p.keys.push(se),p.files[se]=e.FileIndex[re]}))),t&&t.bookVBA&&(a.vba.length>0?p.vbaraw=at(e,hr(a.vba[0]),!0):a.defaults&&a.defaults.bin===CR&&(p.vbaraw=at(e,"xl/vbaProject.bin",!0))),p}function x9(e,t){var r=t||{},n="Workbook",a=Fe.find(e,n);try{if(n="/!DataSpaces/Version",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(cO(a.content),n="/!DataSpaces/DataSpaceMap",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=fO(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=lO(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);dO(a.content)}catch{}if(n="/EncryptionInfo",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=pO(a.content);if(n="/EncryptedPackage",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function If(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Yt(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function g9(e,t){return Fe.find(e,"EncryptedPackage")?x9(e,t):Lg(e,t)}function v9(e,t){var r,n=e,a=t||{};return a.type||(a.type=be&&Buffer.isBuffer(e)?"buffer":"base64"),r=Xm(n,a),m9(r,a)}function Kg(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ef(e.slice(r),t);default:break e}return os.to_workbook(e,t)}function _9(e,t){var r="",n=If(e,t);switch(t.type){case"base64":r=Yt(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ua(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=He(r)),t.type="binary",Kg(r,t)}function y9(e,t){var r=e;return t.type=="base64"&&(r=Yt(r)),r=H0.utils.decode(1200,r.slice(2),"str"),t.type="binary",Kg(r,t)}function w9(e){return e.match(/[^\x00-\x7F]/)?Ji(e):e}function Of(e,t,r,n){return n?(r.type="string",os.to_workbook(e,r)):os.to_workbook(t,r)}function bc(e,t){xm();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return bc(new Uint8Array(e),(r=_t(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ni={},r.dateNF&&(ni.dateNF=r.dateNF),r.type||(r.type=be&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=be?"buffer":"binary",n=c8(e),typeof Uint8Array<"u"&&!be&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=w9(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),c=new Uint8Array(s);if(c.foo="bar",!c.foo)return r=_t(r),r.type="array",bc(W0(n),r)}switch((a=If(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return g9(Fe.read(n,r),r);break;case 9:if(a[1]<=8)return Lg(n,r);break;case 60:return Ef(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Y5(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return K5.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?v9(n,r):Of(e,n,r,i);case 239:return a[3]===60?Ef(n,r):Of(e,n,r,i);case 255:if(a[1]===254)return y9(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return cs.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return cs.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return rg.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return CO.to_workbook(n,r);break;case 10:case 13:case 32:return _9(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return G5.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?rg.to_workbook(n,r):Of(e,n,r,i)}function E9(e,t,r,n,a,i,s,c){var f=wt(r),u=c.defval,o=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),l=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var d=t.s.c;d<=t.e.c;++d){var p=s?e[r][d]:e[n[d]+f];if(p===void 0||p.t===void 0){if(u===void 0)continue;i[d]!=null&&(h[i[d]]=u);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[d]!=null){if(m==null)if(p.t=="e"&&m===null)h[i[d]]=null;else if(u!==void 0)h[i[d]]=u;else if(o&&m===null)h[i[d]]=null;else continue;else h[i[d]]=o&&(p.t!=="n"||p.t==="n"&&c.rawNumbers!==!1)?m:ln(p,m,c);m!=null&&(l=!1)}}return{row:h,isempty:l}}function Rf(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},o=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof o){case"string":f=Qe(o);break;case"number":f=Qe(e["!ref"]),f.s.r=o;break;default:f=o}n>0&&(a=0);var l=wt(f.s.r),h=[],d=[],p=0,m=0,x=Array.isArray(e),v=f.s.r,y=0,g={};x&&!e[v]&&(e[v]=[]);var _=u.skipHidden&&e["!cols"]||[],w=u.skipHidden&&e["!rows"]||[];for(y=f.s.c;y<=f.e.c;++y)if(!(_[y]||{}).hidden)switch(h[y]=lt(y),r=x?e[v][y]:e[h[y]+l],n){case 1:i[y]=y-f.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=u.header[y-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=s=ln(r,null,u),m=g[s]||0,!m)g[s]=1;else{do c=s+"_"+m++;while(g[c]);g[s]=m,g[c]=1}i[y]=c}for(v=f.s.r+a;v<=f.e.r;++v)if(!(w[v]||{}).hidden){var E=E9(e,f,v,h,n,i,x,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[p++]=E.row)}return d.length=p,d}var Xg=/"/g;function k9(e,t,r,n,a,i,s,c){for(var f=!0,u=[],o="",l=wt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=c.dense?(e[r]||[])[h]:e[n[h]+l];if(d==null)o="";else if(d.v!=null){f=!1,o=""+(c.rawNumbers&&d.t=="n"?d.v:ln(d,null,c));for(var p=0,m=0;p!==o.length;++p)if((m=o.charCodeAt(p))===a||m===i||m===34||c.forceQuotes){o='"'+o.replace(Xg,'""')+'"';break}o=="ID"&&(o='"ID"')}else d.f!=null&&!d.F?(f=!1,o="="+d.f,o.indexOf(",")>=0&&(o='"'+o.replace(Xg,'""')+'"')):o="";u.push(o)}return c.blankrows===!1&&f?null:u.join(s)}function Yg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Qe(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),o="",l=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(l[p]=lt(p));for(var m=0,x=a.s.r;x<=a.e.r;++x)(d[x]||{}).hidden||(o=k9(e,a,x,l,s,f,i,n),o!=null&&(n.strip&&(o=o.replace(u,"")),(o||n.blankrows!==!1)&&r.push((m++?c:"")+o)));return delete n.dense,r.join("")}function T9(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Yg(e,t);return r}function A9(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Qe(e["!ref"]),i="",s=[],c,f=[],u=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)s[c]=lt(c);for(var o=a.s.r;o<=a.e.r;++o)for(i=wt(o),c=a.s.c;c<=a.e.c;++c)if(t=s[c]+i,r=u?(e[o]||[])[c]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=t+"="+n}return f}function Jg(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?Lt(n.origin):n.origin;s=f.r,c=f.c}var u,o={s:{c:0,r:0},e:{c,r:s+t.length-1+a}};if(i["!ref"]){var l=Qe(i["!ref"]);o.e.c=Math.max(o.e.c,l.e.c),o.e.r=Math.max(o.e.r,l.e.r),s==-1&&(s=l.e.r+1,o.e.r=s+t.length-1+a)}else s==-1&&(s=0,o.e.r=t.length-1+a);var h=n.header||[],d=0;t.forEach(function(m,x){Hr(m).forEach(function(v){(d=h.indexOf(v))==-1&&(h[d=h.length]=v);var y=m[v],g="z",_="",w=ve({c:c+d,r:s+x+a});u=vs(i,w),y&&typeof y=="object"&&!(y instanceof Date)?i[w]=y:(typeof y=="number"?g="n":typeof y=="boolean"?g="b":typeof y=="string"?g="s":y instanceof Date?(g="d",n.cellDates||(g="n",y=Pt(y)),_=n.dateNF||Ee[14]):y===null&&n.nullError&&(g="e",y=0),u?(u.t=g,u.v=y,delete u.w,delete u.R,_&&(u.z=_)):i[w]=u={t:g,v:y},_&&(u.z=_))})}),o.e.c=Math.max(o.e.c,c+h.length-1);var p=wt(s);if(a)for(d=0;d<h.length;++d)i[lt(d+c)+p]={t:"s",v:h[d]};return i["!ref"]=Ie(o),i}function C9(e,t){return Jg(null,e,t)}function vs(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Lt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vs(e,ve(t)):vs(e,ve({r:t,c:r||0}))}function b9(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Nf(){return{SheetNames:[],Sheets:{}}}function Df(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(lP(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function S9(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=b9(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function F9(e,t){return e.z=t,e}function Qg(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function I9(e,t,r){return Qg(e,"#"+t,r)}function O9(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function R9(e,t,r,n){for(var a=typeof t!="string"?t:Qe(t),i=typeof t=="string"?t:Ie(t),s=a.s.r;s<=a.e.r;++s)for(var c=a.s.c;c<=a.e.c;++c){var f=vs(e,s,c);f.t="n",f.F=i,delete f.v,s==a.s.r&&c==a.s.c&&(f.f=r,n&&(f.D=!0))}return e}var Zg={encode_col:lt,encode_row:wt,encode_cell:ve,encode_range:Ie,decode_col:rf,decode_row:tf,split_cell:z8,decode_cell:Lt,decode_range:Za,format_cell:ln,sheet_add_aoa:Tx,sheet_add_json:Jg,sheet_add_dom:Mg,aoa_to_sheet:ja,json_to_sheet:C9,table_to_sheet:Ug,table_to_book:YP,sheet_to_csv:Yg,sheet_to_txt:T9,sheet_to_json:Rf,sheet_to_html:XP,sheet_to_formulae:A9,sheet_to_row_object_array:Rf,sheet_get_cell:vs,book_new:Nf,book_append_sheet:Df,book_set_sheet_visibility:S9,cell_set_number_format:F9,cell_set_hyperlink:Qg,cell_set_internal_link:I9,cell_add_comment:O9,sheet_set_array_formula:R9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function N9(e){return JSON.parse(JSON.stringify(e))}const ai=Me("dataframe/agg-generate",async({colName:e,formula:t},{getState:r,dispatch:n})=>new Promise((a,i)=>{const s=N9(r().dataframe);try{const c=Vt(s.dataframe).derive({[e]:t},{drop:!1}).objects();n(fv(c)),a(c)}catch(c){console.error(c),i("Failed to create the aggregation ")}})),ii=Me("dataframe/agg-generate-batch",async({cols:e},{getState:t})=>new Promise((r,n)=>{let a={};e.forEach(i=>{var s;(s=i==null?void 0:i.info)!=null&&s.exec&&(a[i.name]=i.info.exec)});try{const i=t().dataframe,s=Vt(i.dataframe).derive(a,{drop:!1}).objects();r(s)}catch(i){console.error(i),n("Failed to create the aggregation ")}})),_s=Me("dataframe/agg-empty",async({colName:e},{getState:t})=>new Promise((r,n)=>{const a=t().dataframe;try{const i=Vt(a.dataframe).derive({[e]:s=>null},{drop:!1}).objects();r(i)}catch{n("Failed to create the aggregation")}})),Sc=Me("dataframe/remove-col",async({colName:e},{getState:t})=>new Promise((r,n)=>{const a=t().dataframe;try{console.log("REMOVING COLUMN");const i=[e],s=Vt(a.dataframe).select(eo(i)).objects();r(s)}catch{n("Failed to remove attribute")}})),Fc=Me("dataframe/remove-batch",async({cols:e},{getState:t})=>new Promise((r,n)=>{const a=t().dataframe;try{const i=Vt(a.dataframe).select(eo(e)).objects();r(i)}catch{n("Failed to remove attribute")}}));function D9(e){let t=1;const r=[];for(const n in e)e.hasOwnProperty(n)&&r.push({id:t++,name:n,dtype:e[n],related:[],isShown:!0,type:"attribute",desc:""});return r}const jg=Me("meta/build-auto-create",async(e,t)=>(console.log(e),new Promise(async(r,n)=>{const a=t.getState().metadata.attributes.filter(f=>f.type=="root"),i=a.filter(f=>f.type==="attribute").map(f=>f.name),s=e.filter(f=>f.type=="aggregation"&i.find(u=>u==f.name)==null),c=a.filter(f=>f.type=="aggregation").map(f=>f.name);return await t.dispatch(Fc({cols:c})).then(f=>{t.dispatch(ii({cols:s}))}),r(e)}))),ys=Me("meta/build-from-data",async(e,t)=>new Promise((r,n)=>{try{const a=D9(e),s=[{id:0,name:"Root",dtype:"none",type:"root",isShown:!0,desc:"Nodo Raíz",related:a.map(c=>c.id)},...a];r(s)}catch(a){n(a)}})),ev=Me("meta/add-attribute",async(e,{dispatch:t})=>new Promise((r,n)=>{const{name:a,type:i}=e;return i=="aggregation"&&t(_s({colName:a})),r(e)})),Pf=Me("meta/update-attribute",async(e,{dispatch:t})=>new Promise((r,n)=>{const{name:a,type:i,info:s,recover:c}=e;if(i=="aggregation"&&(s.exec===""?t(_s({colName:a})):t(ai({colName:a,formula:s.exec}))),c==null|c)return r({node:{...e},recover:null});{const{recover:f,...u}=e;return r({node:{...u},recover:!1})}})),tv=Me("meta/remove-attribute",async(e,{dispatch:t,getState:r})=>new Promise((n,a)=>{console.log(e);const{attributeID:i}=e,c=r().metadata.attributes.find(f=>f.id===i);return c.type=="aggregation"&&t(Sc({colName:c.name})),n(e)})),P9="id",ws="orderVariable",rv="Country",nv="Visit Name",L9=[ws,"__description"],{publish:Vn}=On,B9={init:!1,attributes:[{id:0,name:"Raíz",desc:"nodo origen",type:"root",dtype:"none",isShown:!0,related:[],info:{}}],loadingStatus:"ready",recoverableOperations:[],version:-1},Lf=Me("meta/load-desc-csv",async(e,t)=>{const r=e.opts.delimiter||",",n=e.opts.decimal||".",a=await dp(e.fileURL,{delimiter:r,decimal:n}),i=e.opts.attributes,s=e.opts.descriptions,c={};return a.objects().forEach(f=>{c[f[i]]=f[s]}),c}),Bf=Me("metadata/load-desc-excel",async(e,t)=>{try{const{fileURL:r,opts:n}=e,i=await(await fetch(r)).arrayBuffer(),c=bc(i,{type:"buffer"}).Sheets[n.sheetname],f=Vt(Zg.sheet_to_json(c)),u={};return f.objects().forEach(o=>{u[o[attrCol]]=o[descCol]}),u}catch{return t.rejectWithValue("Invalid Excel File")}}),av=Me("meta/undo",async(e,{dispatch:t,getState:r,rejectWithValue:n})=>{const a=r().metadata.recoverableOperations;if(a.length<1)return n("No hay nada que deshacer");const i=a[a.length-1];switch(i.change){case"updateNode":t(Pf({...i.associatedData,recover:!1}));break;case"addNode":t(tv({attributeID:i.associatedId,recover:!1}));case"removeNode":t(ev({...i.associatedData,parentID:i.associatedParent,recover:!1}));break;case"relationshipNode":t(U9(i));break;default:return n("Acción a Recuperar No Conocida")}return{}}),iv=or({name:"metadata",initialState:B9,reducers:e=>({setInit:e.reducer((t,r)=>{t.init=r.payload}),toggleAttribute:e.reducer((t,r)=>{const{attributeID:n}=r.payload,a=t.attributes.findIndex(i=>i.id===n);a==-1&&console.error(`The node ${n} does not exist`).return,t.attributes[a].isShown=!t.attributes[a].isShown}),changeRelationship:e.reducer((t,r)=>{const{source:n,target:a,recover:i}=r.payload,s=t.attributes.findIndex(f=>f.related.includes(n)),c=t.attributes.findIndex(f=>f.id===a);if((i==null||i)&&t.recoverableOperations.push({change:"relationshipNode",associatedId:n,associatedParent:t.attributes[s].id,associatedData:{originalPos:t.attributes[s].related.findIndex(f=>f==n)}}),t.attributes[s].related=t.attributes[s].related.filter(f=>f!==n),t.attributes[c].related=[...t.attributes[c].related.filter(f=>f!==n),n],t.attributes[s].type=="aggregation"){const f=t.attributes[s].info.usedAttributes.filter(u=>u.id!==n);t.attributes[s].info.usedAttributes=f}t.version+=.5}),revertChangeRelationship:e.reducer((t,r)=>{const{associatedId:n,associatedParent:a,associatedData:{originalPos:i}}=r.payload,s=t.attributes.findIndex(u=>u.related.includes(n));t.attributes[s].related=t.attributes[s].related.filter(u=>u!=n),t.attributes[s]==="aggregation"&&(t.attributes[s].info.usedAttributes=t.attributes[s].info.usedAttributes.filter(u=>u.id!=n));const c=t.attributes.findIndex(u=>u.id===a),f=t.attributes[c].related;f.splice(i,0,n),t.attributes[c].related=f,t.version-=.5}),setFullMeta:e.reducer((t,r)=>{t.attributes=r.payload,t.loadingStatus="done",t.version=t.version===0?1:0})}),extraReducers:e=>{e.addCase(ys.fulfilled,(t,r)=>{t.attributes=r.payload,t.version=t.version===0?1:0}),e.addCase(ys.rejected,(t,r)=>{Vn("addAlertNotification",{type:"error",msg:`Import Hierarchy Failure:
${r.payload}`})}),e.addCase(jg.fulfilled,(t,r)=>{t.attributes=r.payload,t.version=Math.min(t.version-1,0)}),e.addCase(jg.rejected,(t,r)=>{Vn("addAlertNotification",{type:"error",msg:`Failure to Save Created Hierarchy:
${r.payload}`})}),e.addCase(K9,(t,r)=>{const n=r.payload;t.attributes=t.attributes.map(a=>{const i=a.name;return a.desc=n.hasOwnProperty(i)?n[i]:"",a}),t.loadingStatus="done",t.version=0}),e.addCase(Lf.fulfilled,(t,r)=>{const n=r.payload;t.attributes=t.attributes.map(a=>{const i=a.name;return a.desc=n.hasOwnProperty(i)?n[i]:"",a}),t.loadingStatus="done",t.version=0}),e.addCase(Lf.pending,t=>{t.loadingStatus="loading"}),e.addCase(Lf.rejected,(t,r)=>{console.error("meta: fallo crear. error: ",r.payload),Vn("addAlertNotification",{type:"error",msg:`Failure to Load Attribute Metadata:
${r.payload}`}),t.loadingStatus="error"}),e.addCase(Bf.fulfilled,(t,r)=>{const n=r.payload;t.attributes=t.attributes.map(a=>{const i=a.name;return a.desc=n.hasOwnProperty(i)?n[i]:"",a}),t.loadingStatus="done",t.version=0}),e.addCase(Bf.pending,t=>{t.loadingStatus="loading"}),e.addCase(Bf.rejected,(t,r)=>{Vn("addAlertNotification",{type:"error",msg:`Failure to Load Attribute Metadata:
${r.payload}`}),t.loadingStatus="error"}),e.addCase(ev.fulfilled,(t,r)=>{const{id:n,name:a,parentID:i,type:s,recover:c,info:f}=r.payload,u=t.attributes.findIndex(l=>l.id===i);if(u===-1)return;(c==null||c)&&t.recoverableOperations.push({change:"addNode",associatedId:n,associatedParent:null,associatedData:null});let o;f==null?o=s==="aggregation"?{operation:"concat",exec:"",formula:"",usedAttributes:[]}:{}:o=f,t.attributes.push({id:n,name:a,related:[],type:s,info:o,isShown:!0,desc:"",dtype:"determine"}),t.attributes[u].related.push(n),t.loadingStatus="done",t.version+=c!=null||c?.5:-.5}),e.addCase(tv.fulfilled,(t,r)=>{const{attributeID:n,recover:a}=r.payload;if(n===0)return;const i=t.attributes.findIndex(c=>c.related.includes(n));if(a==null||a){const c=t.attributes[i].related.findIndex(u=>u==n),f=t.attributes.find(u=>u.id===n);if(f==null)return;f.type==="attribute"?t.recoverableOperations=[]:t.recoverableOperations.push({change:"removeNode",associatedId:n,associatedNodePosition:c,associatedParent:t.attributes[i].id,associatedData:{...f}})}t.attributes[i].related=t.attributes[i].related.filter(c=>c!==n);const s=t.attributes.find(c=>c.id===n);t.attributes[i].related=[...t.attributes[i].related,...s.related],t.attributes[i].info&&(t.attributes[i].info.usedAttributes=t.attributes[i].info.usedAttributes.filter(c=>c.id!==n)),t.attributes=t.attributes.filter(c=>c.id!==n),t.loadingStatus="done",t.version+=a!=null||a?.5:-.5}),e.addCase(Pf.fulfilled,(t,r)=>{const{node:n,recover:a}=r.payload,i=t.attributes.findIndex(s=>s.id===n.id);i==null||i===-1||((a==null||a)&&t.recoverableOperations.push({change:"updateNode",associatedId:n.id,associatedParent:null,associatedData:{...t.attributes[i]}}),t.attributes[i]={...t.attributes[i],...n},t.loadingStatus="done",t.version+=a!=null||a?.5:-.5,Vn("modifyNodeInfo",{node:{id:n.id,name:n.name}}))}),e.addCase(Pf.rejected,(t,r)=>{console.error("fallo actualización node:",r.payload),Vn("addAlertNotification",{type:"error",msg:"Fallo Al Actualizar"})}),e.addCase(av.fulfilled,(t,r)=>{t.recoverableOperations=t.recoverableOperations.slice(0,-1),Vn("addAlertNotification",{type:"info",msg:"Acción Recuperada"})}),e.addCase(av.rejected,(t,r)=>{Vn("addAlertNotification",{type:"warning",msg:r.payload})})}}),{setInit:ZM,setNavioColumns:jM,setFullMeta:M9,changeRelationship:eU,toggleAttribute:tU,revertChangeRelationship:U9}=iv.actions;var V9=iv.reducer;const $9={dataframe:null,original:null,navioColumns:null,loadedState:"ready",version:-1},Ic=e=>{const t=e.objects(),r={};return t.forEach(n=>{for(const a in n)if(n.hasOwnProperty(a)){const i=n[a];if(i===null)continue;const s=typeof i,c=s!=="object"?s:i instanceof Date?"date":"object";r[a]=c}}),r},H9=(e,t,r,n)=>{switch(r){case"string":return`(r) => string(r["${e}"])`;case"number":return`(r) => parse_float(r["${e}"])`;case"date":return t=="string"?`(r) => parseDate(r["${e}"], "${n}")`:t=="number"?`(r) => parseUnixDate(r["${e}"])`:`(r) => r["${e}"]`;default:return"(r) => null"}};function Oc(e,t){const r={};return t.forEach(n=>{if(n.original==n.transform)return;const a=H9(n.attribute,n.original,n.transform,n.format);r[n.attribute]=a}),e.derive(r)}Me("dataframe/load-csv",async(e,{dispatch:t,rejectWithValue:r})=>{try{const n=e.opts.delimiter||",",a=e.opts.decimal||".";let i=await dp(e.fileURL,{delimiter:n,decimal:a});i=Oc(i,e.transforms);const s=Ic(i);return t(ys(s)),i}catch{return r("Invalid CSV File")}});function sv(e,t,r){let n=Vt(e),a=Ic(n);const i=[],s=[];return[t,r].forEach(f=>{n.columnNames().includes(f)&&(i.push({attribute:f,original:a[f],transform:"string",other:""}),s.push({attribute:f,original:"string",transform:a[f],other:""}))}),n=Oc(n,i),a=Ic(n),{dt:n,meta:a,pre_ret:s}}function ov(e){let t=Vt(e),{dt:r,meta:n,pre_ret:a}=sv(t,rv,nv);return r.columnNames().includes(ws)||(r=r.derive({[ws]:zn.row_number()})),{dt:r,meta:n,pre_ret:a}}const Es=Me("dataframe/load-api",async(e,{dispatch:t,rejectWithValue:r,getState:n})=>{try{if((e==null?void 0:e.length)===0)throw new Error("Retrieved data is empty...");let a=Vt(e);console.log(a.columnNames(),a.columnNames().length);const i=n().metadata.attributes,s=i.map(m=>m.name),c=a.columnNames(),f=s.filter(m=>!c.includes(m));let u=a;f.map(m=>{u=u.derive({[m]:x=>null},{drop:!1})});let o={};i.forEach(m=>{var x;(x=m==null?void 0:m.info)!=null&&x.exec&&(o[m.name]=m.info.exec)});const l=a.derive(o,{drop:!1});let{dt:h,meta:d,pre_ret:p}=ov(l.objects());return{items:h.objects(),column_names:h.columnNames().filter(m=>m!==ws)}}catch(a){return console.error(a),r("Something is wrong with API data")}}),ks=Me("dataframe/load-import",async({data:e,isGenerateHierarchy:t},{dispatch:r,rejectWithValue:n})=>{try{const{dt:a,meta:i,pre_ret:s}=ov(e);return t&&(r(q9(s)),r(ys(i))),{items:a.objects(),column_names:a.columnNames().filter(c=>c!==ws),isNewColumns:t}}catch{return n("Something is wrong with API data")}}),cv=Me("cantab/updateDataAppVariables",async(e,{dispatch:t,rejectWithValue:r,getState:n})=>{try{const a=n().cantab.preTransforms,i=e.time,s=e.population;let c=Vt(n().dataframe.dataframe);c=Oc(c,a);const{dt:f,meta:u,pre_ret:o}=sv(c,s,i);return t(dv(s)),t(hv(i)),f.objects()}catch{return r("Something is wrong with API data")}});Me("dataframe/load-excel",async(e,{dispatch:t,rejectWithValue:r})=>{try{const{fileURL:n,opts:a,transforms:i}=e,c=await(await fetch(n)).arrayBuffer(),u=bc(c,{type:"buffer"}).Sheets[a.sheetname];let o=Vt(Zg.sheet_to_json(u));o=Oc(o,i);const l=Ic(o);return t(ys(l)),o}catch{return r("Invalid Excel File")}});const uv=or({name:"dataframe",initialState:$9,reducers:e=>({renameColumn:e.reducer((t,r)=>{const{prevName:n,newName:a}=r.payload;t.dataframe=Vt(t.dataframe).rename({[n]:a}).objects();const i=t.navioColumns.findIndex(s=>s===n);t.navioColumns[i]=a,t.version+=1}),setNavioColumns:e.reducer((t,r)=>{console.log("settin nabio colums ",r.payload),t.navioColumns=r.payload}),setDataframe:e.reducer((t,r)=>{t.dataframe=r.payload,t.version+=1})}),extraReducers:e=>{e.addCase(M9,(t,r)=>{const n=r.payload,a=lv(n,0),i=z9(a);t.navioColumns=i,console.log("filtered",i)}),e.addCase(Es.pending,(t,r)=>{t.loadedState="loading"}),e.addCase(Es.fulfilled,(t,r)=>{t.loadedState="done",t.dataframe=r.payload.items,t.original=r.payload.column_names,t.version+=1}),e.addCase(Es.rejected,(t,r)=>{t.loadedState="error"}),e.addCase(ks.pending,(t,r)=>{t.loadedState="loading"}),e.addCase(ks.fulfilled,(t,r)=>{t.loadedState="done",t.dataframe=r.payload.items,r.payload.isNewColumns&&(t.navioColumns=r.payload.column_names,t.original=r.payload.column_names),t.version+=1}),e.addCase(ks.rejected,(t,r)=>{t.loadedState="error"}),e.addCase(ai.pending,(t,r)=>{t.loadedState="loading"}),e.addCase(ai.fulfilled,(t,r)=>{t.loadedState="done",t.dataframe=r.payload,t.version+=1}),e.addCase(ai.rejected,(t,r)=>{t.loadedState="error"}),e.addCase(ii.pending,(t,r)=>{t.loadedState="loading"}),e.addCase(ii.fulfilled,(t,r)=>{t.loadedState="done",t.dataframe=r.payload,t.version+=1}),e.addCase(ii.rejected,(t,r)=>{t.loadedState="error"}),e.addCase(_s.pending,(t,r)=>{t.loadedState="loading"}),e.addCase(_s.fulfilled,(t,r)=>{t.loadedState="done",t.dataframe=r.payload,t.version+=1}),e.addCase(_s.rejected,(t,r)=>{t.loadedState="error"}),e.addCase(Sc.pending,(t,r)=>{t.loadedState="loading"}),e.addCase(Sc.fulfilled,(t,r)=>{t.loadedState="done",t.dataframe=r.payload,t.version+=1}),e.addCase(Sc.rejected,(t,r)=>{t.loadedState="error"}),e.addCase(Fc.pending,(t,r)=>{t.loadedState="loading"}),e.addCase(Fc.fulfilled,(t,r)=>{t.loadedState="done",t.dataframe=r.payload,t.version+=1}),e.addCase(Fc.rejected,(t,r)=>{t.loadedState="error"})}}),{renameColumn:rU,setNavioColumns:nU,setDataframe:fv}=uv.actions;var W9=uv.reducer;function lv(e,t){var a;const r=e.find(i=>i.id===t);if(r==null)return null;const n=r.related.map(i=>lv(e,i));return{id:r.id,name:r.name,children:n,isShown:r.isShown,type:r.type,formula:(a=r==null?void 0:r.info)==null?void 0:a.formula}}function z9(e){const t=[],r=[e];for(;r.length>0;){const n=r.shift();n.isShown===!1||!n.children||n.children.length===0?(n==null?void 0:n.type)==="aggregation"||(n==null?void 0:n.formula)===""||t.push(n.name):n.children&&n.children.length>0&&r.push(...n.children)}return t}const{publish:qr}=On,hv=Me("cantab/setTimeVar",async(e,{getState:t})=>{const n=t().dataframe.dataframe;return{time_var:e,times:[...new Set(n.map(a=>a[e]))],selection_times:[...new Set(n.map(a=>a[e]))]}}),dv=Me("cantab/setGroupVar",async(e,{getState:t})=>{const n=t().dataframe.dataframe;return{group_var:e,populations:[...new Set(n.map(a=>a[e]))],selection_populations:[...new Set(n.map(a=>a[e]))]}}),pv=or({name:"cantab",initialState:{selectedIds:[],scenarioRunResults:[],notApi:null,init:!1,attr_width:20,quarantineData:null,quarantineSelection:null,filteredData:null,pop_metadata:null,preTransforms:null,descriptions:{},times:null,populations:null,selection:null,selection_times:null,selection_populations:null,time_var:nv,group_var:rv,idVar:P9},reducers:{setInit:(e,t)=>{e.init=t.payload},setFilteredData:(e,t)=>{e.filteredData=t.payload},setQuarantineData:(e,t)=>{e.quarantineData=t.payload},setScenarioRunResults:(e,t)=>{e.scenarioRunResults=t.payload},setSelectedIds:(e,t)=>{e.selectedIds=t.payload},setPreTransforms:(e,t)=>{e.preTransforms=t.payload},setDescriptions:(e,t)=>{e.descriptions=t.payload},setSelection:(e,t)=>{e.selection=t.payload,e.selection_populations=[...new Set(t.payload.map(r=>r[e.group_var]))],e.selection_times=[...new Set(t.payload.map(r=>r[e.time_var]))]},setQuarantineSelection:(e,t)=>{e.quarantineSelection=t.payload},setAttrWidth:(e,t)=>{e.attr_width=t.payload}},extraReducers:e=>{e.addCase(fv,(t,r)=>{const n=r.payload;t.selection=n,t.populations=[...new Set(n.map(a=>a[t.group_var]))],t.times=[...new Set(n.map(a=>a[t.time_var]))],t.selection_populations=[...new Set(n.map(a=>a[t.group_var]))],t.selection_times=[...new Set(n.map(a=>a[t.time_var]))]}).addCase(hv.fulfilled,(t,r)=>{t.time_var=r.payload.time_var,t.times=r.payload.times,t.selection_times=r.payload.selection_times}).addCase(dv.fulfilled,(t,r)=>{t.group_var=r.payload.group_var,t.populations=r.payload.populations,t.selection_populations=r.payload.selection_populations}),e.addCase(cv.fulfilled,(t,r)=>{qr("notification",{message:"Variables Assigned",description:"",placement:"topRight",type:"success"})}).addCase(cv.rejected,(t,r)=>{const n={message:"Error Assigning Variables",description:r.payload,type:"error"};qr("notification",n)}),e.addCase(Es.fulfilled,(t,r)=>{const n=r.payload.items;t.selection=n,t.populations=[...new Set(n.map(i=>i[t.group_var]))],t.times=[...new Set(n.map(i=>i[t.time_var]))],t.selection_populations=[...new Set(n.map(i=>i[t.group_var]))],t.selection_times=[...new Set(n.map(i=>i[t.time_var]))],qr("notification",{message:"Data Loaded",description:"",placement:"bottomRight",type:"success"})}),e.addCase(Es.rejected,(t,r)=>{const n={message:"Error Loading Data",description:r.payload,type:"error"};qr("notification",n)}),e.addCase(ks.fulfilled,(t,r)=>{const n=r.payload.items;t.quarantineData=[],t.selection=n,t.populations=[...new Set(n.map(i=>i[t.group_var]))],t.times=[...new Set(n.map(i=>i[t.time_var]))],t.selection_populations=[...new Set(n.map(i=>i[t.group_var]))],t.selection_times=[...new Set(n.map(i=>i[t.time_var]))],qr("notification",{message:"Data Loaded",description:"",placement:"bottomRight",type:"success"})}),e.addCase(ks.rejected,(t,r)=>{const n={message:"Error Loading Data",description:r.payload,type:"error"};qr("notification",n)}),e.addCase(ai.fulfilled,(t,r)=>{qr("notification",{message:"Aggregation Computed",type:"success"})}),e.addCase(ai.rejected,(t,r)=>{qr("notification",{message:"Error Computing Aggregation",type:"error"})}),e.addCase(ii.fulfilled,(t,r)=>{t.selection=r.payload,qr("notification",{message:"Hierarchy Aggregations Computed",type:"success"})}),e.addCase(ii.rejected,(t,r)=>{qr("notification",{message:"Error Computing Hierarchy Aggregations",type:"error"})})}});var G9=pv.reducer;const{setInit:iU,setSelection:sU,setFilteredData:oU,setAttrWidth:cU,setPreTransforms:q9,setScenarioRunResults:uU,setSelectedIds:fU,setDescriptions:K9,setQuarantineData:lU,setQuarantineSelection:hU}=pv.actions;let dn;const mv=e=>{console.log("starting WORKERS");const t=()=>dn||(e==="compare"?dn=new Worker(self.location.href,{type:"module"}):e==="evolution"?dn=new Worker(new URL("/cantabvis/assets/evo_worker-BUztd2x9.js",self.location.href),{type:"module"}):e==="correlation"&&(dn=new Worker(new URL("/cantabvis/assets/corr_worker-m7JlJPIx.js",self.location.href),{type:"module"})),dn);return{sendMessageToWorker:a=>new Promise((i,s)=>{try{const c=t();c.onmessage=f=>{const u=f.data;i(u)},c.onerror=f=>{s(f)},c.postMessage(a)}catch(c){s(c)}}),terminateWorker:()=>{dn&&(dn.terminate(),dn=null)}}},{sendMessageToWorker:X9}=mv("compare"),Mf=Me("compare/startWorker",async(e,{rejectWithValue:t})=>{try{return await X9(e)}catch(r){return console.error("Error starting worker:",r),t(r.message||"Failed sending message to worker")}}),{publish:Y9}=On,xv=or({name:"compare",initialState:{init:!1,selectedVar:null,nBars:15,desc:!0,filterList:[],isNumeric:!0,pValue:1,estimator:"swarm",nPoints:100,distrRange:.5,pointSize:5,blurGroups:[],hideGroups:[],result:null,loading:!1},reducers:{setInit:(e,t)=>{e.init=t.payload},setIsNumeric:(e,t)=>{e.isNumeric=t.payload},setSelectedVar:(e,t)=>{e.selectedVar=t.payload},setNBars:(e,t)=>{e.nBars=t.payload},setDesc:(e,t)=>{e.desc=t.payload},addFilteringVariable:(e,t)=>{e.filterList.push(t.payload)},setFilteringList:(e,t)=>{e.filterList=t.payload},setPValue:(e,t)=>{e.pValue=t.payload},setResult:(e,t)=>{e.result=t.payload},setEstimator:(e,t)=>{e.estimator=t.payload},setPointSize:(e,t)=>{e.pointSize=t.payload},setDistrRange:(e,t)=>{e.distrRange=t.payload},setNPoints:(e,t)=>{e.nPoints=t.payload},setBlurGroups:(e,t)=>{e.blurGroups=t.payload},setHideGroups:(e,t)=>{e.hideGroups=t.payload}},extraReducers:e=>{e.addCase(Mf.pending,t=>{t.loading=!0,t.error=null}).addCase(Mf.fulfilled,(t,r)=>{t.loading=!1,console.log("UPDATING RESULT"),t.result=r.payload}).addCase(Mf.rejected,(t,r)=>{t.loading=!1;const n={message:"Error computing data on worker",description:r.payload,type:"error",pauseOnHover:!0};Y9("notification",n)})}});var J9=xv.reducer;const{setInit:pU,setIsNumeric:mU,setSelectedVar:xU,setNBars:gU,setPValue:vU,setDesc:_U,setFilteringList:yU,addFilteringVariable:wU,setResult:EU,setEstimator:kU,setDistrRange:TU,setPointSize:AU,setNPoints:CU,setBlurGroups:bU,setHideGroups:SU}=xv.actions,{sendMessageToWorker:Q9}=mv("evolution"),Uf=Me("evolution/startWorker",async(e,{rejectWithValue:t})=>{try{return await Q9(e)}catch(r){return console.error("Error starting worker:",r),t(r.message||"Failed sending message to worker")}}),{publish:Z9}=On,gv=or({name:"evolution",initialState:{init:!1,selectedVar:null,selectedPopulation:null,nBars:15,desc:!0,filterList:[],isNumeric:!0,pValue:.05,showStds:!0,showMeans:!0,meanPointSize:20,subjectPointSize:5,meanStrokeWidth:10,subjectStrokeWidth:2,blurGroups:[],hideGroups:[],result:null,loading:!1},reducers:{setInit:(e,t)=>{e.init=t.payload},setIsNumeric:(e,t)=>{e.isNumeric=t.payload},setSelectedVar:(e,t)=>{e.selectedVar=t.payload},setSelectedPopulation:(e,t)=>{e.selectedPopulation=t.payload},setNBars:(e,t)=>{e.nBars=t.payload},setDesc:(e,t)=>{e.desc=t.payload},addFilteringVariable:(e,t)=>{e.filterList.push(t.payload)},setFilteringList:(e,t)=>{e.filterList=t.payload},setPValue:(e,t)=>{e.pValue=t.payload},setResult:(e,t)=>{e.result=t.payload},setShowStd:(e,t)=>{e.showStds=t.payload},setShowMeans:(e,t)=>{e.showMeans=t.payload},setMeanPointSize:(e,t)=>{e.meanPointSize=t.payload},setSubjectPointSize:(e,t)=>{e.subjectPointSize=t.payload},setMeanStrokeWidth:(e,t)=>{e.meanStrokeWidth=t.payload},setSubjectStrokeWidth:(e,t)=>{e.subjectStrokeWidth=t.payload},setBlurGroups:(e,t)=>{e.blurGroups=t.payload},setHideGroups:(e,t)=>{e.hideGroups=t.payload}},extraReducers:e=>{e.addCase(Uf.pending,t=>{t.loading=!0,t.error=null}).addCase(Uf.fulfilled,(t,r)=>{t.loading=!1,t.result=r.payload}).addCase(Uf.rejected,(t,r)=>{t.loading=!1;const n={message:"Error computing data on worker",description:r.payload,type:"error",pauseOnHover:!0};Z9("notification",n)})}});var j9=gv.reducer;const{setInit:IU,setIsNumeric:OU,setSelectedVar:RU,setSelectedPopulation:NU,setNBars:DU,setPValue:PU,setDesc:LU,setFilteringList:BU,addFilteringVariable:MU,setResult:UU,setShowStd:VU,setShowMeans:$U,setMeanPointSize:HU,setSubjectPointSize:WU,setMeanStrokeWidth:zU,setSubjectStrokeWidth:GU,setBlurGroups:qU,setHideGroups:KU}=gv.actions,{publish:eL}=On,tL={init:!1,is_scatter:!0,columns:[],points_size:5,selectedPopulations:[],result:[],loading:!1,isOnlyCorrelations:!1,nVariables:10},Vf=Me("correlation/startWorker",async(e,{rejectWithValue:t})=>{try{const[r,n,a,i]=e,s=y7(r,n,a,i);return console.log(s),s}catch(r){return console.error("Error starting worker:",r),t(r.message||"Failed to start worker")}}),vv=or({name:"correlation",initialState:tL,reducers:{setInit:(e,t)=>{e.init=t.payload},setIsScatter:(e,t)=>{e.is_scatter=t.payload},setColumns:(e,t)=>{e.columns=t.payload},setPointsSize:(e,t)=>{e.points_size=t.payload},setIsOnlyCorrelations:(e,t)=>{e.isOnlyCorrelations=t.payload},setNVariables:(e,t)=>{e.nVariables=t.payload},setSelectedPopulations:(e,t)=>{e.selectedPopulations=t.payload}},extraReducers:e=>{e.addCase(Vf.pending,t=>{t.loading=!0,t.error=null}).addCase(Vf.fulfilled,(t,r)=>{t.loading=!1,t.result=r.payload}).addCase(Vf.rejected,(t,r)=>{t.loading=!1;const n={message:"Error computing data on worker",description:r.payload,type:"error",pauseOnHover:!0};eL("notification",n)})}});var rL=vv.reducer;const{setInit:XU,setIsScatter:YU,setColumns:JU,setPointsSize:QU,setIsOnlyCorrelations:ZU,setNVariables:jU,setSelectedPopulations:eV}=vv.actions;var Ue={};function nL(e){return!!(e&&typeof e.then=="function")}function Rc(e){return e||(e=0),new Promise(function(t){return setTimeout(t,e)})}function aL(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function Nc(){return Math.random().toString(36).substring(2)}var _v=0,$f=0;function Dc(){var e=new Date().getTime();return e===_v?($f++,e*1e3+$f):(_v=e,$f=0,e*1e3)}var Ts=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",iL=Dc,sL="native";function oL(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(r){t.messagesCallback&&t.messagesCallback(r.data)},t}function cL(e){e.bc.close(),e.subFns=[]}function uL(e,t){try{return e.bc.postMessage(t,!1),Promise.resolve()}catch(r){return Promise.reject(r)}}function fL(e,t){e.messagesCallback=t}function lL(){if(Ts&&typeof window>"u")return!1;if(typeof BroadcastChannel=="function"){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}else return!1}function hL(){return 150}var dL={create:oL,close:cL,onMessage:fL,postMessage:uL,canBeUsed:lL,type:sL,averageResponseTime:hL,microSeconds:iL},yv=function(){function e(t){this.ttl=t,this.set=new Set,this.timeMap=new Map}return e.prototype.has=function(t){return this.set.has(t)},e.prototype.add=function(t){var r=this;this.timeMap.set(t,wv()),this.set.add(t),setTimeout(function(){pL(r)},0)},e.prototype.clear=function(){this.set.clear(),this.timeMap.clear()},e}();function pL(e){for(var t=wv()-e.ttl,r=e.set[Symbol.iterator]();;){var n=r.next().value;if(!n)return;var a=e.timeMap.get(n);if(a<t)e.timeMap.delete(n),e.set.delete(n);else return}}function wv(){return new Date().getTime()}function Pc(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return typeof t.webWorkerSupport>"u"&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=1e3*45),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&typeof e.idb.onclose=="function"&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=1e3*60),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=1e3*60*2),typeof t.node.useFastPath>"u"&&(t.node.useFastPath=!0),t}var mL=Dc,xL="pubkey.broadcast-channel-0-",pn="messages",gL="idb";function Ev(){if(typeof indexedDB<"u")return indexedDB;if(typeof window<"u"){if(typeof window.mozIndexedDB<"u")return window.mozIndexedDB;if(typeof window.webkitIndexedDB<"u")return window.webkitIndexedDB;if(typeof window.msIndexedDB<"u")return window.msIndexedDB}return!1}function vL(e){var t=Ev(),r=xL+e,n=t.open(r,1);n.onupgradeneeded=function(i){var s=i.target.result;s.createObjectStore(pn,{keyPath:"id",autoIncrement:!0})};var a=new Promise(function(i,s){n.onerror=function(c){return s(c)},n.onsuccess=function(){i(n.result)}});return a}function _L(e,t,r){var n=new Date().getTime(),a={uuid:t,time:n,data:r},i=e.transaction([pn],"readwrite");return new Promise(function(s,c){i.oncomplete=function(){return s()},i.onerror=function(u){return c(u)};var f=i.objectStore(pn);f.add(a)})}function yL(e,t){var r=e.transaction(pn).objectStore(pn),n=[];function a(){try{var i=IDBKeyRange.bound(t+1,1/0);return r.openCursor(i)}catch{return r.openCursor()}}return new Promise(function(i){a().onsuccess=function(s){var c=s.target.result;c?c.value.id<t+1?c.continue(t+1):(n.push(c.value),c.continue()):i(n)}})}function wL(e,t){var r=e.transaction([pn],"readwrite").objectStore(pn).delete(t);return new Promise(function(n){r.onsuccess=function(){return n()}})}function EL(e,t){var r=new Date().getTime()-t,n=e.transaction(pn).objectStore(pn),a=[];return new Promise(function(i){n.openCursor().onsuccess=function(s){var c=s.target.result;if(c){var f=c.value;if(f.time<r)a.push(f),c.continue();else{i(a);return}}else i(a)}})}function kL(e,t){return EL(e,t).then(function(r){return Promise.all(r.map(function(n){return wL(e,n.id)}))})}function TL(e,t){return t=Pc(t),vL(e).then(function(r){var n={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:Nc(),eMIs:new yv(t.idb.ttl*2),writeBlockPromise:Promise.resolve(),messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){n.closed=!0,t.idb.onclose&&t.idb.onclose()},kv(n),n})}function kv(e){e.closed||Tv(e).then(function(){return Rc(e.options.idb.fallbackInterval)}).then(function(){return kv(e)})}function AL(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}function Tv(e){return e.closed||!e.messagesCallback?Promise.resolve():yL(e.db,e.lastCursorId).then(function(t){var r=t.filter(function(n){return!!n}).map(function(n){return n.id>e.lastCursorId&&(e.lastCursorId=n.id),n}).filter(function(n){return AL(n,e)}).sort(function(n,a){return n.time-a.time});return r.forEach(function(n){e.messagesCallback&&(e.eMIs.add(n.id),e.messagesCallback(n.data))}),Promise.resolve()})}function CL(e){e.closed=!0,e.db.close()}function bL(e,t){return e.writeBlockPromise=e.writeBlockPromise.then(function(){return _L(e.db,e.uuid,t)}).then(function(){aL(0,10)===0&&kL(e.db,e.options.idb.ttl)}),e.writeBlockPromise}function SL(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,Tv(e)}function FL(){if(Ts)return!1;var e=Ev();return!!e}function IL(e){return e.idb.fallbackInterval*2}var OL={create:TL,close:CL,onMessage:SL,postMessage:bL,canBeUsed:FL,type:gL,averageResponseTime:IL,microSeconds:mL},RL=Dc,NL="pubkey.broadcastChannel-",DL="localstorage";function Av(){var e;if(typeof window>"u")return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch{}return e}function Cv(e){return NL+e}function PL(e,t){return new Promise(function(r){Rc().then(function(){var n=Cv(e.channelName),a={token:Nc(),time:new Date().getTime(),data:t,uuid:e.uuid},i=JSON.stringify(a);Av().setItem(n,i);var s=document.createEvent("Event");s.initEvent("storage",!0,!0),s.key=n,s.newValue=i,window.dispatchEvent(s),r()})})}function LL(e,t){var r=Cv(e),n=function(i){i.key===r&&t(JSON.parse(i.newValue))};return window.addEventListener("storage",n),n}function BL(e){window.removeEventListener("storage",e)}function ML(e,t){if(t=Pc(t),!bv())throw new Error("BroadcastChannel: localstorage cannot be used");var r=Nc(),n=new yv(t.localstorage.removeTimeout),a={channelName:e,uuid:r,eMIs:n};return a.listener=LL(e,function(i){a.messagesCallback&&i.uuid!==r&&(!i.token||n.has(i.token)||i.data.time&&i.data.time<a.messagesCallbackTime||(n.add(i.token),a.messagesCallback(i.data)))}),a}function UL(e){BL(e.listener)}function VL(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t}function bv(){if(Ts)return!1;var e=Av();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch{return!1}return!0}function $L(){var e=120,t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?e*2:e}var HL={create:ML,close:UL,onMessage:VL,postMessage:PL,canBeUsed:bv,type:DL,averageResponseTime:$L,microSeconds:RL},WL=Dc,zL="simulate",Hf=new Set;function GL(e){var t={name:e,messagesCallback:null};return Hf.add(t),t}function qL(e){Hf.delete(e)}function KL(e,t){return new Promise(function(r){return setTimeout(function(){var n=Array.from(Hf);n.filter(function(a){return a.name===e.name}).filter(function(a){return a!==e}).filter(function(a){return!!a.messagesCallback}).forEach(function(a){return a.messagesCallback(t)}),r()},5)})}function XL(e,t){e.messagesCallback=t}function YL(){return!0}function JL(){return 5}var QL={create:GL,close:qL,onMessage:XL,postMessage:KL,canBeUsed:YL,type:zL,averageResponseTime:JL,microSeconds:WL},Wf=[dL,OL,HL];if(Ts){var Sv=require("../../src/methods/node.js");typeof Sv.canBeUsed=="function"&&Wf.push(Sv)}function Fv(e){var t=[].concat(e.methods,Wf).filter(Boolean);if(e.type){if(e.type==="simulate")return QL;var r=t.find(function(a){return a.type===e.type});if(r)return r;throw new Error("method-type "+e.type+" not found")}!e.webWorkerSupport&&!Ts&&(t=t.filter(function(a){return a.type!=="idb"}));var n=t.find(function(a){return a.canBeUsed()});if(n)return n;throw new Error("No useable methode found:"+JSON.stringify(Wf.map(function(a){return a.type})))}var zf=function(t,r){this.name=t,Gf&&(r=Gf),this.options=Pc(r),this.method=Fv(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,e7(this)};zf._pubkey=!0;function ZL(e){e=Pc(e);var t=Fv(e);return t.type==="node"?t.clearNodeFolder().then(function(){return!0}):Promise.resolve(!1)}var Gf;function jL(e){Gf=e}zf.prototype={postMessage:function(t){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed");return Iv(this,"message",t)},postInternal:function(t){return Iv(this,"internal",t)},set onmessage(e){var t=this.method.microSeconds(),r={time:t,fn:e};Nv(this,"message",this._onML),e&&typeof e=="function"?(this._onML=r,Rv(this,"message",r)):this._onML=null},addEventListener:function(t,r){var n=this.method.microSeconds(),a={time:n,fn:r};Rv(this,t,a)},removeEventListener:function(t,r){var n=this._addEL[t].find(function(a){return a.fn===r});Nv(this,t,n)},close:function(){var t=this;if(!this.closed){this.closed=!0;var r=this._prepP?this._prepP:Promise.resolve();return this._onML=null,this._addEL.message=[],r.then(function(){return Promise.all(Array.from(t._uMP))}).then(function(){return Promise.all(t._befC.map(function(n){return n()}))}).then(function(){return t.method.close(t._state)})}},get type(){return this.method.type},get isClosed(){return this.closed}};function Iv(e,t,r){var n=e.method.microSeconds(),a={time:n,type:t,data:r},i=e._prepP?e._prepP:Promise.resolve();return i.then(function(){var s=e.method.postMessage(e._state,a);return e._uMP.add(s),s.catch().then(function(){return e._uMP.delete(s)}),s})}function e7(e){var t=e.method.create(e.name,e.options);nL(t)?(e._prepP=t,t.then(function(r){e._state=r})):e._state=t}function Ov(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function Rv(e,t,r){e._addEL[t].push(r),t7(e)}function Nv(e,t,r){e._addEL[t]=e._addEL[t].filter(function(n){return n!==r}),r7(e)}function t7(e){if(!e._iL&&Ov(e)){var t=function(a){e._addEL[a.type].forEach(function(i){a.time>=i.time&&i.fn(a.data)})},r=e.method.microSeconds();e._prepP?e._prepP.then(function(){e._iL=!0,e.method.onMessage(e._state,t,r)}):(e._iL=!0,e.method.onMessage(e._state,t,r))}}function r7(e){if(e._iL&&!Ov(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}var n7=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";function a7(e){if(!(typeof WorkerGlobalScope=="function"&&self instanceof WorkerGlobalScope)){if(typeof window.addEventListener!="function")return;window.addEventListener("beforeunload",function(){e()},!0),window.addEventListener("unload",function(){e()},!0)}}var i7={add:a7},s7={},o7=n7?s7:i7,ga=new Set,Dv=!1;function c7(){Dv||(Dv=!0,o7.add(Pv))}function u7(e){if(c7(),typeof e!="function")throw new Error("Listener is no function");ga.add(e);var t={remove:function(){return ga.delete(e)},run:function(){return ga.delete(e),e()}};return t}function Pv(){var e=[];return ga.forEach(function(t){e.push(t()),ga.delete(t)}),Promise.all(e)}function f7(){ga.clear()}function l7(){return ga.size}var h7={add:u7,runAll:Pv,removeAll:f7,getSize:l7},Lv=function(t,r){this._channel=t,this._options=r,this.isLeader=!1,this.isDead=!1,this.token=Nc(),this._isApl=!1,this._reApply=!1,this._unl=[],this._lstns=[],this._invs=[],this._dpL=function(){},this._dpLC=!1};Lv.prototype={applyOnce:function(){var t=this;if(this.isLeader||this.isDead)return Promise.resolve(!1);if(this._isApl)return this._reApply=!0,Promise.resolve(!1);this._isApl=!0;var r=!1,n=function(s){s.context==="leader"&&s.token!=t.token&&(s.action==="apply"&&s.token>t.token&&(r=!0),s.action==="tell"&&(r=!0))};this._channel.addEventListener("internal",n);var a=va(this,"apply").then(function(){return Rc(t._options.responseTime)}).then(function(){return r?Promise.reject(new Error):va(t,"apply")}).then(function(){return Rc(t._options.responseTime)}).then(function(){return r?Promise.reject(new Error):va(t)}).then(function(){return Bv(t)}).then(function(){return!0}).catch(function(){return!1}).then(function(i){return t._channel.removeEventListener("internal",n),t._isApl=!1,!i&&t._reApply?(t._reApply=!1,t.applyOnce()):i});return a},awaitLeadership:function(){return this._aLP||(this._aLP=d7(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var t=this;if(!this.isDead)return this.isDead=!0,this._lstns.forEach(function(r){return t._channel.removeEventListener("internal",r)}),this._invs.forEach(function(r){return clearInterval(r)}),this._unl.forEach(function(r){r.remove()}),va(this,"death")}};function d7(e){return e.isLeader?Promise.resolve():new Promise(function(t){var r=!1;function n(){r||(r=!0,clearInterval(a),e._channel.removeEventListener("internal",i),t(!0))}e.applyOnce().then(function(){e.isLeader&&n()});var a=setInterval(function(){e.applyOnce().then(function(){e.isLeader&&n()})},e._options.fallbackInterval);e._invs.push(a);var i=function(c){c.context==="leader"&&c.action==="death"&&e.applyOnce().then(function(){e.isLeader&&n()})};e._channel.addEventListener("internal",i),e._lstns.push(i)})}function va(e,t){var r={context:"leader",action:t,token:e.token};return e._channel.postInternal(r)}function Bv(e){e.isLeader=!0;var t=h7.add(function(){return e.die()});e._unl.push(t);var r=function(a){a.context==="leader"&&a.action==="apply"&&va(e,"tell"),a.context==="leader"&&a.action==="tell"&&!e._dpLC&&(e._dpLC=!0,e._dpL(),va(e,"tell"))};return e._channel.addEventListener("internal",r),e._lstns.push(r),va(e,"tell")}function p7(e,t){return e||(e={}),e=JSON.parse(JSON.stringify(e)),e.fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}function m7(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=p7(t,e);var r=new Lv(e,t);return e._befC.push(function(){return r.die()}),e._leaderElector=r,r}var x7=Object.freeze({__proto__:null,BroadcastChannel:zf,beLeader:Bv,clearNodeFolder:ZL,createLeaderElection:m7,enforceOptions:jL}),g7=Hb(x7),Mv;function v7(){if(Mv)return Ue;Mv=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.initMessageListener=Ue.initStateWithPrevTab=Ue.withReduxStateSync=Ue.createReduxStateSync=Ue.createStateSyncMiddleware=Ue.WINDOW_STATE_SYNC_ID=Ue.INIT_MESSAGE_LISTENER=Ue.RECEIVE_INIT_STATE=Ue.SEND_INIT_STATE=Ue.GET_INIT_STATE=void 0,Ue.generateUuidForAction=p,Ue.isActionAllowed=m,Ue.isActionSynced=x,Ue.MessageListener=v;var e=g7,t=0,r=Ue.GET_INIT_STATE="&_GET_INIT_STATE",n=Ue.SEND_INIT_STATE="&_SEND_INIT_STATE",a=Ue.RECEIVE_INIT_STATE="&_RECEIVE_INIT_STATE",i=Ue.INIT_MESSAGE_LISTENER="&_INIT_MESSAGE_LISTENER",s={channel:"redux_state_sync",predicate:null,blacklist:[],whitelist:[],broadcastChannelOption:void 0,prepareState:function(_){return _},receiveState:function(_,w){return w}},c=function(){return{type:r}},f=function(){return{type:n}},u=function(_){return{type:a,payload:_}},o=function(){return{type:i}};function l(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}function h(){return""+l()+l()+"-"+l()+"-"+l()+"-"+l()+"-"+l()+l()+l()}var d=Ue.WINDOW_STATE_SYNC_ID=h();function p(g){var _=g;return _.$uuid=h(),_.$wuid=d,_}function m(g){var _=g.predicate,w=g.blacklist,E=g.whitelist,k=function(){return!0};return _&&typeof _=="function"?k=_:Array.isArray(w)?k=function(b){return w.indexOf(b.type)<0}:Array.isArray(E)&&(k=function(b){return E.indexOf(b.type)>=0}),k}function x(g){return!!g.$isSync}function v(g){var _=g.channel,w=g.dispatch,E=g.allowed,k=!1,F={};this.handleOnMessage=function(b){b.$wuid!==d&&b.type!==a&&b.$uuid&&b.$uuid!==t&&(b.type===r&&!F[b.$wuid]?(F[b.$wuid]=!0,w(f())):b.type===n&&!F[b.$wuid]?k||(k=!0,w(u(b.payload))):E(b)&&(t=b.$uuid,w(Object.assign(b,{$isSync:!0}))))},this.messageChannel=_,this.messageChannel.onmessage=this.handleOnMessage}Ue.createStateSyncMiddleware=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s,w=m(_),E=new e.BroadcastChannel(_.channel,_.broadcastChannelOption),k=_.prepareState||s.prepareState,F=null;return function(b){var L=b.getState,U=b.dispatch;return function(B){return function(Y){if(F||(F=new v({channel:E,dispatch:U,allowed:w})),Y&&!Y.$uuid){var se=p(Y);t=se.$uuid;try{if(Y.type===n)return L()&&(se.payload=k(L()),E.postMessage(se)),B(Y);(w(se)||Y.type===r)&&E.postMessage(se)}catch{console.error("Your browser doesn't support cross tab communication")}}return B(Object.assign(Y,{$isSync:typeof Y.$isSync>"u"?!1:Y.$isSync}))}}}};var y=Ue.createReduxStateSync=function(_){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s.receiveState;return function(E,k){var F=E;return k.type===a&&(F=w(E,k.payload)),_(F,k)}};return Ue.withReduxStateSync=y,Ue.initStateWithPrevTab=function(_){var w=_.dispatch;w(c())},Ue.initMessageListener=function(_){var w=_.dispatch;w(o())},Ue}var Uv=v7();const _7=s1({main:A6,selection:I6,atlas:y6,matrix:b6,circular:O6,list:S6,cantab:G9,compare:J9,evolution:j9,correlation:rL,metadata:V9,dataframe:W9});yS({reducer:Uv.withReduxStateSync(_7),middleware:e=>e({immutableCheck:!1,serializableCheck:!1,immutableStateInvariant:!1}).concat(Uv.createStateSyncMiddleware())});function y7(e,t,r,n){const a={};console.log(e,t),t.filter(f=>!L9.includes(f));for(const f of e)if(r.includes(f[n]))for(const u of t)a[u]||(a[u]=[]),a[u].push(+f[u]);const s=TA(a).select(t).objects();return w7(s)}function w7(e){const t=E7(e).reverse(),r=[];for(let n=0;n<t.length;n++){const a=Vv(e,t[n]);for(let i=n;i<t.length;i++){const s=Vv(e,t[i]),c=Yb(a,s);r.push({x:t[n],y:t[i],value:c}),n!==i&&r.push({x:t[i],y:t[n],value:c})}}return r}function E7(e){return Object.keys(e[0])}function Vv(e,t){return e.map(r=>r[t])}function k7(e,t,r){const n=Vt(e),a=S7(n),i=[];return a.forEach(s=>{const c=F7(e,s,t),{chiSquared:f,pValue:u}=I7(c),o={variable:s,value:f,p_value:u};!Number.isNaN(f)&&Number.isFinite(f)&&f>0&&u<r&&s!==t&&i.push(o)}),i}function T7(e,t,r){const n=e.groupby(t),a=Hv(e),i=[];return a.forEach(s=>{const c=$v(n,s,t),f=c.array("mean"),u=c.array("std").map(p=>p||0),o=c.array("count"),l=(f[0]-f[1])/Math.sqrt(u[0]**2/o[0]+u[1]**2/o[1]),h=2*(1-h0.jStat.normal.cdf(Math.abs(l),0,1)),d={variable:s,value:l,p_value:h,my_value:"lalalala",statistics:c.objects()};!Number.isNaN(l)&&Number.isFinite(l)&&h<r&&i.push(d)}),i}function A7(e,t,r){const n=e.groupby(t),a=n.objects({grouped:"entries"}).length,i=n.numRows(),s=Hv(e),c=[];return s.forEach(f=>{const u=$v(n,f,t),o=u.array("mean"),l=AA(e.array(f)),d=C7(o,l)/(a-1),p=n.objects({grouped:"entries"}),x=b7(p,u,f)/(i-a),v=d/x,y=a-1,g=i-a,_=h0.jStat.ftest(v,y,g);if(!Number.isNaN(v)&&Number.isFinite(v)&&v>0&&_<r){const w={variable:f,value:v,p_value:_,statistics:u.objects()};c.push(w)}}),c}function $v(e,t,r){return e.rollup({mean:zn.average(t),std:zn.stdev(t),variance:zn.variance(t),count:zn.count()}).rename({[r]:"group"})}function C7(e,t){return e.reduce((r,n)=>r+Math.pow(n-t,2),0)}function b7(e,t,r){return e.map(i=>{const s=i[0],c=t.filter(mA(o=>o.group===s)).get("mean");return i[1].reduce((o,l)=>o+Math.pow(l[r]-c,2),0)}).reduce((i,s)=>i+s,0)}function Hv(e){return e.columnNames().filter(r=>{if(r!="")return e.array(r).every(n=>typeof+n=="number"&&!isNaN(n))})}function S7(e){const t=e.columnNames().filter(n=>e.array(n).every(a=>typeof+a=="number"&&!isNaN(a)));return e.columnNames().filter(n=>!t.includes(n))}function F7(e,t,r){const n=new Set,a=new Set;e.forEach(f=>{n.add(f[r]),a.add(f[t])});const i=Array.from(n),s=Array.from(a),c=Array.from({length:i.length},()=>Array(s.length).fill(0));return e.forEach(f=>{const u=i.indexOf(f[r]),o=s.indexOf(f[t]);c[u][o]++}),c}function I7(e){const t=e.map(c=>c.reduce((f,u)=>f+u,0)),r=e[0].map((c,f)=>e.reduce((u,o)=>u+o[f],0)),n=t.reduce((c,f)=>c+f,0);let a=0;for(let c=0;c<e.length;c++)for(let f=0;f<e[c].length;f++){const u=t[c]*r[f]/n;a+=Math.pow(e[c][f]-u,2)/u}const i=(e.length-1)*(e[0].length-1),s=1-h0.jStat.chisquare.cdf(a,i);return{chiSquared:a,pValue:s}}const O7=(e,t)=>{try{return parse(e,t,new Date)}catch{return null}},R7=e=>{try{return new Date(e*1e3)}catch{return null}};Ju("string",e=>e==null?"":e.toString(),{override:!0}),Ju("parseDate",O7,{override:!0}),Ju("parseUnixDate",R7,{override:!0}),onmessage=function(e){const[t,r,n,a]=e.data,i=Vt(t);let s;console.log("COM WROKER"),n==="Z-Score"?s=T7(i,r,a):n==="F-Value"?s=A7(i,r,a):n==="Chi-Square"&&(s=k7(t,r,a));const c={data:s,measure:n};s.length===0&&(c.measure="No Data"),console.log("WORKER RESPONSE:",c),postMessage(c)}})();
